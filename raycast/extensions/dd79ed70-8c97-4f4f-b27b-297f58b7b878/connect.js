"use strict";var m=Object.create;var s=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var R=(t,e)=>{for(var o in e)s(t,o,{get:e[o],enumerable:!0})},i=(t,e,o,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of h(e))!y.call(t,r)&&r!==o&&s(t,r,{get:()=>e[r],enumerable:!(c=f(e,r))||c.enumerable});return t};var S=(t,e,o)=>(o=t!=null?m(g(t)):{},i(e||!t||!t.__esModule?s(o,"default",{value:t,enumerable:!0}):o,t)),C=t=>i(s({},"__esModule",{value:!0}),t);var F={};R(F,{default:()=>T});module.exports=C(F);var n=require("@raycast/api");var a=require("@raycast/api"),u=require("child_process"),l=S(require("util")),k=l.default.promisify(u.exec),x=(0,a.getPreferenceValues)(),P="/Applications/Cloudflare WARP.app/Contents/Resources/warp-cli",b=x.wrapCliPath??P;function d(t){return k(`"${b}" ${t}`)}async function w(){try{let{stdout:t}=await d("connect");if(t.includes("Success"))return!0;throw new Error("Failed to connect")}catch(t){return console.error(t),!1}}async function p(){let{stdout:t}=await d("status"),e=t.trim().split(`
`);return e.length<2?{status:"disconnected",disconnectReason:"unknown"}:e[1].includes("Disconnected")?{status:"disconnected",disconnectReason:e[1].substring(37)}:e[1].includes("Connected")?{status:"connected",disconnectReason:""}:{status:"unknown",disconnectReason:"unknown"}}var T=async()=>{try{if((await p()).status==="connected"){await(0,n.showHUD)("Already connected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}if(await w()){await(0,n.showHUD)("Connected",{clearRootSearch:!0,popToRootType:n.PopToRootType.Immediate});return}throw new Error("Failed to connect")}catch{await(0,n.showToast)({style:n.Toast.Style.Failure,title:"Failed to connect"})}};
