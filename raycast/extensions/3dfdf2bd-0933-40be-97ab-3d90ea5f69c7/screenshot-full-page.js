"use strict";var aA=Object.create;var Za=Object.defineProperty;var lA=Object.getOwnPropertyDescriptor;var cA=Object.getOwnPropertyNames;var uA=Object.getPrototypeOf,dA=Object.prototype.hasOwnProperty;var M=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),hA=(r,e)=>{for(var t in e)Za(r,t,{get:e[t],enumerable:!0})},q0=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of cA(e))!dA.call(r,s)&&s!==t&&Za(r,s,{get:()=>e[s],enumerable:!(n=lA(e,s))||n.enumerable});return r};var ip=(r,e,t)=>(t=r!=null?aA(uA(r)):{},q0(e||!r||!r.__esModule?Za(t,"default",{value:r,enumerable:!0}):t,r)),pA=r=>q0(Za({},"__esModule",{value:!0}),r);var it=M((WU,py)=>{"use strict";var fA=Object.create,el=Object.defineProperty,mA=Object.getOwnPropertyDescriptor,gA=Object.getOwnPropertyNames,_A=Object.getPrototypeOf,wA=Object.prototype.hasOwnProperty,ee=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),vA=(r,e)=>{for(var t in e)el(r,t,{get:e[t],enumerable:!0})},H0=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of gA(e))!wA.call(r,s)&&s!==t&&el(r,s,{get:()=>e[s],enumerable:!(n=mA(e,s))||n.enumerable});return r},ct=(r,e,t)=>(t=r!=null?fA(_A(r)):{},H0(e||!r||!r.__esModule?el(t,"default",{value:r,enumerable:!0}):t,r)),bA=r=>H0(el({},"__esModule",{value:!0}),r),yA=ee((r,e)=>{var t={};e.exports=t;var n={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(n).forEach(function(s){var o=n[s],a=t[s]=[];a.open="\x1B["+o[0]+"m",a.close="\x1B["+o[1]+"m"})}),xA=ee((r,e)=>{"use strict";e.exports=function(t,n){n=n||process.argv;var s=n.indexOf("--"),o=/^-{1,2}/.test(t)?"":"--",a=n.indexOf(o+t);return a!==-1&&(s===-1?!0:a<s)}}),SA=ee((r,e)=>{"use strict";var t=require("os"),n=xA(),s=process.env,o=void 0;n("no-color")||n("no-colors")||n("color=false")?o=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=!0),"FORCE_COLOR"in s&&(o=s.FORCE_COLOR.length===0||parseInt(s.FORCE_COLOR,10)!==0);function a(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function l(u){if(o===!1)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!u.isTTY&&o!==!0)return 0;var d=o?1:0;if(process.platform==="win32"){var h=t.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(h[0])>=10&&Number(h[2])>=10586?Number(h[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(function(f){return f in s})||s.CI_NAME==="codeship"?1:d;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in s){var p=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return p>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:(s.TERM,d)}function c(u){var d=l(u);return a(d)}e.exports={supportsColor:c,stdout:c(process.stdout),stderr:c(process.stderr)}}),EA=ee((r,e)=>{e.exports=function(t,n){var s="";t=t||"Run the trap, drop the bass",t=t.split("");var o={a:["@","\u0104","\u023A","\u0245","\u0394","\u039B","\u0414"],b:["\xDF","\u0181","\u0243","\u026E","\u03B2","\u0E3F"],c:["\xA9","\u023B","\u03FE"],d:["\xD0","\u018A","\u0500","\u0501","\u0502","\u0503"],e:["\xCB","\u0115","\u018E","\u0258","\u03A3","\u03BE","\u04BC","\u0A6C"],f:["\u04FA"],g:["\u0262"],h:["\u0126","\u0195","\u04A2","\u04BA","\u04C7","\u050A"],i:["\u0F0F"],j:["\u0134"],k:["\u0138","\u04A0","\u04C3","\u051E"],l:["\u0139"],m:["\u028D","\u04CD","\u04CE","\u0520","\u0521","\u0D69"],n:["\xD1","\u014B","\u019D","\u0376","\u03A0","\u048A"],o:["\xD8","\xF5","\xF8","\u01FE","\u0298","\u047A","\u05DD","\u06DD","\u0E4F"],p:["\u01F7","\u048E"],q:["\u09CD"],r:["\xAE","\u01A6","\u0210","\u024C","\u0280","\u042F"],s:["\xA7","\u03DE","\u03DF","\u03E8"],t:["\u0141","\u0166","\u0373"],u:["\u01B1","\u054D"],v:["\u05D8"],w:["\u0428","\u0460","\u047C","\u0D70"],x:["\u04B2","\u04FE","\u04FC","\u04FD"],y:["\xA5","\u04B0","\u04CB"],z:["\u01B5","\u0240"]};return t.forEach(function(a){a=a.toLowerCase();var l=o[a]||[" "],c=Math.floor(Math.random()*l.length);typeof o[a]<"u"?s+=o[a][c]:s+=a}),s}}),kA=ee((r,e)=>{e.exports=function(t,n){t=t||"   he is here   ";var s={up:["\u030D","\u030E","\u0304","\u0305","\u033F","\u0311","\u0306","\u0310","\u0352","\u0357","\u0351","\u0307","\u0308","\u030A","\u0342","\u0313","\u0308","\u034A","\u034B","\u034C","\u0303","\u0302","\u030C","\u0350","\u0300","\u0301","\u030B","\u030F","\u0312","\u0313","\u0314","\u033D","\u0309","\u0363","\u0364","\u0365","\u0366","\u0367","\u0368","\u0369","\u036A","\u036B","\u036C","\u036D","\u036E","\u036F","\u033E","\u035B","\u0346","\u031A"],down:["\u0316","\u0317","\u0318","\u0319","\u031C","\u031D","\u031E","\u031F","\u0320","\u0324","\u0325","\u0326","\u0329","\u032A","\u032B","\u032C","\u032D","\u032E","\u032F","\u0330","\u0331","\u0332","\u0333","\u0339","\u033A","\u033B","\u033C","\u0345","\u0347","\u0348","\u0349","\u034D","\u034E","\u0353","\u0354","\u0355","\u0356","\u0359","\u035A","\u0323"],mid:["\u0315","\u031B","\u0300","\u0301","\u0358","\u0321","\u0322","\u0327","\u0328","\u0334","\u0335","\u0336","\u035C","\u035D","\u035E","\u035F","\u0360","\u0362","\u0338","\u0337","\u0361"," \u0489"]},o=[].concat(s.up,s.down,s.mid);function a(u){var d=Math.floor(Math.random()*u);return d}function l(u){var d=!1;return o.filter(function(h){d=h===u}),d}function c(u,d){var h="",p,f;d=d||{},d.up=typeof d.up<"u"?d.up:!0,d.mid=typeof d.mid<"u"?d.mid:!0,d.down=typeof d.down<"u"?d.down:!0,d.size=typeof d.size<"u"?d.size:"maxi",u=u.split("");for(f in u)if(!l(f)){switch(h=h+u[f],p={up:0,down:0,mid:0},d.size){case"mini":p.up=a(8),p.mid=a(2),p.down=a(8);break;case"maxi":p.up=a(16)+3,p.mid=a(4)+1,p.down=a(64)+3;break;default:p.up=a(8)+1,p.mid=a(6)/2,p.down=a(8)+1;break}var _=["up","mid","down"];for(var v in _)for(var w=_[v],m=0;m<=p[w];m++)d[w]&&(h=h+s[w][a(s[w].length)])}return h}return c(t,n)}}),CA=ee((r,e)=>{e.exports=function(t){return function(n,s,o){if(n===" ")return n;switch(s%3){case 0:return t.red(n);case 1:return t.white(n);case 2:return t.blue(n)}}}}),TA=ee((r,e)=>{e.exports=function(t){return function(n,s,o){return s%2===0?n:t.inverse(n)}}}),OA=ee((r,e)=>{e.exports=function(t){var n=["red","yellow","green","blue","magenta"];return function(s,o,a){return s===" "?s:t[n[o++%n.length]](s)}}}),PA=ee((r,e)=>{e.exports=function(t){var n=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(s,o,a){return s===" "?s:t[n[Math.round(Math.random()*(n.length-2))]](s)}}}),AA=ee((r,e)=>{var t={};e.exports=t,t.themes={};var n=require("util"),s=t.styles=yA(),o=Object.defineProperties,a=new RegExp(/[\r\n]+/g);t.supportsColor=SA().supportsColor,typeof t.enabled>"u"&&(t.enabled=t.supportsColor()!==!1),t.enable=function(){t.enabled=!0},t.disable=function(){t.enabled=!1},t.stripColors=t.strip=function(m){return(""+m).replace(/\x1B\[\d+m/g,"")};var l=t.stylize=function(m,g){if(!t.enabled)return m+"";var x=s[g];return!x&&g in t?t[g](m):x.open+m+x.close},c=/[|\\{}()[\]^$+*?.]/g,u=function(m){if(typeof m!="string")throw new TypeError("Expected a string");return m.replace(c,"\\$&")};function d(m){var g=function x(){return f.apply(x,arguments)};return g._styles=m,g.__proto__=p,g}var h=function(){var m={};return s.grey=s.gray,Object.keys(s).forEach(function(g){s[g].closeRe=new RegExp(u(s[g].close),"g"),m[g]={get:function(){return d(this._styles.concat(g))}}}),m}(),p=o(function(){},h);function f(){var m=Array.prototype.slice.call(arguments),g=m.map(function(E){return E!=null&&E.constructor===String?E:n.inspect(E)}).join(" ");if(!t.enabled||!g)return g;for(var x=g.indexOf(`
`)!=-1,b=this._styles,y=b.length;y--;){var S=s[b[y]];g=S.open+g.replace(S.closeRe,S.open)+S.close,x&&(g=g.replace(a,function(E){return S.close+E+S.open}))}return g}t.setTheme=function(m){if(typeof m=="string"){console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));");return}for(var g in m)(function(x){t[x]=function(b){if(typeof m[x]=="object"){var y=b;for(var S in m[x])y=t[m[x][S]](y);return y}return t[m[x]](b)}})(g)};function _(){var m={};return Object.keys(h).forEach(function(g){m[g]={get:function(){return d([g])}}}),m}var v=function(m,g){var x=g.split("");return x=x.map(m),x.join("")};t.trap=EA(),t.zalgo=kA(),t.maps={},t.maps.america=CA()(t),t.maps.zebra=TA()(t),t.maps.rainbow=OA()(t),t.maps.random=PA()(t);for(w in t.maps)(function(m){t[m]=function(g){return v(t.maps[m],g)}})(w);var w;o(t,_())}),IA=ee((r,e)=>{var t=AA();e.exports=t}),RA=ee((r,e)=>{var t=1e3,n=t*60,s=n*60,o=s*24,a=o*7,l=o*365.25;e.exports=function(p,f){f=f||{};var _=typeof p;if(_==="string"&&p.length>0)return c(p);if(_==="number"&&isFinite(p))return f.long?d(p):u(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function c(p){if(p=String(p),!(p.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(f){var _=parseFloat(f[1]),v=(f[2]||"ms").toLowerCase();switch(v){case"years":case"year":case"yrs":case"yr":case"y":return _*l;case"weeks":case"week":case"w":return _*a;case"days":case"day":case"d":return _*o;case"hours":case"hour":case"hrs":case"hr":case"h":return _*s;case"minutes":case"minute":case"mins":case"min":case"m":return _*n;case"seconds":case"second":case"secs":case"sec":case"s":return _*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function u(p){var f=Math.abs(p);return f>=o?Math.round(p/o)+"d":f>=s?Math.round(p/s)+"h":f>=n?Math.round(p/n)+"m":f>=t?Math.round(p/t)+"s":p+"ms"}function d(p){var f=Math.abs(p);return f>=o?h(p,f,o,"day"):f>=s?h(p,f,s,"hour"):f>=n?h(p,f,n,"minute"):f>=t?h(p,f,t,"second"):p+" ms"}function h(p,f,_,v){var w=f>=_*1.5;return Math.round(p/_)+" "+v+(w?"s":"")}}),$0=ee((r,e)=>{function t(n){o.debug=o,o.default=o,o.coerce=h,o.disable=c,o.enable=l,o.enabled=u,o.humanize=RA(),o.destroy=p,Object.keys(n).forEach(f=>{o[f]=n[f]}),o.names=[],o.skips=[],o.formatters={};function s(f){let _=0;for(let v=0;v<f.length;v++)_=(_<<5)-_+f.charCodeAt(v),_|=0;return o.colors[Math.abs(_)%o.colors.length]}o.selectColor=s;function o(f){let _,v=null,w,m;function g(...x){if(!g.enabled)return;let b=g,y=Number(new Date),S=y-(_||y);b.diff=S,b.prev=_,b.curr=y,_=y,x[0]=o.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let E=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(C,k)=>{if(C==="%%")return"%";E++;let F=o.formatters[k];if(typeof F=="function"){let O=x[E];C=F.call(b,O),x.splice(E,1),E--}return C}),o.formatArgs.call(b,x),(b.log||o.log).apply(b,x)}return g.namespace=f,g.useColors=o.useColors(),g.color=o.selectColor(f),g.extend=a,g.destroy=o.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>v!==null?v:(w!==o.namespaces&&(w=o.namespaces,m=o.enabled(f)),m),set:x=>{v=x}}),typeof o.init=="function"&&o.init(g),g}function a(f,_){let v=o(this.namespace+(typeof _>"u"?":":_)+f);return v.log=this.log,v}function l(f){o.save(f),o.namespaces=f,o.names=[],o.skips=[];let _,v=(typeof f=="string"?f:"").split(/[\s,]+/),w=v.length;for(_=0;_<w;_++)v[_]&&(f=v[_].replace(/\*/g,".*?"),f[0]==="-"?o.skips.push(new RegExp("^"+f.slice(1)+"$")):o.names.push(new RegExp("^"+f+"$")))}function c(){let f=[...o.names.map(d),...o.skips.map(d).map(_=>"-"+_)].join(",");return o.enable(""),f}function u(f){if(f[f.length-1]==="*")return!0;let _,v;for(_=0,v=o.skips.length;_<v;_++)if(o.skips[_].test(f))return!1;for(_=0,v=o.names.length;_<v;_++)if(o.names[_].test(f))return!0;return!1}function d(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function h(f){return f instanceof Error?f.stack||f.message:f}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return o.enable(o.load()),o}e.exports=t}),MA=ee((r,e)=>{r.formatArgs=n,r.save=s,r.load=o,r.useColors=t,r.storage=a(),r.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,h=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(h=d))}),c.splice(h,0,u)}r.log=console.debug||console.log||(()=>{});function s(c){try{c?r.storage.setItem("debug",c):r.storage.removeItem("debug")}catch{}}function o(){let c;try{c=r.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function a(){try{return localStorage}catch{}}e.exports=$0()(r);var{formatters:l}=e.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}),FA=ee((r,e)=>{"use strict";e.exports=(t,n)=>{n=n||process.argv;let s=t.startsWith("-")?"":t.length===1?"-":"--",o=n.indexOf(s+t),a=n.indexOf("--");return o!==-1&&(a===-1?!0:o<a)}}),NA=ee((r,e)=>{"use strict";var t=require("os"),n=FA(),s=process.env,o;n("no-color")||n("no-colors")||n("color=false")?o=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=!0),"FORCE_COLOR"in s&&(o=s.FORCE_COLOR.length===0||parseInt(s.FORCE_COLOR,10)!==0);function a(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function l(u){if(o===!1)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!u.isTTY&&o!==!0)return 0;let d=o?1:0;if(process.platform==="win32"){let h=t.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(h[0])>=10&&Number(h[2])>=10586?Number(h[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(h=>h in s)||s.CI_NAME==="codeship"?1:d;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if(s.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in s){let h=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return h>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:(s.TERM,d)}function c(u){let d=l(u);return a(d)}e.exports={supportsColor:c,stdout:c(process.stdout),stderr:c(process.stderr)}}),LA=ee((r,e)=>{var t=require("tty"),n=require("util");r.init=d,r.log=l,r.formatArgs=o,r.save=c,r.load=u,r.useColors=s,r.destroy=n.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let p=NA();p&&(p.stderr||p).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}r.inspectOpts=Object.keys(process.env).filter(p=>/^debug_/i.test(p)).reduce((p,f)=>{let _=f.substring(6).toLowerCase().replace(/_([a-z])/g,(w,m)=>m.toUpperCase()),v=process.env[f];return/^(yes|on|true|enabled)$/i.test(v)?v=!0:/^(no|off|false|disabled)$/i.test(v)?v=!1:v==="null"?v=null:v=Number(v),p[_]=v,p},{});function s(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:t.isatty(process.stderr.fd)}function o(p){let{namespace:f,useColors:_}=this;if(_){let v=this.color,w="\x1B[3"+(v<8?v:"8;5;"+v),m=`  ${w};1m${f} \x1B[0m`;p[0]=m+p[0].split(`
`).join(`
`+m),p.push(w+"m+"+e.exports.humanize(this.diff)+"\x1B[0m")}else p[0]=a()+f+" "+p[0]}function a(){return r.inspectOpts.hideDate?"":new Date().toISOString()+" "}function l(...p){return process.stderr.write(n.format(...p)+`
`)}function c(p){p?process.env.DEBUG=p:delete process.env.DEBUG}function u(){return process.env.DEBUG}function d(p){p.inspectOpts={};let f=Object.keys(r.inspectOpts);for(let _=0;_<f.length;_++)p.inspectOpts[f[_]]=r.inspectOpts[f[_]]}e.exports=$0()(r);var{formatters:h}=e.exports;h.o=function(p){return this.inspectOpts.colors=this.useColors,n.inspect(p,this.inspectOpts).split(`
`).map(f=>f.trim()).join(" ")},h.O=function(p){return this.inspectOpts.colors=this.useColors,n.inspect(p,this.inspectOpts)}}),co=ee((r,e)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?e.exports=MA():e.exports=LA()}),DA=ee(r=>{"use strict";var e=require("url").parse,t={ftp:21,gopher:70,http:80,https:443,ws:80,wss:443},n=String.prototype.endsWith||function(l){return l.length<=this.length&&this.indexOf(l,this.length-l.length)!==-1};function s(l){var c=typeof l=="string"?e(l):l||{},u=c.protocol,d=c.host,h=c.port;if(typeof d!="string"||!d||typeof u!="string"||(u=u.split(":",1)[0],d=d.replace(/:\d*$/,""),h=parseInt(h)||t[u]||0,!o(d,h)))return"";var p=a("npm_config_"+u+"_proxy")||a(u+"_proxy")||a("npm_config_proxy")||a("all_proxy");return p&&p.indexOf("://")===-1&&(p=u+"://"+p),p}function o(l,c){var u=(a("npm_config_no_proxy")||a("no_proxy")).toLowerCase();return u?u==="*"?!1:u.split(/[,\s]/).every(function(d){if(!d)return!0;var h=d.match(/^(.+):(\d+)$/),p=h?h[1]:d,f=h?parseInt(h[2]):0;return f&&f!==c?!0:/^[.*]/.test(p)?(p.charAt(0)==="*"&&(p=p.slice(1)),!n.call(l,p)):l!==p}):!0}function a(l){return process.env[l.toLowerCase()]||process.env[l.toUpperCase()]||""}r.getProxyForUrl=s}),BA=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});function e(t){return function(n,s){return new Promise((o,a)=>{t.call(this,n,s,(l,c)=>{l?a(l):o(c)})})}}r.default=e}),W0=ee((r,e)=>{"use strict";var t=r&&r.__importDefault||function(d){return d&&d.__esModule?d:{default:d}},n=require("events"),s=t(co()),o=t(BA()),a=s.default("agent-base");function l(d){return!!d&&typeof d.addRequest=="function"}function c(){let{stack:d}=new Error;return typeof d!="string"?!1:d.split(`
`).some(h=>h.indexOf("(https.js:")!==-1||h.indexOf("node:https:")!==-1)}function u(d,h){return new u.Agent(d,h)}(function(d){class h extends n.EventEmitter{constructor(f,_){super();let v=_;typeof f=="function"?this.callback=f:f&&(v=f),this.timeout=null,v&&typeof v.timeout=="number"&&(this.timeout=v.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:c()?443:80}set defaultPort(f){this.explicitDefaultPort=f}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:c()?"https:":"http:"}set protocol(f){this.explicitProtocol=f}callback(f,_,v){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(f,_){let v=Object.assign({},_);typeof v.secureEndpoint!="boolean"&&(v.secureEndpoint=c()),v.host==null&&(v.host="localhost"),v.port==null&&(v.port=v.secureEndpoint?443:80),v.protocol==null&&(v.protocol=v.secureEndpoint?"https:":"http:"),v.host&&v.path&&delete v.path,delete v.agent,delete v.hostname,delete v._defaultAgent,delete v.defaultPort,delete v.createConnection,f._last=!0,f.shouldKeepAlive=!1;let w=!1,m=null,g=v.timeout||this.timeout,x=E=>{f._hadError||(f.emit("error",E),f._hadError=!0)},b=()=>{m=null,w=!0;let E=new Error(`A "socket" was not created for HTTP request before ${g}ms`);E.code="ETIMEOUT",x(E)},y=E=>{w||(m!==null&&(clearTimeout(m),m=null),x(E))},S=E=>{if(w)return;if(m!=null&&(clearTimeout(m),m=null),l(E)){a("Callback returned another Agent instance %o",E.constructor.name),E.addRequest(f,v);return}if(E){E.once("free",()=>{this.freeSocket(E,v)}),f.onSocket(E);return}let C=new Error(`no Duplex stream was returned to agent-base for \`${f.method} ${f.path}\``);x(C)};if(typeof this.callback!="function"){x(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(a("Converting legacy callback function to promise"),this.promisifiedCallback=o.default(this.callback)):this.promisifiedCallback=this.callback),typeof g=="number"&&g>0&&(m=setTimeout(b,g)),"port"in v&&typeof v.port!="number"&&(v.port=Number(v.port));try{a("Resolving socket for %o request: %o",v.protocol,`${f.method} ${f.path}`),Promise.resolve(this.promisifiedCallback(f,v)).then(S,y)}catch(E){Promise.reject(E).catch(y)}}freeSocket(f,_){a("Freeing socket %o %o",f.constructor.name,_),f.destroy()}destroy(){a("Destroying agent %o",this.constructor.name)}}d.Agent=h,d.prototype=d.Agent.prototype})(u||(u={})),e.exports=u}),jA=ee(r=>{"use strict";var e=r&&r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(r,"__esModule",{value:!0});var t=e(co()),n=t.default("https-proxy-agent:parse-proxy-response");function s(o){return new Promise((a,l)=>{let c=0,u=[];function d(){let w=o.read();w?v(w):o.once("readable",d)}function h(){o.removeListener("end",f),o.removeListener("error",_),o.removeListener("close",p),o.removeListener("readable",d)}function p(w){n("onclose had error %o",w)}function f(){n("onend")}function _(w){h(),n("onerror %o",w),l(w)}function v(w){u.push(w),c+=w.length;let m=Buffer.concat(u,c);if(m.indexOf(`\r
\r
`)===-1){n("have not received end of HTTP headers yet..."),d();return}let g=m.toString("ascii",0,m.indexOf(`\r
`)),x=+g.split(" ")[1];n("got proxy server response: %o",g),a({statusCode:x,buffered:m})}o.on("error",_),o.on("close",p),o.on("end",f),d()})}r.default=s}),qA=ee(r=>{"use strict";var e=r&&r.__awaiter||function(w,m,g,x){function b(y){return y instanceof g?y:new g(function(S){S(y)})}return new(g||(g=Promise))(function(y,S){function E(F){try{k(x.next(F))}catch(O){S(O)}}function C(F){try{k(x.throw(F))}catch(O){S(O)}}function k(F){F.done?y(F.value):b(F.value).then(E,C)}k((x=x.apply(w,m||[])).next())})},t=r&&r.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(r,"__esModule",{value:!0});var n=t(require("net")),s=t(require("tls")),o=t(require("url")),a=t(require("assert")),l=t(co()),c=W0(),u=t(jA()),d=l.default("https-proxy-agent:agent"),h=class extends c.Agent{constructor(w){let m;if(typeof w=="string"?m=o.default.parse(w):m=w,!m)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");d("creating new HttpsProxyAgent instance: %o",m),super(m);let g=Object.assign({},m);this.secureProxy=m.secureProxy||_(g.protocol),g.host=g.hostname||g.host,typeof g.port=="string"&&(g.port=parseInt(g.port,10)),!g.port&&g.host&&(g.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in g)&&(g.ALPNProtocols=["http 1.1"]),g.host&&g.path&&(delete g.path,delete g.pathname),this.proxy=g}callback(w,m){return e(this,void 0,void 0,function*(){let{proxy:g,secureProxy:x}=this,b;x?(d("Creating `tls.Socket`: %o",g),b=s.default.connect(g)):(d("Creating `net.Socket`: %o",g),b=n.default.connect(g));let y=Object.assign({},g.headers),S=`CONNECT ${`${m.host}:${m.port}`} HTTP/1.1\r
`;g.auth&&(y["Proxy-Authorization"]=`Basic ${Buffer.from(g.auth).toString("base64")}`);let{host:E,port:C,secureEndpoint:k}=m;f(C,k)||(E+=`:${C}`),y.Host=E,y.Connection="close";for(let T of Object.keys(y))S+=`${T}: ${y[T]}\r
`;let F=u.default(b);b.write(`${S}\r
`);let{statusCode:O,buffered:I}=yield F;if(O===200){if(w.once("socket",p),m.secureEndpoint){let T=m.servername||m.host;if(!T)throw new Error('Could not determine "servername"');return d("Upgrading socket connection to TLS"),s.default.connect(Object.assign(Object.assign({},v(m,"host","hostname","path","port")),{socket:b,servername:T}))}return b}b.destroy();let P=new n.default.Socket;return P.readable=!0,w.once("socket",T=>{d("replaying proxy buffer for failed request"),a.default(T.listenerCount("data")>0),T.push(I),T.push(null)}),P})}};r.default=h;function p(w){w.resume()}function f(w,m){return!!(!m&&w===80||m&&w===443)}function _(w){return typeof w=="string"?/^https:?$/i.test(w):!1}function v(w,...m){let g={},x;for(x in w)m.includes(x)||(g[x]=w[x]);return g}}),HA=ee((r,e)=>{"use strict";var t=r&&r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}},n=t(qA());function s(o){return new n.default(o)}(function(o){o.HttpsProxyAgent=n.default,o.prototype=n.default.prototype})(s||(s={})),e.exports=s}),$A=ee((r,e)=>{var t=t||function(o){return Buffer.from(o).toString("base64")};function n(o){var a=this,l=Math.round,c=Math.floor,u=new Array(64),d=new Array(64),h=new Array(64),p=new Array(64),f,_,v,w,m=new Array(65535),g=new Array(65535),x=new Array(64),b=new Array(64),y=[],S=0,E=7,C=new Array(64),k=new Array(64),F=new Array(64),O=new Array(256),I=new Array(2048),P,T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],A=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],V=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],J=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],q=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Q=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(G){for(var de=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],me=0;me<64;me++){var pe=c((de[me]*G+50)/100);pe<1?pe=1:pe>255&&(pe=255),u[T[me]]=pe}for(var ve=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],_e=0;_e<64;_e++){var fe=c((ve[_e]*G+50)/100);fe<1?fe=1:fe>255&&(fe=255),d[T[_e]]=fe}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],he=0,ue=0;ue<8;ue++)for(var le=0;le<8;le++)h[he]=1/(u[T[he]]*we[ue]*we[le]*8),p[he]=1/(d[T[he]]*we[ue]*we[le]*8),he++}function oe(G,de){for(var me=0,pe=0,ve=new Array,_e=1;_e<=16;_e++){for(var fe=1;fe<=G[_e];fe++)ve[de[pe]]=[],ve[de[pe]][0]=me,ve[de[pe]][1]=_e,pe++,me++;me*=2}return ve}function N(){f=oe(A,R),_=oe(q,U),v=oe(V,J),w=oe(Y,Q)}function B(){for(var G=1,de=2,me=1;me<=15;me++){for(var pe=G;pe<de;pe++)g[32767+pe]=me,m[32767+pe]=[],m[32767+pe][1]=me,m[32767+pe][0]=pe;for(var ve=-(de-1);ve<=-G;ve++)g[32767+ve]=me,m[32767+ve]=[],m[32767+ve][1]=me,m[32767+ve][0]=de-1+ve;G<<=1,de<<=1}}function W(){for(var G=0;G<256;G++)I[G]=19595*G,I[G+256>>0]=38470*G,I[G+512>>0]=7471*G+32768,I[G+768>>0]=-11059*G,I[G+1024>>0]=-21709*G,I[G+1280>>0]=32768*G+8421375,I[G+1536>>0]=-27439*G,I[G+1792>>0]=-5329*G}function $(G){for(var de=G[0],me=G[1]-1;me>=0;)de&1<<me&&(S|=1<<E),me--,E--,E<0&&(S==255?(L(255),L(0)):L(S),E=7,S=0)}function L(G){y.push(G)}function H(G){L(G>>8&255),L(G&255)}function z(G,de){var me,pe,ve,_e,fe,we,he,ue,le=0,be,xe=8,Oe=64;for(be=0;be<xe;++be){me=G[le],pe=G[le+1],ve=G[le+2],_e=G[le+3],fe=G[le+4],we=G[le+5],he=G[le+6],ue=G[le+7];var ge=me+ue,Ee=me-ue,We=pe+he,Fe=pe-he,Ye=ve+we,It=ve-we,Rt=_e+fe,zr=_e-fe,nr=ge+Rt,Vr=ge-Rt,Gr=We+Ye,Mi=We-Ye;G[le]=nr+Gr,G[le+4]=nr-Gr;var io=(Mi+Vr)*.707106781;G[le+2]=Vr+io,G[le+6]=Vr-io,nr=zr+It,Gr=It+Fe,Mi=Fe+Ee;var so=(nr-Mi)*.382683433,oo=.5411961*nr+so,ao=1.306562965*Mi+so,E0=Gr*.707106781,k0=Ee+E0,C0=Ee-E0;G[le+5]=C0+oo,G[le+3]=C0-oo,G[le+1]=k0+ao,G[le+7]=k0-ao,le+=8}for(le=0,be=0;be<xe;++be){me=G[le],pe=G[le+8],ve=G[le+16],_e=G[le+24],fe=G[le+32],we=G[le+40],he=G[le+48],ue=G[le+56];var T0=me+ue,np=me-ue,O0=pe+he,P0=pe-he,A0=ve+we,I0=ve-we,R0=_e+fe,oA=_e-fe,lo=T0+R0,rp=T0-R0,Xa=O0+A0,Ya=O0-A0;G[le]=lo+Xa,G[le+32]=lo-Xa;var M0=(Ya+rp)*.707106781;G[le+16]=rp+M0,G[le+48]=rp-M0,lo=oA+I0,Xa=I0+P0,Ya=P0+np;var F0=(lo-Ya)*.382683433,N0=.5411961*lo+F0,L0=1.306562965*Ya+F0,D0=Xa*.707106781,B0=np+D0,j0=np-D0;G[le+40]=j0+N0,G[le+24]=j0-N0,G[le+8]=B0+L0,G[le+56]=B0-L0,le++}var Qa;for(be=0;be<Oe;++be)Qa=G[be]*de[be],x[be]=Qa>0?Qa+.5|0:Qa-.5|0;return x}function K(){H(65504),H(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),H(1),H(1),L(0),L(0)}function ae(G){if(G){H(65505),G[0]===69&&G[1]===120&&G[2]===105&&G[3]===102?H(G.length+2):(H(G.length+5+2),L(69),L(120),L(105),L(102),L(0));for(var de=0;de<G.length;de++)L(G[de])}}function D(G,de){H(65472),H(17),L(8),H(de),H(G),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}function j(){H(65499),H(132),L(0);for(var G=0;G<64;G++)L(u[G]);L(1);for(var de=0;de<64;de++)L(d[de])}function X(){H(65476),H(418),L(0);for(var G=0;G<16;G++)L(A[G+1]);for(var de=0;de<=11;de++)L(R[de]);L(16);for(var me=0;me<16;me++)L(V[me+1]);for(var pe=0;pe<=161;pe++)L(J[pe]);L(1);for(var ve=0;ve<16;ve++)L(q[ve+1]);for(var _e=0;_e<=11;_e++)L(U[_e]);L(17);for(var fe=0;fe<16;fe++)L(Y[fe+1]);for(var we=0;we<=161;we++)L(Q[we])}function Z(G){typeof G>"u"||G.constructor!==Array||G.forEach(de=>{if(typeof de=="string"){H(65534);var me=de.length;H(me+2);var pe;for(pe=0;pe<me;pe++)L(de.charCodeAt(pe))}})}function se(){H(65498),H(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0)}function Ce(G,de,me,pe,ve){for(var _e=ve[0],fe=ve[240],we,he=16,ue=63,le=64,be=z(G,de),xe=0;xe<le;++xe)b[T[xe]]=be[xe];var Oe=b[0]-me;me=b[0],Oe==0?$(pe[0]):(we=32767+Oe,$(pe[g[we]]),$(m[we]));for(var ge=63;ge>0&&b[ge]==0;ge--);if(ge==0)return $(_e),me;for(var Ee=1,We;Ee<=ge;){for(var Fe=Ee;b[Ee]==0&&Ee<=ge;++Ee);var Ye=Ee-Fe;if(Ye>=he){We=Ye>>4;for(var It=1;It<=We;++It)$(fe);Ye=Ye&15}we=32767+b[Ee],$(ve[(Ye<<4)+g[we]]),$(m[we]),Ee++}return ge!=ue&&$(_e),me}function Ge(){for(var G=String.fromCharCode,de=0;de<256;de++)O[de]=G(de)}this.encode=function(G,de){var me=new Date().getTime();de&&rt(de),y=new Array,S=0,E=7,H(65496),K(),Z(G.comments),ae(G.exifBuffer),j(),D(G.width,G.height),X(),se();var pe=0,ve=0,_e=0;S=0,E=7,this.encode.displayName="_encode_";for(var fe=G.data,we=G.width,he=G.height,ue=we*4,le=we*3,be,xe=0,Oe,ge,Ee,We,Fe,Ye,It,Rt;xe<he;){for(be=0;be<ue;){for(We=ue*xe+be,Fe=We,Ye=-1,It=0,Rt=0;Rt<64;Rt++)It=Rt>>3,Ye=(Rt&7)*4,Fe=We+It*ue+Ye,xe+It>=he&&(Fe-=ue*(xe+1+It-he)),be+Ye>=ue&&(Fe-=be+Ye-ue+4),Oe=fe[Fe++],ge=fe[Fe++],Ee=fe[Fe++],C[Rt]=(I[Oe]+I[ge+256>>0]+I[Ee+512>>0]>>16)-128,k[Rt]=(I[Oe+768>>0]+I[ge+1024>>0]+I[Ee+1280>>0]>>16)-128,F[Rt]=(I[Oe+1280>>0]+I[ge+1536>>0]+I[Ee+1792>>0]>>16)-128;pe=Ce(C,h,pe,f,v),ve=Ce(k,p,ve,_,w),_e=Ce(F,p,_e,_,w),be+=32}xe+=8}if(E>=0){var zr=[];zr[1]=E+1,zr[0]=(1<<E+1)-1,$(zr)}if(H(65497),typeof e>"u")return new Uint8Array(y);return Buffer.from(y);var nr,Vr};function rt(G){if(G<=0&&(G=1),G>100&&(G=100),P!=G){var de=0;G<50?de=Math.floor(5e3/G):de=Math.floor(200-G*2),te(de),P=G}}function lt(){var G=new Date().getTime();o||(o=50),Ge(),N(),B(),W(),rt(o);var de=new Date().getTime()-G}lt()}typeof e<"u"?e.exports=s:typeof window<"u"&&(window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].encode=s);function s(o,a){typeof a>"u"&&(a=50);var l=new n(a),c=l.encode(o,a);return{data:c,width:o.width,height:o.height}}}),WA=ee((r,e)=>{var t=function(){"use strict";var s=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,a=799,l=3406,c=2276,u=1567,d=3784,h=5793,p=2896;function f(){}function _(y,S){for(var E=0,C=[],k,F,O=16;O>0&&!y[O-1];)O--;C.push({children:[],index:0});var I=C[0],P;for(k=0;k<O;k++){for(F=0;F<y[k];F++){for(I=C.pop(),I.children[I.index]=S[E];I.index>0;){if(C.length===0)throw new Error("Could not recreate Huffman Table");I=C.pop()}for(I.index++,C.push(I);C.length<=k;)C.push(P={children:[],index:0}),I.children[I.index]=P.children,I=P;E++}k+1<O&&(C.push(P={children:[],index:0}),I.children[I.index]=P.children,I=P)}return C[0].children}function v(y,S,E,C,k,F,O,I,P,T){var A=E.precision,R=E.samplesPerLine,V=E.scanLines,J=E.mcusPerLine,q=E.progressive,U=E.maxH,Y=E.maxV,Q=S,te=0,oe=0;function N(){if(oe>0)return oe--,te>>oe&1;if(te=y[S++],te==255){var he=y[S++];if(he)throw new Error("unexpected marker: "+(te<<8|he).toString(16))}return oe=7,te>>>7}function B(he){for(var ue=he,le;(le=N())!==null;){if(ue=ue[le],typeof ue=="number")return ue;if(typeof ue!="object")throw new Error("invalid huffman sequence")}return null}function W(he){for(var ue=0;he>0;){var le=N();if(le===null)return;ue=ue<<1|le,he--}return ue}function $(he){var ue=W(he);return ue>=1<<he-1?ue:ue+(-1<<he)+1}function L(he,ue){var le=B(he.huffmanTableDC),be=le===0?0:$(le);ue[0]=he.pred+=be;for(var xe=1;xe<64;){var Oe=B(he.huffmanTableAC),ge=Oe&15,Ee=Oe>>4;if(ge===0){if(Ee<15)break;xe+=16;continue}xe+=Ee;var We=s[xe];ue[We]=$(ge),xe++}}function H(he,ue){var le=B(he.huffmanTableDC),be=le===0?0:$(le)<<P;ue[0]=he.pred+=be}function z(he,ue){ue[0]|=N()<<P}var K=0;function ae(he,ue){if(K>0){K--;return}for(var le=F,be=O;le<=be;){var xe=B(he.huffmanTableAC),Oe=xe&15,ge=xe>>4;if(Oe===0){if(ge<15){K=W(ge)+(1<<ge)-1;break}le+=16;continue}le+=ge;var Ee=s[le];ue[Ee]=$(Oe)*(1<<P),le++}}var D=0,j;function X(he,ue){for(var le=F,be=O,xe=0;le<=be;){var Oe=s[le],ge=ue[Oe]<0?-1:1;switch(D){case 0:var Ee=B(he.huffmanTableAC),We=Ee&15,xe=Ee>>4;if(We===0)xe<15?(K=W(xe)+(1<<xe),D=4):(xe=16,D=1);else{if(We!==1)throw new Error("invalid ACn encoding");j=$(We),D=xe?2:3}continue;case 1:case 2:ue[Oe]?ue[Oe]+=(N()<<P)*ge:(xe--,xe===0&&(D=D==2?3:0));break;case 3:ue[Oe]?ue[Oe]+=(N()<<P)*ge:(ue[Oe]=j<<P,D=0);break;case 4:ue[Oe]&&(ue[Oe]+=(N()<<P)*ge);break}le++}D===4&&(K--,K===0&&(D=0))}function Z(he,ue,le,be,xe){var Oe=le/J|0,ge=le%J,Ee=Oe*he.v+be,We=ge*he.h+xe;he.blocks[Ee]===void 0&&T.tolerantDecoding||ue(he,he.blocks[Ee][We])}function se(he,ue,le){var be=le/he.blocksPerLine|0,xe=le%he.blocksPerLine;he.blocks[be]===void 0&&T.tolerantDecoding||ue(he,he.blocks[be][xe])}var Ce=C.length,Ge,rt,lt,G,de,me;q?F===0?me=I===0?H:z:me=I===0?ae:X:me=L;var pe=0,ve,_e;Ce==1?_e=C[0].blocksPerLine*C[0].blocksPerColumn:_e=J*E.mcusPerColumn,k||(k=_e);for(var fe,we;pe<_e;){for(rt=0;rt<Ce;rt++)C[rt].pred=0;if(K=0,Ce==1)for(Ge=C[0],de=0;de<k;de++)se(Ge,me,pe),pe++;else for(de=0;de<k;de++){for(rt=0;rt<Ce;rt++)for(Ge=C[rt],fe=Ge.h,we=Ge.v,lt=0;lt<we;lt++)for(G=0;G<fe;G++)Z(Ge,me,pe,lt,G);if(pe++,pe===_e)break}if(pe===_e)do{if(y[S]===255&&y[S+1]!==0)break;S+=1}while(S<y.length-2);if(oe=0,ve=y[S]<<8|y[S+1],ve<65280)throw new Error("marker was not found");if(ve>=65488&&ve<=65495)S+=2;else break}return S-Q}function w(y,S){var E=[],C=S.blocksPerLine,k=S.blocksPerColumn,F=C<<3,O=new Int32Array(64),I=new Uint8Array(64);function P(Q,te,oe){var N=S.quantizationTable,B,W,$,L,H,z,K,ae,D,j=oe,X;for(X=0;X<64;X++)j[X]=Q[X]*N[X];for(X=0;X<8;++X){var Z=8*X;if(j[1+Z]==0&&j[2+Z]==0&&j[3+Z]==0&&j[4+Z]==0&&j[5+Z]==0&&j[6+Z]==0&&j[7+Z]==0){D=h*j[0+Z]+512>>10,j[0+Z]=D,j[1+Z]=D,j[2+Z]=D,j[3+Z]=D,j[4+Z]=D,j[5+Z]=D,j[6+Z]=D,j[7+Z]=D;continue}B=h*j[0+Z]+128>>8,W=h*j[4+Z]+128>>8,$=j[2+Z],L=j[6+Z],H=p*(j[1+Z]-j[7+Z])+128>>8,ae=p*(j[1+Z]+j[7+Z])+128>>8,z=j[3+Z]<<4,K=j[5+Z]<<4,D=B-W+1>>1,B=B+W+1>>1,W=D,D=$*d+L*u+128>>8,$=$*u-L*d+128>>8,L=D,D=H-K+1>>1,H=H+K+1>>1,K=D,D=ae+z+1>>1,z=ae-z+1>>1,ae=D,D=B-L+1>>1,B=B+L+1>>1,L=D,D=W-$+1>>1,W=W+$+1>>1,$=D,D=H*c+ae*l+2048>>12,H=H*l-ae*c+2048>>12,ae=D,D=z*a+K*o+2048>>12,z=z*o-K*a+2048>>12,K=D,j[0+Z]=B+ae,j[7+Z]=B-ae,j[1+Z]=W+K,j[6+Z]=W-K,j[2+Z]=$+z,j[5+Z]=$-z,j[3+Z]=L+H,j[4+Z]=L-H}for(X=0;X<8;++X){var se=X;if(j[8+se]==0&&j[16+se]==0&&j[24+se]==0&&j[32+se]==0&&j[40+se]==0&&j[48+se]==0&&j[56+se]==0){D=h*oe[X+0]+8192>>14,j[0+se]=D,j[8+se]=D,j[16+se]=D,j[24+se]=D,j[32+se]=D,j[40+se]=D,j[48+se]=D,j[56+se]=D;continue}B=h*j[0+se]+2048>>12,W=h*j[32+se]+2048>>12,$=j[16+se],L=j[48+se],H=p*(j[8+se]-j[56+se])+2048>>12,ae=p*(j[8+se]+j[56+se])+2048>>12,z=j[24+se],K=j[40+se],D=B-W+1>>1,B=B+W+1>>1,W=D,D=$*d+L*u+2048>>12,$=$*u-L*d+2048>>12,L=D,D=H-K+1>>1,H=H+K+1>>1,K=D,D=ae+z+1>>1,z=ae-z+1>>1,ae=D,D=B-L+1>>1,B=B+L+1>>1,L=D,D=W-$+1>>1,W=W+$+1>>1,$=D,D=H*c+ae*l+2048>>12,H=H*l-ae*c+2048>>12,ae=D,D=z*a+K*o+2048>>12,z=z*o-K*a+2048>>12,K=D,j[0+se]=B+ae,j[56+se]=B-ae,j[8+se]=W+K,j[48+se]=W-K,j[16+se]=$+z,j[40+se]=$-z,j[24+se]=L+H,j[32+se]=L-H}for(X=0;X<64;++X){var Ce=128+(j[X]+8>>4);te[X]=Ce<0?0:Ce>255?255:Ce}}b(F*k*8);for(var T,A,R=0;R<k;R++){var V=R<<3;for(T=0;T<8;T++)E.push(new Uint8Array(F));for(var J=0;J<C;J++){P(S.blocks[R][J],I,O);var q=0,U=J<<3;for(A=0;A<8;A++){var Y=E[V+A];for(T=0;T<8;T++)Y[U+T]=I[q++]}}}return E}function m(y){return y<0?0:y>255?255:y}f.prototype={load:function(y){var S=new XMLHttpRequest;S.open("GET",y,!0),S.responseType="arraybuffer",S.onload=function(){var E=new Uint8Array(S.response||S.mozResponseArrayBuffer);this.parse(E),this.onload&&this.onload()}.bind(this),S.send(null)},parse:function(y){var S=this.opts.maxResolutionInMP*1e3*1e3,E=0,C=y.length;function k(){var ge=y[E]<<8|y[E+1];return E+=2,ge}function F(){var ge=k(),Ee=y.subarray(E,E+ge-2);return E+=Ee.length,Ee}function O(ge){var Ee=1,We=1,Fe,Ye;for(Ye in ge.components)ge.components.hasOwnProperty(Ye)&&(Fe=ge.components[Ye],Ee<Fe.h&&(Ee=Fe.h),We<Fe.v&&(We=Fe.v));var It=Math.ceil(ge.samplesPerLine/8/Ee),Rt=Math.ceil(ge.scanLines/8/We);for(Ye in ge.components)if(ge.components.hasOwnProperty(Ye)){Fe=ge.components[Ye];var zr=Math.ceil(Math.ceil(ge.samplesPerLine/8)*Fe.h/Ee),nr=Math.ceil(Math.ceil(ge.scanLines/8)*Fe.v/We),Vr=It*Fe.h,Gr=Rt*Fe.v,Mi=Gr*Vr,io=[];b(Mi*256);for(var so=0;so<Gr;so++){for(var oo=[],ao=0;ao<Vr;ao++)oo.push(new Int32Array(64));io.push(oo)}Fe.blocksPerLine=zr,Fe.blocksPerColumn=nr,Fe.blocks=io}ge.maxH=Ee,ge.maxV=We,ge.mcusPerLine=It,ge.mcusPerColumn=Rt}var I=null,P=null,T=null,A,R,V=[],J=[],q=[],U=[],Y=k(),Q=-1;if(this.comments=[],Y!=65496)throw new Error("SOI not found");for(Y=k();Y!=65497;){var te,oe,N;switch(Y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var B=F();if(Y===65534){var W=String.fromCharCode.apply(null,B);this.comments.push(W)}Y===65504&&B[0]===74&&B[1]===70&&B[2]===73&&B[3]===70&&B[4]===0&&(I={version:{major:B[5],minor:B[6]},densityUnits:B[7],xDensity:B[8]<<8|B[9],yDensity:B[10]<<8|B[11],thumbWidth:B[12],thumbHeight:B[13],thumbData:B.subarray(14,14+3*B[12]*B[13])}),Y===65505&&B[0]===69&&B[1]===120&&B[2]===105&&B[3]===102&&B[4]===0&&(this.exifBuffer=B.subarray(5,B.length)),Y===65518&&B[0]===65&&B[1]===100&&B[2]===111&&B[3]===98&&B[4]===101&&B[5]===0&&(P={version:B[6],flags0:B[7]<<8|B[8],flags1:B[9]<<8|B[10],transformCode:B[11]});break;case 65499:for(var $=k(),L=$+E-2;E<L;){var H=y[E++];b(256);var z=new Int32Array(64);if(H>>4)if(H>>4===1)for(oe=0;oe<64;oe++){var K=s[oe];z[K]=k()}else throw new Error("DQT: invalid table spec");else for(oe=0;oe<64;oe++){var K=s[oe];z[K]=y[E++]}V[H&15]=z}break;case 65472:case 65473:case 65474:k(),A={},A.extended=Y===65473,A.progressive=Y===65474,A.precision=y[E++],A.scanLines=k(),A.samplesPerLine=k(),A.components={},A.componentsOrder=[];var ae=A.scanLines*A.samplesPerLine;if(ae>S){var D=Math.ceil((ae-S)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${D}MP`)}var j=y[E++],X,Z=0,se=0;for(te=0;te<j;te++){X=y[E];var Ce=y[E+1]>>4,Ge=y[E+1]&15,rt=y[E+2];if(Ce<=0||Ge<=0)throw new Error("Invalid sampling factor, expected values above 0");A.componentsOrder.push(X),A.components[X]={h:Ce,v:Ge,quantizationIdx:rt},E+=3}O(A),J.push(A);break;case 65476:var lt=k();for(te=2;te<lt;){var G=y[E++],de=new Uint8Array(16),me=0;for(oe=0;oe<16;oe++,E++)me+=de[oe]=y[E];b(16+me);var pe=new Uint8Array(me);for(oe=0;oe<me;oe++,E++)pe[oe]=y[E];te+=17+me,(G>>4?q:U)[G&15]=_(de,pe)}break;case 65501:k(),R=k();break;case 65500:k(),k();break;case 65498:var ve=k(),_e=y[E++],fe=[],we;for(te=0;te<_e;te++){we=A.components[y[E++]];var he=y[E++];we.huffmanTableDC=U[he>>4],we.huffmanTableAC=q[he&15],fe.push(we)}var ue=y[E++],le=y[E++],be=y[E++],xe=v(y,E,A,fe,R,ue,le,be>>4,be&15,this.opts);E+=xe;break;case 65535:y[E]!==255&&E--;break;default:if(y[E-3]==255&&y[E-2]>=192&&y[E-2]<=254){E-=3;break}else if(Y===224||Y==225){if(Q!==-1)throw new Error(`first unknown JPEG marker at offset ${Q.toString(16)}, second unknown JPEG marker ${Y.toString(16)} at offset ${(E-1).toString(16)}`);Q=E-1;let ge=k();if(y[E+ge-2]===255){E+=ge-2;break}}throw new Error("unknown JPEG marker "+Y.toString(16))}Y=k()}if(J.length!=1)throw new Error("only single frame JPEGs supported");for(var te=0;te<J.length;te++){var Oe=J[te].components;for(var oe in Oe)Oe[oe].quantizationTable=V[Oe[oe].quantizationIdx],delete Oe[oe].quantizationIdx}this.width=A.samplesPerLine,this.height=A.scanLines,this.jfif=I,this.adobe=P,this.components=[];for(var te=0;te<A.componentsOrder.length;te++){var we=A.components[A.componentsOrder[te]];this.components.push({lines:w(A,we),scaleX:we.h/A.maxH,scaleY:we.v/A.maxV})}},getData:function(y,S){var E=this.width/y,C=this.height/S,k,F,O,I,P,T,A,R,V,J,q=0,U,Y,Q,te,oe,N,B,W,$,L,H,z=y*S*this.components.length;b(z);var K=new Uint8Array(z);switch(this.components.length){case 1:for(k=this.components[0],J=0;J<S;J++)for(P=k.lines[0|J*k.scaleY*C],V=0;V<y;V++)U=P[0|V*k.scaleX*E],K[q++]=U;break;case 2:for(k=this.components[0],F=this.components[1],J=0;J<S;J++)for(P=k.lines[0|J*k.scaleY*C],T=F.lines[0|J*F.scaleY*C],V=0;V<y;V++)U=P[0|V*k.scaleX*E],K[q++]=U,U=T[0|V*F.scaleX*E],K[q++]=U;break;case 3:for(H=!0,this.adobe&&this.adobe.transformCode?H=!0:typeof this.opts.colorTransform<"u"&&(H=!!this.opts.colorTransform),k=this.components[0],F=this.components[1],O=this.components[2],J=0;J<S;J++)for(P=k.lines[0|J*k.scaleY*C],T=F.lines[0|J*F.scaleY*C],A=O.lines[0|J*O.scaleY*C],V=0;V<y;V++)H?(U=P[0|V*k.scaleX*E],Y=T[0|V*F.scaleX*E],Q=A[0|V*O.scaleX*E],W=m(U+1.402*(Q-128)),$=m(U-.3441363*(Y-128)-.71413636*(Q-128)),L=m(U+1.772*(Y-128))):(W=P[0|V*k.scaleX*E],$=T[0|V*F.scaleX*E],L=A[0|V*O.scaleX*E]),K[q++]=W,K[q++]=$,K[q++]=L;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(H=!1,this.adobe&&this.adobe.transformCode?H=!0:typeof this.opts.colorTransform<"u"&&(H=!!this.opts.colorTransform),k=this.components[0],F=this.components[1],O=this.components[2],I=this.components[3],J=0;J<S;J++)for(P=k.lines[0|J*k.scaleY*C],T=F.lines[0|J*F.scaleY*C],A=O.lines[0|J*O.scaleY*C],R=I.lines[0|J*I.scaleY*C],V=0;V<y;V++)H?(U=P[0|V*k.scaleX*E],Y=T[0|V*F.scaleX*E],Q=A[0|V*O.scaleX*E],te=R[0|V*I.scaleX*E],oe=255-m(U+1.402*(Q-128)),N=255-m(U-.3441363*(Y-128)-.71413636*(Q-128)),B=255-m(U+1.772*(Y-128))):(oe=P[0|V*k.scaleX*E],N=T[0|V*F.scaleX*E],B=A[0|V*O.scaleX*E],te=R[0|V*I.scaleX*E]),K[q++]=255-oe,K[q++]=255-N,K[q++]=255-B,K[q++]=255-te;break;default:throw new Error("Unsupported color mode")}return K},copyToImageData:function(y,S){var E=y.width,C=y.height,k=y.data,F=this.getData(E,C),O=0,I=0,P,T,A,R,V,J,q,U,Y;switch(this.components.length){case 1:for(T=0;T<C;T++)for(P=0;P<E;P++)A=F[O++],k[I++]=A,k[I++]=A,k[I++]=A,S&&(k[I++]=255);break;case 3:for(T=0;T<C;T++)for(P=0;P<E;P++)q=F[O++],U=F[O++],Y=F[O++],k[I++]=q,k[I++]=U,k[I++]=Y,S&&(k[I++]=255);break;case 4:for(T=0;T<C;T++)for(P=0;P<E;P++)V=F[O++],J=F[O++],A=F[O++],R=F[O++],q=255-m(V*(1-R/255)+R),U=255-m(J*(1-R/255)+R),Y=255-m(A*(1-R/255)+R),k[I++]=q,k[I++]=U,k[I++]=Y,S&&(k[I++]=255);break;default:throw new Error("Unsupported color mode")}}};var g=0,x=0;function b(y=0){var S=g+y;if(S>x){var E=Math.ceil((S-x)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${E}MB`)}g=S}return f.resetMaxMemoryUsage=function(y){g=0,x=y},f.getBytesAllocated=function(){return g},f.requestMemoryAllocation=b,f}();typeof e<"u"?e.exports=n:typeof window<"u"&&(window["jpeg-js"]=window["jpeg-js"]||{},window["jpeg-js"].decode=n);function n(s,o={}){var a={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},l={...a,...o},c=new Uint8Array(s),u=new t;u.opts=l,t.resetMaxMemoryUsage(l.maxMemoryUsageInMB*1024*1024),u.parse(c);var d=l.formatAsRGBA?4:3,h=u.width*u.height*d;try{t.requestMemoryAllocation(h);var p={width:u.width,height:u.height,exifBuffer:u.exifBuffer,data:l.useTArray?new Uint8Array(h):Buffer.alloc(h)};u.comments.length>0&&(p.comments=u.comments)}catch(f){throw f instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+h):f instanceof ReferenceError&&f.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):f}return u.copyToImageData(p,l.formatAsRGBA),p}}),UA=ee((r,e)=>{var t=$A(),n=WA();e.exports={encode:t,decode:n}}),zA=ee((r,e)=>{"use strict";function t(){this._types=Object.create(null),this._extensions=Object.create(null);for(let n=0;n<arguments.length;n++)this.define(arguments[n]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}t.prototype.define=function(n,s){for(let o in n){let a=n[o].map(function(l){return l.toLowerCase()});o=o.toLowerCase();for(let l=0;l<a.length;l++){let c=a[l];if(c[0]!=="*"){if(!s&&c in this._types)throw new Error('Attempt to change mapping for "'+c+'" extension from "'+this._types[c]+'" to "'+o+'". Pass `force=true` to allow this, otherwise remove "'+c+'" from the list of extensions for "'+o+'".');this._types[c]=o}}if(s||!this._extensions[o]){let l=a[0];this._extensions[o]=l[0]!=="*"?l:l.substr(1)}}},t.prototype.getType=function(n){n=String(n);let s=n.replace(/^.*[/\\]/,"").toLowerCase(),o=s.replace(/^.*\./,"").toLowerCase(),a=s.length<n.length;return(o.length<s.length-1||!a)&&this._types[o]||null},t.prototype.getExtension=function(n){return n=/^\s*([^;\s]*)/.test(n)&&RegExp.$1,n&&this._extensions[n.toLowerCase()]||null},e.exports=t}),VA=ee((r,e)=>{e.exports={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]}}),GA=ee((r,e)=>{e.exports={"application/prs.cww":["cww"],"application/vnd.1000minds.decision-model+xml":["1km"],"application/vnd.3gpp.pic-bw-large":["plb"],"application/vnd.3gpp.pic-bw-small":["psb"],"application/vnd.3gpp.pic-bw-var":["pvb"],"application/vnd.3gpp2.tcap":["tcap"],"application/vnd.3m.post-it-notes":["pwn"],"application/vnd.accpac.simply.aso":["aso"],"application/vnd.accpac.simply.imp":["imp"],"application/vnd.acucobol":["acu"],"application/vnd.acucorp":["atc","acutc"],"application/vnd.adobe.air-application-installer-package+zip":["air"],"application/vnd.adobe.formscentral.fcdt":["fcdt"],"application/vnd.adobe.fxp":["fxp","fxpl"],"application/vnd.adobe.xdp+xml":["xdp"],"application/vnd.adobe.xfdf":["xfdf"],"application/vnd.ahead.space":["ahead"],"application/vnd.airzip.filesecure.azf":["azf"],"application/vnd.airzip.filesecure.azs":["azs"],"application/vnd.amazon.ebook":["azw"],"application/vnd.americandynamics.acc":["acc"],"application/vnd.amiga.ami":["ami"],"application/vnd.android.package-archive":["apk"],"application/vnd.anser-web-certificate-issue-initiation":["cii"],"application/vnd.anser-web-funds-transfer-initiation":["fti"],"application/vnd.antix.game-component":["atx"],"application/vnd.apple.installer+xml":["mpkg"],"application/vnd.apple.keynote":["key"],"application/vnd.apple.mpegurl":["m3u8"],"application/vnd.apple.numbers":["numbers"],"application/vnd.apple.pages":["pages"],"application/vnd.apple.pkpass":["pkpass"],"application/vnd.aristanetworks.swi":["swi"],"application/vnd.astraea-software.iota":["iota"],"application/vnd.audiograph":["aep"],"application/vnd.balsamiq.bmml+xml":["bmml"],"application/vnd.blueice.multipass":["mpm"],"application/vnd.bmi":["bmi"],"application/vnd.businessobjects":["rep"],"application/vnd.chemdraw+xml":["cdxml"],"application/vnd.chipnuts.karaoke-mmd":["mmd"],"application/vnd.cinderella":["cdy"],"application/vnd.citationstyles.style+xml":["csl"],"application/vnd.claymore":["cla"],"application/vnd.cloanto.rp9":["rp9"],"application/vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"application/vnd.cluetrust.cartomobile-config":["c11amc"],"application/vnd.cluetrust.cartomobile-config-pkg":["c11amz"],"application/vnd.commonspace":["csp"],"application/vnd.contact.cmsg":["cdbcmsg"],"application/vnd.cosmocaller":["cmc"],"application/vnd.crick.clicker":["clkx"],"application/vnd.crick.clicker.keyboard":["clkk"],"application/vnd.crick.clicker.palette":["clkp"],"application/vnd.crick.clicker.template":["clkt"],"application/vnd.crick.clicker.wordbank":["clkw"],"application/vnd.criticaltools.wbs+xml":["wbs"],"application/vnd.ctc-posml":["pml"],"application/vnd.cups-ppd":["ppd"],"application/vnd.curl.car":["car"],"application/vnd.curl.pcurl":["pcurl"],"application/vnd.dart":["dart"],"application/vnd.data-vision.rdz":["rdz"],"application/vnd.dbf":["dbf"],"application/vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"application/vnd.dece.ttml+xml":["uvt","uvvt"],"application/vnd.dece.unspecified":["uvx","uvvx"],"application/vnd.dece.zip":["uvz","uvvz"],"application/vnd.denovo.fcselayout-link":["fe_launch"],"application/vnd.dna":["dna"],"application/vnd.dolby.mlp":["mlp"],"application/vnd.dpgraph":["dpg"],"application/vnd.dreamfactory":["dfac"],"application/vnd.ds-keypoint":["kpxx"],"application/vnd.dvb.ait":["ait"],"application/vnd.dvb.service":["svc"],"application/vnd.dynageo":["geo"],"application/vnd.ecowin.chart":["mag"],"application/vnd.enliven":["nml"],"application/vnd.epson.esf":["esf"],"application/vnd.epson.msf":["msf"],"application/vnd.epson.quickanime":["qam"],"application/vnd.epson.salt":["slt"],"application/vnd.epson.ssf":["ssf"],"application/vnd.eszigno3+xml":["es3","et3"],"application/vnd.ezpix-album":["ez2"],"application/vnd.ezpix-package":["ez3"],"application/vnd.fdf":["fdf"],"application/vnd.fdsn.mseed":["mseed"],"application/vnd.fdsn.seed":["seed","dataless"],"application/vnd.flographit":["gph"],"application/vnd.fluxtime.clip":["ftc"],"application/vnd.framemaker":["fm","frame","maker","book"],"application/vnd.frogans.fnc":["fnc"],"application/vnd.frogans.ltf":["ltf"],"application/vnd.fsc.weblaunch":["fsc"],"application/vnd.fujitsu.oasys":["oas"],"application/vnd.fujitsu.oasys2":["oa2"],"application/vnd.fujitsu.oasys3":["oa3"],"application/vnd.fujitsu.oasysgp":["fg5"],"application/vnd.fujitsu.oasysprs":["bh2"],"application/vnd.fujixerox.ddd":["ddd"],"application/vnd.fujixerox.docuworks":["xdw"],"application/vnd.fujixerox.docuworks.binder":["xbd"],"application/vnd.fuzzysheet":["fzs"],"application/vnd.genomatix.tuxedo":["txd"],"application/vnd.geogebra.file":["ggb"],"application/vnd.geogebra.tool":["ggt"],"application/vnd.geometry-explorer":["gex","gre"],"application/vnd.geonext":["gxt"],"application/vnd.geoplan":["g2w"],"application/vnd.geospace":["g3w"],"application/vnd.gmx":["gmx"],"application/vnd.google-apps.document":["gdoc"],"application/vnd.google-apps.presentation":["gslides"],"application/vnd.google-apps.spreadsheet":["gsheet"],"application/vnd.google-earth.kml+xml":["kml"],"application/vnd.google-earth.kmz":["kmz"],"application/vnd.grafeq":["gqf","gqs"],"application/vnd.groove-account":["gac"],"application/vnd.groove-help":["ghf"],"application/vnd.groove-identity-message":["gim"],"application/vnd.groove-injector":["grv"],"application/vnd.groove-tool-message":["gtm"],"application/vnd.groove-tool-template":["tpl"],"application/vnd.groove-vcard":["vcg"],"application/vnd.hal+xml":["hal"],"application/vnd.handheld-entertainment+xml":["zmm"],"application/vnd.hbci":["hbci"],"application/vnd.hhe.lesson-player":["les"],"application/vnd.hp-hpgl":["hpgl"],"application/vnd.hp-hpid":["hpid"],"application/vnd.hp-hps":["hps"],"application/vnd.hp-jlyt":["jlt"],"application/vnd.hp-pcl":["pcl"],"application/vnd.hp-pclxl":["pclxl"],"application/vnd.hydrostatix.sof-data":["sfd-hdstx"],"application/vnd.ibm.minipay":["mpy"],"application/vnd.ibm.modcap":["afp","listafp","list3820"],"application/vnd.ibm.rights-management":["irm"],"application/vnd.ibm.secure-container":["sc"],"application/vnd.iccprofile":["icc","icm"],"application/vnd.igloader":["igl"],"application/vnd.immervision-ivp":["ivp"],"application/vnd.immervision-ivu":["ivu"],"application/vnd.insors.igm":["igm"],"application/vnd.intercon.formnet":["xpw","xpx"],"application/vnd.intergeo":["i2g"],"application/vnd.intu.qbo":["qbo"],"application/vnd.intu.qfx":["qfx"],"application/vnd.ipunplugged.rcprofile":["rcprofile"],"application/vnd.irepository.package+xml":["irp"],"application/vnd.is-xpr":["xpr"],"application/vnd.isac.fcs":["fcs"],"application/vnd.jam":["jam"],"application/vnd.jcp.javame.midlet-rms":["rms"],"application/vnd.jisp":["jisp"],"application/vnd.joost.joda-archive":["joda"],"application/vnd.kahootz":["ktz","ktr"],"application/vnd.kde.karbon":["karbon"],"application/vnd.kde.kchart":["chrt"],"application/vnd.kde.kformula":["kfo"],"application/vnd.kde.kivio":["flw"],"application/vnd.kde.kontour":["kon"],"application/vnd.kde.kpresenter":["kpr","kpt"],"application/vnd.kde.kspread":["ksp"],"application/vnd.kde.kword":["kwd","kwt"],"application/vnd.kenameaapp":["htke"],"application/vnd.kidspiration":["kia"],"application/vnd.kinar":["kne","knp"],"application/vnd.koan":["skp","skd","skt","skm"],"application/vnd.kodak-descriptor":["sse"],"application/vnd.las.las+xml":["lasxml"],"application/vnd.llamagraphics.life-balance.desktop":["lbd"],"application/vnd.llamagraphics.life-balance.exchange+xml":["lbe"],"application/vnd.lotus-1-2-3":["123"],"application/vnd.lotus-approach":["apr"],"application/vnd.lotus-freelance":["pre"],"application/vnd.lotus-notes":["nsf"],"application/vnd.lotus-organizer":["org"],"application/vnd.lotus-screencam":["scm"],"application/vnd.lotus-wordpro":["lwp"],"application/vnd.macports.portpkg":["portpkg"],"application/vnd.mapbox-vector-tile":["mvt"],"application/vnd.mcd":["mcd"],"application/vnd.medcalcdata":["mc1"],"application/vnd.mediastation.cdkey":["cdkey"],"application/vnd.mfer":["mwf"],"application/vnd.mfmp":["mfm"],"application/vnd.micrografx.flo":["flo"],"application/vnd.micrografx.igx":["igx"],"application/vnd.mif":["mif"],"application/vnd.mobius.daf":["daf"],"application/vnd.mobius.dis":["dis"],"application/vnd.mobius.mbk":["mbk"],"application/vnd.mobius.mqy":["mqy"],"application/vnd.mobius.msl":["msl"],"application/vnd.mobius.plc":["plc"],"application/vnd.mobius.txf":["txf"],"application/vnd.mophun.application":["mpn"],"application/vnd.mophun.certificate":["mpc"],"application/vnd.mozilla.xul+xml":["xul"],"application/vnd.ms-artgalry":["cil"],"application/vnd.ms-cab-compressed":["cab"],"application/vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"application/vnd.ms-excel.addin.macroenabled.12":["xlam"],"application/vnd.ms-excel.sheet.binary.macroenabled.12":["xlsb"],"application/vnd.ms-excel.sheet.macroenabled.12":["xlsm"],"application/vnd.ms-excel.template.macroenabled.12":["xltm"],"application/vnd.ms-fontobject":["eot"],"application/vnd.ms-htmlhelp":["chm"],"application/vnd.ms-ims":["ims"],"application/vnd.ms-lrm":["lrm"],"application/vnd.ms-officetheme":["thmx"],"application/vnd.ms-outlook":["msg"],"application/vnd.ms-pki.seccat":["cat"],"application/vnd.ms-pki.stl":["*stl"],"application/vnd.ms-powerpoint":["ppt","pps","pot"],"application/vnd.ms-powerpoint.addin.macroenabled.12":["ppam"],"application/vnd.ms-powerpoint.presentation.macroenabled.12":["pptm"],"application/vnd.ms-powerpoint.slide.macroenabled.12":["sldm"],"application/vnd.ms-powerpoint.slideshow.macroenabled.12":["ppsm"],"application/vnd.ms-powerpoint.template.macroenabled.12":["potm"],"application/vnd.ms-project":["mpp","mpt"],"application/vnd.ms-word.document.macroenabled.12":["docm"],"application/vnd.ms-word.template.macroenabled.12":["dotm"],"application/vnd.ms-works":["wps","wks","wcm","wdb"],"application/vnd.ms-wpl":["wpl"],"application/vnd.ms-xpsdocument":["xps"],"application/vnd.mseq":["mseq"],"application/vnd.musician":["mus"],"application/vnd.muvee.style":["msty"],"application/vnd.mynfc":["taglet"],"application/vnd.neurolanguage.nlu":["nlu"],"application/vnd.nitf":["ntf","nitf"],"application/vnd.noblenet-directory":["nnd"],"application/vnd.noblenet-sealer":["nns"],"application/vnd.noblenet-web":["nnw"],"application/vnd.nokia.n-gage.ac+xml":["*ac"],"application/vnd.nokia.n-gage.data":["ngdat"],"application/vnd.nokia.n-gage.symbian.install":["n-gage"],"application/vnd.nokia.radio-preset":["rpst"],"application/vnd.nokia.radio-presets":["rpss"],"application/vnd.novadigm.edm":["edm"],"application/vnd.novadigm.edx":["edx"],"application/vnd.novadigm.ext":["ext"],"application/vnd.oasis.opendocument.chart":["odc"],"application/vnd.oasis.opendocument.chart-template":["otc"],"application/vnd.oasis.opendocument.database":["odb"],"application/vnd.oasis.opendocument.formula":["odf"],"application/vnd.oasis.opendocument.formula-template":["odft"],"application/vnd.oasis.opendocument.graphics":["odg"],"application/vnd.oasis.opendocument.graphics-template":["otg"],"application/vnd.oasis.opendocument.image":["odi"],"application/vnd.oasis.opendocument.image-template":["oti"],"application/vnd.oasis.opendocument.presentation":["odp"],"application/vnd.oasis.opendocument.presentation-template":["otp"],"application/vnd.oasis.opendocument.spreadsheet":["ods"],"application/vnd.oasis.opendocument.spreadsheet-template":["ots"],"application/vnd.oasis.opendocument.text":["odt"],"application/vnd.oasis.opendocument.text-master":["odm"],"application/vnd.oasis.opendocument.text-template":["ott"],"application/vnd.oasis.opendocument.text-web":["oth"],"application/vnd.olpc-sugar":["xo"],"application/vnd.oma.dd2+xml":["dd2"],"application/vnd.openblox.game+xml":["obgx"],"application/vnd.openofficeorg.extension":["oxt"],"application/vnd.openstreetmap.data+xml":["osm"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"application/vnd.openxmlformats-officedocument.presentationml.slide":["sldx"],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":["ppsx"],"application/vnd.openxmlformats-officedocument.presentationml.template":["potx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":["xltx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.template":["dotx"],"application/vnd.osgeo.mapguide.package":["mgp"],"application/vnd.osgi.dp":["dp"],"application/vnd.osgi.subsystem":["esa"],"application/vnd.palm":["pdb","pqa","oprc"],"application/vnd.pawaafile":["paw"],"application/vnd.pg.format":["str"],"application/vnd.pg.osasli":["ei6"],"application/vnd.picsel":["efif"],"application/vnd.pmi.widget":["wg"],"application/vnd.pocketlearn":["plf"],"application/vnd.powerbuilder6":["pbd"],"application/vnd.previewsystems.box":["box"],"application/vnd.proteus.magazine":["mgz"],"application/vnd.publishare-delta-tree":["qps"],"application/vnd.pvi.ptid1":["ptid"],"application/vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"application/vnd.rar":["rar"],"application/vnd.realvnc.bed":["bed"],"application/vnd.recordare.musicxml":["mxl"],"application/vnd.recordare.musicxml+xml":["musicxml"],"application/vnd.rig.cryptonote":["cryptonote"],"application/vnd.rim.cod":["cod"],"application/vnd.rn-realmedia":["rm"],"application/vnd.rn-realmedia-vbr":["rmvb"],"application/vnd.route66.link66+xml":["link66"],"application/vnd.sailingtracker.track":["st"],"application/vnd.seemail":["see"],"application/vnd.sema":["sema"],"application/vnd.semd":["semd"],"application/vnd.semf":["semf"],"application/vnd.shana.informed.formdata":["ifm"],"application/vnd.shana.informed.formtemplate":["itp"],"application/vnd.shana.informed.interchange":["iif"],"application/vnd.shana.informed.package":["ipk"],"application/vnd.simtech-mindmapper":["twd","twds"],"application/vnd.smaf":["mmf"],"application/vnd.smart.teacher":["teacher"],"application/vnd.software602.filler.form+xml":["fo"],"application/vnd.solent.sdkm+xml":["sdkm","sdkd"],"application/vnd.spotfire.dxp":["dxp"],"application/vnd.spotfire.sfs":["sfs"],"application/vnd.stardivision.calc":["sdc"],"application/vnd.stardivision.draw":["sda"],"application/vnd.stardivision.impress":["sdd"],"application/vnd.stardivision.math":["smf"],"application/vnd.stardivision.writer":["sdw","vor"],"application/vnd.stardivision.writer-global":["sgl"],"application/vnd.stepmania.package":["smzip"],"application/vnd.stepmania.stepchart":["sm"],"application/vnd.sun.wadl+xml":["wadl"],"application/vnd.sun.xml.calc":["sxc"],"application/vnd.sun.xml.calc.template":["stc"],"application/vnd.sun.xml.draw":["sxd"],"application/vnd.sun.xml.draw.template":["std"],"application/vnd.sun.xml.impress":["sxi"],"application/vnd.sun.xml.impress.template":["sti"],"application/vnd.sun.xml.math":["sxm"],"application/vnd.sun.xml.writer":["sxw"],"application/vnd.sun.xml.writer.global":["sxg"],"application/vnd.sun.xml.writer.template":["stw"],"application/vnd.sus-calendar":["sus","susp"],"application/vnd.svd":["svd"],"application/vnd.symbian.install":["sis","sisx"],"application/vnd.syncml+xml":["xsm"],"application/vnd.syncml.dm+wbxml":["bdm"],"application/vnd.syncml.dm+xml":["xdm"],"application/vnd.syncml.dmddf+xml":["ddf"],"application/vnd.tao.intent-module-archive":["tao"],"application/vnd.tcpdump.pcap":["pcap","cap","dmp"],"application/vnd.tmobile-livetv":["tmo"],"application/vnd.trid.tpt":["tpt"],"application/vnd.triscape.mxs":["mxs"],"application/vnd.trueapp":["tra"],"application/vnd.ufdl":["ufd","ufdl"],"application/vnd.uiq.theme":["utz"],"application/vnd.umajin":["umj"],"application/vnd.unity":["unityweb"],"application/vnd.uoml+xml":["uoml"],"application/vnd.vcx":["vcx"],"application/vnd.visio":["vsd","vst","vss","vsw"],"application/vnd.visionary":["vis"],"application/vnd.vsf":["vsf"],"application/vnd.wap.wbxml":["wbxml"],"application/vnd.wap.wmlc":["wmlc"],"application/vnd.wap.wmlscriptc":["wmlsc"],"application/vnd.webturbo":["wtb"],"application/vnd.wolfram.player":["nbp"],"application/vnd.wordperfect":["wpd"],"application/vnd.wqd":["wqd"],"application/vnd.wt.stf":["stf"],"application/vnd.xara":["xar"],"application/vnd.xfdl":["xfdl"],"application/vnd.yamaha.hv-dic":["hvd"],"application/vnd.yamaha.hv-script":["hvs"],"application/vnd.yamaha.hv-voice":["hvp"],"application/vnd.yamaha.openscoreformat":["osf"],"application/vnd.yamaha.openscoreformat.osfpvg+xml":["osfpvg"],"application/vnd.yamaha.smaf-audio":["saf"],"application/vnd.yamaha.smaf-phrase":["spf"],"application/vnd.yellowriver-custom-menu":["cmp"],"application/vnd.zul":["zir","zirz"],"application/vnd.zzazz.deck+xml":["zaz"],"application/x-7z-compressed":["7z"],"application/x-abiword":["abw"],"application/x-ace-compressed":["ace"],"application/x-apple-diskimage":["*dmg"],"application/x-arj":["arj"],"application/x-authorware-bin":["aab","x32","u32","vox"],"application/x-authorware-map":["aam"],"application/x-authorware-seg":["aas"],"application/x-bcpio":["bcpio"],"application/x-bdoc":["*bdoc"],"application/x-bittorrent":["torrent"],"application/x-blorb":["blb","blorb"],"application/x-bzip":["bz"],"application/x-bzip2":["bz2","boz"],"application/x-cbr":["cbr","cba","cbt","cbz","cb7"],"application/x-cdlink":["vcd"],"application/x-cfs-compressed":["cfs"],"application/x-chat":["chat"],"application/x-chess-pgn":["pgn"],"application/x-chrome-extension":["crx"],"application/x-cocoa":["cco"],"application/x-conference":["nsc"],"application/x-cpio":["cpio"],"application/x-csh":["csh"],"application/x-debian-package":["*deb","udeb"],"application/x-dgc-compressed":["dgc"],"application/x-director":["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"],"application/x-doom":["wad"],"application/x-dtbncx+xml":["ncx"],"application/x-dtbook+xml":["dtb"],"application/x-dtbresource+xml":["res"],"application/x-dvi":["dvi"],"application/x-envoy":["evy"],"application/x-eva":["eva"],"application/x-font-bdf":["bdf"],"application/x-font-ghostscript":["gsf"],"application/x-font-linux-psf":["psf"],"application/x-font-pcf":["pcf"],"application/x-font-snf":["snf"],"application/x-font-type1":["pfa","pfb","pfm","afm"],"application/x-freearc":["arc"],"application/x-futuresplash":["spl"],"application/x-gca-compressed":["gca"],"application/x-glulx":["ulx"],"application/x-gnumeric":["gnumeric"],"application/x-gramps-xml":["gramps"],"application/x-gtar":["gtar"],"application/x-hdf":["hdf"],"application/x-httpd-php":["php"],"application/x-install-instructions":["install"],"application/x-iso9660-image":["*iso"],"application/x-iwork-keynote-sffkey":["*key"],"application/x-iwork-numbers-sffnumbers":["*numbers"],"application/x-iwork-pages-sffpages":["*pages"],"application/x-java-archive-diff":["jardiff"],"application/x-java-jnlp-file":["jnlp"],"application/x-keepass2":["kdbx"],"application/x-latex":["latex"],"application/x-lua-bytecode":["luac"],"application/x-lzh-compressed":["lzh","lha"],"application/x-makeself":["run"],"application/x-mie":["mie"],"application/x-mobipocket-ebook":["prc","mobi"],"application/x-ms-application":["application"],"application/x-ms-shortcut":["lnk"],"application/x-ms-wmd":["wmd"],"application/x-ms-wmz":["wmz"],"application/x-ms-xbap":["xbap"],"application/x-msaccess":["mdb"],"application/x-msbinder":["obd"],"application/x-mscardfile":["crd"],"application/x-msclip":["clp"],"application/x-msdos-program":["*exe"],"application/x-msdownload":["*exe","*dll","com","bat","*msi"],"application/x-msmediaview":["mvb","m13","m14"],"application/x-msmetafile":["*wmf","*wmz","*emf","emz"],"application/x-msmoney":["mny"],"application/x-mspublisher":["pub"],"application/x-msschedule":["scd"],"application/x-msterminal":["trm"],"application/x-mswrite":["wri"],"application/x-netcdf":["nc","cdf"],"application/x-ns-proxy-autoconfig":["pac"],"application/x-nzb":["nzb"],"application/x-perl":["pl","pm"],"application/x-pilot":["*prc","*pdb"],"application/x-pkcs12":["p12","pfx"],"application/x-pkcs7-certificates":["p7b","spc"],"application/x-pkcs7-certreqresp":["p7r"],"application/x-rar-compressed":["*rar"],"application/x-redhat-package-manager":["rpm"],"application/x-research-info-systems":["ris"],"application/x-sea":["sea"],"application/x-sh":["sh"],"application/x-shar":["shar"],"application/x-shockwave-flash":["swf"],"application/x-silverlight-app":["xap"],"application/x-sql":["sql"],"application/x-stuffit":["sit"],"application/x-stuffitx":["sitx"],"application/x-subrip":["srt"],"application/x-sv4cpio":["sv4cpio"],"application/x-sv4crc":["sv4crc"],"application/x-t3vm-image":["t3"],"application/x-tads":["gam"],"application/x-tar":["tar"],"application/x-tcl":["tcl","tk"],"application/x-tex":["tex"],"application/x-tex-tfm":["tfm"],"application/x-texinfo":["texinfo","texi"],"application/x-tgif":["*obj"],"application/x-ustar":["ustar"],"application/x-virtualbox-hdd":["hdd"],"application/x-virtualbox-ova":["ova"],"application/x-virtualbox-ovf":["ovf"],"application/x-virtualbox-vbox":["vbox"],"application/x-virtualbox-vbox-extpack":["vbox-extpack"],"application/x-virtualbox-vdi":["vdi"],"application/x-virtualbox-vhd":["vhd"],"application/x-virtualbox-vmdk":["vmdk"],"application/x-wais-source":["src"],"application/x-web-app-manifest+json":["webapp"],"application/x-x509-ca-cert":["der","crt","pem"],"application/x-xfig":["fig"],"application/x-xliff+xml":["*xlf"],"application/x-xpinstall":["xpi"],"application/x-xz":["xz"],"application/x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"audio/vnd.dece.audio":["uva","uvva"],"audio/vnd.digital-winds":["eol"],"audio/vnd.dra":["dra"],"audio/vnd.dts":["dts"],"audio/vnd.dts.hd":["dtshd"],"audio/vnd.lucent.voice":["lvp"],"audio/vnd.ms-playready.media.pya":["pya"],"audio/vnd.nuera.ecelp4800":["ecelp4800"],"audio/vnd.nuera.ecelp7470":["ecelp7470"],"audio/vnd.nuera.ecelp9600":["ecelp9600"],"audio/vnd.rip":["rip"],"audio/x-aac":["aac"],"audio/x-aiff":["aif","aiff","aifc"],"audio/x-caf":["caf"],"audio/x-flac":["flac"],"audio/x-m4a":["*m4a"],"audio/x-matroska":["mka"],"audio/x-mpegurl":["m3u"],"audio/x-ms-wax":["wax"],"audio/x-ms-wma":["wma"],"audio/x-pn-realaudio":["ram","ra"],"audio/x-pn-realaudio-plugin":["rmp"],"audio/x-realaudio":["*ra"],"audio/x-wav":["*wav"],"chemical/x-cdx":["cdx"],"chemical/x-cif":["cif"],"chemical/x-cmdf":["cmdf"],"chemical/x-cml":["cml"],"chemical/x-csml":["csml"],"chemical/x-xyz":["xyz"],"image/prs.btif":["btif"],"image/prs.pti":["pti"],"image/vnd.adobe.photoshop":["psd"],"image/vnd.airzip.accelerator.azv":["azv"],"image/vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"image/vnd.djvu":["djvu","djv"],"image/vnd.dvb.subtitle":["*sub"],"image/vnd.dwg":["dwg"],"image/vnd.dxf":["dxf"],"image/vnd.fastbidsheet":["fbs"],"image/vnd.fpx":["fpx"],"image/vnd.fst":["fst"],"image/vnd.fujixerox.edmics-mmr":["mmr"],"image/vnd.fujixerox.edmics-rlc":["rlc"],"image/vnd.microsoft.icon":["ico"],"image/vnd.ms-dds":["dds"],"image/vnd.ms-modi":["mdi"],"image/vnd.ms-photo":["wdp"],"image/vnd.net-fpx":["npx"],"image/vnd.pco.b16":["b16"],"image/vnd.tencent.tap":["tap"],"image/vnd.valve.source.texture":["vtf"],"image/vnd.wap.wbmp":["wbmp"],"image/vnd.xiff":["xif"],"image/vnd.zbrush.pcx":["pcx"],"image/x-3ds":["3ds"],"image/x-cmu-raster":["ras"],"image/x-cmx":["cmx"],"image/x-freehand":["fh","fhc","fh4","fh5","fh7"],"image/x-icon":["*ico"],"image/x-jng":["jng"],"image/x-mrsid-image":["sid"],"image/x-ms-bmp":["*bmp"],"image/x-pcx":["*pcx"],"image/x-pict":["pic","pct"],"image/x-portable-anymap":["pnm"],"image/x-portable-bitmap":["pbm"],"image/x-portable-graymap":["pgm"],"image/x-portable-pixmap":["ppm"],"image/x-rgb":["rgb"],"image/x-tga":["tga"],"image/x-xbitmap":["xbm"],"image/x-xpixmap":["xpm"],"image/x-xwindowdump":["xwd"],"message/vnd.wfa.wsc":["wsc"],"model/vnd.collada+xml":["dae"],"model/vnd.dwf":["dwf"],"model/vnd.gdl":["gdl"],"model/vnd.gtw":["gtw"],"model/vnd.mts":["mts"],"model/vnd.opengex":["ogex"],"model/vnd.parasolid.transmit.binary":["x_b"],"model/vnd.parasolid.transmit.text":["x_t"],"model/vnd.sap.vds":["vds"],"model/vnd.usdz+zip":["usdz"],"model/vnd.valve.source.compiled-map":["bsp"],"model/vnd.vtu":["vtu"],"text/prs.lines.tag":["dsc"],"text/vnd.curl":["curl"],"text/vnd.curl.dcurl":["dcurl"],"text/vnd.curl.mcurl":["mcurl"],"text/vnd.curl.scurl":["scurl"],"text/vnd.dvb.subtitle":["sub"],"text/vnd.fly":["fly"],"text/vnd.fmi.flexstor":["flx"],"text/vnd.graphviz":["gv"],"text/vnd.in3d.3dml":["3dml"],"text/vnd.in3d.spot":["spot"],"text/vnd.sun.j2me.app-descriptor":["jad"],"text/vnd.wap.wml":["wml"],"text/vnd.wap.wmlscript":["wmls"],"text/x-asm":["s","asm"],"text/x-c":["c","cc","cxx","cpp","h","hh","dic"],"text/x-component":["htc"],"text/x-fortran":["f","for","f77","f90"],"text/x-handlebars-template":["hbs"],"text/x-java-source":["java"],"text/x-lua":["lua"],"text/x-markdown":["mkd"],"text/x-nfo":["nfo"],"text/x-opml":["opml"],"text/x-org":["*org"],"text/x-pascal":["p","pas"],"text/x-processing":["pde"],"text/x-sass":["sass"],"text/x-scss":["scss"],"text/x-setext":["etx"],"text/x-sfv":["sfv"],"text/x-suse-ymp":["ymp"],"text/x-uuencode":["uu"],"text/x-vcalendar":["vcs"],"text/x-vcard":["vcf"],"video/vnd.dece.hd":["uvh","uvvh"],"video/vnd.dece.mobile":["uvm","uvvm"],"video/vnd.dece.pd":["uvp","uvvp"],"video/vnd.dece.sd":["uvs","uvvs"],"video/vnd.dece.video":["uvv","uvvv"],"video/vnd.dvb.file":["dvb"],"video/vnd.fvt":["fvt"],"video/vnd.mpegurl":["mxu","m4u"],"video/vnd.ms-playready.media.pyv":["pyv"],"video/vnd.uvvu.mp4":["uvu","uvvu"],"video/vnd.vivo":["viv"],"video/x-f4v":["f4v"],"video/x-fli":["fli"],"video/x-flv":["flv"],"video/x-m4v":["m4v"],"video/x-matroska":["mkv","mk3d","mks"],"video/x-mng":["mng"],"video/x-ms-asf":["asf","asx"],"video/x-ms-vob":["vob"],"video/x-ms-wm":["wm"],"video/x-ms-wmv":["wmv"],"video/x-ms-wmx":["wmx"],"video/x-ms-wvx":["wvx"],"video/x-msvideo":["avi"],"video/x-sgi-movie":["movie"],"video/x-smv":["smv"],"x-conference/x-cooltalk":["ice"]}}),KA=ee((r,e)=>{"use strict";var t=zA();e.exports=new t(VA(),GA())}),JA=ee((r,e)=>{e.exports=function(n,s){for(var o=[],a=0;a<n.length;a++){var l=s(n[a],a);t(l)?o.push.apply(o,l):o.push(l)}return o};var t=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}}),XA=ee((r,e)=>{"use strict";e.exports=t;function t(o,a,l){o instanceof RegExp&&(o=n(o,l)),a instanceof RegExp&&(a=n(a,l));var c=s(o,a,l);return c&&{start:c[0],end:c[1],pre:l.slice(0,c[0]),body:l.slice(c[0]+o.length,c[1]),post:l.slice(c[1]+a.length)}}function n(o,a){var l=a.match(o);return l?l[0]:null}t.range=s;function s(o,a,l){var c,u,d,h,p,f=l.indexOf(o),_=l.indexOf(a,f+1),v=f;if(f>=0&&_>0){if(o===a)return[f,_];for(c=[],d=l.length;v>=0&&!p;)v==f?(c.push(v),f=l.indexOf(o,v+1)):c.length==1?p=[c.pop(),_]:(u=c.pop(),u<d&&(d=u,h=_),_=l.indexOf(a,v+1)),v=f<_&&f>=0?f:_;c.length&&(p=[d,h])}return p}}),YA=ee((r,e)=>{var t=JA(),n=XA();e.exports=f;var s="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(x){return parseInt(x,10)==x?parseInt(x,10):x.charCodeAt(0)}function d(x){return x.split("\\\\").join(s).split("\\{").join(o).split("\\}").join(a).split("\\,").join(l).split("\\.").join(c)}function h(x){return x.split(s).join("\\").split(o).join("{").split(a).join("}").split(l).join(",").split(c).join(".")}function p(x){if(!x)return[""];var b=[],y=n("{","}",x);if(!y)return x.split(",");var S=y.pre,E=y.body,C=y.post,k=S.split(",");k[k.length-1]+="{"+E+"}";var F=p(C);return C.length&&(k[k.length-1]+=F.shift(),k.push.apply(k,F)),b.push.apply(b,k),b}function f(x){return x?(x.substr(0,2)==="{}"&&(x="\\{\\}"+x.substr(2)),g(d(x),!0).map(h)):[]}function _(x){return"{"+x+"}"}function v(x){return/^-?0\d/.test(x)}function w(x,b){return x<=b}function m(x,b){return x>=b}function g(x,b){var y=[],S=n("{","}",x);if(!S||/\$$/.test(S.pre))return[x];var E=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(S.body),C=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(S.body),k=E||C,F=S.body.indexOf(",")>=0;if(!k&&!F)return S.post.match(/,.*\}/)?(x=S.pre+"{"+S.body+a+S.post,g(x)):[x];var O;if(k)O=S.body.split(/\.\./);else if(O=p(S.body),O.length===1&&(O=g(O[0],!1).map(_),O.length===1)){var P=S.post.length?g(S.post,!1):[""];return P.map(function(H){return S.pre+O[0]+H})}var I=S.pre,P=S.post.length?g(S.post,!1):[""],T;if(k){var A=u(O[0]),R=u(O[1]),V=Math.max(O[0].length,O[1].length),J=O.length==3?Math.abs(u(O[2])):1,q=w,U=R<A;U&&(J*=-1,q=m);var Y=O.some(v);T=[];for(var Q=A;q(Q,R);Q+=J){var te;if(C)te=String.fromCharCode(Q),te==="\\"&&(te="");else if(te=String(Q),Y){var oe=V-te.length;if(oe>0){var N=new Array(oe+1).join("0");Q<0?te="-"+N+te.slice(1):te=N+te}}T.push(te)}}else T=t(O,function(L){return g(L,!1)});for(var B=0;B<T.length;B++)for(var W=0;W<P.length;W++){var $=I+T[B]+P[W];(!b||k||$)&&y.push($)}return y}}),QA=ee((r,e)=>{e.exports=v,v.Minimatch=w;var t=function(){try{return require("path")}catch{}}()||{sep:"/"};v.sep=t.sep;var n=v.GLOBSTAR=w.GLOBSTAR={},s=YA(),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",l=a+"*?",c="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",u="(?:(?!(?:\\/|^)\\.).)*?",d=h("().*{}+?[]^$\\!");function h(O){return O.split("").reduce(function(I,P){return I[P]=!0,I},{})}var p=/\/+/;v.filter=f;function f(O,I){return I=I||{},function(P,T,A){return v(P,O,I)}}function _(O,I){I=I||{};var P={};return Object.keys(O).forEach(function(T){P[T]=O[T]}),Object.keys(I).forEach(function(T){P[T]=I[T]}),P}v.defaults=function(O){if(!O||typeof O!="object"||!Object.keys(O).length)return v;var I=v,P=function(T,A,R){return I(T,A,_(O,R))};return P.Minimatch=function(T,A){return new I.Minimatch(T,_(O,A))},P.Minimatch.defaults=function(T){return I.defaults(_(O,T)).Minimatch},P.filter=function(T,A){return I.filter(T,_(O,A))},P.defaults=function(T){return I.defaults(_(O,T))},P.makeRe=function(T,A){return I.makeRe(T,_(O,A))},P.braceExpand=function(T,A){return I.braceExpand(T,_(O,A))},P.match=function(T,A,R){return I.match(T,A,_(O,R))},P},w.defaults=function(O){return v.defaults(O).Minimatch};function v(O,I,P){return y(I),P||(P={}),!P.nocomment&&I.charAt(0)==="#"?!1:new w(I,P).match(O)}function w(O,I){if(!(this instanceof w))return new w(O,I);y(O),I||(I={}),O=O.trim(),!I.allowWindowsEscape&&t.sep!=="/"&&(O=O.split(t.sep).join("/")),this.options=I,this.set=[],this.pattern=O,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!I.partial,this.make()}w.prototype.debug=function(){},w.prototype.make=m;function m(){var O=this.pattern,I=this.options;if(!I.nocomment&&O.charAt(0)==="#"){this.comment=!0;return}if(!O){this.empty=!0;return}this.parseNegate();var P=this.globSet=this.braceExpand();I.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,P),P=this.globParts=P.map(function(T){return T.split(p)}),this.debug(this.pattern,P),P=P.map(function(T,A,R){return T.map(this.parse,this)},this),this.debug(this.pattern,P),P=P.filter(function(T){return T.indexOf(!1)===-1}),this.debug(this.pattern,P),this.set=P}w.prototype.parseNegate=g;function g(){var O=this.pattern,I=!1,P=this.options,T=0;if(!P.nonegate){for(var A=0,R=O.length;A<R&&O.charAt(A)==="!";A++)I=!I,T++;T&&(this.pattern=O.substr(T)),this.negate=I}}v.braceExpand=function(O,I){return x(O,I)},w.prototype.braceExpand=x;function x(O,I){return I||(this instanceof w?I=this.options:I={}),O=typeof O>"u"?this.pattern:O,y(O),I.nobrace||!/\{(?:(?!\{).)*\}/.test(O)?[O]:s(O)}var b=1024*64,y=function(O){if(typeof O!="string")throw new TypeError("invalid pattern");if(O.length>b)throw new TypeError("pattern is too long")};w.prototype.parse=E;var S={};function E(O,I){y(O);var P=this.options;if(O==="**")if(P.noglobstar)O="*";else return n;if(O==="")return"";var T="",A=!!P.nocase,R=!1,V=[],J=[],q,U=!1,Y=-1,Q=-1,te=O.charAt(0)==="."?"":P.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",oe=this;function N(){if(q){switch(q){case"*":T+=l,A=!0;break;case"?":T+=a,A=!0;break;default:T+="\\"+q;break}oe.debug("clearStateChar %j %j",q,T),q=!1}}for(var B=0,W=O.length,$;B<W&&($=O.charAt(B));B++){if(this.debug("%s	%s %s %j",O,B,T,$),R&&d[$]){T+="\\"+$,R=!1;continue}switch($){case"/":return!1;case"\\":N(),R=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",O,B,T,$),U){this.debug("  in class"),$==="!"&&B===Q+1&&($="^"),T+=$;continue}oe.debug("call clearStateChar %j",q),N(),q=$,P.noext&&N();continue;case"(":if(U){T+="(";continue}if(!q){T+="\\(";continue}V.push({type:q,start:B-1,reStart:T.length,open:o[q].open,close:o[q].close}),T+=q==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",q,T),q=!1;continue;case")":if(U||!V.length){T+="\\)";continue}N(),A=!0;var L=V.pop();T+=L.close,L.type==="!"&&J.push(L),L.reEnd=T.length;continue;case"|":if(U||!V.length||R){T+="\\|",R=!1;continue}N(),T+="|";continue;case"[":if(N(),U){T+="\\"+$;continue}U=!0,Q=B,Y=T.length,T+=$;continue;case"]":if(B===Q+1||!U){T+="\\"+$,R=!1;continue}var H=O.substring(Q+1,B);try{RegExp("["+H+"]")}catch{var z=this.parse(H,S);T=T.substr(0,Y)+"\\["+z[0]+"\\]",A=A||z[1],U=!1;continue}A=!0,U=!1,T+=$;continue;default:N(),R?R=!1:d[$]&&!($==="^"&&U)&&(T+="\\"),T+=$}}for(U&&(H=O.substr(Q+1),z=this.parse(H,S),T=T.substr(0,Y)+"\\["+z[0],A=A||z[1]),L=V.pop();L;L=V.pop()){var K=T.slice(L.reStart+L.open.length);this.debug("setting tail",T,L),K=K.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(ve,_e,fe){return fe||(fe="\\"),_e+_e+fe+"|"}),this.debug(`tail=%j
   %s`,K,K,L,T);var ae=L.type==="*"?l:L.type==="?"?a:"\\"+L.type;A=!0,T=T.slice(0,L.reStart)+ae+"\\("+K}N(),R&&(T+="\\\\");var D=!1;switch(T.charAt(0)){case"[":case".":case"(":D=!0}for(var j=J.length-1;j>-1;j--){var X=J[j],Z=T.slice(0,X.reStart),se=T.slice(X.reStart,X.reEnd-8),Ce=T.slice(X.reEnd-8,X.reEnd),Ge=T.slice(X.reEnd);Ce+=Ge;var rt=Z.split("(").length-1,lt=Ge;for(B=0;B<rt;B++)lt=lt.replace(/\)[+*?]?/,"");Ge=lt;var G="";Ge===""&&I!==S&&(G="$");var de=Z+se+Ge+G+Ce;T=de}if(T!==""&&A&&(T="(?=.)"+T),D&&(T=te+T),I===S)return[T,A];if(!A)return k(O);var me=P.nocase?"i":"";try{var pe=new RegExp("^"+T+"$",me)}catch{return new RegExp("$.")}return pe._glob=O,pe._src=T,pe}v.makeRe=function(O,I){return new w(O,I||{}).makeRe()},w.prototype.makeRe=C;function C(){if(this.regexp||this.regexp===!1)return this.regexp;var O=this.set;if(!O.length)return this.regexp=!1,this.regexp;var I=this.options,P=I.noglobstar?l:I.dot?c:u,T=I.nocase?"i":"",A=O.map(function(R){return R.map(function(V){return V===n?P:typeof V=="string"?F(V):V._src}).join("\\/")}).join("|");A="^(?:"+A+")$",this.negate&&(A="^(?!"+A+").*$");try{this.regexp=new RegExp(A,T)}catch{this.regexp=!1}return this.regexp}v.match=function(O,I,P){P=P||{};var T=new w(I,P);return O=O.filter(function(A){return T.match(A)}),T.options.nonull&&!O.length&&O.push(I),O},w.prototype.match=function(O,I){if(typeof I>"u"&&(I=this.partial),this.debug("match",O,this.pattern),this.comment)return!1;if(this.empty)return O==="";if(O==="/"&&I)return!0;var P=this.options;t.sep!=="/"&&(O=O.split(t.sep).join("/")),O=O.split(p),this.debug(this.pattern,"split",O);var T=this.set;this.debug(this.pattern,"set",T);var A,R;for(R=O.length-1;R>=0&&(A=O[R],!A);R--);for(R=0;R<T.length;R++){var V=T[R],J=O;P.matchBase&&V.length===1&&(J=[A]);var q=this.matchOne(J,V,I);if(q)return P.flipNegate?!0:!this.negate}return P.flipNegate?!1:this.negate},w.prototype.matchOne=function(O,I,P){var T=this.options;this.debug("matchOne",{this:this,file:O,pattern:I}),this.debug("matchOne",O.length,I.length);for(var A=0,R=0,V=O.length,J=I.length;A<V&&R<J;A++,R++){this.debug("matchOne loop");var q=I[R],U=O[A];if(this.debug(I,q,U),q===!1)return!1;if(q===n){this.debug("GLOBSTAR",[I,q,U]);var Y=A,Q=R+1;if(Q===J){for(this.debug("** at the end");A<V;A++)if(O[A]==="."||O[A]===".."||!T.dot&&O[A].charAt(0)===".")return!1;return!0}for(;Y<V;){var te=O[Y];if(this.debug(`
globstar while`,O,Y,I,Q,te),this.matchOne(O.slice(Y),I.slice(Q),P))return this.debug("globstar found match!",Y,V,te),!0;if(te==="."||te===".."||!T.dot&&te.charAt(0)==="."){this.debug("dot detected!",O,Y,I,Q);break}this.debug("globstar swallow a segment, and continue"),Y++}return!!(P&&(this.debug(`
>>> no match, partial?`,O,Y,I,Q),Y===V))}var oe;if(typeof q=="string"?(oe=U===q,this.debug("string match",q,U,oe)):(oe=U.match(q),this.debug("pattern match",q,U,oe)),!oe)return!1}if(A===V&&R===J)return!0;if(A===V)return P;if(R===J)return A===V-1&&O[A]==="";throw new Error("wtf?")};function k(O){return O.replace(/\\(.)/g,"$1")}function F(O){return O.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}),U0=ee((r,e)=>{"use strict";var t=require("fs"),n;function s(){try{return t.statSync("/.dockerenv"),!0}catch{return!1}}function o(){try{return t.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}e.exports=()=>(n===void 0&&(n=s()||o()),n)}),ZA=ee((r,e)=>{"use strict";var t=require("os"),n=require("fs"),s=U0(),o=()=>{if(process.platform!=="linux")return!1;if(t.release().toLowerCase().includes("microsoft"))return!s();try{return n.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!s():!1}catch{return!1}};process.env.__IS_WSL_TEST__?e.exports=o:e.exports=o()}),eI=ee((r,e)=>{"use strict";e.exports=(t,n,s)=>{let o=a=>Object.defineProperty(t,n,{value:a,enumerable:!0,writable:!0});return Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get(){let a=s();return o(a),a},set(a){o(a)}}),t}}),tI=ee((r,e)=>{var t=require("path"),n=require("child_process"),{promises:s,constants:o}=require("fs"),a=ZA(),l=U0(),c=eI(),u=t.join(__dirname,"xdg-open"),{platform:d,arch:h}=process,p=(()=>{let b="/mnt/",y;return async function(){if(y)return y;let S="/etc/wsl.conf",E=!1;try{await s.access(S,o.F_OK),E=!0}catch{}if(!E)return b;let C=await s.readFile(S,{encoding:"utf8"}),k=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(C);return k?(y=k.groups.mountPoint.trim(),y=y.endsWith("/")?y:`${y}/`,y):b}})(),f=async(b,y)=>{let S;for(let E of b)try{return await y(E)}catch(C){S=C}throw S},_=async b=>{if(b={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...b},Array.isArray(b.app))return f(b.app,O=>_({...b,app:O}));let{name:y,arguments:S=[]}=b.app||{};if(S=[...S],Array.isArray(y))return f(y,O=>_({...b,app:{name:O,arguments:S}}));let E,C=[],k={};if(d==="darwin")E="open",b.wait&&C.push("--wait-apps"),b.background&&C.push("--background"),b.newInstance&&C.push("--new"),y&&C.push("-a",y);else if(d==="win32"||a&&!l()){let O=await p();E=a?`${O}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,C.push("-NoProfile","-NonInteractive","\u2013ExecutionPolicy","Bypass","-EncodedCommand"),a||(k.windowsVerbatimArguments=!0);let I=["Start"];b.wait&&I.push("-Wait"),y?(I.push(`"\`"${y}\`""`,"-ArgumentList"),b.target&&S.unshift(b.target)):b.target&&I.push(`"${b.target}"`),S.length>0&&(S=S.map(P=>`"\`"${P}\`""`),I.push(S.join(","))),b.target=Buffer.from(I.join(" "),"utf16le").toString("base64")}else{if(y)E=y;else{let O=!__dirname||__dirname==="/",I=!1;try{await s.access(u,o.X_OK),I=!0}catch{}E=process.versions.electron||d==="android"||O||!I?"xdg-open":u}S.length>0&&C.push(...S),b.wait||(k.stdio="ignore",k.detached=!0)}b.target&&C.push(b.target),d==="darwin"&&S.length>0&&C.push("--args",...S);let F=n.spawn(E,C,k);return b.wait?new Promise((O,I)=>{F.once("error",I),F.once("close",P=>{if(b.allowNonzeroExitCode&&P>0){I(new Error(`Exited with code ${P}`));return}O(F)})}):(F.unref(),F)},v=(b,y)=>{if(typeof b!="string")throw new TypeError("Expected a `target`");return _({...y,target:b})},w=(b,y)=>{if(typeof b!="string")throw new TypeError("Expected a `name`");let{arguments:S=[]}=y||{};if(S!=null&&!Array.isArray(S))throw new TypeError("Expected `appArguments` as Array type");return _({...y,app:{name:b,arguments:S}})};function m(b){if(typeof b=="string"||Array.isArray(b))return b;let{[h]:y}=b;if(!y)throw new Error(`${h} is not supported`);return y}function g({[d]:b},{wsl:y}){if(y&&a)return m(y);if(!b)throw new Error(`${d} is not supported`);return m(b)}var x={};c(x,"chrome",()=>g({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}})),c(x,"firefox",()=>g({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"})),c(x,"edge",()=>g({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"})),v.apps=x,v.openApp=w,e.exports=v}),z0=ee((r,e)=>{"use strict";var t=require("util"),n=require("stream"),s=e.exports=function(){n.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};t.inherits(s,n),s.prototype.read=function(o,a){this._reads.push({length:Math.abs(o),allowLess:o<0,func:a}),process.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},s.prototype.write=function(o,a){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let l;return Buffer.isBuffer(o)?l=o:l=Buffer.from(o,a||this._encoding),this._buffers.push(l),this._buffered+=l.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},s.prototype.end=function(o,a){o&&this.write(o,a),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},s.prototype.destroySoon=s.prototype.end,s.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},s.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},s.prototype._processReadAllowingLess=function(o){this._reads.shift();let a=this._buffers[0];a.length>o.length?(this._buffered-=o.length,this._buffers[0]=a.slice(o.length),o.func.call(this,a.slice(0,o.length))):(this._buffered-=a.length,this._buffers.shift(),o.func.call(this,a))},s.prototype._processRead=function(o){this._reads.shift();let a=0,l=0,c=Buffer.alloc(o.length);for(;a<o.length;){let u=this._buffers[l++],d=Math.min(u.length,o.length-a);u.copy(c,a,0,d),a+=d,d!==u.length&&(this._buffers[--l]=u.slice(d))}l>0&&this._buffers.splice(0,l),this._buffered-=o.length,o.func.call(this,c)},s.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let o=this._reads[0];if(o.allowLess)this._processReadAllowingLess(o);else if(this._buffered>=o.length)this._processRead(o);else break}this._buffers&&!this.writable&&this._end()}catch(o){this.emit("error",o)}}}),V0=ee(r=>{"use strict";var e=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];r.getImagePasses=function(t,n){let s=[],o=t%8,a=n%8,l=(t-o)/8,c=(n-a)/8;for(let u=0;u<e.length;u++){let d=e[u],h=l*d.x.length,p=c*d.y.length;for(let f=0;f<d.x.length&&d.x[f]<o;f++)h++;for(let f=0;f<d.y.length&&d.y[f]<a;f++)p++;h>0&&p>0&&s.push({width:h,height:p,index:u})}return s},r.getInterlaceIterator=function(t){return function(n,s,o){let a=n%e[o].x.length,l=(n-a)/e[o].x.length*8+e[o].x[a],c=s%e[o].y.length,u=(s-c)/e[o].y.length*8+e[o].y[c];return l*4+u*t*4}}}),G0=ee((r,e)=>{"use strict";e.exports=function(t,n,s){let o=t+n-s,a=Math.abs(o-t),l=Math.abs(o-n),c=Math.abs(o-s);return a<=l&&a<=c?t:l<=c?n:s}}),K0=ee((r,e)=>{"use strict";var t=V0(),n=G0();function s(a,l,c){let u=a*l;return c!==8&&(u=Math.ceil(u/(8/c))),u}var o=e.exports=function(a,l){let c=a.width,u=a.height,d=a.interlace,h=a.bpp,p=a.depth;if(this.read=l.read,this.write=l.write,this.complete=l.complete,this._imageIndex=0,this._images=[],d){let f=t.getImagePasses(c,u);for(let _=0;_<f.length;_++)this._images.push({byteWidth:s(f[_].width,h,p),height:f[_].height,lineIndex:0})}else this._images.push({byteWidth:s(c,h,p),height:u,lineIndex:0});p===8?this._xComparison=h:p===16?this._xComparison=h*2:this._xComparison=1};o.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},o.prototype._unFilterType1=function(a,l,c){let u=this._xComparison,d=u-1;for(let h=0;h<c;h++){let p=a[1+h],f=h>d?l[h-u]:0;l[h]=p+f}},o.prototype._unFilterType2=function(a,l,c){let u=this._lastLine;for(let d=0;d<c;d++){let h=a[1+d],p=u?u[d]:0;l[d]=h+p}},o.prototype._unFilterType3=function(a,l,c){let u=this._xComparison,d=u-1,h=this._lastLine;for(let p=0;p<c;p++){let f=a[1+p],_=h?h[p]:0,v=p>d?l[p-u]:0,w=Math.floor((v+_)/2);l[p]=f+w}},o.prototype._unFilterType4=function(a,l,c){let u=this._xComparison,d=u-1,h=this._lastLine;for(let p=0;p<c;p++){let f=a[1+p],_=h?h[p]:0,v=p>d?l[p-u]:0,w=p>d&&h?h[p-u]:0,m=n(v,_,w);l[p]=f+m}},o.prototype._reverseFilterLine=function(a){let l=a[0],c,u=this._images[this._imageIndex],d=u.byteWidth;if(l===0)c=a.slice(1,d+1);else switch(c=Buffer.alloc(d),l){case 1:this._unFilterType1(a,c,d);break;case 2:this._unFilterType2(a,c,d);break;case 3:this._unFilterType3(a,c,d);break;case 4:this._unFilterType4(a,c,d);break;default:throw new Error("Unrecognised filter type - "+l)}this.write(c),u.lineIndex++,u.lineIndex>=u.height?(this._lastLine=null,this._imageIndex++,u=this._images[this._imageIndex]):this._lastLine=c,u?this.read(u.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}),nI=ee((r,e)=>{"use strict";var t=require("util"),n=z0(),s=K0(),o=e.exports=function(a){n.call(this);let l=[],c=this;this._filter=new s(a,{read:this.read.bind(this),write:function(u){l.push(u)},complete:function(){c.emit("complete",Buffer.concat(l))}}),this._filter.start()};t.inherits(o,n)}),uo=ee((r,e)=>{"use strict";e.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}}),J0=ee((r,e)=>{"use strict";var t=[];(function(){for(let s=0;s<256;s++){let o=s;for(let a=0;a<8;a++)o&1?o=3988292384^o>>>1:o=o>>>1;t[s]=o}})();var n=e.exports=function(){this._crc=-1};n.prototype.write=function(s){for(let o=0;o<s.length;o++)this._crc=t[(this._crc^s[o])&255]^this._crc>>>8;return!0},n.prototype.crc32=function(){return this._crc^-1},n.crc32=function(s){let o=-1;for(let a=0;a<s.length;a++)o=t[(o^s[a])&255]^o>>>8;return o^-1}}),X0=ee((r,e)=>{"use strict";var t=uo(),n=J0(),s=e.exports=function(o,a){this._options=o,o.checkCRC=o.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[t.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[t.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[t.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[t.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[t.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[t.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=a.read,this.error=a.error,this.metadata=a.metadata,this.gamma=a.gamma,this.transColor=a.transColor,this.palette=a.palette,this.parsed=a.parsed,this.inflateData=a.inflateData,this.finished=a.finished,this.simpleTransparency=a.simpleTransparency,this.headersFinished=a.headersFinished||function(){}};s.prototype.start=function(){this.read(t.PNG_SIGNATURE.length,this._parseSignature.bind(this))},s.prototype._parseSignature=function(o){let a=t.PNG_SIGNATURE;for(let l=0;l<a.length;l++)if(o[l]!==a[l]){this.error(new Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))},s.prototype._parseChunkBegin=function(o){let a=o.readUInt32BE(0),l=o.readUInt32BE(4),c="";for(let d=4;d<8;d++)c+=String.fromCharCode(o[d]);let u=!!(o[4]&32);if(!this._hasIHDR&&l!==t.TYPE_IHDR){this.error(new Error("Expected IHDR on beggining"));return}if(this._crc=new n,this._crc.write(Buffer.from(c)),this._chunks[l])return this._chunks[l](a);if(!u){this.error(new Error("Unsupported critical chunk type "+c));return}this.read(a+4,this._skipChunk.bind(this))},s.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},s.prototype._parseChunkEnd=function(o){let a=o.readInt32BE(0),l=this._crc.crc32();if(this._options.checkCRC&&l!==a){this.error(new Error("Crc error - "+a+" - "+l));return}this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleIHDR=function(o){this.read(o,this._parseIHDR.bind(this))},s.prototype._parseIHDR=function(o){this._crc.write(o);let a=o.readUInt32BE(0),l=o.readUInt32BE(4),c=o[8],u=o[9],d=o[10],h=o[11],p=o[12];if(c!==8&&c!==4&&c!==2&&c!==1&&c!==16){this.error(new Error("Unsupported bit depth "+c));return}if(!(u in t.COLORTYPE_TO_BPP_MAP)){this.error(new Error("Unsupported color type"));return}if(d!==0){this.error(new Error("Unsupported compression method"));return}if(h!==0){this.error(new Error("Unsupported filter method"));return}if(p!==0&&p!==1){this.error(new Error("Unsupported interlace method"));return}this._colorType=u;let f=t.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:a,height:l,depth:c,interlace:!!p,palette:!!(u&t.COLORTYPE_PALETTE),color:!!(u&t.COLORTYPE_COLOR),alpha:!!(u&t.COLORTYPE_ALPHA),bpp:f,colorType:u}),this._handleChunkEnd()},s.prototype._handlePLTE=function(o){this.read(o,this._parsePLTE.bind(this))},s.prototype._parsePLTE=function(o){this._crc.write(o);let a=Math.floor(o.length/3);for(let l=0;l<a;l++)this._palette.push([o[l*3],o[l*3+1],o[l*3+2],255]);this.palette(this._palette),this._handleChunkEnd()},s.prototype._handleTRNS=function(o){this.simpleTransparency(),this.read(o,this._parseTRNS.bind(this))},s.prototype._parseTRNS=function(o){if(this._crc.write(o),this._colorType===t.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(new Error("Transparency chunk must be after palette"));return}if(o.length>this._palette.length){this.error(new Error("More transparent colors than palette size"));return}for(let a=0;a<o.length;a++)this._palette[a][3]=o[a];this.palette(this._palette)}this._colorType===t.COLORTYPE_GRAYSCALE&&this.transColor([o.readUInt16BE(0)]),this._colorType===t.COLORTYPE_COLOR&&this.transColor([o.readUInt16BE(0),o.readUInt16BE(2),o.readUInt16BE(4)]),this._handleChunkEnd()},s.prototype._handleGAMA=function(o){this.read(o,this._parseGAMA.bind(this))},s.prototype._parseGAMA=function(o){this._crc.write(o),this.gamma(o.readUInt32BE(0)/t.GAMMA_DIVISION),this._handleChunkEnd()},s.prototype._handleIDAT=function(o){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-o,this._parseIDAT.bind(this,o))},s.prototype._parseIDAT=function(o,a){if(this._crc.write(a),this._colorType===t.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(a);let l=o-a.length;l>0?this._handleIDAT(l):this._handleChunkEnd()},s.prototype._handleIEND=function(o){this.read(o,this._parseIEND.bind(this))},s.prototype._parseIEND=function(o){this._crc.write(o),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}),Y0=ee(r=>{"use strict";var e=V0(),t=[function(){},function(l,c,u,d){if(d===c.length)throw new Error("Ran out of data");let h=c[d];l[u]=h,l[u+1]=h,l[u+2]=h,l[u+3]=255},function(l,c,u,d){if(d+1>=c.length)throw new Error("Ran out of data");let h=c[d];l[u]=h,l[u+1]=h,l[u+2]=h,l[u+3]=c[d+1]},function(l,c,u,d){if(d+2>=c.length)throw new Error("Ran out of data");l[u]=c[d],l[u+1]=c[d+1],l[u+2]=c[d+2],l[u+3]=255},function(l,c,u,d){if(d+3>=c.length)throw new Error("Ran out of data");l[u]=c[d],l[u+1]=c[d+1],l[u+2]=c[d+2],l[u+3]=c[d+3]}],n=[function(){},function(l,c,u,d){let h=c[0];l[u]=h,l[u+1]=h,l[u+2]=h,l[u+3]=d},function(l,c,u){let d=c[0];l[u]=d,l[u+1]=d,l[u+2]=d,l[u+3]=c[1]},function(l,c,u,d){l[u]=c[0],l[u+1]=c[1],l[u+2]=c[2],l[u+3]=d},function(l,c,u){l[u]=c[0],l[u+1]=c[1],l[u+2]=c[2],l[u+3]=c[3]}];function s(l,c){let u=[],d=0;function h(){if(d===l.length)throw new Error("Ran out of data");let p=l[d];d++;let f,_,v,w,m,g,x,b;switch(c){default:throw new Error("unrecognised depth");case 16:x=l[d],d++,u.push((p<<8)+x);break;case 4:x=p&15,b=p>>4,u.push(b,x);break;case 2:m=p&3,g=p>>2&3,x=p>>4&3,b=p>>6&3,u.push(b,x,g,m);break;case 1:f=p&1,_=p>>1&1,v=p>>2&1,w=p>>3&1,m=p>>4&1,g=p>>5&1,x=p>>6&1,b=p>>7&1,u.push(b,x,g,m,w,v,_,f);break}}return{get:function(p){for(;u.length<p;)h();let f=u.slice(0,p);return u=u.slice(p),f},resetAfterLine:function(){u.length=0},end:function(){if(d!==l.length)throw new Error("extra data found")}}}function o(l,c,u,d,h,p){let f=l.width,_=l.height,v=l.index;for(let w=0;w<_;w++)for(let m=0;m<f;m++){let g=u(m,w,v);t[d](c,h,g,p),p+=d}return p}function a(l,c,u,d,h,p){let f=l.width,_=l.height,v=l.index;for(let w=0;w<_;w++){for(let m=0;m<f;m++){let g=h.get(d),x=u(m,w,v);n[d](c,g,x,p)}h.resetAfterLine()}}r.dataToBitMap=function(l,c){let u=c.width,d=c.height,h=c.depth,p=c.bpp,f=c.interlace,_;h!==8&&(_=s(l,h));let v;h<=8?v=Buffer.alloc(u*d*4):v=new Uint16Array(u*d*4);let w=Math.pow(2,h)-1,m=0,g,x;if(f)g=e.getImagePasses(u,d),x=e.getInterlaceIterator(u,d);else{let b=0;x=function(){let y=b;return b+=4,y},g=[{width:u,height:d}]}for(let b=0;b<g.length;b++)h===8?m=o(g[b],v,x,p,l,m):a(g[b],v,x,p,_,w);if(h===8){if(m!==l.length)throw new Error("extra data found")}else _.end();return v}}),Q0=ee((r,e)=>{"use strict";function t(o,a,l,c,u){let d=0;for(let h=0;h<c;h++)for(let p=0;p<l;p++){let f=u[o[d]];if(!f)throw new Error("index "+o[d]+" not in palette");for(let _=0;_<4;_++)a[d+_]=f[_];d+=4}}function n(o,a,l,c,u){let d=0;for(let h=0;h<c;h++)for(let p=0;p<l;p++){let f=!1;if(u.length===1?u[0]===o[d]&&(f=!0):u[0]===o[d]&&u[1]===o[d+1]&&u[2]===o[d+2]&&(f=!0),f)for(let _=0;_<4;_++)a[d+_]=0;d+=4}}function s(o,a,l,c,u){let d=255,h=Math.pow(2,u)-1,p=0;for(let f=0;f<c;f++)for(let _=0;_<l;_++){for(let v=0;v<4;v++)a[p+v]=Math.floor(o[p+v]*d/h+.5);p+=4}}e.exports=function(o,a,l=!1){let c=a.depth,u=a.width,d=a.height,h=a.colorType,p=a.transColor,f=a.palette,_=o;return h===3?t(o,_,u,d,f):(p&&n(o,_,u,d,p),c!==8&&!l&&(c===16&&(_=Buffer.alloc(u*d*4)),s(o,_,u,d,c))),_}}),rI=ee((r,e)=>{"use strict";var t=require("util"),n=require("zlib"),s=z0(),o=nI(),a=X0(),l=Y0(),c=Q0(),u=e.exports=function(d){s.call(this),this._parser=new a(d,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=d,this.writable=!0,this._parser.start()};t.inherits(u,s),u.prototype._handleError=function(d){this.emit("error",d),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},u.prototype._inflateData=function(d){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=n.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let h=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,p=Math.max(h,n.Z_MIN_CHUNK);this._inflate=n.createInflate({chunkSize:p});let f=h,_=this.emit.bind(this,"error");this._inflate.on("error",function(w){f&&_(w)}),this._filter.on("complete",this._complete.bind(this));let v=this._filter.write.bind(this._filter);this._inflate.on("data",function(w){f&&(w.length>f&&(w=w.slice(0,f)),f-=w.length,v(w))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(d)},u.prototype._handleMetaData=function(d){this._metaData=d,this._bitmapInfo=Object.create(d),this._filter=new o(this._bitmapInfo)},u.prototype._handleTransColor=function(d){this._bitmapInfo.transColor=d},u.prototype._handlePalette=function(d){this._bitmapInfo.palette=d},u.prototype._simpleTransparency=function(){this._metaData.alpha=!0},u.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},u.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},u.prototype._complete=function(d){if(this.errord)return;let h;try{let p=l.dataToBitMap(d,this._bitmapInfo);h=c(p,this._bitmapInfo,this._options.skipRescale),p=null}catch(p){this._handleError(p);return}this.emit("parsed",h)}}),iI=ee((r,e)=>{"use strict";var t=uo();e.exports=function(n,s,o,a){let l=[t.COLORTYPE_COLOR_ALPHA,t.COLORTYPE_ALPHA].indexOf(a.colorType)!==-1;if(a.colorType===a.inputColorType){let m=function(){let g=new ArrayBuffer(2);return new DataView(g).setInt16(0,256,!0),new Int16Array(g)[0]!==256}();if(a.bitDepth===8||a.bitDepth===16&&m)return n}let c=a.bitDepth!==16?n:new Uint16Array(n.buffer),u=255,d=t.COLORTYPE_TO_BPP_MAP[a.inputColorType];d===4&&!a.inputHasAlpha&&(d=3);let h=t.COLORTYPE_TO_BPP_MAP[a.colorType];a.bitDepth===16&&(u=65535,h*=2);let p=Buffer.alloc(s*o*h),f=0,_=0,v=a.bgColor||{};v.red===void 0&&(v.red=u),v.green===void 0&&(v.green=u),v.blue===void 0&&(v.blue=u);function w(){let m,g,x,b=u;switch(a.inputColorType){case t.COLORTYPE_COLOR_ALPHA:b=c[f+3],m=c[f],g=c[f+1],x=c[f+2];break;case t.COLORTYPE_COLOR:m=c[f],g=c[f+1],x=c[f+2];break;case t.COLORTYPE_ALPHA:b=c[f+1],m=c[f],g=m,x=m;break;case t.COLORTYPE_GRAYSCALE:m=c[f],g=m,x=m;break;default:throw new Error("input color type:"+a.inputColorType+" is not supported at present")}return a.inputHasAlpha&&(l||(b/=u,m=Math.min(Math.max(Math.round((1-b)*v.red+b*m),0),u),g=Math.min(Math.max(Math.round((1-b)*v.green+b*g),0),u),x=Math.min(Math.max(Math.round((1-b)*v.blue+b*x),0),u))),{red:m,green:g,blue:x,alpha:b}}for(let m=0;m<o;m++)for(let g=0;g<s;g++){let x=w(c,f);switch(a.colorType){case t.COLORTYPE_COLOR_ALPHA:case t.COLORTYPE_COLOR:a.bitDepth===8?(p[_]=x.red,p[_+1]=x.green,p[_+2]=x.blue,l&&(p[_+3]=x.alpha)):(p.writeUInt16BE(x.red,_),p.writeUInt16BE(x.green,_+2),p.writeUInt16BE(x.blue,_+4),l&&p.writeUInt16BE(x.alpha,_+6));break;case t.COLORTYPE_ALPHA:case t.COLORTYPE_GRAYSCALE:{let b=(x.red+x.green+x.blue)/3;a.bitDepth===8?(p[_]=b,l&&(p[_+1]=x.alpha)):(p.writeUInt16BE(b,_),l&&p.writeUInt16BE(x.alpha,_+2));break}default:throw new Error("unrecognised color Type "+a.colorType)}f+=d,_+=h}return p}}),sI=ee((r,e)=>{"use strict";var t=G0();function n(v,w,m,g,x){for(let b=0;b<m;b++)g[x+b]=v[w+b]}function s(v,w,m){let g=0,x=w+m;for(let b=w;b<x;b++)g+=Math.abs(v[b]);return g}function o(v,w,m,g,x,b){for(let y=0;y<m;y++){let S=y>=b?v[w+y-b]:0,E=v[w+y]-S;g[x+y]=E}}function a(v,w,m,g){let x=0;for(let b=0;b<m;b++){let y=b>=g?v[w+b-g]:0,S=v[w+b]-y;x+=Math.abs(S)}return x}function l(v,w,m,g,x){for(let b=0;b<m;b++){let y=w>0?v[w+b-m]:0,S=v[w+b]-y;g[x+b]=S}}function c(v,w,m){let g=0,x=w+m;for(let b=w;b<x;b++){let y=w>0?v[b-m]:0,S=v[b]-y;g+=Math.abs(S)}return g}function u(v,w,m,g,x,b){for(let y=0;y<m;y++){let S=y>=b?v[w+y-b]:0,E=w>0?v[w+y-m]:0,C=v[w+y]-(S+E>>1);g[x+y]=C}}function d(v,w,m,g){let x=0;for(let b=0;b<m;b++){let y=b>=g?v[w+b-g]:0,S=w>0?v[w+b-m]:0,E=v[w+b]-(y+S>>1);x+=Math.abs(E)}return x}function h(v,w,m,g,x,b){for(let y=0;y<m;y++){let S=y>=b?v[w+y-b]:0,E=w>0?v[w+y-m]:0,C=w>0&&y>=b?v[w+y-(m+b)]:0,k=v[w+y]-t(S,E,C);g[x+y]=k}}function p(v,w,m,g){let x=0;for(let b=0;b<m;b++){let y=b>=g?v[w+b-g]:0,S=w>0?v[w+b-m]:0,E=w>0&&b>=g?v[w+b-(m+g)]:0,C=v[w+b]-t(y,S,E);x+=Math.abs(C)}return x}var f={0:n,1:o,2:l,3:u,4:h},_={0:s,1:a,2:c,3:d,4:p};e.exports=function(v,w,m,g,x){let b;if(!("filterType"in g)||g.filterType===-1)b=[0,1,2,3,4];else if(typeof g.filterType=="number")b=[g.filterType];else throw new Error("unrecognised filter types");g.bitDepth===16&&(x*=2);let y=w*x,S=0,E=0,C=Buffer.alloc((y+1)*m),k=b[0];for(let F=0;F<m;F++){if(b.length>1){let O=1/0;for(let I=0;I<b.length;I++){let P=_[b[I]](v,E,y,x);P<O&&(k=b[I],O=P)}}C[S]=k,S++,f[k](v,E,y,C,S,x),S+=y,E+=y}return C}}),Z0=ee((r,e)=>{"use strict";var t=uo(),n=J0(),s=iI(),o=sI(),a=require("zlib"),l=e.exports=function(c){if(this._options=c,c.deflateChunkSize=c.deflateChunkSize||32*1024,c.deflateLevel=c.deflateLevel!=null?c.deflateLevel:9,c.deflateStrategy=c.deflateStrategy!=null?c.deflateStrategy:3,c.inputHasAlpha=c.inputHasAlpha!=null?c.inputHasAlpha:!0,c.deflateFactory=c.deflateFactory||a.createDeflate,c.bitDepth=c.bitDepth||8,c.colorType=typeof c.colorType=="number"?c.colorType:t.COLORTYPE_COLOR_ALPHA,c.inputColorType=typeof c.inputColorType=="number"?c.inputColorType:t.COLORTYPE_COLOR_ALPHA,[t.COLORTYPE_GRAYSCALE,t.COLORTYPE_COLOR,t.COLORTYPE_COLOR_ALPHA,t.COLORTYPE_ALPHA].indexOf(c.colorType)===-1)throw new Error("option color type:"+c.colorType+" is not supported at present");if([t.COLORTYPE_GRAYSCALE,t.COLORTYPE_COLOR,t.COLORTYPE_COLOR_ALPHA,t.COLORTYPE_ALPHA].indexOf(c.inputColorType)===-1)throw new Error("option input color type:"+c.inputColorType+" is not supported at present");if(c.bitDepth!==8&&c.bitDepth!==16)throw new Error("option bit depth:"+c.bitDepth+" is not supported at present")};l.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},l.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},l.prototype.filterData=function(c,u,d){let h=s(c,u,d,this._options),p=t.COLORTYPE_TO_BPP_MAP[this._options.colorType];return o(h,u,d,this._options,p)},l.prototype._packChunk=function(c,u){let d=u?u.length:0,h=Buffer.alloc(d+12);return h.writeUInt32BE(d,0),h.writeUInt32BE(c,4),u&&u.copy(h,8),h.writeInt32BE(n.crc32(h.slice(4,h.length-4)),h.length-4),h},l.prototype.packGAMA=function(c){let u=Buffer.alloc(4);return u.writeUInt32BE(Math.floor(c*t.GAMMA_DIVISION),0),this._packChunk(t.TYPE_gAMA,u)},l.prototype.packIHDR=function(c,u){let d=Buffer.alloc(13);return d.writeUInt32BE(c,0),d.writeUInt32BE(u,4),d[8]=this._options.bitDepth,d[9]=this._options.colorType,d[10]=0,d[11]=0,d[12]=0,this._packChunk(t.TYPE_IHDR,d)},l.prototype.packIDAT=function(c){return this._packChunk(t.TYPE_IDAT,c)},l.prototype.packIEND=function(){return this._packChunk(t.TYPE_IEND,null)}}),oI=ee((r,e)=>{"use strict";var t=require("util"),n=require("stream"),s=uo(),o=Z0(),a=e.exports=function(l){n.call(this);let c=l||{};this._packer=new o(c),this._deflate=this._packer.createDeflate(),this.readable=!0};t.inherits(a,n),a.prototype.pack=function(l,c,u,d){this.emit("data",Buffer.from(s.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(c,u)),d&&this.emit("data",this._packer.packGAMA(d));let h=this._packer.filterData(l,c,u);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(p){this.emit("data",this._packer.packIDAT(p))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(h)}}),aI=ee((r,e)=>{"use strict";var t=require("assert").ok,n=require("zlib"),s=require("util"),o=require("buffer").kMaxLength;function a(h){if(!(this instanceof a))return new a(h);h&&h.chunkSize<n.Z_MIN_CHUNK&&(h.chunkSize=n.Z_MIN_CHUNK),n.Inflate.call(this,h),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,h&&h.maxLength!=null&&(this._maxLength=h.maxLength)}function l(h){return new a(h)}function c(h,p){p&&process.nextTick(p),h._handle&&(h._handle.close(),h._handle=null)}a.prototype._processChunk=function(h,p,f){if(typeof f=="function")return n.Inflate._processChunk.call(this,h,p,f);let _=this,v=h&&h.length,w=this._chunkSize-this._offset,m=this._maxLength,g=0,x=[],b=0,y;this.on("error",function(k){y=k});function S(k,F){if(_._hadError)return;let O=w-F;if(t(O>=0,"have should not go down"),O>0){let I=_._buffer.slice(_._offset,_._offset+O);if(_._offset+=O,I.length>m&&(I=I.slice(0,m)),x.push(I),b+=I.length,m-=I.length,m===0)return!1}return(F===0||_._offset>=_._chunkSize)&&(w=_._chunkSize,_._offset=0,_._buffer=Buffer.allocUnsafe(_._chunkSize)),F===0?(g+=v-k,v=k,!0):!1}t(this._handle,"zlib binding closed");let E;do E=this._handle.writeSync(p,h,g,v,this._buffer,this._offset,w),E=E||this._writeState;while(!this._hadError&&S(E[0],E[1]));if(this._hadError)throw y;if(b>=o)throw c(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+o.toString(16)+" bytes");let C=Buffer.concat(x,b);return c(this),C},s.inherits(a,n.Inflate);function u(h,p){if(typeof p=="string"&&(p=Buffer.from(p)),!(p instanceof Buffer))throw new TypeError("Not a string or buffer");let f=h._finishFlushFlag;return f==null&&(f=n.Z_FINISH),h._processChunk(p,f)}function d(h,p){return u(new a(p),h)}e.exports=r=d,r.Inflate=a,r.createInflate=l,r.inflateSync=d}),ey=ee((r,e)=>{"use strict";var t=e.exports=function(n){this._buffer=n,this._reads=[]};t.prototype.read=function(n,s){this._reads.push({length:Math.abs(n),allowLess:n<0,func:s})},t.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let n=this._reads[0];if(this._buffer.length&&(this._buffer.length>=n.length||n.allowLess)){this._reads.shift();let s=this._buffer;this._buffer=s.slice(n.length),n.func.call(this,s.slice(0,n.length))}else break}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}}),lI=ee(r=>{"use strict";var e=ey(),t=K0();r.process=function(n,s){let o=[],a=new e(n);return new t(s,{read:a.read.bind(a),write:function(l){o.push(l)},complete:function(){}}).start(),a.process(),Buffer.concat(o)}}),cI=ee((r,e)=>{"use strict";var t=!0,n=require("zlib"),s=aI();n.deflateSync||(t=!1);var o=ey(),a=lI(),l=X0(),c=Y0(),u=Q0();e.exports=function(d,h){if(!t)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let p;function f(P){p=P}let _;function v(P){_=P}function w(P){_.transColor=P}function m(P){_.palette=P}function g(){_.alpha=!0}let x;function b(P){x=P}let y=[];function S(P){y.push(P)}let E=new o(d);if(new l(h,{read:E.read.bind(E),error:f,metadata:v,gamma:b,palette:m,transColor:w,inflateData:S,simpleTransparency:g}).start(),E.process(),p)throw p;let C=Buffer.concat(y);y.length=0;let k;if(_.interlace)k=n.inflateSync(C);else{let P=((_.width*_.bpp*_.depth+7>>3)+1)*_.height;k=s(C,{chunkSize:P,maxLength:P})}if(C=null,!k||!k.length)throw new Error("bad png - invalid inflate data response");let F=a.process(k,_);C=null;let O=c.dataToBitMap(F,_);F=null;let I=u(O,_,h.skipRescale);return _.data=I,_.gamma=x||0,_}}),uI=ee((r,e)=>{"use strict";var t=!0,n=require("zlib");n.deflateSync||(t=!1);var s=uo(),o=Z0();e.exports=function(a,l){if(!t)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let c=l||{},u=new o(c),d=[];d.push(Buffer.from(s.PNG_SIGNATURE)),d.push(u.packIHDR(a.width,a.height)),a.gamma&&d.push(u.packGAMA(a.gamma));let h=u.filterData(a.data,a.width,a.height),p=n.deflateSync(h,u.getDeflateOptions());if(h=null,!p||!p.length)throw new Error("bad png - invalid compressed data response");return d.push(u.packIDAT(p)),d.push(u.packIEND()),Buffer.concat(d)}}),dI=ee(r=>{"use strict";var e=cI(),t=uI();r.read=function(n,s){return e(n,s||{})},r.write=function(n,s){return t(n,s)}}),hI=ee(r=>{"use strict";var e=require("util"),t=require("stream"),n=rI(),s=oI(),o=dI(),a=r.PNG=function(l){t.call(this),l=l||{},this.width=l.width|0,this.height=l.height|0,this.data=this.width>0&&this.height>0?Buffer.alloc(4*this.width*this.height):null,l.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new n(l),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(c){this.data=c,this.emit("parsed",c)}.bind(this)),this._packer=new s(l),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};e.inherits(a,t),a.sync=o,a.prototype.pack=function(){return!this.data||!this.data.length?(this.emit("error","No data provided"),this):(process.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this)},a.prototype.parse=function(l,c){if(c){let u,d;u=function(h){this.removeListener("error",d),this.data=h,c(null,this)}.bind(this),d=function(h){this.removeListener("parsed",u),c(h,null)}.bind(this),this.once("parsed",u),this.once("error",d)}return this.end(l),this},a.prototype.write=function(l){return this._parser.write(l),!0},a.prototype.end=function(l){this._parser.end(l)},a.prototype._metadata=function(l){this.width=l.width,this.height=l.height,this.emit("metadata",l)},a.prototype._gamma=function(l){this.gamma=l},a.prototype._handleClose=function(){!this._parser.writable&&!this._packer.readable&&this.emit("close")},a.bitblt=function(l,c,u,d,h,p,f,_){if(u|=0,d|=0,h|=0,p|=0,f|=0,_|=0,u>l.width||d>l.height||u+h>l.width||d+p>l.height)throw new Error("bitblt reading outside image");if(f>c.width||_>c.height||f+h>c.width||_+p>c.height)throw new Error("bitblt writing outside image");for(let v=0;v<p;v++)l.data.copy(c.data,(_+v)*c.width+f<<2,(d+v)*l.width+u<<2,(d+v)*l.width+u+h<<2)},a.prototype.bitblt=function(l,c,u,d,h,p,f){return a.bitblt(this,l,c,u,d,h,p,f),this},a.adjustGamma=function(l){if(l.gamma){for(let c=0;c<l.height;c++)for(let u=0;u<l.width;u++){let d=l.width*c+u<<2;for(let h=0;h<3;h++){let p=l.data[d+h]/255;p=Math.pow(p,1/2.2/l.gamma),l.data[d+h]=Math.round(p*255)}}l.gamma=0}},a.prototype.adjustGamma=function(){a.adjustGamma(this)}}),tl=ee(r=>{var e=class extends Error{constructor(n,s,o){super(o),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=s,this.exitCode=n,this.nestedError=void 0}},t=class extends e{constructor(n){super(1,"commander.invalidArgument",n),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};r.CommanderError=e,r.InvalidArgumentError=t}),op=ee(r=>{var{InvalidArgumentError:e}=tl(),t=class{constructor(s,o){switch(this.description=o||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,s[0]){case"<":this.required=!0,this._name=s.slice(1,-1);break;case"[":this.required=!1,this._name=s.slice(1,-1);break;default:this.required=!0,this._name=s;break}this._name.length>3&&this._name.slice(-3)==="..."&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(s,o){return o===this.defaultValue||!Array.isArray(o)?[s]:o.concat(s)}default(s,o){return this.defaultValue=s,this.defaultValueDescription=o,this}argParser(s){return this.parseArg=s,this}choices(s){return this.argChoices=s,this.parseArg=(o,a)=>{if(!s.includes(o))throw new e(`Allowed choices are ${s.join(", ")}.`);return this.variadic?this._concatValue(o,a):o},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function n(s){let o=s.name()+(s.variadic===!0?"...":"");return s.required?"<"+o+">":"["+o+"]"}r.Argument=t,r.humanReadableArgName=n}),ty=ee(r=>{var{humanReadableArgName:e}=op(),t=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1}visibleCommands(n){let s=n.commands.filter(o=>!o._hidden);if(n._hasImplicitHelpCommand()){let[,o,a]=n._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),l=n.createCommand(o).helpOption(!1);l.description(n._helpCommandDescription),a&&l.arguments(a),s.push(l)}return this.sortSubcommands&&s.sort((o,a)=>o.name().localeCompare(a.name())),s}visibleOptions(n){let s=n.options.filter(l=>!l.hidden),o=n._hasHelpOption&&n._helpShortFlag&&!n._findOption(n._helpShortFlag),a=n._hasHelpOption&&!n._findOption(n._helpLongFlag);if(o||a){let l;o?a?l=n.createOption(n._helpFlags,n._helpDescription):l=n.createOption(n._helpShortFlag,n._helpDescription):l=n.createOption(n._helpLongFlag,n._helpDescription),s.push(l)}if(this.sortOptions){let l=c=>c.short?c.short.replace(/^-/,""):c.long.replace(/^--/,"");s.sort((c,u)=>l(c).localeCompare(l(u)))}return s}visibleArguments(n){return n._argsDescription&&n._args.forEach(s=>{s.description=s.description||n._argsDescription[s.name()]||""}),n._args.find(s=>s.description)?n._args:[]}subcommandTerm(n){let s=n._args.map(o=>e(o)).join(" ");return n._name+(n._aliases[0]?"|"+n._aliases[0]:"")+(n.options.length?" [options]":"")+(s?" "+s:"")}optionTerm(n){return n.flags}argumentTerm(n){return n.name()}longestSubcommandTermLength(n,s){return s.visibleCommands(n).reduce((o,a)=>Math.max(o,s.subcommandTerm(a).length),0)}longestOptionTermLength(n,s){return s.visibleOptions(n).reduce((o,a)=>Math.max(o,s.optionTerm(a).length),0)}longestArgumentTermLength(n,s){return s.visibleArguments(n).reduce((o,a)=>Math.max(o,s.argumentTerm(a).length),0)}commandUsage(n){let s=n._name;n._aliases[0]&&(s=s+"|"+n._aliases[0]);let o="";for(let a=n.parent;a;a=a.parent)o=a.name()+" "+o;return o+s+" "+n.usage()}commandDescription(n){return n.description()}subcommandDescription(n){return n.description()}optionDescription(n){let s=[];return n.argChoices&&!n.negate&&s.push(`choices: ${n.argChoices.map(o=>JSON.stringify(o)).join(", ")}`),n.defaultValue!==void 0&&!n.negate&&s.push(`default: ${n.defaultValueDescription||JSON.stringify(n.defaultValue)}`),n.envVar!==void 0&&s.push(`env: ${n.envVar}`),s.length>0?`${n.description} (${s.join(", ")})`:n.description}argumentDescription(n){let s=[];if(n.argChoices&&s.push(`choices: ${n.argChoices.map(o=>JSON.stringify(o)).join(", ")}`),n.defaultValue!==void 0&&s.push(`default: ${n.defaultValueDescription||JSON.stringify(n.defaultValue)}`),s.length>0){let o=`(${s.join(", ")})`;return n.description?`${n.description} ${o}`:o}return n.description}formatHelp(n,s){let o=s.padWidth(n,s),a=s.helpWidth||80,l=2,c=2;function u(w,m){if(m){let g=`${w.padEnd(o+c)}${m}`;return s.wrap(g,a-l,o+c)}return w}function d(w){return w.join(`
`).replace(/^/gm," ".repeat(l))}let h=[`Usage: ${s.commandUsage(n)}`,""],p=s.commandDescription(n);p.length>0&&(h=h.concat([p,""]));let f=s.visibleArguments(n).map(w=>u(s.argumentTerm(w),s.argumentDescription(w)));f.length>0&&(h=h.concat(["Arguments:",d(f),""]));let _=s.visibleOptions(n).map(w=>u(s.optionTerm(w),s.optionDescription(w)));_.length>0&&(h=h.concat(["Options:",d(_),""]));let v=s.visibleCommands(n).map(w=>u(s.subcommandTerm(w),s.subcommandDescription(w)));return v.length>0&&(h=h.concat(["Commands:",d(v),""])),h.join(`
`)}padWidth(n,s){return Math.max(s.longestOptionTermLength(n,s),s.longestSubcommandTermLength(n,s),s.longestArgumentTermLength(n,s))}wrap(n,s,o,a=40){if(n.match(/[\n]\s+/))return n;let l=s-o;if(l<a)return n;let c=n.substr(0,o),u=n.substr(o),d=" ".repeat(o),h=new RegExp(".{1,"+(l-1)+"}([\\s\u200B]|$)|[^\\s\u200B]+?([\\s\u200B]|$)","g"),p=u.match(h)||[];return c+p.map((f,_)=>(f.slice(-1)===`
`&&(f=f.slice(0,f.length-1)),(_>0?d:"")+f.trimRight())).join(`
`)}};r.Help=t}),ny=ee(r=>{var{InvalidArgumentError:e}=tl(),t=class{constructor(o,a){this.flags=o,this.description=a||"",this.required=o.includes("<"),this.optional=o.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(o),this.mandatory=!1;let l=s(o);this.short=l.shortFlag,this.long=l.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0}default(o,a){return this.defaultValue=o,this.defaultValueDescription=a,this}env(o){return this.envVar=o,this}argParser(o){return this.parseArg=o,this}makeOptionMandatory(o=!0){return this.mandatory=!!o,this}hideHelp(o=!0){return this.hidden=!!o,this}_concatValue(o,a){return a===this.defaultValue||!Array.isArray(a)?[o]:a.concat(o)}choices(o){return this.argChoices=o,this.parseArg=(a,l)=>{if(!o.includes(a))throw new e(`Allowed choices are ${o.join(", ")}.`);return this.variadic?this._concatValue(a,l):a},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return n(this.name().replace(/^no-/,""))}is(o){return this.short===o||this.long===o}};function n(o){return o.split("-").reduce((a,l)=>a+l[0].toUpperCase()+l.slice(1))}function s(o){let a,l,c=o.split(/[ |,]+/);return c.length>1&&!/^[[<]/.test(c[1])&&(a=c.shift()),l=c.shift(),!a&&/^-[^-]$/.test(l)&&(a=l,l=void 0),{shortFlag:a,longFlag:l}}r.Option=t,r.splitOptionFlags=s}),pI=ee(r=>{function e(n,s){if(Math.abs(n.length-s.length)>3)return Math.max(n.length,s.length);let o=[];for(let a=0;a<=n.length;a++)o[a]=[a];for(let a=0;a<=s.length;a++)o[0][a]=a;for(let a=1;a<=s.length;a++)for(let l=1;l<=n.length;l++){let c=1;n[l-1]===s[a-1]?c=0:c=1,o[l][a]=Math.min(o[l-1][a]+1,o[l][a-1]+1,o[l-1][a-1]+c),l>1&&a>1&&n[l-1]===s[a-2]&&n[l-2]===s[a-1]&&(o[l][a]=Math.min(o[l][a],o[l-2][a-2]+1))}return o[n.length][s.length]}function t(n,s){if(!s||s.length===0)return"";s=Array.from(new Set(s));let o=n.startsWith("--");o&&(n=n.slice(2),s=s.map(u=>u.slice(2)));let a=[],l=3,c=.4;return s.forEach(u=>{if(u.length<=1)return;let d=e(n,u),h=Math.max(n.length,u.length);(h-d)/h>c&&(d<l?(l=d,a=[u]):d===l&&a.push(u))}),a.sort((u,d)=>u.localeCompare(d)),o&&(a=a.map(u=>`--${u}`)),a.length>1?`
(Did you mean one of ${a.join(", ")}?)`:a.length===1?`
(Did you mean ${a[0]}?)`:""}r.suggestSimilar=t}),fI=ee(r=>{var e=require("events").EventEmitter,t=require("child_process"),n=require("path"),s=require("fs"),{Argument:o,humanReadableArgName:a}=op(),{CommanderError:l}=tl(),{Help:c}=ty(),{Option:u,splitOptionFlags:d}=ny(),{suggestSimilar:h}=pI(),p=class ry extends e{constructor(m){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this._args=[],this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=m||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!1,this._outputConfiguration={writeOut:g=>process.stdout.write(g),writeErr:g=>process.stderr.write(g),getOutHelpWidth:()=>process.stdout.isTTY?process.stdout.columns:void 0,getErrHelpWidth:()=>process.stderr.isTTY?process.stderr.columns:void 0,outputError:(g,x)=>x(g)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(m){return this._outputConfiguration=m._outputConfiguration,this._hasHelpOption=m._hasHelpOption,this._helpFlags=m._helpFlags,this._helpDescription=m._helpDescription,this._helpShortFlag=m._helpShortFlag,this._helpLongFlag=m._helpLongFlag,this._helpCommandName=m._helpCommandName,this._helpCommandnameAndArgs=m._helpCommandnameAndArgs,this._helpCommandDescription=m._helpCommandDescription,this._helpConfiguration=m._helpConfiguration,this._exitCallback=m._exitCallback,this._storeOptionsAsProperties=m._storeOptionsAsProperties,this._combineFlagAndOptionalValue=m._combineFlagAndOptionalValue,this._allowExcessArguments=m._allowExcessArguments,this._enablePositionalOptions=m._enablePositionalOptions,this._showHelpAfterError=m._showHelpAfterError,this._showSuggestionAfterError=m._showSuggestionAfterError,this}command(m,g,x){let b=g,y=x;typeof b=="object"&&b!==null&&(y=b,b=null),y=y||{};let[,S,E]=m.match(/([^ ]+) *(.*)/),C=this.createCommand(S);return b&&(C.description(b),C._executableHandler=!0),y.isDefault&&(this._defaultCommandName=C._name),C._hidden=!!(y.noHelp||y.hidden),C._executableFile=y.executableFile||null,E&&C.arguments(E),this.commands.push(C),C.parent=this,C.copyInheritedSettings(this),b?this:C}createCommand(m){return new ry(m)}createHelp(){return Object.assign(new c,this.configureHelp())}configureHelp(m){return m===void 0?this._helpConfiguration:(this._helpConfiguration=m,this)}configureOutput(m){return m===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,m),this)}showHelpAfterError(m=!0){return typeof m!="string"&&(m=!!m),this._showHelpAfterError=m,this}showSuggestionAfterError(m=!0){return this._showSuggestionAfterError=!!m,this}addCommand(m,g){if(!m._name)throw new Error("Command passed to .addCommand() must have a name");function x(b){b.forEach(y=>{if(y._executableHandler&&!y._executableFile)throw new Error(`Must specify executableFile for deeply nested executable: ${y.name()}`);x(y.commands)})}return x(m.commands),g=g||{},g.isDefault&&(this._defaultCommandName=m._name),(g.noHelp||g.hidden)&&(m._hidden=!0),this.commands.push(m),m.parent=this,this}createArgument(m,g){return new o(m,g)}argument(m,g,x,b){let y=this.createArgument(m,g);return typeof x=="function"?y.default(b).argParser(x):y.default(x),this.addArgument(y),this}arguments(m){return m.split(/ +/).forEach(g=>{this.argument(g)}),this}addArgument(m){let g=this._args.slice(-1)[0];if(g&&g.variadic)throw new Error(`only the last argument can be variadic '${g.name()}'`);if(m.required&&m.defaultValue!==void 0&&m.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${m.name()}'`);return this._args.push(m),this}addHelpCommand(m,g){return m===!1?this._addImplicitHelpCommand=!1:(this._addImplicitHelpCommand=!0,typeof m=="string"&&(this._helpCommandName=m.split(" ")[0],this._helpCommandnameAndArgs=m),this._helpCommandDescription=g||this._helpCommandDescription),this}_hasImplicitHelpCommand(){return this._addImplicitHelpCommand===void 0?this.commands.length&&!this._actionHandler&&!this._findCommand("help"):this._addImplicitHelpCommand}hook(m,g){let x=["preAction","postAction"];if(!x.includes(m))throw new Error(`Unexpected value for event passed to hook : '${m}'.
Expecting one of '${x.join("', '")}'`);return this._lifeCycleHooks[m]?this._lifeCycleHooks[m].push(g):this._lifeCycleHooks[m]=[g],this}exitOverride(m){return m?this._exitCallback=m:this._exitCallback=g=>{if(g.code!=="commander.executeSubCommandAsync")throw g},this}_exit(m,g,x){this._exitCallback&&this._exitCallback(new l(m,g,x)),process.exit(m)}action(m){let g=x=>{let b=this._args.length,y=x.slice(0,b);return this._storeOptionsAsProperties?y[b]=this:y[b]=this.opts(),y.push(this),m.apply(this,y)};return this._actionHandler=g,this}createOption(m,g){return new u(m,g)}addOption(m){let g=m.name(),x=m.attributeName(),b=m.defaultValue;if(m.negate||m.optional||m.required||typeof b=="boolean"){if(m.negate){let S=m.long.replace(/^--no-/,"--");b=this._findOption(S)?this.getOptionValue(x):!0}b!==void 0&&this.setOptionValueWithSource(x,b,"default")}this.options.push(m);let y=(S,E,C)=>{let k=this.getOptionValue(x);if(S!==null&&m.parseArg)try{S=m.parseArg(S,k===void 0?b:k)}catch(F){if(F.code==="commander.invalidArgument"){let O=`${E} ${F.message}`;this._displayError(F.exitCode,F.code,O)}throw F}else S!==null&&m.variadic&&(S=m._concatValue(S,k));typeof k=="boolean"||typeof k>"u"?S==null?this.setOptionValueWithSource(x,m.negate?!1:b||!0,C):this.setOptionValueWithSource(x,S,C):S!==null&&this.setOptionValueWithSource(x,m.negate?!1:S,C)};return this.on("option:"+g,S=>{let E=`error: option '${m.flags}' argument '${S}' is invalid.`;y(S,E,"cli")}),m.envVar&&this.on("optionEnv:"+g,S=>{let E=`error: option '${m.flags}' value '${S}' from env '${m.envVar}' is invalid.`;y(S,E,"env")}),this}_optionEx(m,g,x,b,y){let S=this.createOption(g,x);if(S.makeOptionMandatory(!!m.mandatory),typeof b=="function")S.default(y).argParser(b);else if(b instanceof RegExp){let E=b;b=(C,k)=>{let F=E.exec(C);return F?F[0]:k},S.default(y).argParser(b)}else S.default(b);return this.addOption(S)}option(m,g,x,b){return this._optionEx({},m,g,x,b)}requiredOption(m,g,x,b){return this._optionEx({mandatory:!0},m,g,x,b)}combineFlagAndOptionalValue(m=!0){return this._combineFlagAndOptionalValue=!!m,this}allowUnknownOption(m=!0){return this._allowUnknownOption=!!m,this}allowExcessArguments(m=!0){return this._allowExcessArguments=!!m,this}enablePositionalOptions(m=!0){return this._enablePositionalOptions=!!m,this}passThroughOptions(m=!0){if(this._passThroughOptions=!!m,this.parent&&m&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(m=!0){if(this._storeOptionsAsProperties=!!m,this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this}getOptionValue(m){return this._storeOptionsAsProperties?this[m]:this._optionValues[m]}setOptionValue(m,g){return this._storeOptionsAsProperties?this[m]=g:this._optionValues[m]=g,this}setOptionValueWithSource(m,g,x){return this.setOptionValue(m,g),this._optionValueSources[m]=x,this}getOptionValueSource(m){return this._optionValueSources[m]}_prepareUserArgs(m,g){if(m!==void 0&&!Array.isArray(m))throw new Error("first parameter to parse must be array or undefined");g=g||{},m===void 0&&(m=process.argv,process.versions&&process.versions.electron&&(g.from="electron")),this.rawArgs=m.slice();let x;switch(g.from){case void 0:case"node":this._scriptPath=m[1],x=m.slice(2);break;case"electron":process.defaultApp?(this._scriptPath=m[1],x=m.slice(2)):x=m.slice(1);break;case"user":x=m.slice(0);break;default:throw new Error(`unexpected parse option { from: '${g.from}' }`)}return!this._scriptPath&&require.main&&(this._scriptPath=require.main.filename),this._name=this._name||this._scriptPath&&n.basename(this._scriptPath,n.extname(this._scriptPath)),x}parse(m,g){let x=this._prepareUserArgs(m,g);return this._parseCommand([],x),this}async parseAsync(m,g){let x=this._prepareUserArgs(m,g);return await this._parseCommand([],x),this}_executeSubCommand(m,g){g=g.slice();let x=!1,b=[".js",".ts",".tsx",".mjs",".cjs"];this._checkForMissingMandatoryOptions();let y=this._scriptPath;!y&&require.main&&(y=require.main.filename);let S;try{let O=s.realpathSync(y);S=n.dirname(O)}catch{S="."}let E=n.basename(y,n.extname(y))+"-"+m._name;m._executableFile&&(E=m._executableFile);let C=n.join(S,E);s.existsSync(C)?E=C:b.forEach(O=>{s.existsSync(`${C}${O}`)&&(E=`${C}${O}`)}),x=b.includes(n.extname(E));let k;process.platform!=="win32"?x?(g.unshift(E),g=_(process.execArgv).concat(g),k=t.spawn(process.argv[0],g,{stdio:"inherit"})):k=t.spawn(E,g,{stdio:"inherit"}):(g.unshift(E),g=_(process.execArgv).concat(g),k=t.spawn(process.execPath,g,{stdio:"inherit"})),["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(O=>{process.on(O,()=>{k.killed===!1&&k.exitCode===null&&k.kill(O)})});let F=this._exitCallback;F?k.on("close",()=>{F(new l(process.exitCode||0,"commander.executeSubCommandAsync","(close)"))}):k.on("close",process.exit.bind(process)),k.on("error",O=>{if(O.code==="ENOENT"){let I=`'${E}' does not exist
 - if '${m._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name`;throw new Error(I)}else if(O.code==="EACCES")throw new Error(`'${E}' not executable`);if(!F)process.exit(1);else{let I=new l(1,"commander.executeSubCommandAsync","(error)");I.nestedError=O,F(I)}}),this.runningCommand=k}_dispatchSubcommand(m,g,x){let b=this._findCommand(m);if(b||this.help({error:!0}),b._executableHandler)this._executeSubCommand(b,g.concat(x));else return b._parseCommand(g,x)}_checkNumberOfArguments(){this._args.forEach((m,g)=>{m.required&&this.args[g]==null&&this.missingArgument(m.name())}),!(this._args.length>0&&this._args[this._args.length-1].variadic)&&this.args.length>this._args.length&&this._excessArguments(this.args)}_processArguments(){let m=(x,b,y)=>{let S=b;if(b!==null&&x.parseArg)try{S=x.parseArg(b,y)}catch(E){if(E.code==="commander.invalidArgument"){let C=`error: command-argument value '${b}' is invalid for argument '${x.name()}'. ${E.message}`;this._displayError(E.exitCode,E.code,C)}throw E}return S};this._checkNumberOfArguments();let g=[];this._args.forEach((x,b)=>{let y=x.defaultValue;x.variadic?b<this.args.length?(y=this.args.slice(b),x.parseArg&&(y=y.reduce((S,E)=>m(x,E,S),x.defaultValue))):y===void 0&&(y=[]):b<this.args.length&&(y=this.args[b],x.parseArg&&(y=m(x,y,x.defaultValue))),g[b]=y}),this.processedArgs=g}_chainOrCall(m,g){return m&&m.then&&typeof m.then=="function"?m.then(()=>g()):g()}_chainOrCallHooks(m,g){let x=m,b=[];return v(this).reverse().filter(y=>y._lifeCycleHooks[g]!==void 0).forEach(y=>{y._lifeCycleHooks[g].forEach(S=>{b.push({hookedCommand:y,callback:S})})}),g==="postAction"&&b.reverse(),b.forEach(y=>{x=this._chainOrCall(x,()=>y.callback(y.hookedCommand,this))}),x}_parseCommand(m,g){let x=this.parseOptions(g);if(this._parseOptionsEnv(),m=m.concat(x.operands),g=x.unknown,this.args=m.concat(g),m&&this._findCommand(m[0]))return this._dispatchSubcommand(m[0],m.slice(1),g);if(this._hasImplicitHelpCommand()&&m[0]===this._helpCommandName)return m.length===1&&this.help(),this._dispatchSubcommand(m[1],[],[this._helpLongFlag]);if(this._defaultCommandName)return f(this,g),this._dispatchSubcommand(this._defaultCommandName,m,g);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),f(this,x.unknown),this._checkForMissingMandatoryOptions();let b=()=>{x.unknown.length>0&&this.unknownOption(x.unknown[0])},y=`command:${this.name()}`;if(this._actionHandler){b(),this._processArguments();let S;return S=this._chainOrCallHooks(S,"preAction"),S=this._chainOrCall(S,()=>this._actionHandler(this.processedArgs)),this.parent&&this.parent.emit(y,m,g),S=this._chainOrCallHooks(S,"postAction"),S}if(this.parent&&this.parent.listenerCount(y))b(),this._processArguments(),this.parent.emit(y,m,g);else if(m.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",m,g);this.listenerCount("command:*")?this.emit("command:*",m,g):this.commands.length?this.unknownCommand():(b(),this._processArguments())}else this.commands.length?(b(),this.help({error:!0})):(b(),this._processArguments())}_findCommand(m){if(m)return this.commands.find(g=>g._name===m||g._aliases.includes(m))}_findOption(m){return this.options.find(g=>g.is(m))}_checkForMissingMandatoryOptions(){for(let m=this;m;m=m.parent)m.options.forEach(g=>{g.mandatory&&m.getOptionValue(g.attributeName())===void 0&&m.missingMandatoryOptionValue(g)})}parseOptions(m){let g=[],x=[],b=g,y=m.slice();function S(C){return C.length>1&&C[0]==="-"}let E=null;for(;y.length;){let C=y.shift();if(C==="--"){b===x&&b.push(C),b.push(...y);break}if(E&&!S(C)){this.emit(`option:${E.name()}`,C);continue}if(E=null,S(C)){let k=this._findOption(C);if(k){if(k.required){let F=y.shift();F===void 0&&this.optionMissingArgument(k),this.emit(`option:${k.name()}`,F)}else if(k.optional){let F=null;y.length>0&&!S(y[0])&&(F=y.shift()),this.emit(`option:${k.name()}`,F)}else this.emit(`option:${k.name()}`);E=k.variadic?k:null;continue}}if(C.length>2&&C[0]==="-"&&C[1]!=="-"){let k=this._findOption(`-${C[1]}`);if(k){k.required||k.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${k.name()}`,C.slice(2)):(this.emit(`option:${k.name()}`),y.unshift(`-${C.slice(2)}`));continue}}if(/^--[^=]+=/.test(C)){let k=C.indexOf("="),F=this._findOption(C.slice(0,k));if(F&&(F.required||F.optional)){this.emit(`option:${F.name()}`,C.slice(k+1));continue}}if(S(C)&&(b=x),(this._enablePositionalOptions||this._passThroughOptions)&&g.length===0&&x.length===0){if(this._findCommand(C)){g.push(C),y.length>0&&x.push(...y);break}else if(C===this._helpCommandName&&this._hasImplicitHelpCommand()){g.push(C),y.length>0&&g.push(...y);break}else if(this._defaultCommandName){x.push(C),y.length>0&&x.push(...y);break}}if(this._passThroughOptions){b.push(C),y.length>0&&b.push(...y);break}b.push(C)}return{operands:g,unknown:x}}opts(){if(this._storeOptionsAsProperties){let m={},g=this.options.length;for(let x=0;x<g;x++){let b=this.options[x].attributeName();m[b]=b===this._versionOptionName?this._version:this[b]}return m}return this._optionValues}_displayError(m,g,x){this._outputConfiguration.outputError(`${x}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0})),this._exit(m,g,x)}_parseOptionsEnv(){this.options.forEach(m=>{if(m.envVar&&m.envVar in process.env){let g=m.attributeName();(this.getOptionValue(g)===void 0||["default","config","env"].includes(this.getOptionValueSource(g)))&&(m.required||m.optional?this.emit(`optionEnv:${m.name()}`,process.env[m.envVar]):this.emit(`optionEnv:${m.name()}`))}})}missingArgument(m){let g=`error: missing required argument '${m}'`;this._displayError(1,"commander.missingArgument",g)}optionMissingArgument(m){let g=`error: option '${m.flags}' argument missing`;this._displayError(1,"commander.optionMissingArgument",g)}missingMandatoryOptionValue(m){let g=`error: required option '${m.flags}' not specified`;this._displayError(1,"commander.missingMandatoryOptionValue",g)}unknownOption(m){if(this._allowUnknownOption)return;let g="";if(m.startsWith("--")&&this._showSuggestionAfterError){let b=[],y=this;do{let S=y.createHelp().visibleOptions(y).filter(E=>E.long).map(E=>E.long);b=b.concat(S),y=y.parent}while(y&&!y._enablePositionalOptions);g=h(m,b)}let x=`error: unknown option '${m}'${g}`;this._displayError(1,"commander.unknownOption",x)}_excessArguments(m){if(this._allowExcessArguments)return;let g=this._args.length,x=g===1?"":"s",b=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${g} argument${x} but got ${m.length}.`;this._displayError(1,"commander.excessArguments",b)}unknownCommand(){let m=this.args[0],g="";if(this._showSuggestionAfterError){let b=[];this.createHelp().visibleCommands(this).forEach(y=>{b.push(y.name()),y.alias()&&b.push(y.alias())}),g=h(m,b)}let x=`error: unknown command '${m}'${g}`;this._displayError(1,"commander.unknownCommand",x)}version(m,g,x){if(m===void 0)return this._version;this._version=m,g=g||"-V, --version",x=x||"output the version number";let b=this.createOption(g,x);return this._versionOptionName=b.attributeName(),this.options.push(b),this.on("option:"+b.name(),()=>{this._outputConfiguration.writeOut(`${m}
`),this._exit(0,"commander.version",m)}),this}description(m,g){return m===void 0&&g===void 0?this._description:(this._description=m,g&&(this._argsDescription=g),this)}alias(m){if(m===void 0)return this._aliases[0];let g=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(g=this.commands[this.commands.length-1]),m===g._name)throw new Error("Command alias can't be the same as its name");return g._aliases.push(m),this}aliases(m){return m===void 0?this._aliases:(m.forEach(g=>this.alias(g)),this)}usage(m){if(m===void 0){if(this._usage)return this._usage;let g=this._args.map(x=>a(x));return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this._args.length?g:[]).join(" ")}return this._usage=m,this}name(m){return m===void 0?this._name:(this._name=m,this)}helpInformation(m){let g=this.createHelp();return g.helpWidth===void 0&&(g.helpWidth=m&&m.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),g.formatHelp(this,g)}_getHelpContext(m){m=m||{};let g={error:!!m.error},x;return g.error?x=b=>this._outputConfiguration.writeErr(b):x=b=>this._outputConfiguration.writeOut(b),g.write=m.write||x,g.command=this,g}outputHelp(m){let g;typeof m=="function"&&(g=m,m=void 0);let x=this._getHelpContext(m);v(this).reverse().forEach(y=>y.emit("beforeAllHelp",x)),this.emit("beforeHelp",x);let b=this.helpInformation(x);if(g&&(b=g(b),typeof b!="string"&&!Buffer.isBuffer(b)))throw new Error("outputHelp callback must return a string or a Buffer");x.write(b),this.emit(this._helpLongFlag),this.emit("afterHelp",x),v(this).forEach(y=>y.emit("afterAllHelp",x))}helpOption(m,g){if(typeof m=="boolean")return this._hasHelpOption=m,this;this._helpFlags=m||this._helpFlags,this._helpDescription=g||this._helpDescription;let x=d(this._helpFlags);return this._helpShortFlag=x.shortFlag,this._helpLongFlag=x.longFlag,this}help(m){this.outputHelp(m);let g=process.exitCode||0;g===0&&m&&typeof m!="function"&&m.error&&(g=1),this._exit(g,"commander.help","(outputHelp)")}addHelpText(m,g){let x=["beforeAll","before","after","afterAll"];if(!x.includes(m))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${x.join("', '")}'`);let b=`${m}Help`;return this.on(b,y=>{let S;typeof g=="function"?S=g({error:y.error,command:y.command}):S=g,S&&y.write(`${S}
`)}),this}};function f(w,m){w._hasHelpOption&&m.find(g=>g===w._helpLongFlag||g===w._helpShortFlag)&&(w.outputHelp(),w._exit(0,"commander.helpDisplayed","(outputHelp)"))}function _(w){return w.map(m=>{if(!m.startsWith("--inspect"))return m;let g,x="127.0.0.1",b="9229",y;return(y=m.match(/^(--inspect(-brk)?)$/))!==null?g=y[1]:(y=m.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(g=y[1],/^\d+$/.test(y[3])?b=y[3]:x=y[3]):(y=m.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(g=y[1],x=y[3],b=y[4]),g&&b!=="0"?`${g}=${x}:${parseInt(b)+1}`:m})}function v(w){let m=[];for(let g=w;g;g=g.parent)m.push(g);return m}r.Command=p}),mI=ee((r,e)=>{var{Argument:t}=op(),{Command:n}=fI(),{CommanderError:s,InvalidArgumentError:o}=tl(),{Help:a}=ty(),{Option:l}=ny();r=e.exports=new n,r.program=r,r.Argument=t,r.Command=n,r.CommanderError=s,r.Help=a,r.InvalidArgumentError=o,r.InvalidOptionArgumentError=o,r.Option=l}),gI=ee((r,e)=>{r=e.exports=t;function t(n,s){if(this.stream=s.stream||process.stderr,typeof s=="number"){var o=s;s={},s.total=o}else{if(s=s||{},typeof n!="string")throw new Error("format required");if(typeof s.total!="number")throw new Error("total required")}this.fmt=n,this.curr=s.curr||0,this.total=s.total,this.width=s.width||this.total,this.clear=s.clear,this.chars={complete:s.complete||"=",incomplete:s.incomplete||"-",head:s.head||s.complete||"="},this.renderThrottle=s.renderThrottle!==0?s.renderThrottle||16:0,this.lastRender=-1/0,this.callback=s.callback||function(){},this.tokens={},this.lastDraw=""}t.prototype.tick=function(n,s){if(n!==0&&(n=n||1),typeof n=="object"&&(s=n,n=1),s&&(this.tokens=s),this.curr==0&&(this.start=new Date),this.curr+=n,this.render(),this.curr>=this.total){this.render(void 0,!0),this.complete=!0,this.terminate(),this.callback(this);return}},t.prototype.render=function(n,s){if(s=s!==void 0?s:!1,n&&(this.tokens=n),!!this.stream.isTTY){var o=Date.now(),a=o-this.lastRender;if(!(!s&&a<this.renderThrottle)){this.lastRender=o;var l=this.curr/this.total;l=Math.min(Math.max(l,0),1);var c=Math.floor(l*100),u,d,h,p=new Date-this.start,f=c==100?0:p*(this.total/this.curr-1),_=this.curr/(p/1e3),v=this.fmt.replace(":current",this.curr).replace(":total",this.total).replace(":elapsed",isNaN(p)?"0.0":(p/1e3).toFixed(1)).replace(":eta",isNaN(f)||!isFinite(f)?"0.0":(f/1e3).toFixed(1)).replace(":percent",c.toFixed(0)+"%").replace(":rate",Math.round(_)),w=Math.max(0,this.stream.columns-v.replace(":bar","").length);w&&process.platform==="win32"&&(w=w-1);var m=Math.min(this.width,w);if(h=Math.round(m*l),d=Array(Math.max(0,h+1)).join(this.chars.complete),u=Array(Math.max(0,m-h+1)).join(this.chars.incomplete),h>0&&(d=d.slice(0,-1)+this.chars.head),v=v.replace(":bar",d+u),this.tokens)for(var g in this.tokens)v=v.replace(":"+g,this.tokens[g]);this.lastDraw!==v&&(this.stream.cursorTo(0),this.stream.write(v),this.stream.clearLine(1),this.lastDraw=v)}}},t.prototype.update=function(n,s){var o=Math.floor(n*this.total),a=o-this.curr;this.tick(a,s)},t.prototype.interrupt=function(n){this.stream.clearLine(),this.stream.cursorTo(0),this.stream.write(n),this.stream.write(`
`),this.stream.write(this.lastDraw)},t.prototype.terminate=function(){this.clear?this.stream.clearLine&&(this.stream.clearLine(),this.stream.cursorTo(0)):this.stream.write(`
`)}}),_I=ee((r,e)=>{e.exports=gI()}),wI=ee(r=>{var e=r,{Buffer:t}=require("buffer"),n=require("os");e.toBuffer=function(l,c,u){u=~~u;let d;if(this.isV4Format(l))d=c||t.alloc(u+4),l.split(/\./g).map(h=>{d[u++]=parseInt(h,10)&255});else if(this.isV6Format(l)){let h=l.split(":",8),p;for(p=0;p<h.length;p++){let f=this.isV4Format(h[p]),_;f&&(_=this.toBuffer(h[p]),h[p]=_.slice(0,2).toString("hex")),_&&++p<8&&h.splice(p,0,_.slice(2,4).toString("hex"))}if(h[0]==="")for(;h.length<8;)h.unshift("0");else if(h[h.length-1]==="")for(;h.length<8;)h.push("0");else if(h.length<8){for(p=0;p<h.length&&h[p]!=="";p++);let f=[p,1];for(p=9-h.length;p>0;p--)f.push("0");h.splice(...f)}for(d=c||t.alloc(u+16),p=0;p<h.length;p++){let f=parseInt(h[p],16);d[u++]=f>>8&255,d[u++]=f&255}}if(!d)throw Error(`Invalid ip address: ${l}`);return d},e.toString=function(l,c,u){c=~~c,u=u||l.length-c;let d=[];if(u===4){for(let h=0;h<u;h++)d.push(l[c+h]);d=d.join(".")}else if(u===16){for(let h=0;h<u;h+=2)d.push(l.readUInt16BE(c+h).toString(16));d=d.join(":"),d=d.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),d=d.replace(/:{3,4}/,"::")}return d};var s=/^(\d{1,3}\.){3,3}\d{1,3}$/,o=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;e.isV4Format=function(l){return s.test(l)},e.isV6Format=function(l){return o.test(l)};function a(l){return l===4?"ipv4":l===6?"ipv6":l?l.toLowerCase():"ipv4"}e.fromPrefixLen=function(l,c){l>32?c="ipv6":c=a(c);let u=4;c==="ipv6"&&(u=16);let d=t.alloc(u);for(let h=0,p=d.length;h<p;++h){let f=8;l<8&&(f=l),l-=f,d[h]=~(255>>f)&255}return e.toString(d)},e.mask=function(l,c){l=e.toBuffer(l),c=e.toBuffer(c);let u=t.alloc(Math.max(l.length,c.length)),d;if(l.length===c.length)for(d=0;d<l.length;d++)u[d]=l[d]&c[d];else if(c.length===4)for(d=0;d<c.length;d++)u[d]=l[l.length-4+d]&c[d];else{for(d=0;d<u.length-6;d++)u[d]=0;for(u[10]=255,u[11]=255,d=0;d<l.length;d++)u[d+12]=l[d]&c[d+12];d+=12}for(;d<u.length;d++)u[d]=0;return e.toString(u)},e.cidr=function(l){let c=l.split("/"),u=c[0];if(c.length!==2)throw new Error(`invalid CIDR subnet: ${u}`);let d=e.fromPrefixLen(parseInt(c[1],10));return e.mask(u,d)},e.subnet=function(l,c){let u=e.toLong(e.mask(l,c)),d=e.toBuffer(c),h=0;for(let f=0;f<d.length;f++)if(d[f]===255)h+=8;else{let _=d[f]&255;for(;_;)_=_<<1&255,h++}let p=2**(32-h);return{networkAddress:e.fromLong(u),firstAddress:p<=2?e.fromLong(u):e.fromLong(u+1),lastAddress:p<=2?e.fromLong(u+p-1):e.fromLong(u+p-2),broadcastAddress:e.fromLong(u+p-1),subnetMask:c,subnetMaskLength:h,numHosts:p<=2?p:p-2,length:p,contains(f){return u===e.toLong(e.mask(f,c))}}},e.cidrSubnet=function(l){let c=l.split("/"),u=c[0];if(c.length!==2)throw new Error(`invalid CIDR subnet: ${u}`);let d=e.fromPrefixLen(parseInt(c[1],10));return e.subnet(u,d)},e.not=function(l){let c=e.toBuffer(l);for(let u=0;u<c.length;u++)c[u]=255^c[u];return e.toString(c)},e.or=function(l,c){if(l=e.toBuffer(l),c=e.toBuffer(c),l.length===c.length){for(let p=0;p<l.length;++p)l[p]|=c[p];return e.toString(l)}let u=l,d=c;c.length>l.length&&(u=c,d=l);let h=u.length-d.length;for(let p=h;p<u.length;++p)u[p]|=d[p-h];return e.toString(u)},e.isEqual=function(l,c){if(l=e.toBuffer(l),c=e.toBuffer(c),l.length===c.length){for(let d=0;d<l.length;d++)if(l[d]!==c[d])return!1;return!0}if(c.length===4){let d=c;c=l,l=d}for(let d=0;d<10;d++)if(c[d]!==0)return!1;let u=c.readUInt16BE(10);if(u!==0&&u!==65535)return!1;for(let d=0;d<4;d++)if(l[d]!==c[d+12])return!1;return!0},e.isPrivate=function(l){if(e.isLoopback(l))return!0;if(!e.isV6Format(l)){let c=e.normalizeToLong(l);if(c<0)throw new Error("invalid ipv4 address");l=e.fromLong(c)}return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(l)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(l)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(l)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(l)||/^f[cd][0-9a-f]{2}:/i.test(l)||/^fe80:/i.test(l)||/^::1$/.test(l)||/^::$/.test(l)},e.isPublic=function(l){return!e.isPrivate(l)},e.isLoopback=function(l){return!/\./.test(l)&&!/:/.test(l)&&(l=e.fromLong(Number(l))),/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(l)||/^0177\./.test(l)||/^0x7f\./i.test(l)||/^fe80::1$/i.test(l)||/^::1$/.test(l)||/^::$/.test(l)},e.loopback=function(l){if(l=a(l),l!=="ipv4"&&l!=="ipv6")throw new Error("family must be ipv4 or ipv6");return l==="ipv4"?"127.0.0.1":"fe80::1"},e.address=function(l,c){let u=n.networkInterfaces();if(c=a(c),l&&l!=="private"&&l!=="public"){let h=u[l].filter(p=>a(p.family)===c);return h.length===0?void 0:h[0].address}let d=Object.keys(u).map(h=>{let p=u[h].filter(f=>(f.family=a(f.family),f.family!==c||e.isLoopback(f.address)?!1:l?l==="public"?e.isPrivate(f.address):e.isPublic(f.address):!0));return p.length?p[0].address:void 0}).filter(Boolean);return d.length?d[0]:e.loopback(c)},e.toLong=function(l){let c=0;return l.split(".").forEach(u=>{c<<=8,c+=parseInt(u)}),c>>>0},e.fromLong=function(l){return`${l>>>24}.${l>>16&255}.${l>>8&255}.${l&255}`},e.normalizeToLong=function(l){let c=l.split(".").map(d=>d.startsWith("0x")||d.startsWith("0X")?parseInt(d,16):d.startsWith("0")&&d!=="0"&&/^[0-7]+$/.test(d)?parseInt(d,8):/^[1-9]\d*$/.test(d)||d==="0"?parseInt(d,10):NaN);if(c.some(isNaN))return-1;let u=0;switch(c.length){case 1:u=c[0];break;case 2:if(c[0]>255||c[1]>16777215)return-1;u=c[0]<<24|c[1]&16777215;break;case 3:if(c[0]>255||c[1]>255||c[2]>65535)return-1;u=c[0]<<24|c[1]<<16|c[2]&65535;break;case 4:if(c.some(d=>d>255))return-1;u=c[0]<<24|c[1]<<16|c[2]<<8|c[3];break;default:return-1}return u>>>0}}),vI=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=require("buffer"),t={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};r.ERRORS=t;function n(h){if(!e.Buffer.isEncoding(h))throw new Error(t.INVALID_ENCODING)}r.checkEncoding=n;function s(h){return typeof h=="number"&&isFinite(h)&&u(h)}r.isFiniteInteger=s;function o(h,p){if(typeof h=="number"){if(!s(h)||h<0)throw new Error(p?t.INVALID_OFFSET:t.INVALID_LENGTH)}else throw new Error(p?t.INVALID_OFFSET_NON_NUMBER:t.INVALID_LENGTH_NON_NUMBER)}function a(h){o(h,!1)}r.checkLengthValue=a;function l(h){o(h,!0)}r.checkOffsetValue=l;function c(h,p){if(h<0||h>p.length)throw new Error(t.INVALID_TARGET_OFFSET)}r.checkTargetOffset=c;function u(h){return typeof h=="number"&&isFinite(h)&&Math.floor(h)===h}function d(h){if(typeof BigInt>"u")throw new Error("Platform does not support JS BigInt type.");if(typeof e.Buffer.prototype[h]>"u")throw new Error(`Platform does not support Buffer.prototype.${h}.`)}r.bigIntAndBufferInt64Check=d}),bI=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=vI(),t=4096,n="utf8",s=class iy{constructor(a){if(this.length=0,this._encoding=n,this._writeOffset=0,this._readOffset=0,iy.isSmartBufferOptions(a))if(a.encoding&&(e.checkEncoding(a.encoding),this._encoding=a.encoding),a.size)if(e.isFiniteInteger(a.size)&&a.size>0)this._buff=Buffer.allocUnsafe(a.size);else throw new Error(e.ERRORS.INVALID_SMARTBUFFER_SIZE);else if(a.buff)if(Buffer.isBuffer(a.buff))this._buff=a.buff,this.length=a.buff.length;else throw new Error(e.ERRORS.INVALID_SMARTBUFFER_BUFFER);else this._buff=Buffer.allocUnsafe(t);else{if(typeof a<"u")throw new Error(e.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(t)}}static fromSize(a,l){return new this({size:a,encoding:l})}static fromBuffer(a,l){return new this({buff:a,encoding:l})}static fromOptions(a){return new this(a)}static isSmartBufferOptions(a){let l=a;return l&&(l.encoding!==void 0||l.size!==void 0||l.buff!==void 0)}readInt8(a){return this._readNumberValue(Buffer.prototype.readInt8,1,a)}readInt16BE(a){return this._readNumberValue(Buffer.prototype.readInt16BE,2,a)}readInt16LE(a){return this._readNumberValue(Buffer.prototype.readInt16LE,2,a)}readInt32BE(a){return this._readNumberValue(Buffer.prototype.readInt32BE,4,a)}readInt32LE(a){return this._readNumberValue(Buffer.prototype.readInt32LE,4,a)}readBigInt64BE(a){return e.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,a)}readBigInt64LE(a){return e.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,a)}writeInt8(a,l){return this._writeNumberValue(Buffer.prototype.writeInt8,1,a,l),this}insertInt8(a,l){return this._insertNumberValue(Buffer.prototype.writeInt8,1,a,l)}writeInt16BE(a,l){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,a,l)}insertInt16BE(a,l){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,a,l)}writeInt16LE(a,l){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,a,l)}insertInt16LE(a,l){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,a,l)}writeInt32BE(a,l){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,a,l)}insertInt32BE(a,l){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,a,l)}writeInt32LE(a,l){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,a,l)}insertInt32LE(a,l){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,a,l)}writeBigInt64BE(a,l){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,a,l)}insertBigInt64BE(a,l){return e.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,a,l)}writeBigInt64LE(a,l){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,a,l)}insertBigInt64LE(a,l){return e.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,a,l)}readUInt8(a){return this._readNumberValue(Buffer.prototype.readUInt8,1,a)}readUInt16BE(a){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,a)}readUInt16LE(a){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,a)}readUInt32BE(a){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,a)}readUInt32LE(a){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,a)}readBigUInt64BE(a){return e.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,a)}readBigUInt64LE(a){return e.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,a)}writeUInt8(a,l){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,a,l)}insertUInt8(a,l){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,a,l)}writeUInt16BE(a,l){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,a,l)}insertUInt16BE(a,l){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,a,l)}writeUInt16LE(a,l){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,a,l)}insertUInt16LE(a,l){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,a,l)}writeUInt32BE(a,l){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,a,l)}insertUInt32BE(a,l){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,a,l)}writeUInt32LE(a,l){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,a,l)}insertUInt32LE(a,l){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,a,l)}writeBigUInt64BE(a,l){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,a,l)}insertBigUInt64BE(a,l){return e.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,a,l)}writeBigUInt64LE(a,l){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,a,l)}insertBigUInt64LE(a,l){return e.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,a,l)}readFloatBE(a){return this._readNumberValue(Buffer.prototype.readFloatBE,4,a)}readFloatLE(a){return this._readNumberValue(Buffer.prototype.readFloatLE,4,a)}writeFloatBE(a,l){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,a,l)}insertFloatBE(a,l){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,a,l)}writeFloatLE(a,l){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,a,l)}insertFloatLE(a,l){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,a,l)}readDoubleBE(a){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,a)}readDoubleLE(a){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,a)}writeDoubleBE(a,l){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,a,l)}insertDoubleBE(a,l){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,a,l)}writeDoubleLE(a,l){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,a,l)}insertDoubleLE(a,l){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,a,l)}readString(a,l){let c;typeof a=="number"?(e.checkLengthValue(a),c=Math.min(a,this.length-this._readOffset)):(l=a,c=this.length-this._readOffset),typeof l<"u"&&e.checkEncoding(l);let u=this._buff.slice(this._readOffset,this._readOffset+c).toString(l||this._encoding);return this._readOffset+=c,u}insertString(a,l,c){return e.checkOffsetValue(l),this._handleString(a,!0,l,c)}writeString(a,l,c){return this._handleString(a,!1,l,c)}readStringNT(a){typeof a<"u"&&e.checkEncoding(a);let l=this.length;for(let u=this._readOffset;u<this.length;u++)if(this._buff[u]===0){l=u;break}let c=this._buff.slice(this._readOffset,l);return this._readOffset=l+1,c.toString(a||this._encoding)}insertStringNT(a,l,c){return e.checkOffsetValue(l),this.insertString(a,l,c),this.insertUInt8(0,l+a.length),this}writeStringNT(a,l,c){return this.writeString(a,l,c),this.writeUInt8(0,typeof l=="number"?l+a.length:this.writeOffset),this}readBuffer(a){typeof a<"u"&&e.checkLengthValue(a);let l=typeof a=="number"?a:this.length,c=Math.min(this.length,this._readOffset+l),u=this._buff.slice(this._readOffset,c);return this._readOffset=c,u}insertBuffer(a,l){return e.checkOffsetValue(l),this._handleBuffer(a,!0,l)}writeBuffer(a,l){return this._handleBuffer(a,!1,l)}readBufferNT(){let a=this.length;for(let c=this._readOffset;c<this.length;c++)if(this._buff[c]===0){a=c;break}let l=this._buff.slice(this._readOffset,a);return this._readOffset=a+1,l}insertBufferNT(a,l){return e.checkOffsetValue(l),this.insertBuffer(a,l),this.insertUInt8(0,l+a.length),this}writeBufferNT(a,l){return typeof l<"u"&&e.checkOffsetValue(l),this.writeBuffer(a,l),this.writeUInt8(0,typeof l=="number"?l+a.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(a){e.checkOffsetValue(a),e.checkTargetOffset(a,this),this._readOffset=a}get writeOffset(){return this._writeOffset}set writeOffset(a){e.checkOffsetValue(a),e.checkTargetOffset(a,this),this._writeOffset=a}get encoding(){return this._encoding}set encoding(a){e.checkEncoding(a),this._encoding=a}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(a){let l=typeof a=="string"?a:this._encoding;return e.checkEncoding(l),this._buff.toString(l,0,this.length)}destroy(){return this.clear(),this}_handleString(a,l,c,u){let d=this._writeOffset,h=this._encoding;typeof c=="number"?d=c:typeof c=="string"&&(e.checkEncoding(c),h=c),typeof u=="string"&&(e.checkEncoding(u),h=u);let p=Buffer.byteLength(a,h);return l?this.ensureInsertable(p,d):this._ensureWriteable(p,d),this._buff.write(a,d,p,h),l?this._writeOffset+=p:typeof c=="number"?this._writeOffset=Math.max(this._writeOffset,d+p):this._writeOffset+=p,this}_handleBuffer(a,l,c){let u=typeof c=="number"?c:this._writeOffset;return l?this.ensureInsertable(a.length,u):this._ensureWriteable(a.length,u),a.copy(this._buff,u),l?this._writeOffset+=a.length:typeof c=="number"?this._writeOffset=Math.max(this._writeOffset,u+a.length):this._writeOffset+=a.length,this}ensureReadable(a,l){let c=this._readOffset;if(typeof l<"u"&&(e.checkOffsetValue(l),c=l),c<0||c+a>this.length)throw new Error(e.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(a,l){e.checkOffsetValue(l),this._ensureCapacity(this.length+a),l<this.length&&this._buff.copy(this._buff,l+a,l,this._buff.length),l+a>this.length?this.length=l+a:this.length+=a}_ensureWriteable(a,l){let c=typeof l=="number"?l:this._writeOffset;this._ensureCapacity(c+a),c+a>this.length&&(this.length=c+a)}_ensureCapacity(a){let l=this._buff.length;if(a>l){let c=this._buff,u=l*3/2+1;u<a&&(u=a),this._buff=Buffer.allocUnsafe(u),c.copy(this._buff,0,0,l)}}_readNumberValue(a,l,c){this.ensureReadable(l,c);let u=a.call(this._buff,typeof c=="number"?c:this._readOffset);return typeof c>"u"&&(this._readOffset+=l),u}_insertNumberValue(a,l,c,u){return e.checkOffsetValue(u),this.ensureInsertable(l,u),a.call(this._buff,c,u),this._writeOffset+=l,this}_writeNumberValue(a,l,c,u){if(typeof u=="number"){if(u<0)throw new Error(e.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);e.checkOffsetValue(u)}let d=typeof u=="number"?u:this._writeOffset;return this._ensureWriteable(l,d),a.call(this._buff,c,d),typeof u=="number"?this._writeOffset=Math.max(this._writeOffset,d+l):this._writeOffset+=l,this}};r.SmartBuffer=s}),sy=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SOCKS5_NO_ACCEPTABLE_AUTH=r.SOCKS5_CUSTOM_AUTH_END=r.SOCKS5_CUSTOM_AUTH_START=r.SOCKS_INCOMING_PACKET_SIZES=r.SocksClientState=r.Socks5Response=r.Socks5HostType=r.Socks5Auth=r.Socks4Response=r.SocksCommand=r.ERRORS=r.DEFAULT_TIMEOUT=void 0;var e=3e4;r.DEFAULT_TIMEOUT=e;var t={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};r.ERRORS=t;var n={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:f=>f+7,Socks4Response:8};r.SOCKS_INCOMING_PACKET_SIZES=n;var s;(function(f){f[f.connect=1]="connect",f[f.bind=2]="bind",f[f.associate=3]="associate"})(s||(s={})),r.SocksCommand=s;var o;(function(f){f[f.Granted=90]="Granted",f[f.Failed=91]="Failed",f[f.Rejected=92]="Rejected",f[f.RejectedIdent=93]="RejectedIdent"})(o||(o={})),r.Socks4Response=o;var a;(function(f){f[f.NoAuth=0]="NoAuth",f[f.GSSApi=1]="GSSApi",f[f.UserPass=2]="UserPass"})(a||(a={})),r.Socks5Auth=a;var l=128;r.SOCKS5_CUSTOM_AUTH_START=l;var c=254;r.SOCKS5_CUSTOM_AUTH_END=c;var u=255;r.SOCKS5_NO_ACCEPTABLE_AUTH=u;var d;(function(f){f[f.Granted=0]="Granted",f[f.Failure=1]="Failure",f[f.NotAllowed=2]="NotAllowed",f[f.NetworkUnreachable=3]="NetworkUnreachable",f[f.HostUnreachable=4]="HostUnreachable",f[f.ConnectionRefused=5]="ConnectionRefused",f[f.TTLExpired=6]="TTLExpired",f[f.CommandNotSupported=7]="CommandNotSupported",f[f.AddressNotSupported=8]="AddressNotSupported"})(d||(d={})),r.Socks5Response=d;var h;(function(f){f[f.IPv4=1]="IPv4",f[f.Hostname=3]="Hostname",f[f.IPv6=4]="IPv6"})(h||(h={})),r.Socks5HostType=h;var p;(function(f){f[f.Created=0]="Created",f[f.Connecting=1]="Connecting",f[f.Connected=2]="Connected",f[f.SentInitialHandshake=3]="SentInitialHandshake",f[f.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",f[f.SentAuthentication=5]="SentAuthentication",f[f.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",f[f.SentFinalHandshake=7]="SentFinalHandshake",f[f.ReceivedFinalResponse=8]="ReceivedFinalResponse",f[f.BoundWaitingForConnection=9]="BoundWaitingForConnection",f[f.Established=10]="Established",f[f.Disconnected=11]="Disconnected",f[f.Error=99]="Error"})(p||(p={})),r.SocksClientState=p}),oy=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shuffleArray=r.SocksClientError=void 0;var e=class extends Error{constructor(n,s){super(n),this.options=s}};r.SocksClientError=e;function t(n){for(let s=n.length-1;s>0;s--){let o=Math.floor(Math.random()*(s+1));[n[s],n[o]]=[n[o],n[s]]}}r.shuffleArray=t}),yI=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validateSocksClientChainOptions=r.validateSocksClientOptions=void 0;var e=oy(),t=sy(),n=require("stream");function s(d,h=["connect","bind","associate"]){if(!t.SocksCommand[d.command])throw new e.SocksClientError(t.ERRORS.InvalidSocksCommand,d);if(h.indexOf(d.command)===-1)throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandForOperation,d);if(!l(d.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,d);if(!c(d.proxy))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,d);if(a(d.proxy,d),d.timeout&&!u(d.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,d);if(d.existing_socket&&!(d.existing_socket instanceof n.Duplex))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsExistingSocket,d)}r.validateSocksClientOptions=s;function o(d){if(d.command!=="connect")throw new e.SocksClientError(t.ERRORS.InvalidSocksCommandChain,d);if(!l(d.destination))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsDestination,d);if(!(d.proxies&&Array.isArray(d.proxies)&&d.proxies.length>=2))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxiesLength,d);if(d.proxies.forEach(h=>{if(!c(h))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsProxy,d);a(h,d)}),d.timeout&&!u(d.timeout))throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsTimeout,d)}r.validateSocksClientChainOptions=o;function a(d,h){if(d.custom_auth_method!==void 0){if(d.custom_auth_method<t.SOCKS5_CUSTOM_AUTH_START||d.custom_auth_method>t.SOCKS5_CUSTOM_AUTH_END)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthRange,h);if(d.custom_auth_request_handler===void 0||typeof d.custom_auth_request_handler!="function")throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,h);if(d.custom_auth_response_size===void 0)throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,h);if(d.custom_auth_response_handler===void 0||typeof d.custom_auth_response_handler!="function")throw new e.SocksClientError(t.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,h)}}function l(d){return d&&typeof d.host=="string"&&typeof d.port=="number"&&d.port>=0&&d.port<=65535}function c(d){return d&&(typeof d.host=="string"||typeof d.ipaddress=="string")&&typeof d.port=="number"&&d.port>=0&&d.port<=65535&&(d.type===4||d.type===5)}function u(d){return typeof d=="number"&&d>0}}),xI=ee(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ReceiveBuffer=void 0;var e=class{constructor(t=4096){this.buffer=Buffer.allocUnsafe(t),this.offset=0,this.originalSize=t}get length(){return this.offset}append(t){if(!Buffer.isBuffer(t))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+t.length>=this.buffer.length){let n=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+t.length)),n.copy(this.buffer)}return t.copy(this.buffer,this.offset),this.offset+=t.length}peek(t){if(t>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,t)}get(t){if(t>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");let n=Buffer.allocUnsafe(t);return this.buffer.slice(0,t).copy(n),this.buffer.copyWithin(0,t,t+this.offset-t),this.offset-=t,n}};r.ReceiveBuffer=e}),SI=ee(r=>{"use strict";var e=r&&r.__awaiter||function(h,p,f,_){function v(w){return w instanceof f?w:new f(function(m){m(w)})}return new(f||(f=Promise))(function(w,m){function g(y){try{b(_.next(y))}catch(S){m(S)}}function x(y){try{b(_.throw(y))}catch(S){m(S)}}function b(y){y.done?w(y.value):v(y.value).then(g,x)}b((_=_.apply(h,p||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.SocksClientError=r.SocksClient=void 0;var t=require("events"),n=require("net"),s=wI(),o=bI(),a=sy(),l=yI(),c=xI(),u=oy();Object.defineProperty(r,"SocksClientError",{enumerable:!0,get:function(){return u.SocksClientError}});var d=class sp extends t.EventEmitter{constructor(p){super(),this.options=Object.assign({},p),(0,l.validateSocksClientOptions)(p),this.setState(a.SocksClientState.Created)}static createConnection(p,f){return new Promise((_,v)=>{try{(0,l.validateSocksClientOptions)(p,["connect"])}catch(m){return typeof f=="function"?(f(m),_(m)):v(m)}let w=new sp(p);w.connect(p.existing_socket),w.once("established",m=>{w.removeAllListeners(),typeof f=="function"&&f(null,m),_(m)}),w.once("error",m=>{w.removeAllListeners(),typeof f=="function"?(f(m),_(m)):v(m)})})}static createConnectionChain(p,f){return new Promise((_,v)=>e(this,void 0,void 0,function*(){try{(0,l.validateSocksClientChainOptions)(p)}catch(m){return typeof f=="function"?(f(m),_(m)):v(m)}let w;p.randomizeChain&&(0,u.shuffleArray)(p.proxies);try{for(let m=0;m<p.proxies.length;m++){let g=p.proxies[m],x=m===p.proxies.length-1?p.destination:{host:p.proxies[m+1].host||p.proxies[m+1].ipaddress,port:p.proxies[m+1].port},b=yield sp.createConnection({command:"connect",proxy:g,destination:x});w||(w=b.socket)}typeof f=="function"?(f(null,{socket:w}),_({socket:w})):_({socket:w})}catch(m){typeof f=="function"?(f(m),_(m)):v(m)}}))}static createUDPFrame(p){let f=new o.SmartBuffer;return f.writeUInt16BE(0),f.writeUInt8(p.frameNumber||0),n.isIPv4(p.remoteHost.host)?(f.writeUInt8(a.Socks5HostType.IPv4),f.writeUInt32BE(s.toLong(p.remoteHost.host))):n.isIPv6(p.remoteHost.host)?(f.writeUInt8(a.Socks5HostType.IPv6),f.writeBuffer(s.toBuffer(p.remoteHost.host))):(f.writeUInt8(a.Socks5HostType.Hostname),f.writeUInt8(Buffer.byteLength(p.remoteHost.host)),f.writeString(p.remoteHost.host)),f.writeUInt16BE(p.remoteHost.port),f.writeBuffer(p.data),f.toBuffer()}static parseUDPFrame(p){let f=o.SmartBuffer.fromBuffer(p);f.readOffset=2;let _=f.readUInt8(),v=f.readUInt8(),w;v===a.Socks5HostType.IPv4?w=s.fromLong(f.readUInt32BE()):v===a.Socks5HostType.IPv6?w=s.toString(f.readBuffer(16)):w=f.readString(f.readUInt8());let m=f.readUInt16BE();return{frameNumber:_,remoteHost:{host:w,port:m},data:f.readBuffer()}}setState(p){this.state!==a.SocksClientState.Error&&(this.state=p)}connect(p){this.onDataReceived=_=>this.onDataReceivedHandler(_),this.onClose=()=>this.onCloseHandler(),this.onError=_=>this.onErrorHandler(_),this.onConnect=()=>this.onConnectHandler();let f=setTimeout(()=>this.onEstablishedTimeout(),this.options.timeout||a.DEFAULT_TIMEOUT);f.unref&&typeof f.unref=="function"&&f.unref(),p?this.socket=p:this.socket=new n.Socket,this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(a.SocksClientState.Connecting),this.receiveBuffer=new c.ReceiveBuffer,p?this.socket.emit("connect"):(this.socket.connect(this.getSocketOptions()),this.options.set_tcp_nodelay!==void 0&&this.options.set_tcp_nodelay!==null&&this.socket.setNoDelay(!!this.options.set_tcp_nodelay)),this.prependOnceListener("established",_=>{setImmediate(()=>{if(this.receiveBuffer.length>0){let v=this.receiveBuffer.get(this.receiveBuffer.length);_.socket.emit("data",v)}_.socket.resume()})})}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){this.state!==a.SocksClientState.Established&&this.state!==a.SocksClientState.BoundWaitingForConnection&&this.closeSocket(a.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){this.setState(a.SocksClientState.Connected),this.options.proxy.type===4?this.sendSocks4InitialHandshake():this.sendSocks5InitialHandshake(),this.setState(a.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(p){this.receiveBuffer.append(p),this.processData()}processData(){for(;this.state!==a.SocksClientState.Established&&this.state!==a.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize;)if(this.state===a.SocksClientState.SentInitialHandshake)this.options.proxy.type===4?this.handleSocks4FinalHandshakeResponse():this.handleInitialSocks5HandshakeResponse();else if(this.state===a.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===a.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else if(this.state===a.SocksClientState.BoundWaitingForConnection)this.options.proxy.type===4?this.handleSocks4IncomingConnectionResponse():this.handleSocks5IncomingConnectionResponse();else{this.closeSocket(a.ERRORS.InternalError);break}}onCloseHandler(){this.closeSocket(a.ERRORS.SocketClosed)}onErrorHandler(p){this.closeSocket(p.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(p){this.state!==a.SocksClientState.Error&&(this.setState(a.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new u.SocksClientError(p,this.options)))}sendSocks4InitialHandshake(){let p=this.options.proxy.userId||"",f=new o.SmartBuffer;f.writeUInt8(4),f.writeUInt8(a.SocksCommand[this.options.command]),f.writeUInt16BE(this.options.destination.port),n.isIPv4(this.options.destination.host)?(f.writeBuffer(s.toBuffer(this.options.destination.host)),f.writeStringNT(p)):(f.writeUInt8(0),f.writeUInt8(0),f.writeUInt8(0),f.writeUInt8(1),f.writeStringNT(p),f.writeStringNT(this.options.destination.host)),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(f.toBuffer())}handleSocks4FinalHandshakeResponse(){let p=this.receiveBuffer.get(8);if(p[1]!==a.Socks4Response.Granted)this.closeSocket(`${a.ERRORS.Socks4ProxyRejectedConnection} - (${a.Socks4Response[p[1]]})`);else if(a.SocksCommand[this.options.command]===a.SocksCommand.bind){let f=o.SmartBuffer.fromBuffer(p);f.readOffset=2;let _={port:f.readUInt16BE(),host:s.fromLong(f.readUInt32BE())};_.host==="0.0.0.0"&&(_.host=this.options.proxy.ipaddress),this.setState(a.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:_,socket:this.socket})}else this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){let p=this.receiveBuffer.get(8);if(p[1]!==a.Socks4Response.Granted)this.closeSocket(`${a.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${a.Socks4Response[p[1]]})`);else{let f=o.SmartBuffer.fromBuffer(p);f.readOffset=2;let _={port:f.readUInt16BE(),host:s.fromLong(f.readUInt32BE())};this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:_,socket:this.socket})}}sendSocks5InitialHandshake(){let p=new o.SmartBuffer,f=[a.Socks5Auth.NoAuth];(this.options.proxy.userId||this.options.proxy.password)&&f.push(a.Socks5Auth.UserPass),this.options.proxy.custom_auth_method!==void 0&&f.push(this.options.proxy.custom_auth_method),p.writeUInt8(5),p.writeUInt8(f.length);for(let _ of f)p.writeUInt8(_);this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(p.toBuffer()),this.setState(a.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){let p=this.receiveBuffer.get(2);p[0]!==5?this.closeSocket(a.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion):p[1]===a.SOCKS5_NO_ACCEPTABLE_AUTH?this.closeSocket(a.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType):p[1]===a.Socks5Auth.NoAuth?(this.socks5ChosenAuthType=a.Socks5Auth.NoAuth,this.sendSocks5CommandRequest()):p[1]===a.Socks5Auth.UserPass?(this.socks5ChosenAuthType=a.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication()):p[1]===this.options.proxy.custom_auth_method?(this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication()):this.closeSocket(a.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){let p=this.options.proxy.userId||"",f=this.options.proxy.password||"",_=new o.SmartBuffer;_.writeUInt8(1),_.writeUInt8(Buffer.byteLength(p)),_.writeString(p),_.writeUInt8(Buffer.byteLength(f)),_.writeString(f),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(_.toBuffer()),this.setState(a.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return e(this,void 0,void 0,function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(a.SocksClientState.SentAuthentication)})}handleSocks5CustomAuthHandshakeResponse(p){return e(this,void 0,void 0,function*(){return yield this.options.proxy.custom_auth_response_handler(p)})}handleSocks5AuthenticationNoAuthHandshakeResponse(p){return e(this,void 0,void 0,function*(){return p[1]===0})}handleSocks5AuthenticationUserPassHandshakeResponse(p){return e(this,void 0,void 0,function*(){return p[1]===0})}handleInitialSocks5AuthenticationHandshakeResponse(){return e(this,void 0,void 0,function*(){this.setState(a.SocksClientState.ReceivedAuthenticationResponse);let p=!1;this.socks5ChosenAuthType===a.Socks5Auth.NoAuth?p=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===a.Socks5Auth.UserPass?p=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2)):this.socks5ChosenAuthType===this.options.proxy.custom_auth_method&&(p=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size))),p?this.sendSocks5CommandRequest():this.closeSocket(a.ERRORS.Socks5AuthenticationFailed)})}sendSocks5CommandRequest(){let p=new o.SmartBuffer;p.writeUInt8(5),p.writeUInt8(a.SocksCommand[this.options.command]),p.writeUInt8(0),n.isIPv4(this.options.destination.host)?(p.writeUInt8(a.Socks5HostType.IPv4),p.writeBuffer(s.toBuffer(this.options.destination.host))):n.isIPv6(this.options.destination.host)?(p.writeUInt8(a.Socks5HostType.IPv6),p.writeBuffer(s.toBuffer(this.options.destination.host))):(p.writeUInt8(a.Socks5HostType.Hostname),p.writeUInt8(this.options.destination.host.length),p.writeString(this.options.destination.host)),p.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(p.toBuffer()),this.setState(a.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){let p=this.receiveBuffer.peek(5);if(p[0]!==5||p[1]!==a.Socks5Response.Granted)this.closeSocket(`${a.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${a.Socks5Response[p[1]]}`);else{let f=p[3],_,v;if(f===a.Socks5HostType.IPv4){let w=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<w){this.nextRequiredPacketBufferSize=w;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(w).slice(4)),_={host:s.fromLong(v.readUInt32BE()),port:v.readUInt16BE()},_.host==="0.0.0.0"&&(_.host=this.options.proxy.ipaddress)}else if(f===a.Socks5HostType.Hostname){let w=p[4],m=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(w);if(this.receiveBuffer.length<m){this.nextRequiredPacketBufferSize=m;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(m).slice(5)),_={host:v.readString(w),port:v.readUInt16BE()}}else if(f===a.Socks5HostType.IPv6){let w=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<w){this.nextRequiredPacketBufferSize=w;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(w).slice(4)),_={host:s.toString(v.readBuffer(16)),port:v.readUInt16BE()}}this.setState(a.SocksClientState.ReceivedFinalResponse),a.SocksCommand[this.options.command]===a.SocksCommand.connect?(this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:_,socket:this.socket})):a.SocksCommand[this.options.command]===a.SocksCommand.bind?(this.setState(a.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:_,socket:this.socket})):a.SocksCommand[this.options.command]===a.SocksCommand.associate&&(this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:_,socket:this.socket}))}}handleSocks5IncomingConnectionResponse(){let p=this.receiveBuffer.peek(5);if(p[0]!==5||p[1]!==a.Socks5Response.Granted)this.closeSocket(`${a.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${a.Socks5Response[p[1]]}`);else{let f=p[3],_,v;if(f===a.Socks5HostType.IPv4){let w=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<w){this.nextRequiredPacketBufferSize=w;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(w).slice(4)),_={host:s.fromLong(v.readUInt32BE()),port:v.readUInt16BE()},_.host==="0.0.0.0"&&(_.host=this.options.proxy.ipaddress)}else if(f===a.Socks5HostType.Hostname){let w=p[4],m=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(w);if(this.receiveBuffer.length<m){this.nextRequiredPacketBufferSize=m;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(m).slice(5)),_={host:v.readString(w),port:v.readUInt16BE()}}else if(f===a.Socks5HostType.IPv6){let w=a.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<w){this.nextRequiredPacketBufferSize=w;return}v=o.SmartBuffer.fromBuffer(this.receiveBuffer.get(w).slice(4)),_={host:s.toString(v.readBuffer(16)),port:v.readUInt16BE()}}this.setState(a.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:_,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}};r.SocksClient=d}),EI=ee(r=>{"use strict";var e=r&&r.__createBinding||(Object.create?function(n,s,o,a){a===void 0&&(a=o);var l=Object.getOwnPropertyDescriptor(s,o);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[o]}}),Object.defineProperty(n,a,l)}:function(n,s,o,a){a===void 0&&(a=o),n[a]=s[o]}),t=r&&r.__exportStar||function(n,s){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&e(s,n,o)};Object.defineProperty(r,"__esModule",{value:!0}),t(SI(),r)}),kI=ee(r=>{"use strict";var e=r&&r.__awaiter||function(_,v,w,m){function g(x){return x instanceof w?x:new w(function(b){b(x)})}return new(w||(w=Promise))(function(x,b){function y(C){try{E(m.next(C))}catch(k){b(k)}}function S(C){try{E(m.throw(C))}catch(k){b(k)}}function E(C){C.done?x(C.value):g(C.value).then(y,S)}E((m=m.apply(_,v||[])).next())})},t=r&&r.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(r,"__esModule",{value:!0});var n=t(require("dns")),s=t(require("tls")),o=t(require("url")),a=t(co()),l=W0(),c=EI(),u=a.default("socks-proxy-agent");function d(_){return new Promise((v,w)=>{n.default.lookup(_,(m,g)=>{m?w(m):v(g)})})}function h(_){let v=0,w=!1,m=5,g=_.hostname||_.host;if(!g)throw new TypeError('No "host"');if(typeof _.port=="number"?v=_.port:typeof _.port=="string"&&(v=parseInt(_.port,10)),v||(v=1080),_.protocol)switch(_.protocol.replace(":","")){case"socks4":w=!0;case"socks4a":m=4;break;case"socks5":w=!0;case"socks":case"socks5h":m=5;break;default:throw new TypeError(`A "socks" protocol must be specified! Got: ${_.protocol}`)}if(typeof _.type<"u")if(_.type===4||_.type===5)m=_.type;else throw new TypeError(`"type" must be 4 or 5, got: ${_.type}`);let x={host:g,port:v,type:m},b=_.userId||_.username,y=_.password;if(_.auth){let S=_.auth.split(":");b=S[0],y=S[1]}return b&&Object.defineProperty(x,"userId",{value:b,enumerable:!1}),y&&Object.defineProperty(x,"password",{value:y,enumerable:!1}),{lookup:w,proxy:x}}var p=class extends l.Agent{constructor(_){let v;if(typeof _=="string"?v=o.default.parse(_):v=_,!v)throw new TypeError("a SOCKS proxy server `host` and `port` must be specified!");super(v);let w=h(v);this.lookup=w.lookup,this.proxy=w.proxy,this.tlsConnectionOptions=v.tls||{}}callback(_,v){return e(this,void 0,void 0,function*(){let{lookup:w,proxy:m}=this,{host:g,port:x,timeout:b}=v;if(!g)throw new Error("No `host` defined!");w&&(g=yield d(g));let y={proxy:m,destination:{host:g,port:x},command:"connect",timeout:b};u("Creating socks proxy connection: %o",y);let{socket:S}=yield c.SocksClient.createConnection(y);if(u("Successfully created socks proxy connection"),v.secureEndpoint){u("Upgrading socket connection to TLS");let E=v.servername||v.host;return s.default.connect(Object.assign(Object.assign(Object.assign({},f(v,"host","hostname","path","port")),{socket:S,servername:E}),this.tlsConnectionOptions))}return S})}};r.default=p;function f(_,...v){let w={},m;for(m in _)v.includes(m)||(w[m]=_[m]);return w}}),CI=ee((r,e)=>{"use strict";var t=r&&r.__importDefault||function(o){return o&&o.__esModule?o:{default:o}},n=t(kI());function s(o){return new n.default(o)}(function(o){o.SocksProxyAgent=n.default,o.prototype=n.default.prototype})(s||(s={})),e.exports=s}),TI=ee((r,e)=>{"use strict";var t=/[|\\{}()[\]^$+*?.-]/g;e.exports=n=>{if(typeof n!="string")throw new TypeError("Expected a string");return n.replace(t,"\\$&")}}),OI=ee((r,e)=>{"use strict";var t=TI(),n=typeof process=="object"&&process&&typeof process.cwd=="function"?process.cwd():".",s=[].concat(require("module").builtinModules,"bootstrap_node","node").map(d=>new RegExp(`(?:\\((?:node:)?${d}(?:\\.js)?:\\d+:\\d+\\)$|^\\s*at (?:node:)?${d}(?:\\.js)?:\\d+:\\d+$)`));s.push(/\((?:node:)?internal\/[^:]+:\d+:\d+\)$/,/\s*at (?:node:)?internal\/[^:]+:\d+:\d+$/,/\/\.node-spawn-wrap-\w+-\w+\/node:\d+:\d+\)?$/);var o=class ay{constructor(h){h={ignoredPackages:[],...h},"internals"in h||(h.internals=ay.nodeInternals()),"cwd"in h||(h.cwd=n),this._cwd=h.cwd.replace(/\\/g,"/"),this._internals=[].concat(h.internals,l(h.ignoredPackages)),this._wrapCallSite=h.wrapCallSite||!1}static nodeInternals(){return[...s]}clean(h,p=0){p=" ".repeat(p),Array.isArray(h)||(h=h.split(`
`)),!/^\s*at /.test(h[0])&&/^\s*at /.test(h[1])&&(h=h.slice(1));let f=!1,_=null,v=[];return h.forEach(w=>{if(w=w.replace(/\\/g,"/"),this._internals.some(g=>g.test(w)))return;let m=/^\s*at /.test(w);f?w=w.trimEnd().replace(/^(\s+)at /,"$1"):(w=w.trim(),m&&(w=w.slice(3))),w=w.replace(`${this._cwd}/`,""),w&&(m?(_&&(v.push(_),_=null),v.push(w)):(f=!0,_=w))}),v.map(w=>`${p}${w}
`).join("")}captureString(h,p=this.captureString){typeof h=="function"&&(p=h,h=1/0);let{stackTraceLimit:f}=Error;h&&(Error.stackTraceLimit=h);let _={};Error.captureStackTrace(_,p);let{stack:v}=_;return Error.stackTraceLimit=f,this.clean(v)}capture(h,p=this.capture){typeof h=="function"&&(p=h,h=1/0);let{prepareStackTrace:f,stackTraceLimit:_}=Error;Error.prepareStackTrace=(m,g)=>this._wrapCallSite?g.map(this._wrapCallSite):g,h&&(Error.stackTraceLimit=h);let v={};Error.captureStackTrace(v,p);let{stack:w}=v;return Object.assign(Error,{prepareStackTrace:f,stackTraceLimit:_}),w}at(h=this.at){let[p]=this.capture(1,h);if(!p)return{};let f={line:p.getLineNumber(),column:p.getColumnNumber()};a(f,p.getFileName(),this._cwd),p.isConstructor()&&(f.constructor=!0),p.isEval()&&(f.evalOrigin=p.getEvalOrigin()),p.isNative()&&(f.native=!0);let _;try{_=p.getTypeName()}catch{}_&&_!=="Object"&&_!=="[object Object]"&&(f.type=_);let v=p.getFunctionName();v&&(f.function=v);let w=p.getMethodName();return w&&v!==w&&(f.method=w),f}parseLine(h){let p=h&&h.match(c);if(!p)return null;let f=p[1]==="new",_=p[2],v=p[3],w=p[4],m=Number(p[5]),g=Number(p[6]),x=p[7],b=p[8],y=p[9],S=p[10]==="native",E=p[11]===")",C,k={};if(b&&(k.line=Number(b)),y&&(k.column=Number(y)),E&&x){let F=0;for(let O=x.length-1;O>0;O--)if(x.charAt(O)===")")F++;else if(x.charAt(O)==="("&&x.charAt(O-1)===" "&&(F--,F===-1&&x.charAt(O-1)===" ")){let I=x.slice(0,O-1);x=x.slice(O+1),_+=` (${I}`;break}}if(_){let F=_.match(u);F&&(_=F[1],C=F[2])}return a(k,x,this._cwd),f&&(k.constructor=!0),v&&(k.evalOrigin=v,k.evalLine=m,k.evalColumn=g,k.evalFile=w&&w.replace(/\\/g,"/")),S&&(k.native=!0),_&&(k.function=_),C&&_!==C&&(k.method=C),k}};function a(d,h,p){h&&(h=h.replace(/\\/g,"/"),h.startsWith(`${p}/`)&&(h=h.slice(p.length+1)),d.file=h)}function l(d){if(d.length===0)return[];let h=d.map(p=>t(p));return new RegExp(`[/\\\\]node_modules[/\\\\](?:${h.join("|")})[/\\\\][^:]+:\\d+:\\d+`)}var c=new RegExp("^(?:\\s*at )?(?:(new) )?(?:(.*?) \\()?(?:eval at ([^ ]+) \\((.+?):(\\d+):(\\d+)\\), )?(?:(.+?):(\\d+):(\\d+)|(native))(\\)?)$"),u=/^(.*?) \[as (.*?)\]$/;e.exports=o}),PI=ee((r,e)=>{"use strict";var{Duplex:t}=require("stream");function n(l){l.emit("close")}function s(){!this.destroyed&&this._writableState.finished&&this.destroy()}function o(l){this.removeListener("error",o),this.destroy(),this.listenerCount("error")===0&&this.emit("error",l)}function a(l,c){let u=!0,d=new t({...c,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return l.on("message",function(h,p){let f=!p&&d._readableState.objectMode?h.toString():h;d.push(f)||l.pause()}),l.once("error",function(h){d.destroyed||(u=!1,d.destroy(h))}),l.once("close",function(){d.destroyed||d.push(null)}),d._destroy=function(h,p){if(l.readyState===l.CLOSED){p(h),process.nextTick(n,d);return}let f=!1;l.once("error",function(_){f=!0,p(_)}),l.once("close",function(){f||p(h),process.nextTick(n,d)}),u&&l.terminate()},d._final=function(h){if(l.readyState===l.CONNECTING){l.once("open",function(){d._final(h)});return}l._socket!==null&&(l._socket._writableState.finished?(h(),d._readableState.endEmitted&&d.destroy()):(l._socket.once("finish",function(){h()}),l.close()))},d._read=function(){l.isPaused&&l.resume()},d._write=function(h,p,f){if(l.readyState===l.CONNECTING){l.once("open",function(){d._write(h,p,f)});return}l.send(h,f)},d.on("end",s),d.on("error",o),d}e.exports=a}),Jr=ee((r,e)=>{"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}}),nl=ee((r,e)=>{"use strict";var{EMPTY_BUFFER:t}=Jr();function n(c,u){if(c.length===0)return t;if(c.length===1)return c[0];let d=Buffer.allocUnsafe(u),h=0;for(let p=0;p<c.length;p++){let f=c[p];d.set(f,h),h+=f.length}return h<u?d.slice(0,h):d}function s(c,u,d,h,p){for(let f=0;f<p;f++)d[h+f]=c[f]^u[f&3]}function o(c,u){for(let d=0;d<c.length;d++)c[d]^=u[d&3]}function a(c){return c.byteLength===c.buffer.byteLength?c.buffer:c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}function l(c){if(l.readOnly=!0,Buffer.isBuffer(c))return c;let u;return c instanceof ArrayBuffer?u=Buffer.from(c):ArrayBuffer.isView(c)?u=Buffer.from(c.buffer,c.byteOffset,c.byteLength):(u=Buffer.from(c),l.readOnly=!1),u}try{let c=require("bufferutil");e.exports={concat:n,mask(u,d,h,p,f){f<48?s(u,d,h,p,f):c.mask(u,d,h,p,f)},toArrayBuffer:a,toBuffer:l,unmask(u,d){u.length<32?o(u,d):c.unmask(u,d)}}}catch{e.exports={concat:n,mask:s,toArrayBuffer:a,toBuffer:l,unmask:o}}}),AI=ee((r,e)=>{"use strict";var t=Symbol("kDone"),n=Symbol("kRun"),s=class{constructor(o){this[t]=()=>{this.pending--,this[n]()},this.concurrency=o||1/0,this.jobs=[],this.pending=0}add(o){this.jobs.push(o),this[n]()}[n](){if(this.pending!==this.concurrency&&this.jobs.length){let o=this.jobs.shift();this.pending++,o(this[t])}}};e.exports=s}),rl=ee((r,e)=>{"use strict";var t=require("zlib"),n=nl(),s=AI(),{kStatusCode:o}=Jr(),a=Buffer.from([0,0,255,255]),l=Symbol("permessage-deflate"),c=Symbol("total-length"),u=Symbol("callback"),d=Symbol("buffers"),h=Symbol("error"),p,f=class{constructor(m,g,x){if(this._maxPayload=x|0,this._options=m||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!g,this._deflate=null,this._inflate=null,this.params=null,!p){let b=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;p=new s(b)}}static get extensionName(){return"permessage-deflate"}offer(){let m={};return this._options.serverNoContextTakeover&&(m.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(m.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(m.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?m.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(m.client_max_window_bits=!0),m}accept(m){return m=this.normalizeParams(m),this.params=this._isServer?this.acceptAsServer(m):this.acceptAsClient(m),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let m=this._deflate[u];this._deflate.close(),this._deflate=null,m&&m(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(m){let g=this._options,x=m.find(b=>!(g.serverNoContextTakeover===!1&&b.server_no_context_takeover||b.server_max_window_bits&&(g.serverMaxWindowBits===!1||typeof g.serverMaxWindowBits=="number"&&g.serverMaxWindowBits>b.server_max_window_bits)||typeof g.clientMaxWindowBits=="number"&&!b.client_max_window_bits));if(!x)throw new Error("None of the extension offers can be accepted");return g.serverNoContextTakeover&&(x.server_no_context_takeover=!0),g.clientNoContextTakeover&&(x.client_no_context_takeover=!0),typeof g.serverMaxWindowBits=="number"&&(x.server_max_window_bits=g.serverMaxWindowBits),typeof g.clientMaxWindowBits=="number"?x.client_max_window_bits=g.clientMaxWindowBits:(x.client_max_window_bits===!0||g.clientMaxWindowBits===!1)&&delete x.client_max_window_bits,x}acceptAsClient(m){let g=m[0];if(this._options.clientNoContextTakeover===!1&&g.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!g.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(g.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&g.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return g}normalizeParams(m){return m.forEach(g=>{Object.keys(g).forEach(x=>{let b=g[x];if(b.length>1)throw new Error(`Parameter "${x}" must have only a single value`);if(b=b[0],x==="client_max_window_bits"){if(b!==!0){let y=+b;if(!Number.isInteger(y)||y<8||y>15)throw new TypeError(`Invalid value for parameter "${x}": ${b}`);b=y}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${x}": ${b}`)}else if(x==="server_max_window_bits"){let y=+b;if(!Number.isInteger(y)||y<8||y>15)throw new TypeError(`Invalid value for parameter "${x}": ${b}`);b=y}else if(x==="client_no_context_takeover"||x==="server_no_context_takeover"){if(b!==!0)throw new TypeError(`Invalid value for parameter "${x}": ${b}`)}else throw new Error(`Unknown parameter "${x}"`);g[x]=b})}),m}decompress(m,g,x){p.add(b=>{this._decompress(m,g,(y,S)=>{b(),x(y,S)})})}compress(m,g,x){p.add(b=>{this._compress(m,g,(y,S)=>{b(),x(y,S)})})}_decompress(m,g,x){let b=this._isServer?"client":"server";if(!this._inflate){let y=`${b}_max_window_bits`,S=typeof this.params[y]!="number"?t.Z_DEFAULT_WINDOWBITS:this.params[y];this._inflate=t.createInflateRaw({...this._options.zlibInflateOptions,windowBits:S}),this._inflate[l]=this,this._inflate[c]=0,this._inflate[d]=[],this._inflate.on("error",w),this._inflate.on("data",v)}this._inflate[u]=x,this._inflate.write(m),g&&this._inflate.write(a),this._inflate.flush(()=>{let y=this._inflate[h];if(y){this._inflate.close(),this._inflate=null,x(y);return}let S=n.concat(this._inflate[d],this._inflate[c]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[c]=0,this._inflate[d]=[],g&&this.params[`${b}_no_context_takeover`]&&this._inflate.reset()),x(null,S)})}_compress(m,g,x){let b=this._isServer?"server":"client";if(!this._deflate){let y=`${b}_max_window_bits`,S=typeof this.params[y]!="number"?t.Z_DEFAULT_WINDOWBITS:this.params[y];this._deflate=t.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:S}),this._deflate[c]=0,this._deflate[d]=[],this._deflate.on("data",_)}this._deflate[u]=x,this._deflate.write(m),this._deflate.flush(t.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let y=n.concat(this._deflate[d],this._deflate[c]);g&&(y=y.slice(0,y.length-4)),this._deflate[u]=null,this._deflate[c]=0,this._deflate[d]=[],g&&this.params[`${b}_no_context_takeover`]&&this._deflate.reset(),x(null,y)})}};e.exports=f;function _(m){this[d].push(m),this[c]+=m.length}function v(m){if(this[c]+=m.length,this[l]._maxPayload<1||this[c]<=this[l]._maxPayload){this[d].push(m);return}this[h]=new RangeError("Max payload size exceeded"),this[h].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[h][o]=1009,this.removeListener("data",v),this.reset()}function w(m){this[l]._inflate=null,m[o]=1007,this[u](m)}}),il=ee((r,e)=>{"use strict";var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function n(o){return o>=1e3&&o<=1014&&o!==1004&&o!==1005&&o!==1006||o>=3e3&&o<=4999}function s(o){let a=o.length,l=0;for(;l<a;)if(!(o[l]&128))l++;else if((o[l]&224)===192){if(l+1===a||(o[l+1]&192)!==128||(o[l]&254)===192)return!1;l+=2}else if((o[l]&240)===224){if(l+2>=a||(o[l+1]&192)!==128||(o[l+2]&192)!==128||o[l]===224&&(o[l+1]&224)===128||o[l]===237&&(o[l+1]&224)===160)return!1;l+=3}else if((o[l]&248)===240){if(l+3>=a||(o[l+1]&192)!==128||(o[l+2]&192)!==128||(o[l+3]&192)!==128||o[l]===240&&(o[l+1]&240)===128||o[l]===244&&o[l+1]>143||o[l]>244)return!1;l+=4}else return!1;return!0}try{let o=require("utf-8-validate");e.exports={isValidStatusCode:n,isValidUTF8(a){return a.length<150?s(a):o(a)},tokenChars:t}}catch{e.exports={isValidStatusCode:n,isValidUTF8:s,tokenChars:t}}}),ly=ee((r,e)=>{"use strict";var{Writable:t}=require("stream"),n=rl(),{BINARY_TYPES:s,EMPTY_BUFFER:o,kStatusCode:a,kWebSocket:l}=Jr(),{concat:c,toArrayBuffer:u,unmask:d}=nl(),{isValidStatusCode:h,isValidUTF8:p}=il(),f=0,_=1,v=2,w=3,m=4,g=5,x=class extends t{constructor(y={}){super(),this._binaryType=y.binaryType||s[0],this._extensions=y.extensions||{},this._isServer=!!y.isServer,this._maxPayload=y.maxPayload|0,this._skipUTF8Validation=!!y.skipUTF8Validation,this[l]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=f,this._loop=!1}_write(y,S,E){if(this._opcode===8&&this._state==f)return E();this._bufferedBytes+=y.length,this._buffers.push(y),this.startLoop(E)}consume(y){if(this._bufferedBytes-=y,y===this._buffers[0].length)return this._buffers.shift();if(y<this._buffers[0].length){let E=this._buffers[0];return this._buffers[0]=E.slice(y),E.slice(0,y)}let S=Buffer.allocUnsafe(y);do{let E=this._buffers[0],C=S.length-y;y>=E.length?S.set(this._buffers.shift(),C):(S.set(new Uint8Array(E.buffer,E.byteOffset,y),C),this._buffers[0]=E.slice(y)),y-=E.length}while(y>0);return S}startLoop(y){let S;this._loop=!0;do switch(this._state){case f:S=this.getInfo();break;case _:S=this.getPayloadLength16();break;case v:S=this.getPayloadLength64();break;case w:this.getMask();break;case m:S=this.getData(y);break;default:this._loop=!1;return}while(this._loop);y(S)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let y=this.consume(2);if(y[0]&48)return this._loop=!1,b(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let S=(y[0]&64)===64;if(S&&!this._extensions[n.extensionName])return this._loop=!1,b(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(y[0]&128)===128,this._opcode=y[0]&15,this._payloadLength=y[1]&127,this._opcode===0){if(S)return this._loop=!1,b(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,b(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,b(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=S}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,b(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(S)return this._loop=!1,b(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,b(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,b(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(y[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,b(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,b(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=_;else if(this._payloadLength===127)this._state=v;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let y=this.consume(8),S=y.readUInt32BE(0);return S>Math.pow(2,21)-1?(this._loop=!1,b(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=S*Math.pow(2,32)+y.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,b(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=w:this._state=m}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=m}getData(y){let S=o;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}S=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&d(S,this._mask)}if(this._opcode>7)return this.controlMessage(S);if(this._compressed){this._state=g,this.decompress(S,y);return}return S.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(S)),this.dataMessage()}decompress(y,S){this._extensions[n.extensionName].decompress(y,this._fin,(E,C)=>{if(E)return S(E);if(C.length){if(this._messageLength+=C.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return S(b(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(C)}let k=this.dataMessage();if(k)return S(k);this.startLoop(S)})}dataMessage(){if(this._fin){let y=this._messageLength,S=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let E;this._binaryType==="nodebuffer"?E=c(S,y):this._binaryType==="arraybuffer"?E=u(c(S,y)):E=S,this.emit("message",E,!0)}else{let E=c(S,y);if(!this._skipUTF8Validation&&!p(E))return this._loop=!1,b(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",E,!1)}}this._state=f}controlMessage(y){if(this._opcode===8)if(this._loop=!1,y.length===0)this.emit("conclude",1005,o),this.end();else{if(y.length===1)return b(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let S=y.readUInt16BE(0);if(!h(S))return b(RangeError,`invalid status code ${S}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let E=y.slice(2);if(!this._skipUTF8Validation&&!p(E))return b(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",S,E),this.end()}}else this._opcode===9?this.emit("ping",y):this.emit("pong",y);this._state=f}};e.exports=x;function b(y,S,E,C,k){let F=new y(E?`Invalid WebSocket frame: ${S}`:S);return Error.captureStackTrace(F,b),F.code=k,F[a]=C,F}}),cy=ee((r,e)=>{"use strict";var t=require("net"),n=require("tls"),{randomFillSync:s}=require("crypto"),o=rl(),{EMPTY_BUFFER:a}=Jr(),{isValidStatusCode:l}=il(),{mask:c,toBuffer:u}=nl(),d=Symbol("kByteLength"),h=Buffer.alloc(4),p=class Kr{constructor(_,v,w){this._extensions=v||{},w&&(this._generateMask=w,this._maskBuffer=Buffer.alloc(4)),this._socket=_,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(_,v){let w,m=!1,g=2,x=!1;v.mask&&(w=v.maskBuffer||h,v.generateMask?v.generateMask(w):s(w,0,4),x=(w[0]|w[1]|w[2]|w[3])===0,g=6);let b;typeof _=="string"?(!v.mask||x)&&v[d]!==void 0?b=v[d]:(_=Buffer.from(_),b=_.length):(b=_.length,m=v.mask&&v.readOnly&&!x);let y=b;b>=65536?(g+=8,y=127):b>125&&(g+=2,y=126);let S=Buffer.allocUnsafe(m?b+g:g);return S[0]=v.fin?v.opcode|128:v.opcode,v.rsv1&&(S[0]|=64),S[1]=y,y===126?S.writeUInt16BE(b,2):y===127&&(S[2]=S[3]=0,S.writeUIntBE(b,4,6)),v.mask?(S[1]|=128,S[g-4]=w[0],S[g-3]=w[1],S[g-2]=w[2],S[g-1]=w[3],x?[S,_]:m?(c(_,w,S,g,b),[S]):(c(_,w,_,0,b),[S,_])):[S,_]}close(_,v,w,m){let g;if(_===void 0)g=a;else{if(typeof _!="number"||!l(_))throw new TypeError("First argument must be a valid error code number");if(v===void 0||!v.length)g=Buffer.allocUnsafe(2),g.writeUInt16BE(_,0);else{let b=Buffer.byteLength(v);if(b>123)throw new RangeError("The message must not be greater than 123 bytes");g=Buffer.allocUnsafe(2+b),g.writeUInt16BE(_,0),typeof v=="string"?g.write(v,2):g.set(v,2)}}let x={[d]:g.length,fin:!0,generateMask:this._generateMask,mask:w,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,g,!1,x,m]):this.sendFrame(Kr.frame(g,x),m)}ping(_,v,w){let m,g;if(typeof _=="string"?(m=Buffer.byteLength(_),g=!1):(_=u(_),m=_.length,g=u.readOnly),m>125)throw new RangeError("The data size must not be greater than 125 bytes");let x={[d]:m,fin:!0,generateMask:this._generateMask,mask:v,maskBuffer:this._maskBuffer,opcode:9,readOnly:g,rsv1:!1};this._deflating?this.enqueue([this.dispatch,_,!1,x,w]):this.sendFrame(Kr.frame(_,x),w)}pong(_,v,w){let m,g;if(typeof _=="string"?(m=Buffer.byteLength(_),g=!1):(_=u(_),m=_.length,g=u.readOnly),m>125)throw new RangeError("The data size must not be greater than 125 bytes");let x={[d]:m,fin:!0,generateMask:this._generateMask,mask:v,maskBuffer:this._maskBuffer,opcode:10,readOnly:g,rsv1:!1};this._deflating?this.enqueue([this.dispatch,_,!1,x,w]):this.sendFrame(Kr.frame(_,x),w)}send(_,v,w){let m=this._extensions[o.extensionName],g=v.binary?2:1,x=v.compress,b,y;if(typeof _=="string"?(b=Buffer.byteLength(_),y=!1):(_=u(_),b=_.length,y=u.readOnly),this._firstFragment?(this._firstFragment=!1,x&&m&&m.params[m._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(x=b>=m._threshold),this._compress=x):(x=!1,g=0),v.fin&&(this._firstFragment=!0),m){let S={[d]:b,fin:v.fin,generateMask:this._generateMask,mask:v.mask,maskBuffer:this._maskBuffer,opcode:g,readOnly:y,rsv1:x};this._deflating?this.enqueue([this.dispatch,_,this._compress,S,w]):this.dispatch(_,this._compress,S,w)}else this.sendFrame(Kr.frame(_,{[d]:b,fin:v.fin,generateMask:this._generateMask,mask:v.mask,maskBuffer:this._maskBuffer,opcode:g,readOnly:y,rsv1:!1}),w)}dispatch(_,v,w,m){if(!v){this.sendFrame(Kr.frame(_,w),m);return}let g=this._extensions[o.extensionName];this._bufferedBytes+=w[d],this._deflating=!0,g.compress(_,w.fin,(x,b)=>{if(this._socket.destroyed){let y=new Error("The socket was closed while data was being compressed");typeof m=="function"&&m(y);for(let S=0;S<this._queue.length;S++){let E=this._queue[S],C=E[E.length-1];typeof C=="function"&&C(y)}return}this._bufferedBytes-=w[d],this._deflating=!1,w.readOnly=!1,this.sendFrame(Kr.frame(b,w),m),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let _=this._queue.shift();this._bufferedBytes-=_[3][d],Reflect.apply(_[0],this,_.slice(1))}}enqueue(_){this._bufferedBytes+=_[3][d],this._queue.push(_)}sendFrame(_,v){_.length===2?(this._socket.cork(),this._socket.write(_[0]),this._socket.write(_[1],v),this._socket.uncork()):this._socket.write(_[0],v)}};e.exports=p}),II=ee((r,e)=>{"use strict";var{kForOnEventAttribute:t,kListener:n}=Jr(),s=Symbol("kCode"),o=Symbol("kData"),a=Symbol("kError"),l=Symbol("kMessage"),c=Symbol("kReason"),u=Symbol("kTarget"),d=Symbol("kType"),h=Symbol("kWasClean"),p=class{constructor(m){this[u]=null,this[d]=m}get target(){return this[u]}get type(){return this[d]}};Object.defineProperty(p.prototype,"target",{enumerable:!0}),Object.defineProperty(p.prototype,"type",{enumerable:!0});var f=class extends p{constructor(m,g={}){super(m),this[s]=g.code===void 0?0:g.code,this[c]=g.reason===void 0?"":g.reason,this[h]=g.wasClean===void 0?!1:g.wasClean}get code(){return this[s]}get reason(){return this[c]}get wasClean(){return this[h]}};Object.defineProperty(f.prototype,"code",{enumerable:!0}),Object.defineProperty(f.prototype,"reason",{enumerable:!0}),Object.defineProperty(f.prototype,"wasClean",{enumerable:!0});var _=class extends p{constructor(m,g={}){super(m),this[a]=g.error===void 0?null:g.error,this[l]=g.message===void 0?"":g.message}get error(){return this[a]}get message(){return this[l]}};Object.defineProperty(_.prototype,"error",{enumerable:!0}),Object.defineProperty(_.prototype,"message",{enumerable:!0});var v=class extends p{constructor(m,g={}){super(m),this[o]=g.data===void 0?null:g.data}get data(){return this[o]}};Object.defineProperty(v.prototype,"data",{enumerable:!0});var w={addEventListener(m,g,x={}){let b;if(m==="message")b=function(y,S){let E=new v("message",{data:S?y:y.toString()});E[u]=this,g.call(this,E)};else if(m==="close")b=function(y,S){let E=new f("close",{code:y,reason:S.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});E[u]=this,g.call(this,E)};else if(m==="error")b=function(y){let S=new _("error",{error:y,message:y.message});S[u]=this,g.call(this,S)};else if(m==="open")b=function(){let y=new p("open");y[u]=this,g.call(this,y)};else return;b[t]=!!x[t],b[n]=g,x.once?this.once(m,b):this.on(m,b)},removeEventListener(m,g){for(let x of this.listeners(m))if(x[n]===g&&!x[t]){this.removeListener(m,x);break}}};e.exports={CloseEvent:f,ErrorEvent:_,Event:p,EventTarget:w,MessageEvent:v}}),uy=ee((r,e)=>{"use strict";var{tokenChars:t}=il();function n(a,l,c){a[l]===void 0?a[l]=[c]:a[l].push(c)}function s(a){let l=Object.create(null),c=Object.create(null),u=!1,d=!1,h=!1,p,f,_=-1,v=-1,w=-1,m=0;for(;m<a.length;m++)if(v=a.charCodeAt(m),p===void 0)if(w===-1&&t[v]===1)_===-1&&(_=m);else if(m!==0&&(v===32||v===9))w===-1&&_!==-1&&(w=m);else if(v===59||v===44){if(_===-1)throw new SyntaxError(`Unexpected character at index ${m}`);w===-1&&(w=m);let x=a.slice(_,w);v===44?(n(l,x,c),c=Object.create(null)):p=x,_=w=-1}else throw new SyntaxError(`Unexpected character at index ${m}`);else if(f===void 0)if(w===-1&&t[v]===1)_===-1&&(_=m);else if(v===32||v===9)w===-1&&_!==-1&&(w=m);else if(v===59||v===44){if(_===-1)throw new SyntaxError(`Unexpected character at index ${m}`);w===-1&&(w=m),n(c,a.slice(_,w),!0),v===44&&(n(l,p,c),c=Object.create(null),p=void 0),_=w=-1}else if(v===61&&_!==-1&&w===-1)f=a.slice(_,m),_=w=-1;else throw new SyntaxError(`Unexpected character at index ${m}`);else if(d){if(t[v]!==1)throw new SyntaxError(`Unexpected character at index ${m}`);_===-1?_=m:u||(u=!0),d=!1}else if(h)if(t[v]===1)_===-1&&(_=m);else if(v===34&&_!==-1)h=!1,w=m;else if(v===92)d=!0;else throw new SyntaxError(`Unexpected character at index ${m}`);else if(v===34&&a.charCodeAt(m-1)===61)h=!0;else if(w===-1&&t[v]===1)_===-1&&(_=m);else if(_!==-1&&(v===32||v===9))w===-1&&(w=m);else if(v===59||v===44){if(_===-1)throw new SyntaxError(`Unexpected character at index ${m}`);w===-1&&(w=m);let x=a.slice(_,w);u&&(x=x.replace(/\\/g,""),u=!1),n(c,f,x),v===44&&(n(l,p,c),c=Object.create(null),p=void 0),f=void 0,_=w=-1}else throw new SyntaxError(`Unexpected character at index ${m}`);if(_===-1||h||v===32||v===9)throw new SyntaxError("Unexpected end of input");w===-1&&(w=m);let g=a.slice(_,w);return p===void 0?n(l,g,c):(f===void 0?n(c,g,!0):u?n(c,f,g.replace(/\\/g,"")):n(c,f,g),n(l,p,c)),l}function o(a){return Object.keys(a).map(l=>{let c=a[l];return Array.isArray(c)||(c=[c]),c.map(u=>[l].concat(Object.keys(u).map(d=>{let h=u[d];return Array.isArray(h)||(h=[h]),h.map(p=>p===!0?d:`${d}=${p}`).join("; ")})).join("; ")).join(", ")}).join(", ")}e.exports={format:o,parse:s}}),dy=ee((r,e)=>{"use strict";var t=require("events"),n=require("https"),s=require("http"),o=require("net"),a=require("tls"),{randomBytes:l,createHash:c}=require("crypto"),{Readable:u}=require("stream"),{URL:d}=require("url"),h=rl(),p=ly(),f=cy(),{BINARY_TYPES:_,EMPTY_BUFFER:v,GUID:w,kForOnEventAttribute:m,kListener:g,kStatusCode:x,kWebSocket:b,NOOP:y}=Jr(),{EventTarget:{addEventListener:S,removeEventListener:E}}=II(),{format:C,parse:k}=uy(),{toBuffer:F}=nl(),O=["CONNECTING","OPEN","CLOSING","CLOSED"],I=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,P=[8,13],T=30*1e3,A=class Ke extends t{constructor(j,X,Z){super(),this._binaryType=_[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=v,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=Ke.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,j!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,X===void 0?X=[]:Array.isArray(X)||(typeof X=="object"&&X!==null?(Z=X,X=[]):X=[X]),R(this,j,X,Z)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(j){_.includes(j)&&(this._binaryType=j,this._receiver&&(this._receiver._binaryType=j))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(j,X,Z){let se=new p({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:Z.maxPayload,skipUTF8Validation:Z.skipUTF8Validation});this._sender=new f(j,this._extensions,Z.generateMask),this._receiver=se,this._socket=j,se[b]=this,j[b]=this,se.on("conclude",Q),se.on("drain",te),se.on("error",oe),se.on("message",B),se.on("ping",W),se.on("pong",$),j.setTimeout(0),j.setNoDelay(),X.length>0&&j.unshift(X),j.on("close",H),j.on("data",z),j.on("end",K),j.on("error",ae),this._readyState=Ke.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=Ke.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[h.extensionName]&&this._extensions[h.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=Ke.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(j,X){if(this.readyState!==Ke.CLOSED){if(this.readyState===Ke.CONNECTING)return U(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===Ke.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=Ke.CLOSING,this._sender.close(j,X,!this._isServer,Z=>{Z||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),T)}}pause(){this.readyState===Ke.CONNECTING||this.readyState===Ke.CLOSED||(this._paused=!0,this._socket.pause())}ping(j,X,Z){if(this.readyState===Ke.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof j=="function"?(Z=j,j=X=void 0):typeof X=="function"&&(Z=X,X=void 0),typeof j=="number"&&(j=j.toString()),this.readyState!==Ke.OPEN){Y(this,j,Z);return}X===void 0&&(X=!this._isServer),this._sender.ping(j||v,X,Z)}pong(j,X,Z){if(this.readyState===Ke.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof j=="function"?(Z=j,j=X=void 0):typeof X=="function"&&(Z=X,X=void 0),typeof j=="number"&&(j=j.toString()),this.readyState!==Ke.OPEN){Y(this,j,Z);return}X===void 0&&(X=!this._isServer),this._sender.pong(j||v,X,Z)}resume(){this.readyState===Ke.CONNECTING||this.readyState===Ke.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(j,X,Z){if(this.readyState===Ke.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof X=="function"&&(Z=X,X={}),typeof j=="number"&&(j=j.toString()),this.readyState!==Ke.OPEN){Y(this,j,Z);return}let se={binary:typeof j!="string",mask:!this._isServer,compress:!0,fin:!0,...X};this._extensions[h.extensionName]||(se.compress=!1),this._sender.send(j||v,se,Z)}terminate(){if(this.readyState!==Ke.CLOSED){if(this.readyState===Ke.CONNECTING)return U(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=Ke.CLOSING,this._socket.destroy())}}};Object.defineProperty(A,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(A.prototype,"CONNECTING",{enumerable:!0,value:O.indexOf("CONNECTING")}),Object.defineProperty(A,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(A.prototype,"OPEN",{enumerable:!0,value:O.indexOf("OPEN")}),Object.defineProperty(A,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(A.prototype,"CLOSING",{enumerable:!0,value:O.indexOf("CLOSING")}),Object.defineProperty(A,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),Object.defineProperty(A.prototype,"CLOSED",{enumerable:!0,value:O.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(D=>{Object.defineProperty(A.prototype,D,{enumerable:!0})}),["open","error","close","message"].forEach(D=>{Object.defineProperty(A.prototype,`on${D}`,{enumerable:!0,get(){for(let j of this.listeners(D))if(j[m])return j[g];return null},set(j){for(let X of this.listeners(D))if(X[m]){this.removeListener(D,X);break}typeof j=="function"&&this.addEventListener(D,j,{[m]:!0})}})}),A.prototype.addEventListener=S,A.prototype.removeEventListener=E,e.exports=A;function R(D,j,X,Z){let se={protocolVersion:P[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...Z,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0};if(!P.includes(se.protocolVersion))throw new RangeError(`Unsupported protocol version: ${se.protocolVersion} (supported versions: ${P.join(", ")})`);let Ce;if(j instanceof d)Ce=j,D._url=j.href;else{try{Ce=new d(j)}catch{throw new SyntaxError(`Invalid URL: ${j}`)}D._url=j}let Ge=Ce.protocol==="wss:",rt=Ce.protocol==="ws+unix:",lt;if(Ce.protocol!=="ws:"&&!Ge&&!rt?lt=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:rt&&!Ce.pathname?lt="The URL's pathname is empty":Ce.hash&&(lt="The URL contains a fragment identifier"),lt){let fe=new SyntaxError(lt);if(D._redirects===0)throw fe;V(D,fe);return}let G=Ge?443:80,de=l(16).toString("base64"),me=Ge?n.get:s.get,pe=new Set,ve;if(se.createConnection=Ge?q:J,se.defaultPort=se.defaultPort||G,se.port=Ce.port||G,se.host=Ce.hostname.startsWith("[")?Ce.hostname.slice(1,-1):Ce.hostname,se.headers={"Sec-WebSocket-Version":se.protocolVersion,"Sec-WebSocket-Key":de,Connection:"Upgrade",Upgrade:"websocket",...se.headers},se.path=Ce.pathname+Ce.search,se.timeout=se.handshakeTimeout,se.perMessageDeflate&&(ve=new h(se.perMessageDeflate!==!0?se.perMessageDeflate:{},!1,se.maxPayload),se.headers["Sec-WebSocket-Extensions"]=C({[h.extensionName]:ve.offer()})),X.length){for(let fe of X){if(typeof fe!="string"||!I.test(fe)||pe.has(fe))throw new SyntaxError("An invalid or duplicated subprotocol was specified");pe.add(fe)}se.headers["Sec-WebSocket-Protocol"]=X.join(",")}if(se.origin&&(se.protocolVersion<13?se.headers["Sec-WebSocket-Origin"]=se.origin:se.headers.Origin=se.origin),(Ce.username||Ce.password)&&(se.auth=`${Ce.username}:${Ce.password}`),rt){let fe=se.path.split(":");se.socketPath=fe[0],se.path=fe[1]}let _e=D._req=me(se);se.timeout&&_e.on("timeout",()=>{U(D,_e,"Opening handshake has timed out")}),_e.on("error",fe=>{_e===null||_e.aborted||(_e=D._req=null,V(D,fe))}),_e.on("response",fe=>{let we=fe.headers.location,he=fe.statusCode;if(we&&se.followRedirects&&he>=300&&he<400){if(++D._redirects>se.maxRedirects){U(D,_e,"Maximum redirects exceeded");return}_e.abort();let ue;try{ue=new d(we,j)}catch{let le=new SyntaxError(`Invalid URL: ${we}`);V(D,le);return}R(D,ue,X,Z)}else D.emit("unexpected-response",_e,fe)||U(D,_e,`Unexpected server response: ${fe.statusCode}`)}),_e.on("upgrade",(fe,we,he)=>{if(D.emit("upgrade",fe),D.readyState!==A.CONNECTING)return;_e=D._req=null;let ue=c("sha1").update(de+w).digest("base64");if(fe.headers["sec-websocket-accept"]!==ue){U(D,we,"Invalid Sec-WebSocket-Accept header");return}let le=fe.headers["sec-websocket-protocol"],be;if(le!==void 0?pe.size?pe.has(le)||(be="Server sent an invalid subprotocol"):be="Server sent a subprotocol but none was requested":pe.size&&(be="Server sent no subprotocol"),be){U(D,we,be);return}le&&(D._protocol=le);let xe=fe.headers["sec-websocket-extensions"];if(xe!==void 0){if(!ve){U(D,we,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Oe;try{Oe=k(xe)}catch{U(D,we,"Invalid Sec-WebSocket-Extensions header");return}let ge=Object.keys(Oe);if(ge.length!==1||ge[0]!==h.extensionName){U(D,we,"Server indicated an extension that was not requested");return}try{ve.accept(Oe[h.extensionName])}catch{U(D,we,"Invalid Sec-WebSocket-Extensions header");return}D._extensions[h.extensionName]=ve}D.setSocket(we,he,{generateMask:se.generateMask,maxPayload:se.maxPayload,skipUTF8Validation:se.skipUTF8Validation})})}function V(D,j){D._readyState=A.CLOSING,D.emit("error",j),D.emitClose()}function J(D){return D.path=D.socketPath,o.connect(D)}function q(D){return D.path=void 0,!D.servername&&D.servername!==""&&(D.servername=o.isIP(D.host)?"":D.host),a.connect(D)}function U(D,j,X){D._readyState=A.CLOSING;let Z=new Error(X);Error.captureStackTrace(Z,U),j.setHeader?(j.abort(),j.socket&&!j.socket.destroyed&&j.socket.destroy(),j.once("abort",D.emitClose.bind(D)),D.emit("error",Z)):(j.destroy(Z),j.once("error",D.emit.bind(D,"error")),j.once("close",D.emitClose.bind(D)))}function Y(D,j,X){if(j){let Z=F(j).length;D._socket?D._sender._bufferedBytes+=Z:D._bufferedAmount+=Z}if(X){let Z=new Error(`WebSocket is not open: readyState ${D.readyState} (${O[D.readyState]})`);X(Z)}}function Q(D,j){let X=this[b];X._closeFrameReceived=!0,X._closeMessage=j,X._closeCode=D,X._socket[b]!==void 0&&(X._socket.removeListener("data",z),process.nextTick(L,X._socket),D===1005?X.close():X.close(D,j))}function te(){let D=this[b];D.isPaused||D._socket.resume()}function oe(D){let j=this[b];j._socket[b]!==void 0&&(j._socket.removeListener("data",z),process.nextTick(L,j._socket),j.close(D[x])),j.emit("error",D)}function N(){this[b].emitClose()}function B(D,j){this[b].emit("message",D,j)}function W(D){let j=this[b];j.pong(D,!j._isServer,y),j.emit("ping",D)}function $(D){this[b].emit("pong",D)}function L(D){D.resume()}function H(){let D=this[b];this.removeListener("close",H),this.removeListener("data",z),this.removeListener("end",K),D._readyState=A.CLOSING;let j;!this._readableState.endEmitted&&!D._closeFrameReceived&&!D._receiver._writableState.errorEmitted&&(j=D._socket.read())!==null&&D._receiver.write(j),D._receiver.end(),this[b]=void 0,clearTimeout(D._closeTimer),D._receiver._writableState.finished||D._receiver._writableState.errorEmitted?D.emitClose():(D._receiver.on("error",N),D._receiver.on("finish",N))}function z(D){this[b]._receiver.write(D)||this.pause()}function K(){let D=this[b];D._readyState=A.CLOSING,D._receiver.end(),this.end()}function ae(){let D=this[b];this.removeListener("error",ae),this.on("error",y),D&&(D._readyState=A.CLOSING,this.destroy())}}),RI=ee((r,e)=>{"use strict";var{tokenChars:t}=il();function n(s){let o=new Set,a=-1,l=-1,c=0;for(c;c<s.length;c++){let d=s.charCodeAt(c);if(l===-1&&t[d]===1)a===-1&&(a=c);else if(c!==0&&(d===32||d===9))l===-1&&a!==-1&&(l=c);else if(d===44){if(a===-1)throw new SyntaxError(`Unexpected character at index ${c}`);l===-1&&(l=c);let h=s.slice(a,l);if(o.has(h))throw new SyntaxError(`The "${h}" subprotocol is duplicated`);o.add(h),a=l=-1}else throw new SyntaxError(`Unexpected character at index ${c}`)}if(a===-1||l!==-1)throw new SyntaxError("Unexpected end of input");let u=s.slice(a,c);if(o.has(u))throw new SyntaxError(`The "${u}" subprotocol is duplicated`);return o.add(u),o}e.exports={parse:n}}),MI=ee((r,e)=>{"use strict";var t=require("events"),n=require("http"),s=require("https"),o=require("net"),a=require("tls"),{createHash:l}=require("crypto"),c=uy(),u=rl(),d=RI(),h=dy(),{GUID:p,kWebSocket:f}=Jr(),_=/^[+/0-9A-Za-z]{22}==$/,v=0,w=1,m=2,g=class extends t{constructor(E,C){if(super(),E={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,...E},E.port==null&&!E.server&&!E.noServer||E.port!=null&&(E.server||E.noServer)||E.server&&E.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(E.port!=null?(this._server=n.createServer((k,F)=>{let O=n.STATUS_CODES[426];F.writeHead(426,{"Content-Length":O.length,"Content-Type":"text/plain"}),F.end(O)}),this._server.listen(E.port,E.host,E.backlog,C)):E.server&&(this._server=E.server),this._server){let k=this.emit.bind(this,"connection");this._removeListeners=x(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(F,O,I)=>{this.handleUpgrade(F,O,I,k)}})}E.perMessageDeflate===!0&&(E.perMessageDeflate={}),E.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=E,this._state=v}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(E){if(this._state===m){E&&this.once("close",()=>{E(new Error("The server is not running"))}),process.nextTick(b,this);return}if(E&&this.once("close",E),this._state!==w)if(this._state=w,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(b,this):process.nextTick(b,this);else{let C=this._server;this._removeListeners(),this._removeListeners=this._server=null,C.close(()=>{b(this)})}}shouldHandle(E){if(this.options.path){let C=E.url.indexOf("?");if((C!==-1?E.url.slice(0,C):E.url)!==this.options.path)return!1}return!0}handleUpgrade(E,C,k,F){C.on("error",y);let O=E.headers["sec-websocket-key"]!==void 0?E.headers["sec-websocket-key"]:!1,I=+E.headers["sec-websocket-version"];if(E.method!=="GET"||E.headers.upgrade.toLowerCase()!=="websocket"||!O||!_.test(O)||I!==8&&I!==13||!this.shouldHandle(E))return S(C,400);let P=E.headers["sec-websocket-protocol"],T=new Set;if(P!==void 0)try{T=d.parse(P)}catch{return S(C,400)}let A=E.headers["sec-websocket-extensions"],R={};if(this.options.perMessageDeflate&&A!==void 0){let V=new u(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let J=c.parse(A);J[u.extensionName]&&(V.accept(J[u.extensionName]),R[u.extensionName]=V)}catch{return S(C,400)}}if(this.options.verifyClient){let V={origin:E.headers[`${I===8?"sec-websocket-origin":"origin"}`],secure:!!(E.socket.authorized||E.socket.encrypted),req:E};if(this.options.verifyClient.length===2){this.options.verifyClient(V,(J,q,U,Y)=>{if(!J)return S(C,q||401,U,Y);this.completeUpgrade(R,O,T,E,C,k,F)});return}if(!this.options.verifyClient(V))return S(C,401)}this.completeUpgrade(R,O,T,E,C,k,F)}completeUpgrade(E,C,k,F,O,I,P){if(!O.readable||!O.writable)return O.destroy();if(O[f])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>v)return S(O,503);let T=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${l("sha1").update(C+p).digest("base64")}`],A=new h(null);if(k.size){let R=this.options.handleProtocols?this.options.handleProtocols(k,F):k.values().next().value;R&&(T.push(`Sec-WebSocket-Protocol: ${R}`),A._protocol=R)}if(E[u.extensionName]){let R=E[u.extensionName].params,V=c.format({[u.extensionName]:[R]});T.push(`Sec-WebSocket-Extensions: ${V}`),A._extensions=E}this.emit("headers",T,F),O.write(T.concat(`\r
`).join(`\r
`)),O.removeListener("error",y),A.setSocket(O,I,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(A),A.on("close",()=>{this.clients.delete(A),this._shouldEmitClose&&!this.clients.size&&process.nextTick(b,this)})),P(A,F)}};e.exports=g;function x(E,C){for(let k of Object.keys(C))E.on(k,C[k]);return function(){for(let k of Object.keys(C))E.removeListener(k,C[k])}}function b(E){E._state=m,E.emit("close")}function y(){this.destroy()}function S(E,C,k,F){E.writable&&(k=k||n.STATUS_CODES[C],F={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(k),...F},E.write(`HTTP/1.1 ${C} ${n.STATUS_CODES[C]}\r
`+Object.keys(F).map(O=>`${O}: ${F[O]}`).join(`\r
`)+`\r
\r
`+k)),E.removeListener("error",y),E.destroy()}}),FI=ee((r,e)=>{var t=require("constants"),n=process.cwd,s=null,o=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return s||(s=n.call(process)),s};try{process.cwd()}catch{}typeof process.chdir=="function"&&(a=process.chdir,process.chdir=function(c){s=null,a.call(process,c)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,a));var a;e.exports=l;function l(c){t.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&u(c),c.lutimes||d(c),c.chown=f(c.chown),c.fchown=f(c.fchown),c.lchown=f(c.lchown),c.chmod=h(c.chmod),c.fchmod=h(c.fchmod),c.lchmod=h(c.lchmod),c.chownSync=_(c.chownSync),c.fchownSync=_(c.fchownSync),c.lchownSync=_(c.lchownSync),c.chmodSync=p(c.chmodSync),c.fchmodSync=p(c.fchmodSync),c.lchmodSync=p(c.lchmodSync),c.stat=v(c.stat),c.fstat=v(c.fstat),c.lstat=v(c.lstat),c.statSync=w(c.statSync),c.fstatSync=w(c.fstatSync),c.lstatSync=w(c.lstatSync),c.chmod&&!c.lchmod&&(c.lchmod=function(g,x,b){b&&process.nextTick(b)},c.lchmodSync=function(){}),c.chown&&!c.lchown&&(c.lchown=function(g,x,b,y){y&&process.nextTick(y)},c.lchownSync=function(){}),o==="win32"&&(c.rename=typeof c.rename!="function"?c.rename:function(g){function x(b,y,S){var E=Date.now(),C=0;g(b,y,function k(F){if(F&&(F.code==="EACCES"||F.code==="EPERM")&&Date.now()-E<6e4){setTimeout(function(){c.stat(y,function(O,I){O&&O.code==="ENOENT"?g(b,y,k):S(F)})},C),C<100&&(C+=10);return}S&&S(F)})}return Object.setPrototypeOf&&Object.setPrototypeOf(x,g),x}(c.rename)),c.read=typeof c.read!="function"?c.read:function(g){function x(b,y,S,E,C,k){var F;if(k&&typeof k=="function"){var O=0;F=function(I,P,T){if(I&&I.code==="EAGAIN"&&O<10)return O++,g.call(c,b,y,S,E,C,F);k.apply(this,arguments)}}return g.call(c,b,y,S,E,C,F)}return Object.setPrototypeOf&&Object.setPrototypeOf(x,g),x}(c.read),c.readSync=typeof c.readSync!="function"?c.readSync:function(g){return function(x,b,y,S,E){for(var C=0;;)try{return g.call(c,x,b,y,S,E)}catch(k){if(k.code==="EAGAIN"&&C<10){C++;continue}throw k}}}(c.readSync);function u(g){g.lchmod=function(x,b,y){g.open(x,t.O_WRONLY|t.O_SYMLINK,b,function(S,E){if(S){y&&y(S);return}g.fchmod(E,b,function(C){g.close(E,function(k){y&&y(C||k)})})})},g.lchmodSync=function(x,b){var y=g.openSync(x,t.O_WRONLY|t.O_SYMLINK,b),S=!0,E;try{E=g.fchmodSync(y,b),S=!1}finally{if(S)try{g.closeSync(y)}catch{}else g.closeSync(y)}return E}}function d(g){t.hasOwnProperty("O_SYMLINK")&&g.futimes?(g.lutimes=function(x,b,y,S){g.open(x,t.O_SYMLINK,function(E,C){if(E){S&&S(E);return}g.futimes(C,b,y,function(k){g.close(C,function(F){S&&S(k||F)})})})},g.lutimesSync=function(x,b,y){var S=g.openSync(x,t.O_SYMLINK),E,C=!0;try{E=g.futimesSync(S,b,y),C=!1}finally{if(C)try{g.closeSync(S)}catch{}else g.closeSync(S)}return E}):g.futimes&&(g.lutimes=function(x,b,y,S){S&&process.nextTick(S)},g.lutimesSync=function(){})}function h(g){return g&&function(x,b,y){return g.call(c,x,b,function(S){m(S)&&(S=null),y&&y.apply(this,arguments)})}}function p(g){return g&&function(x,b){try{return g.call(c,x,b)}catch(y){if(!m(y))throw y}}}function f(g){return g&&function(x,b,y,S){return g.call(c,x,b,y,function(E){m(E)&&(E=null),S&&S.apply(this,arguments)})}}function _(g){return g&&function(x,b,y){try{return g.call(c,x,b,y)}catch(S){if(!m(S))throw S}}}function v(g){return g&&function(x,b,y){typeof b=="function"&&(y=b,b=null);function S(E,C){C&&(C.uid<0&&(C.uid+=4294967296),C.gid<0&&(C.gid+=4294967296)),y&&y.apply(this,arguments)}return b?g.call(c,x,b,S):g.call(c,x,S)}}function w(g){return g&&function(x,b){var y=b?g.call(c,x,b):g.call(c,x);return y&&(y.uid<0&&(y.uid+=4294967296),y.gid<0&&(y.gid+=4294967296)),y}}function m(g){if(!g||g.code==="ENOSYS")return!0;var x=!process.getuid||process.getuid()!==0;return!!(x&&(g.code==="EINVAL"||g.code==="EPERM"))}}}),NI=ee((r,e)=>{var t=require("stream").Stream;e.exports=n;function n(s){return{ReadStream:o,WriteStream:a};function o(l,c){if(!(this instanceof o))return new o(l,c);t.call(this);var u=this;this.path=l,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,c=c||{};for(var d=Object.keys(c),h=0,p=d.length;h<p;h++){var f=d[h];this[f]=c[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){u._read()});return}s.open(this.path,this.flags,this.mode,function(_,v){if(_){u.emit("error",_),u.readable=!1;return}u.fd=v,u.emit("open",v),u._read()})}function a(l,c){if(!(this instanceof a))return new a(l,c);t.call(this),this.path=l,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,c=c||{};for(var u=Object.keys(c),d=0,h=u.length;d<h;d++){var p=u[d];this[p]=c[p]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=s.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}),LI=ee((r,e)=>{"use strict";e.exports=n;var t=Object.getPrototypeOf||function(s){return s.__proto__};function n(s){if(s===null||typeof s!="object")return s;if(s instanceof Object)var o={__proto__:t(s)};else var o=Object.create(null);return Object.getOwnPropertyNames(s).forEach(function(a){Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(s,a))}),o}}),DI=ee((r,e)=>{var t=require("fs"),n=FI(),s=NI(),o=LI(),a=require("util"),l,c;typeof Symbol=="function"&&typeof Symbol.for=="function"?(l=Symbol.for("graceful-fs.queue"),c=Symbol.for("graceful-fs.previous")):(l="___graceful-fs.queue",c="___graceful-fs.previous");function u(){}function d(g,x){Object.defineProperty(g,l,{get:function(){return x}})}var h=u;a.debuglog?h=a.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(h=function(){var g=a.format.apply(a,arguments);g="GFS4: "+g.split(/\n/).join(`
GFS4: `),console.error(g)}),t[l]||(p=global[l]||[],d(t,p),t.close=function(g){function x(b,y){return g.call(t,b,function(S){S||w(),typeof y=="function"&&y.apply(this,arguments)})}return Object.defineProperty(x,c,{value:g}),x}(t.close),t.closeSync=function(g){function x(b){g.apply(t,arguments),w()}return Object.defineProperty(x,c,{value:g}),x}(t.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){h(t[l]),require("assert").equal(t[l].length,0)}));var p;global[l]||d(global,t[l]),e.exports=f(o(t)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!t.__patched&&(e.exports=f(t),t.__patched=!0);function f(g){n(g),g.gracefulify=f,g.createReadStream=te,g.createWriteStream=oe;var x=g.readFile;g.readFile=b;function b(W,$,L){return typeof $=="function"&&(L=$,$=null),H(W,$,L);function H(z,K,ae,D){return x(z,K,function(j){j&&(j.code==="EMFILE"||j.code==="ENFILE")?_([H,[z,K,ae],j,D||Date.now(),Date.now()]):typeof ae=="function"&&ae.apply(this,arguments)})}}var y=g.writeFile;g.writeFile=S;function S(W,$,L,H){return typeof L=="function"&&(H=L,L=null),z(W,$,L,H);function z(K,ae,D,j,X){return y(K,ae,D,function(Z){Z&&(Z.code==="EMFILE"||Z.code==="ENFILE")?_([z,[K,ae,D,j],Z,X||Date.now(),Date.now()]):typeof j=="function"&&j.apply(this,arguments)})}}var E=g.appendFile;E&&(g.appendFile=C);function C(W,$,L,H){return typeof L=="function"&&(H=L,L=null),z(W,$,L,H);function z(K,ae,D,j,X){return E(K,ae,D,function(Z){Z&&(Z.code==="EMFILE"||Z.code==="ENFILE")?_([z,[K,ae,D,j],Z,X||Date.now(),Date.now()]):typeof j=="function"&&j.apply(this,arguments)})}}var k=g.copyFile;k&&(g.copyFile=F);function F(W,$,L,H){return typeof L=="function"&&(H=L,L=0),z(W,$,L,H);function z(K,ae,D,j,X){return k(K,ae,D,function(Z){Z&&(Z.code==="EMFILE"||Z.code==="ENFILE")?_([z,[K,ae,D,j],Z,X||Date.now(),Date.now()]):typeof j=="function"&&j.apply(this,arguments)})}}var O=g.readdir;g.readdir=P;var I=/^v[0-5]\./;function P(W,$,L){typeof $=="function"&&(L=$,$=null);var H=I.test(process.version)?function(K,ae,D,j){return O(K,z(K,ae,D,j))}:function(K,ae,D,j){return O(K,ae,z(K,ae,D,j))};return H(W,$,L);function z(K,ae,D,j){return function(X,Z){X&&(X.code==="EMFILE"||X.code==="ENFILE")?_([H,[K,ae,D],X,j||Date.now(),Date.now()]):(Z&&Z.sort&&Z.sort(),typeof D=="function"&&D.call(this,X,Z))}}}if(process.version.substr(0,4)==="v0.8"){var T=s(g);q=T.ReadStream,Y=T.WriteStream}var A=g.ReadStream;A&&(q.prototype=Object.create(A.prototype),q.prototype.open=U);var R=g.WriteStream;R&&(Y.prototype=Object.create(R.prototype),Y.prototype.open=Q),Object.defineProperty(g,"ReadStream",{get:function(){return q},set:function(W){q=W},enumerable:!0,configurable:!0}),Object.defineProperty(g,"WriteStream",{get:function(){return Y},set:function(W){Y=W},enumerable:!0,configurable:!0});var V=q;Object.defineProperty(g,"FileReadStream",{get:function(){return V},set:function(W){V=W},enumerable:!0,configurable:!0});var J=Y;Object.defineProperty(g,"FileWriteStream",{get:function(){return J},set:function(W){J=W},enumerable:!0,configurable:!0});function q(W,$){return this instanceof q?(A.apply(this,arguments),this):q.apply(Object.create(q.prototype),arguments)}function U(){var W=this;B(W.path,W.flags,W.mode,function($,L){$?(W.autoClose&&W.destroy(),W.emit("error",$)):(W.fd=L,W.emit("open",L),W.read())})}function Y(W,$){return this instanceof Y?(R.apply(this,arguments),this):Y.apply(Object.create(Y.prototype),arguments)}function Q(){var W=this;B(W.path,W.flags,W.mode,function($,L){$?(W.destroy(),W.emit("error",$)):(W.fd=L,W.emit("open",L))})}function te(W,$){return new g.ReadStream(W,$)}function oe(W,$){return new g.WriteStream(W,$)}var N=g.open;g.open=B;function B(W,$,L,H){return typeof L=="function"&&(H=L,L=null),z(W,$,L,H);function z(K,ae,D,j,X){return N(K,ae,D,function(Z,se){Z&&(Z.code==="EMFILE"||Z.code==="ENFILE")?_([z,[K,ae,D,j],Z,X||Date.now(),Date.now()]):typeof j=="function"&&j.apply(this,arguments)})}}return g}function _(g){h("ENQUEUE",g[0].name,g[1]),t[l].push(g),m()}var v;function w(){for(var g=Date.now(),x=0;x<t[l].length;++x)t[l][x].length>2&&(t[l][x][3]=g,t[l][x][4]=g);m()}function m(){if(clearTimeout(v),v=void 0,t[l].length!==0){var g=t[l].shift(),x=g[0],b=g[1],y=g[2],S=g[3],E=g[4];if(S===void 0)h("RETRY",x.name,b),x.apply(null,b);else if(Date.now()-S>=6e4){h("TIMEOUT",x.name,b);var C=b.pop();typeof C=="function"&&C.call(null,y)}else{var k=Date.now()-E,F=Math.max(E-S,1),O=Math.min(F*1.2,100);k>=O?(h("RETRY",x.name,b),x.apply(null,b.concat([S]))):t[l].push(g)}v===void 0&&(v=setTimeout(m,0))}}}),BI=ee((r,e)=>{function t(n,s){typeof s=="boolean"&&(s={forever:s}),this._originalTimeouts=JSON.parse(JSON.stringify(n)),this._timeouts=n,this._options=s||{},this._maxRetryTime=s&&s.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(n){if(this._timeout&&clearTimeout(this._timeout),!n)return!1;var s=new Date().getTime();if(n&&s-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(n);var o=this._timeouts.shift();if(o===void 0)if(this._cachedTimeouts)this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),o=this._timeouts.shift();else return!1;var a=this,l=setTimeout(function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout(function(){a._operationTimeoutCb(a._attempts)},a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)},o);return this._options.unref&&l.unref(),!0},t.prototype.attempt=function(n,s){this._fn=n,s&&(s.timeout&&(this._operationTimeout=s.timeout),s.cb&&(this._operationTimeoutCb=s.cb));var o=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){o._operationTimeoutCb()},o._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},t.prototype.try=function(n){console.log("Using RetryOperation.try() is deprecated"),this.attempt(n)},t.prototype.start=function(n){console.log("Using RetryOperation.start() is deprecated"),this.attempt(n)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(this._errors.length===0)return null;for(var n={},s=null,o=0,a=0;a<this._errors.length;a++){var l=this._errors[a],c=l.message,u=(n[c]||0)+1;n[c]=u,u>=o&&(s=l,o=u)}return s}}),jI=ee(r=>{var e=BI();r.operation=function(t){var n=r.timeouts(t);return new e(n,{forever:t&&t.forever,unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in t)n[s]=t[s];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],a=0;a<n.retries;a++)o.push(this.createTimeout(a,n));return t&&t.forever&&!o.length&&o.push(this.createTimeout(a,n)),o.sort(function(l,c){return l-c}),o},r.createTimeout=function(t,n){var s=n.randomize?Math.random()+1:1,o=Math.round(s*n.minTimeout*Math.pow(n.factor,t));return o=Math.min(o,n.maxTimeout),o},r.wrap=function(t,n,s){if(n instanceof Array&&(s=n,n=null),!s){s=[];for(var o in t)typeof t[o]=="function"&&s.push(o)}for(var a=0;a<s.length;a++){var l=s[a],c=t[l];t[l]=function(u){var d=r.operation(n),h=Array.prototype.slice.call(arguments,1),p=h.pop();h.push(function(f){d.retry(f)||(f&&(arguments[0]=d.mainError()),p.apply(this,arguments))}),d.attempt(function(){u.apply(t,h)})}.bind(t,c),t[l].options=n}}}),qI=ee((r,e)=>{e.exports=jI()}),HI=ee((r,e)=>{e.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],process.platform!=="win32"&&e.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),process.platform==="linux"&&e.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")}),$I=ee((r,e)=>{var t=global.process,n=function(g){return g&&typeof g=="object"&&typeof g.removeListener=="function"&&typeof g.emit=="function"&&typeof g.reallyExit=="function"&&typeof g.listeners=="function"&&typeof g.kill=="function"&&typeof g.pid=="number"&&typeof g.on=="function"};n(t)?(s=require("assert"),o=HI(),a=/^win/i.test(t.platform),l=require("events"),typeof l!="function"&&(l=l.EventEmitter),t.__signal_exit_emitter__?c=t.__signal_exit_emitter__:(c=t.__signal_exit_emitter__=new l,c.count=0,c.emitted={}),c.infinite||(c.setMaxListeners(1/0),c.infinite=!0),e.exports=function(g,x){if(!n(global.process))return function(){};s.equal(typeof g,"function","a callback must be provided for exit handler"),p===!1&&f();var b="exit";x&&x.alwaysLast&&(b="afterexit");var y=function(){c.removeListener(b,g),c.listeners("exit").length===0&&c.listeners("afterexit").length===0&&u()};return c.on(b,g),y},u=function(){!p||!n(global.process)||(p=!1,o.forEach(function(g){try{t.removeListener(g,h[g])}catch{}}),t.emit=w,t.reallyExit=_,c.count-=1)},e.exports.unload=u,d=function(g,x,b){c.emitted[g]||(c.emitted[g]=!0,c.emit(g,x,b))},h={},o.forEach(function(g){h[g]=function(){if(n(global.process)){var x=t.listeners(g);x.length===c.count&&(u(),d("exit",null,g),d("afterexit",null,g),a&&g==="SIGHUP"&&(g="SIGINT"),t.kill(t.pid,g))}}}),e.exports.signals=function(){return o},p=!1,f=function(){p||!n(global.process)||(p=!0,c.count+=1,o=o.filter(function(g){try{return t.on(g,h[g]),!0}catch{return!1}}),t.emit=m,t.reallyExit=v)},e.exports.load=f,_=t.reallyExit,v=function(g){n(global.process)&&(t.exitCode=g||0,d("exit",t.exitCode,null),d("afterexit",t.exitCode,null),_.call(t,t.exitCode))},w=t.emit,m=function(g,x){if(g==="exit"&&n(global.process)){x!==void 0&&(t.exitCode=x);var b=w.apply(this,arguments);return d("exit",t.exitCode,null),d("afterexit",t.exitCode,null),b}else return w.apply(this,arguments)}):e.exports=function(){return function(){}};var s,o,a,l,c,u,d,h,p,f,_,v,w,m}),WI=ee((r,e)=>{"use strict";var t=require("path"),n=DI(),s=qI(),o=$I(),a={},l=Symbol();function c(S,E,C){let k=E[l];if(k)return E.stat(S,(O,I)=>{if(O)return C(O);C(null,I.mtime,k)});let F=new Date(Math.ceil(Date.now()/1e3)*1e3+5);E.utimes(S,F,F,O=>{if(O)return C(O);E.stat(S,(I,P)=>{if(I)return C(I);let T=P.mtime.getTime()%1e3===0?"s":"ms";Object.defineProperty(E,l,{value:T}),C(null,P.mtime,T)})})}function u(S){let E=Date.now();return S==="s"&&(E=Math.ceil(E/1e3)*1e3),new Date(E)}function d(S,E){return E.lockfilePath||`${S}.lock`}function h(S,E,C){if(!E.realpath)return C(null,t.resolve(S));E.fs.realpath(S,C)}function p(S,E,C){let k=d(S,E);E.fs.mkdir(k,F=>{if(!F)return c(k,E.fs,(O,I,P)=>{if(O)return E.fs.rmdir(k,()=>{}),C(O);C(null,I,P)});if(F.code!=="EEXIST")return C(F);if(E.stale<=0)return C(Object.assign(new Error("Lock file is already being held"),{code:"ELOCKED",file:S}));E.fs.stat(k,(O,I)=>{if(O)return O.code==="ENOENT"?p(S,{...E,stale:0},C):C(O);if(!f(I,E))return C(Object.assign(new Error("Lock file is already being held"),{code:"ELOCKED",file:S}));_(S,E,P=>{if(P)return C(P);p(S,{...E,stale:0},C)})})})}function f(S,E){return S.mtime.getTime()<Date.now()-E.stale}function _(S,E,C){E.fs.rmdir(d(S,E),k=>{if(k&&k.code!=="ENOENT")return C(k);C()})}function v(S,E){let C=a[S];C.updateTimeout||(C.updateDelay=C.updateDelay||E.update,C.updateTimeout=setTimeout(()=>{C.updateTimeout=null,E.fs.stat(C.lockfilePath,(k,F)=>{let O=C.lastUpdate+E.stale<Date.now();if(k)return k.code==="ENOENT"||O?w(S,C,Object.assign(k,{code:"ECOMPROMISED"})):(C.updateDelay=1e3,v(S,E));if(C.mtime.getTime()!==F.mtime.getTime())return w(S,C,Object.assign(new Error("Unable to update lock within the stale threshold"),{code:"ECOMPROMISED"}));let I=u(C.mtimePrecision);E.fs.utimes(C.lockfilePath,I,I,P=>{let T=C.lastUpdate+E.stale<Date.now();if(!C.released){if(P)return P.code==="ENOENT"||T?w(S,C,Object.assign(P,{code:"ECOMPROMISED"})):(C.updateDelay=1e3,v(S,E));C.mtime=I,C.lastUpdate=Date.now(),C.updateDelay=null,v(S,E)}})})},C.updateDelay),C.updateTimeout.unref&&C.updateTimeout.unref())}function w(S,E,C){E.released=!0,E.updateTimeout&&clearTimeout(E.updateTimeout),a[S]===E&&delete a[S],E.options.onCompromised(C)}function m(S,E,C){E={stale:1e4,update:null,realpath:!0,retries:0,fs:n,onCompromised:k=>{throw k},...E},E.retries=E.retries||0,E.retries=typeof E.retries=="number"?{retries:E.retries}:E.retries,E.stale=Math.max(E.stale||0,2e3),E.update=E.update==null?E.stale/2:E.update||0,E.update=Math.max(Math.min(E.update,E.stale/2),1e3),h(S,E,(k,F)=>{if(k)return C(k);let O=s.operation(E.retries);O.attempt(()=>{p(F,E,(I,P,T)=>{if(O.retry(I))return;if(I)return C(O.mainError());let A=a[F]={lockfilePath:d(F,E),mtime:P,mtimePrecision:T,options:E,lastUpdate:Date.now()};v(F,E),C(null,R=>{if(A.released)return R&&R(Object.assign(new Error("Lock is already released"),{code:"ERELEASED"}));g(F,{...E,realpath:!1},R)})})})})}function g(S,E,C){E={fs:n,realpath:!0,...E},h(S,E,(k,F)=>{if(k)return C(k);let O=a[F];if(!O)return C(Object.assign(new Error("Lock is not acquired/owned by you"),{code:"ENOTACQUIRED"}));O.updateTimeout&&clearTimeout(O.updateTimeout),O.released=!0,delete a[F],_(F,E,C)})}function x(S){return(...E)=>new Promise((C,k)=>{E.push((F,O)=>{F?k(F):C(O)}),S(...E)})}var b=!1;function y(){b||(b=!0,o(()=>{for(let S in a){let E=a[S].options;try{E.fs.rmdirSync(d(S,E))}catch{}}}))}e.exports.lock=async(S,E)=>{y();let C=await x(m)(S,E);return x(C)}}),hy={};vA(hy,{HttpsProxyAgent:()=>GI.HttpsProxyAgent,PNG:()=>QI.PNG,SocksProxyAgent:()=>t2.SocksProxyAgent,StackUtils:()=>_2,colors:()=>l2,debug:()=>c2,getProxyForUrl:()=>VI.getProxyForUrl,jpegjs:()=>u2,lockfile:()=>h2,mime:()=>p2,minimatch:()=>f2,open:()=>m2,program:()=>ZI.program,progress:()=>g2,ws:()=>w2,wsReceiver:()=>b2,wsSender:()=>y2,wsServer:()=>v2});py.exports=bA(hy);var UI=ct(IA()),zI=ct(co()),VI=ct(DA()),GI=ct(HA()),KI=ct(UA()),JI=ct(KA()),XI=ct(QA()),YI=ct(tI()),QI=ct(hI()),ZI=ct(mI()),e2=ct(_I()),t2=ct(CI()),n2=ct(OI()),$U=ct(PI(),1),r2=ct(ly(),1),i2=ct(cy(),1),s2=ct(dy(),1),o2=ct(MI(),1),a2=s2.default,l2=UI.default,c2=zI.default,u2=KI.default,d2=WI(),h2=d2,p2=JI.default,f2=XI.default,m2=YI.default,g2=e2.default,_2=n2.default,w2=a2,v2=o2.default,b2=r2.default,y2=i2.default;});var Be=M(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.minimatch=Se.mime=Se.lockfile=Se.jpegjs=Se.getProxyForUrl=Se.debug=Se.colors=Se.SocksProxyAgent=Se.PNG=Se.HttpsProxyAgent=void 0;Se.ms=O2;Se.open=void 0;Se.parseStackTraceLine=T2;Se.wsServer=Se.wsSender=Se.wsReceiver=Se.ws=Se.progress=Se.program=void 0;var x2=fy(require("url")),S2=fy(require("path"));function fy(r){return r&&r.__esModule?r:{default:r}}var az=Se.colors=it().colors,lz=Se.debug=it().debug,cz=Se.getProxyForUrl=it().getProxyForUrl,uz=Se.HttpsProxyAgent=it().HttpsProxyAgent,dz=Se.jpegjs=it().jpegjs,hz=Se.lockfile=it().lockfile,pz=Se.mime=it().mime,fz=Se.minimatch=it().minimatch,mz=Se.open=it().open,gz=Se.PNG=it().PNG,_z=Se.program=it().program,wz=Se.progress=it().progress,vz=Se.SocksProxyAgent=it().SocksProxyAgent,bz=Se.ws=it().ws,yz=Se.wsServer=it().wsServer,xz=Se.wsReceiver=it().wsReceiver,Sz=Se.wsSender=it().wsSender,ap=it().StackUtils,E2=new ap({internals:ap.nodeInternals()}),k2=ap.nodeInternals(),C2=+process.versions.node.split(".")[0];function T2(r){var e,t;if(!process.env.PWDEBUGIMPL&&C2<16&&k2.some(o=>o.test(r)))return null;let n=E2.parseLine(r);return!n||!process.env.PWDEBUGIMPL&&((e=n.file)!==null&&e!==void 0&&e.startsWith("internal")||(t=n.file)!==null&&t!==void 0&&t.startsWith("node:"))||!n.file?null:{file:n.file.startsWith("file://")?x2.default.fileURLToPath(n.file):S2.default.resolve(process.cwd(),n.file),line:n.line||0,column:n.column||0,function:n.function}}function O2(r){if(!isFinite(r))return"-";if(r===0)return"0ms";if(r<1e3)return r.toFixed(0)+"ms";let e=r/1e3;if(e<60)return e.toFixed(1)+"s";let t=e/60;if(t<60)return t.toFixed(1)+"m";let n=t/60;return n<24?n.toFixed(1)+"h":(n/24).toFixed(1)+"d"}});var Ht=M(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.cssEscape=my;kt.escapeForAttributeSelector=B2;kt.escapeForTextSelector=D2;kt.escapeRegExp=q2;kt.escapeWithQuotes=P2;kt.isString=A2;kt.normalizeEscapedRegexQuotes=L2;kt.normalizeWhiteSpace=N2;kt.quoteCSSAttributeValue=M2;kt.toSnakeCase=R2;kt.toTitleCase=I2;kt.trimString=_y;kt.trimStringWithEllipsis=j2;function P2(r,e="'"){let t=JSON.stringify(r),n=t.substring(1,t.length-1).replace(/\\"/g,'"');if(e==="'")return e+n.replace(/[']/g,"\\'")+e;if(e==='"')return e+n.replace(/["]/g,'\\"')+e;if(e==="`")return e+n.replace(/[`]/g,"`")+e;throw new Error("Invalid escape char")}function A2(r){return typeof r=="string"||r instanceof String}function I2(r){return r.charAt(0).toUpperCase()+r.substring(1)}function R2(r){return r.replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/([A-Z])([A-Z][a-z])/g,"$1_$2").toLowerCase()}function my(r){let e="";for(let t=0;t<r.length;t++)e+=F2(r,t);return e}function M2(r){return`"${my(r).replace(/\\ /g," ")}"`}function F2(r,e){let t=r.charCodeAt(e);return t===0?"\uFFFD":t>=1&&t<=31||t>=48&&t<=57&&(e===0||e===1&&r.charCodeAt(0)===45)?"\\"+t.toString(16)+" ":e===0&&t===45&&r.length===1?"\\"+r.charAt(e):t>=128||t===45||t===95||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122?r.charAt(e):"\\"+r.charAt(e)}function N2(r){return r.replace(/\u200b/g,"").trim().replace(/\s+/g," ")}function L2(r){return r.replace(/(^|[^\\])(\\\\)*\\(['"`])/g,"$1$2$3")}function gy(r){return r.unicode||r.unicodeSets?String(r):String(r).replace(/(^|[^\\])(\\\\)*(["'`])/g,"$1$2\\$3").replace(/>>/g,"\\>\\>")}function D2(r,e){return typeof r!="string"?gy(r):`${JSON.stringify(r)}${e?"s":"i"}`}function B2(r,e){return typeof r!="string"?gy(r):`"${r.replace(/\\/g,"\\\\").replace(/["]/g,'\\"')}"${e?"s":"i"}`}function _y(r,e,t=""){if(r.length<=e)return r;let n=[...r];return n.length>e?n.slice(0,e-t.length).join("")+t:n.join("")}function j2(r,e){return _y(r,e,"\u2026")}function q2(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}});var lp=M(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.isError=U2;rr.isLikelyNpxGlobal=void 0;rr.isObject=W2;rr.isRegExp=$2;Object.defineProperty(rr,"isString",{enumerable:!0,get:function(){return H2.isString}});var H2=Ht();function $2(r){return r instanceof RegExp||Object.prototype.toString.call(r)==="[object RegExp]"}function W2(r){return typeof r=="object"&&r!==null}function U2(r){var e;return r instanceof Error||r&&((e=Object.getPrototypeOf(r))===null||e===void 0?void 0:e.name)==="Error"}var z2=()=>process.argv.length>=2&&process.argv[1].includes("_npx");rr.isLikelyNpxGlobal=z2});var up=M(cp=>{"use strict";Object.defineProperty(cp,"__esModule",{value:!0});cp.globToRegex=V2;var wy=new Set(["$","^","+",".","*","(",")","|","\\","?","{","}","[","]"]);function V2(r){let e=["^"],t=!1;for(let n=0;n<r.length;++n){let s=r[n];if(s==="\\"&&n+1<r.length){let o=r[++n];e.push(wy.has(o)?"\\"+o:o);continue}if(s==="*"){let o=r[n-1],a=1;for(;r[n+1]==="*";)a++,n++;let l=r[n+1];a>1&&(o==="/"||o===void 0)&&(l==="/"||l===void 0)?(e.push("((?:[^/]*(?:/|$))*)"),n++):e.push("([^/]*)");continue}switch(s){case"?":e.push(".");break;case"[":e.push("[");break;case"]":e.push("]");break;case"{":t=!0,e.push("(");break;case"}":t=!1,e.push(")");break;case",":if(t){e.push("|");break}e.push("\\"+s);break;default:e.push(wy.has(s)?"\\"+s:s)}}return e.push("$"),new RegExp(e.join(""))}});var ol=M(sl=>{"use strict";Object.defineProperty(sl,"__esModule",{value:!0});sl.jsonStringifyForceASCII=K2;sl.wrapInASCIIBox=G2;function G2(r,e=0){let t=r.split(`
`),n=Math.max(...t.map(s=>s.length));return["\u2554"+"\u2550".repeat(n+e*2)+"\u2557",...t.map(s=>"\u2551"+" ".repeat(e)+s+" ".repeat(n-s.length+e)+"\u2551"),"\u255A"+"\u2550".repeat(n+e*2)+"\u255D"].join(`
`)}function K2(r){return JSON.stringify(r).replace(/[\u007f-\uffff]/g,e=>"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4))}});var mp=M(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.blendWithWhite=J2;Xr.colorDeltaE94=Y2;Xr.rgb2gray=X2;Xr.srgb2xyz=pp;Xr.xyz2lab=fp;function J2(r,e){return 255+(r-255)*e}function X2(r,e,t){return 77*r+150*e+29*t+128>>8}function Y2(r,e){let[t,n,s]=fp(pp(r)),[o,a,l]=fp(pp(e)),c=t-o,u=n-a,d=s-l,h=Math.sqrt(n**2+s**2),p=Math.sqrt(a**2+l**2),f=h-p,_=u**2+d**2-f**2;_=_<0?0:Math.sqrt(_);let v=.045,w=.015,m=1,g=1,x=1,b=1+v*h,y=1+w*h;return Math.sqrt((c/1/m)**2+(f/b/g)**2+(_/y/x)**2)}function pp(r){let e=r[0]/255,t=r[1]/255,n=r[2]/255;return e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,[e*.4124+t*.3576+n*.1805,e*.2126+t*.7152+n*.0722,e*.0193+t*.1192+n*.9505]}var dp=6*6/29/29,hp=6*6*6/29/29/29;function fp(r){let e=r[0]/.950489,t=r[1],n=r[2]/1.08884,s=e>hp?e**(1/3):e/3/dp+4/29,o=t>hp?t**(1/3):t/3/dp+4/29,a=n>hp?n**(1/3):n/3/dp+4/29,l=116*o-16,c=500*(s-o),u=200*(o-a);return[l,c,u]}});var vy=M(al=>{"use strict";Object.defineProperty(al,"__esModule",{value:!0});al.ImageChannel=void 0;var gp=mp(),_p=class r{static intoRGB(e,t,n,s={}){let{paddingSize:o=0,paddingColorOdd:a=[255,0,255],paddingColorEven:l=[0,255,0]}=s,c=e+2*o,u=t+2*o,d=new Uint8Array(c*u),h=new Uint8Array(c*u),p=new Uint8Array(c*u);for(let f=0;f<u;++f)for(let _=0;_<c;++_){let v=f*c+_;if(f>=o&&f<u-o&&_>=o&&_<c-o){let w=((f-o)*e+(_-o))*4,m=n[w+3]===255?1:n[w+3]/255;d[v]=(0,gp.blendWithWhite)(n[w],m),h[v]=(0,gp.blendWithWhite)(n[w+1],m),p[v]=(0,gp.blendWithWhite)(n[w+2],m)}else{let w=(f+_)%2===0?l:a;d[v]=w[0],h[v]=w[1],p[v]=w[2]}}return[new r(c,u,d),new r(c,u,h),new r(c,u,p)]}constructor(e,t,n){this.data=void 0,this.width=void 0,this.height=void 0,this.data=n,this.width=e,this.height=t}get(e,t){return this.data[t*this.width+e]}boundXY(e,t){return[Math.min(Math.max(e,0),this.width-1),Math.min(Math.max(t,0),this.height-1)]}};al.ImageChannel=_p});var yy=M(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.FastStats=void 0;ho.ssim=Q2;var by=2**8-1;function Q2(r,e,t,n,s){let o=r.meanC1(e,t,n,s),a=r.meanC2(e,t,n,s),l=r.varianceC1(e,t,n,s),c=r.varianceC2(e,t,n,s),u=r.covariance(e,t,n,s),d=(.01*by)**2,h=(.03*by)**2;return(2*o*a+d)*(2*u+h)/(o**2+a**2+d)/(l+c+h)}var wp=class{constructor(e,t){this.c1=void 0,this.c2=void 0,this._partialSumC1=void 0,this._partialSumC2=void 0,this._partialSumMult=void 0,this._partialSumSq1=void 0,this._partialSumSq2=void 0,this.c1=e,this.c2=t;let{width:n,height:s}=e;this._partialSumC1=new Array(n*s),this._partialSumC2=new Array(n*s),this._partialSumSq1=new Array(n*s),this._partialSumSq2=new Array(n*s),this._partialSumMult=new Array(n*s);let o=(a,l,c,u,d)=>{a[l]=c,d>0&&(a[l]+=a[(d-1)*n+u]),u>0&&(a[l]+=a[d*n+u-1]),u>0&&d>0&&(a[l]-=a[(d-1)*n+u-1])};for(let a=0;a<s;++a)for(let l=0;l<n;++l){let c=a*n+l;o(this._partialSumC1,c,this.c1.data[c],l,a),o(this._partialSumC2,c,this.c2.data[c],l,a),o(this._partialSumSq1,c,this.c1.data[c]*this.c1.data[c],l,a),o(this._partialSumSq2,c,this.c2.data[c]*this.c2.data[c],l,a),o(this._partialSumMult,c,this.c1.data[c]*this.c2.data[c],l,a)}}_sum(e,t,n,s,o){let a=this.c1.width,l=e[o*a+s];return n>0&&(l-=e[(n-1)*a+s]),t>0&&(l-=e[o*a+t-1]),t>0&&n>0&&(l+=e[(n-1)*a+t-1]),l}meanC1(e,t,n,s){let o=(s-t+1)*(n-e+1);return this._sum(this._partialSumC1,e,t,n,s)/o}meanC2(e,t,n,s){let o=(s-t+1)*(n-e+1);return this._sum(this._partialSumC2,e,t,n,s)/o}varianceC1(e,t,n,s){let o=(s-t+1)*(n-e+1);return(this._sum(this._partialSumSq1,e,t,n,s)-this._sum(this._partialSumC1,e,t,n,s)**2/o)/o}varianceC2(e,t,n,s){let o=(s-t+1)*(n-e+1);return(this._sum(this._partialSumSq2,e,t,n,s)-this._sum(this._partialSumC2,e,t,n,s)**2/o)/o}covariance(e,t,n,s){let o=(s-t+1)*(n-e+1);return(this._sum(this._partialSumMult,e,t,n,s)-this._sum(this._partialSumC1,e,t,n,s)*this._sum(this._partialSumC2,e,t,n,s)/o)/o}};ho.FastStats=wp});var Sy=M(yp=>{"use strict";Object.defineProperty(yp,"__esModule",{value:!0});yp.compare=Z2;var vp=mp(),xy=vy(),Fi=yy(),po=15,fo=1;function bp(r,e,t,n,s,o,a){let l=(n*r+t)*4;e[l+0]=s,e[l+1]=o,e[l+2]=a,e[l+3]=255}function Z2(r,e,t,n,s,o={}){let{maxColorDeltaE94:a=1}=o,l=Math.max(fo,po),c=[255,0,255],u=[0,255,0],[d,h,p]=xy.ImageChannel.intoRGB(n,s,e,{paddingSize:l,paddingColorEven:c,paddingColorOdd:u}),[f,_,v]=xy.ImageChannel.intoRGB(n,s,r,{paddingSize:l,paddingColorEven:c,paddingColorOdd:u}),w=(C,k)=>{},m=t?(C,k)=>bp(n,t,C-l,k-l,255,0,0):w,g=t?(C,k)=>bp(n,t,C-l,k-l,255,255,0):w,x=t?(C,k)=>{let F=(0,vp.rgb2gray)(d.get(C,k),h.get(C,k),p.get(C,k)),O=(0,vp.blendWithWhite)(F,.1);bp(n,t,C-l,k-l,O,O,O)}:w,b,y,S,E=0;for(let C=l;C<d.height-l;++C)for(let k=l;k<d.width-l;++k){if(d.get(k,C)===f.get(k,C)&&h.get(k,C)===_.get(k,C)&&p.get(k,C)===v.get(k,C)){x(k,C);continue}if((0,vp.colorDeltaE94)([d.get(k,C),h.get(k,C),p.get(k,C)],[f.get(k,C),_.get(k,C),v.get(k,C)])<=a){x(k,C);continue}(!b||!y||!S)&&(b=new Fi.FastStats(d,f),y=new Fi.FastStats(h,_),S=new Fi.FastStats(p,v));let[O,I]=d.boundXY(k-fo,C-fo),[P,T]=d.boundXY(k+fo,C+fo),A=b.varianceC1(O,I,P,T)+y.varianceC1(O,I,P,T)+S.varianceC1(O,I,P,T),R=b.varianceC2(O,I,P,T)+y.varianceC2(O,I,P,T)+S.varianceC2(O,I,P,T);if(A===0||R===0){m(k,C),++E;continue}let[V,J]=d.boundXY(k-po,C-po),[q,U]=d.boundXY(k+po,C+po);((0,Fi.ssim)(b,V,J,q,U)+(0,Fi.ssim)(y,V,J,q,U)+(0,Fi.ssim)(S,V,J,q,U))/3>=.99?g(k,C):(m(k,C),++E)}return E}});var Ay=M((Mz,Py)=>{"use strict";Py.exports=tR;var eR={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function tR(r,e,t,n,s,o){if(!xp(r)||!xp(e)||t&&!xp(t))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(r.length!==e.length||t&&t.length!==r.length)throw new Error("Image sizes do not match.");if(r.length!==n*s*4)throw new Error("Image data size does not match width/height.");o=Object.assign({},eR,o);let a=n*s,l=new Uint32Array(r.buffer,r.byteOffset,a),c=new Uint32Array(e.buffer,e.byteOffset,a),u=!0;for(let p=0;p<a;p++)if(l[p]!==c[p]){u=!1;break}if(u){if(t&&!o.diffMask)for(let p=0;p<a;p++)Ty(r,4*p,o.alpha,t);return 0}let d=35215*o.threshold*o.threshold,h=0;for(let p=0;p<s;p++)for(let f=0;f<n;f++){let _=(p*n+f)*4,v=Oy(r,e,_,_);Math.abs(v)>d?!o.includeAA&&(Ey(r,f,p,n,s,e)||Ey(e,f,p,n,s,r))?t&&!o.diffMask&&Ep(t,_,...o.aaColor):(t&&Ep(t,_,...v<0&&o.diffColorAlt||o.diffColor),h++):t&&(o.diffMask||Ty(r,_,o.alpha,t))}return h}function xp(r){return ArrayBuffer.isView(r)&&r.constructor.BYTES_PER_ELEMENT===1}function Ey(r,e,t,n,s,o){let a=Math.max(e-1,0),l=Math.max(t-1,0),c=Math.min(e+1,n-1),u=Math.min(t+1,s-1),d=(t*n+e)*4,h=e===a||e===c||t===l||t===u?1:0,p=0,f=0,_,v,w,m;for(let g=a;g<=c;g++)for(let x=l;x<=u;x++){if(g===e&&x===t)continue;let b=Oy(r,r,d,(x*n+g)*4,!0);if(b===0){if(h++,h>2)return!1}else b<p?(p=b,_=g,v=x):b>f&&(f=b,w=g,m=x)}return p===0||f===0?!1:ll(r,_,v,n,s)&&ll(o,_,v,n,s)||ll(r,w,m,n,s)&&ll(o,w,m,n,s)}function ll(r,e,t,n,s){let o=Math.max(e-1,0),a=Math.max(t-1,0),l=Math.min(e+1,n-1),c=Math.min(t+1,s-1),u=(t*n+e)*4,d=e===o||e===l||t===a||t===c?1:0;for(let h=o;h<=l;h++)for(let p=a;p<=c;p++){if(h===e&&p===t)continue;let f=(p*n+h)*4;if(r[u]===r[f]&&r[u+1]===r[f+1]&&r[u+2]===r[f+2]&&r[u+3]===r[f+3]&&d++,d>2)return!0}return!1}function Oy(r,e,t,n,s){let o=r[t+0],a=r[t+1],l=r[t+2],c=r[t+3],u=e[n+0],d=e[n+1],h=e[n+2],p=e[n+3];if(c===p&&o===u&&a===d&&l===h)return 0;c<255&&(c/=255,o=Yr(o,c),a=Yr(a,c),l=Yr(l,c)),p<255&&(p/=255,u=Yr(u,p),d=Yr(d,p),h=Yr(h,p));let f=Sp(o,a,l),_=Sp(u,d,h),v=f-_;if(s)return v;let w=ky(o,a,l)-ky(u,d,h),m=Cy(o,a,l)-Cy(u,d,h),g=.5053*v*v+.299*w*w+.1957*m*m;return f>_?-g:g}function Sp(r,e,t){return r*.29889531+e*.58662247+t*.11448223}function ky(r,e,t){return r*.59597799-e*.2741761-t*.32180189}function Cy(r,e,t){return r*.21147017-e*.52261711+t*.31114694}function Yr(r,e){return 255+(r-255)*e}function Ep(r,e,t,n,s){r[e+0]=t,r[e+1]=n,r[e+2]=s,r[e+3]=255}function Ty(r,e,t,n){let s=r[e+0],o=r[e+1],a=r[e+2],l=Yr(Sp(s,o,a),t*r[e+3]/255);Ep(n,e,l,l,l)}});var Ry=M((Fz,Iy)=>{var re=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},Re=-1,Ne=1,ye=0;re.Diff=function(r,e){this[0]=r,this[1]=e};re.Diff.prototype.length=2;re.Diff.prototype.toString=function(){return this[0]+","+this[1]};re.prototype.diff_main=function(r,e,t,n){typeof n>"u"&&(this.Diff_Timeout<=0?n=Number.MAX_VALUE:n=new Date().getTime()+this.Diff_Timeout*1e3);var s=n;if(r==null||e==null)throw new Error("Null input. (diff_main)");if(r==e)return r?[new re.Diff(ye,r)]:[];typeof t>"u"&&(t=!0);var o=t,a=this.diff_commonPrefix(r,e),l=r.substring(0,a);r=r.substring(a),e=e.substring(a),a=this.diff_commonSuffix(r,e);var c=r.substring(r.length-a);r=r.substring(0,r.length-a),e=e.substring(0,e.length-a);var u=this.diff_compute_(r,e,o,s);return l&&u.unshift(new re.Diff(ye,l)),c&&u.push(new re.Diff(ye,c)),this.diff_cleanupMerge(u),u};re.prototype.diff_compute_=function(r,e,t,n){var s;if(!r)return[new re.Diff(Ne,e)];if(!e)return[new re.Diff(Re,r)];var o=r.length>e.length?r:e,a=r.length>e.length?e:r,l=o.indexOf(a);if(l!=-1)return s=[new re.Diff(Ne,o.substring(0,l)),new re.Diff(ye,a),new re.Diff(Ne,o.substring(l+a.length))],r.length>e.length&&(s[0][0]=s[2][0]=Re),s;if(a.length==1)return[new re.Diff(Re,r),new re.Diff(Ne,e)];var c=this.diff_halfMatch_(r,e);if(c){var u=c[0],d=c[1],h=c[2],p=c[3],f=c[4],_=this.diff_main(u,h,t,n),v=this.diff_main(d,p,t,n);return _.concat([new re.Diff(ye,f)],v)}return t&&r.length>100&&e.length>100?this.diff_lineMode_(r,e,n):this.diff_bisect_(r,e,n)};re.prototype.diff_lineMode_=function(r,e,t){var n=this.diff_linesToChars_(r,e);r=n.chars1,e=n.chars2;var s=n.lineArray,o=this.diff_main(r,e,!1,t);this.diff_charsToLines_(o,s),this.diff_cleanupSemantic(o),o.push(new re.Diff(ye,""));for(var a=0,l=0,c=0,u="",d="";a<o.length;){switch(o[a][0]){case Ne:c++,d+=o[a][1];break;case Re:l++,u+=o[a][1];break;case ye:if(l>=1&&c>=1){o.splice(a-l-c,l+c),a=a-l-c;for(var h=this.diff_main(u,d,!1,t),p=h.length-1;p>=0;p--)o.splice(a,0,h[p]);a=a+h.length}c=0,l=0,u="",d="";break}a++}return o.pop(),o};re.prototype.diff_bisect_=function(r,e,t){for(var n=r.length,s=e.length,o=Math.ceil((n+s)/2),a=o,l=2*o,c=new Array(l),u=new Array(l),d=0;d<l;d++)c[d]=-1,u[d]=-1;c[a+1]=0,u[a+1]=0;for(var h=n-s,p=h%2!=0,f=0,_=0,v=0,w=0,m=0;m<o&&!(new Date().getTime()>t);m++){for(var g=-m+f;g<=m-_;g+=2){var x=a+g,b;g==-m||g!=m&&c[x-1]<c[x+1]?b=c[x+1]:b=c[x-1]+1;for(var y=b-g;b<n&&y<s&&r.charAt(b)==e.charAt(y);)b++,y++;if(c[x]=b,b>n)_+=2;else if(y>s)f+=2;else if(p){var S=a+h-g;if(S>=0&&S<l&&u[S]!=-1){var E=n-u[S];if(b>=E)return this.diff_bisectSplit_(r,e,b,y,t)}}}for(var C=-m+v;C<=m-w;C+=2){var S=a+C,E;C==-m||C!=m&&u[S-1]<u[S+1]?E=u[S+1]:E=u[S-1]+1;for(var k=E-C;E<n&&k<s&&r.charAt(n-E-1)==e.charAt(s-k-1);)E++,k++;if(u[S]=E,E>n)w+=2;else if(k>s)v+=2;else if(!p){var x=a+h-C;if(x>=0&&x<l&&c[x]!=-1){var b=c[x],y=a+b-x;if(E=n-E,b>=E)return this.diff_bisectSplit_(r,e,b,y,t)}}}}return[new re.Diff(Re,r),new re.Diff(Ne,e)]};re.prototype.diff_bisectSplit_=function(r,e,t,n,s){var o=r.substring(0,t),a=e.substring(0,n),l=r.substring(t),c=e.substring(n),u=this.diff_main(o,a,!1,s),d=this.diff_main(l,c,!1,s);return u.concat(d)};re.prototype.diff_linesToChars_=function(r,e){var t=[],n={};t[0]="";function s(c){for(var u="",d=0,h=-1,p=t.length;h<c.length-1;){h=c.indexOf(`
`,d),h==-1&&(h=c.length-1);var f=c.substring(d,h+1);(n.hasOwnProperty?n.hasOwnProperty(f):n[f]!==void 0)?u+=String.fromCharCode(n[f]):(p==o&&(f=c.substring(d),h=c.length),u+=String.fromCharCode(p),n[f]=p,t[p++]=f),d=h+1}return u}var o=4e4,a=s(r);o=65535;var l=s(e);return{chars1:a,chars2:l,lineArray:t}};re.prototype.diff_charsToLines_=function(r,e){for(var t=0;t<r.length;t++){for(var n=r[t][1],s=[],o=0;o<n.length;o++)s[o]=e[n.charCodeAt(o)];r[t][1]=s.join("")}};re.prototype.diff_commonPrefix=function(r,e){if(!r||!e||r.charAt(0)!=e.charAt(0))return 0;for(var t=0,n=Math.min(r.length,e.length),s=n,o=0;t<s;)r.substring(o,s)==e.substring(o,s)?(t=s,o=t):n=s,s=Math.floor((n-t)/2+t);return s};re.prototype.diff_commonSuffix=function(r,e){if(!r||!e||r.charAt(r.length-1)!=e.charAt(e.length-1))return 0;for(var t=0,n=Math.min(r.length,e.length),s=n,o=0;t<s;)r.substring(r.length-s,r.length-o)==e.substring(e.length-s,e.length-o)?(t=s,o=t):n=s,s=Math.floor((n-t)/2+t);return s};re.prototype.diff_commonOverlap_=function(r,e){var t=r.length,n=e.length;if(t==0||n==0)return 0;t>n?r=r.substring(t-n):t<n&&(e=e.substring(0,t));var s=Math.min(t,n);if(r==e)return s;for(var o=0,a=1;;){var l=r.substring(s-a),c=e.indexOf(l);if(c==-1)return o;a+=c,(c==0||r.substring(s-a)==e.substring(0,a))&&(o=a,a++)}};re.prototype.diff_halfMatch_=function(r,e){if(this.Diff_Timeout<=0)return null;var t=r.length>e.length?r:e,n=r.length>e.length?e:r;if(t.length<4||n.length*2<t.length)return null;var s=this;function o(_,v,w){for(var m=_.substring(w,w+Math.floor(_.length/4)),g=-1,x="",b,y,S,E;(g=v.indexOf(m,g+1))!=-1;){var C=s.diff_commonPrefix(_.substring(w),v.substring(g)),k=s.diff_commonSuffix(_.substring(0,w),v.substring(0,g));x.length<k+C&&(x=v.substring(g-k,g)+v.substring(g,g+C),b=_.substring(0,w-k),y=_.substring(w+C),S=v.substring(0,g-k),E=v.substring(g+C))}return x.length*2>=_.length?[b,y,S,E,x]:null}var a=o(t,n,Math.ceil(t.length/4)),l=o(t,n,Math.ceil(t.length/2)),c;if(!a&&!l)return null;l?a?c=a[4].length>l[4].length?a:l:c=l:c=a;var u,d,h,p;r.length>e.length?(u=c[0],d=c[1],h=c[2],p=c[3]):(h=c[0],p=c[1],u=c[2],d=c[3]);var f=c[4];return[u,d,h,p,f]};re.prototype.diff_cleanupSemantic=function(r){for(var e=!1,t=[],n=0,s=null,o=0,a=0,l=0,c=0,u=0;o<r.length;)r[o][0]==ye?(t[n++]=o,a=c,l=u,c=0,u=0,s=r[o][1]):(r[o][0]==Ne?c+=r[o][1].length:u+=r[o][1].length,s&&s.length<=Math.max(a,l)&&s.length<=Math.max(c,u)&&(r.splice(t[n-1],0,new re.Diff(Re,s)),r[t[n-1]+1][0]=Ne,n--,n--,o=n>0?t[n-1]:-1,a=0,l=0,c=0,u=0,s=null,e=!0)),o++;for(e&&this.diff_cleanupMerge(r),this.diff_cleanupSemanticLossless(r),o=1;o<r.length;){if(r[o-1][0]==Re&&r[o][0]==Ne){var d=r[o-1][1],h=r[o][1],p=this.diff_commonOverlap_(d,h),f=this.diff_commonOverlap_(h,d);p>=f?(p>=d.length/2||p>=h.length/2)&&(r.splice(o,0,new re.Diff(ye,h.substring(0,p))),r[o-1][1]=d.substring(0,d.length-p),r[o+1][1]=h.substring(p),o++):(f>=d.length/2||f>=h.length/2)&&(r.splice(o,0,new re.Diff(ye,d.substring(0,f))),r[o-1][0]=Ne,r[o-1][1]=h.substring(0,h.length-f),r[o+1][0]=Re,r[o+1][1]=d.substring(f),o++),o++}o++}};re.prototype.diff_cleanupSemanticLossless=function(r){function e(f,_){if(!f||!_)return 6;var v=f.charAt(f.length-1),w=_.charAt(0),m=v.match(re.nonAlphaNumericRegex_),g=w.match(re.nonAlphaNumericRegex_),x=m&&v.match(re.whitespaceRegex_),b=g&&w.match(re.whitespaceRegex_),y=x&&v.match(re.linebreakRegex_),S=b&&w.match(re.linebreakRegex_),E=y&&f.match(re.blanklineEndRegex_),C=S&&_.match(re.blanklineStartRegex_);return E||C?5:y||S?4:m&&!x&&b?3:x||b?2:m||g?1:0}for(var t=1;t<r.length-1;){if(r[t-1][0]==ye&&r[t+1][0]==ye){var n=r[t-1][1],s=r[t][1],o=r[t+1][1],a=this.diff_commonSuffix(n,s);if(a){var l=s.substring(s.length-a);n=n.substring(0,n.length-a),s=l+s.substring(0,s.length-a),o=l+o}for(var c=n,u=s,d=o,h=e(n,s)+e(s,o);s.charAt(0)===o.charAt(0);){n+=s.charAt(0),s=s.substring(1)+o.charAt(0),o=o.substring(1);var p=e(n,s)+e(s,o);p>=h&&(h=p,c=n,u=s,d=o)}r[t-1][1]!=c&&(c?r[t-1][1]=c:(r.splice(t-1,1),t--),r[t][1]=u,d?r[t+1][1]=d:(r.splice(t+1,1),t--))}t++}};re.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;re.whitespaceRegex_=/\s/;re.linebreakRegex_=/[\r\n]/;re.blanklineEndRegex_=/\n\r?\n$/;re.blanklineStartRegex_=/^\r?\n\r?\n/;re.prototype.diff_cleanupEfficiency=function(r){for(var e=!1,t=[],n=0,s=null,o=0,a=!1,l=!1,c=!1,u=!1;o<r.length;)r[o][0]==ye?(r[o][1].length<this.Diff_EditCost&&(c||u)?(t[n++]=o,a=c,l=u,s=r[o][1]):(n=0,s=null),c=u=!1):(r[o][0]==Re?u=!0:c=!0,s&&(a&&l&&c&&u||s.length<this.Diff_EditCost/2&&a+l+c+u==3)&&(r.splice(t[n-1],0,new re.Diff(Re,s)),r[t[n-1]+1][0]=Ne,n--,s=null,a&&l?(c=u=!0,n=0):(n--,o=n>0?t[n-1]:-1,c=u=!1),e=!0)),o++;e&&this.diff_cleanupMerge(r)};re.prototype.diff_cleanupMerge=function(r){r.push(new re.Diff(ye,""));for(var e=0,t=0,n=0,s="",o="",a;e<r.length;)switch(r[e][0]){case Ne:n++,o+=r[e][1],e++;break;case Re:t++,s+=r[e][1],e++;break;case ye:t+n>1?(t!==0&&n!==0&&(a=this.diff_commonPrefix(o,s),a!==0&&(e-t-n>0&&r[e-t-n-1][0]==ye?r[e-t-n-1][1]+=o.substring(0,a):(r.splice(0,0,new re.Diff(ye,o.substring(0,a))),e++),o=o.substring(a),s=s.substring(a)),a=this.diff_commonSuffix(o,s),a!==0&&(r[e][1]=o.substring(o.length-a)+r[e][1],o=o.substring(0,o.length-a),s=s.substring(0,s.length-a))),e-=t+n,r.splice(e,t+n),s.length&&(r.splice(e,0,new re.Diff(Re,s)),e++),o.length&&(r.splice(e,0,new re.Diff(Ne,o)),e++),e++):e!==0&&r[e-1][0]==ye?(r[e-1][1]+=r[e][1],r.splice(e,1)):e++,n=0,t=0,s="",o="";break}r[r.length-1][1]===""&&r.pop();var l=!1;for(e=1;e<r.length-1;)r[e-1][0]==ye&&r[e+1][0]==ye&&(r[e][1].substring(r[e][1].length-r[e-1][1].length)==r[e-1][1]?(r[e][1]=r[e-1][1]+r[e][1].substring(0,r[e][1].length-r[e-1][1].length),r[e+1][1]=r[e-1][1]+r[e+1][1],r.splice(e-1,1),l=!0):r[e][1].substring(0,r[e+1][1].length)==r[e+1][1]&&(r[e-1][1]+=r[e+1][1],r[e][1]=r[e][1].substring(r[e+1][1].length)+r[e+1][1],r.splice(e+1,1),l=!0)),e++;l&&this.diff_cleanupMerge(r)};re.prototype.diff_xIndex=function(r,e){var t=0,n=0,s=0,o=0,a;for(a=0;a<r.length&&(r[a][0]!==Ne&&(t+=r[a][1].length),r[a][0]!==Re&&(n+=r[a][1].length),!(t>e));a++)s=t,o=n;return r.length!=a&&r[a][0]===Re?o:o+(e-s)};re.prototype.diff_prettyHtml=function(r){for(var e=[],t=/&/g,n=/</g,s=/>/g,o=/\n/g,a=0;a<r.length;a++){var l=r[a][0],c=r[a][1],u=c.replace(t,"&amp;").replace(n,"&lt;").replace(s,"&gt;").replace(o,"&para;<br>");switch(l){case Ne:e[a]='<ins style="background:#e6ffe6;">'+u+"</ins>";break;case Re:e[a]='<del style="background:#ffe6e6;">'+u+"</del>";break;case ye:e[a]="<span>"+u+"</span>";break}}return e.join("")};re.prototype.diff_text1=function(r){for(var e=[],t=0;t<r.length;t++)r[t][0]!==Ne&&(e[t]=r[t][1]);return e.join("")};re.prototype.diff_text2=function(r){for(var e=[],t=0;t<r.length;t++)r[t][0]!==Re&&(e[t]=r[t][1]);return e.join("")};re.prototype.diff_levenshtein=function(r){for(var e=0,t=0,n=0,s=0;s<r.length;s++){var o=r[s][0],a=r[s][1];switch(o){case Ne:t+=a.length;break;case Re:n+=a.length;break;case ye:e+=Math.max(t,n),t=0,n=0;break}}return e+=Math.max(t,n),e};re.prototype.diff_toDelta=function(r){for(var e=[],t=0;t<r.length;t++)switch(r[t][0]){case Ne:e[t]="+"+encodeURI(r[t][1]);break;case Re:e[t]="-"+r[t][1].length;break;case ye:e[t]="="+r[t][1].length;break}return e.join("	").replace(/%20/g," ")};re.prototype.diff_fromDelta=function(r,e){for(var t=[],n=0,s=0,o=e.split(/\t/g),a=0;a<o.length;a++){var l=o[a].substring(1);switch(o[a].charAt(0)){case"+":try{t[n++]=new re.Diff(Ne,decodeURI(l))}catch{throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var c=parseInt(l,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+l);var u=r.substring(s,s+=c);o[a].charAt(0)=="="?t[n++]=new re.Diff(ye,u):t[n++]=new re.Diff(Re,u);break;default:if(o[a])throw new Error("Invalid diff operation in diff_fromDelta: "+o[a])}}if(s!=r.length)throw new Error("Delta length ("+s+") does not equal source text length ("+r.length+").");return t};re.prototype.match_main=function(r,e,t){if(r==null||e==null||t==null)throw new Error("Null input. (match_main)");return t=Math.max(0,Math.min(t,r.length)),r==e?0:r.length?r.substring(t,t+e.length)==e?t:this.match_bitap_(r,e,t):-1};re.prototype.match_bitap_=function(r,e,t){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var n=this.match_alphabet_(e),s=this;function o(b,y){var S=b/e.length,E=Math.abs(t-y);return s.Match_Distance?S+E/s.Match_Distance:E?1:S}var a=this.Match_Threshold,l=r.indexOf(e,t);l!=-1&&(a=Math.min(o(0,l),a),l=r.lastIndexOf(e,t+e.length),l!=-1&&(a=Math.min(o(0,l),a)));var c=1<<e.length-1;l=-1;for(var u,d,h=e.length+r.length,p,f=0;f<e.length;f++){for(u=0,d=h;u<d;)o(f,t+d)<=a?u=d:h=d,d=Math.floor((h-u)/2+u);h=d;var _=Math.max(1,t-d+1),v=Math.min(t+d,r.length)+e.length,w=Array(v+2);w[v+1]=(1<<f)-1;for(var m=v;m>=_;m--){var g=n[r.charAt(m-1)];if(f===0?w[m]=(w[m+1]<<1|1)&g:w[m]=(w[m+1]<<1|1)&g|((p[m+1]|p[m])<<1|1)|p[m+1],w[m]&c){var x=o(f,m-1);if(x<=a)if(a=x,l=m-1,l>t)_=Math.max(1,2*t-l);else break}}if(o(f+1,t)>a)break;p=w}return l};re.prototype.match_alphabet_=function(r){for(var e={},t=0;t<r.length;t++)e[r.charAt(t)]=0;for(var t=0;t<r.length;t++)e[r.charAt(t)]|=1<<r.length-t-1;return e};re.prototype.patch_addContext_=function(r,e){if(e.length!=0){if(r.start2===null)throw Error("patch not initialized");for(var t=e.substring(r.start2,r.start2+r.length1),n=0;e.indexOf(t)!=e.lastIndexOf(t)&&t.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,t=e.substring(r.start2-n,r.start2+r.length1+n);n+=this.Patch_Margin;var s=e.substring(r.start2-n,r.start2);s&&r.diffs.unshift(new re.Diff(ye,s));var o=e.substring(r.start2+r.length1,r.start2+r.length1+n);o&&r.diffs.push(new re.Diff(ye,o)),r.start1-=s.length,r.start2-=s.length,r.length1+=s.length+o.length,r.length2+=s.length+o.length}};re.prototype.patch_make=function(r,e,t){var n,s;if(typeof r=="string"&&typeof e=="string"&&typeof t>"u")n=r,s=this.diff_main(n,e,!0),s.length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(r&&typeof r=="object"&&typeof e>"u"&&typeof t>"u")s=r,n=this.diff_text1(s);else if(typeof r=="string"&&e&&typeof e=="object"&&typeof t>"u")n=r,s=e;else if(typeof r=="string"&&typeof e=="string"&&t&&typeof t=="object")n=r,s=t;else throw new Error("Unknown call format to patch_make.");if(s.length===0)return[];for(var o=[],a=new re.patch_obj,l=0,c=0,u=0,d=n,h=n,p=0;p<s.length;p++){var f=s[p][0],_=s[p][1];switch(!l&&f!==ye&&(a.start1=c,a.start2=u),f){case Ne:a.diffs[l++]=s[p],a.length2+=_.length,h=h.substring(0,u)+_+h.substring(u);break;case Re:a.length1+=_.length,a.diffs[l++]=s[p],h=h.substring(0,u)+h.substring(u+_.length);break;case ye:_.length<=2*this.Patch_Margin&&l&&s.length!=p+1?(a.diffs[l++]=s[p],a.length1+=_.length,a.length2+=_.length):_.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,d),o.push(a),a=new re.patch_obj,l=0,d=h,c=u);break}f!==Ne&&(c+=_.length),f!==Re&&(u+=_.length)}return l&&(this.patch_addContext_(a,d),o.push(a)),o};re.prototype.patch_deepCopy=function(r){for(var e=[],t=0;t<r.length;t++){var n=r[t],s=new re.patch_obj;s.diffs=[];for(var o=0;o<n.diffs.length;o++)s.diffs[o]=new re.Diff(n.diffs[o][0],n.diffs[o][1]);s.start1=n.start1,s.start2=n.start2,s.length1=n.length1,s.length2=n.length2,e[t]=s}return e};re.prototype.patch_apply=function(r,e){if(r.length==0)return[e,[]];r=this.patch_deepCopy(r);var t=this.patch_addPadding(r);e=t+e+t,this.patch_splitMax(r);for(var n=0,s=[],o=0;o<r.length;o++){var a=r[o].start2+n,l=this.diff_text1(r[o].diffs),c,u=-1;if(l.length>this.Match_MaxBits?(c=this.match_main(e,l.substring(0,this.Match_MaxBits),a),c!=-1&&(u=this.match_main(e,l.substring(l.length-this.Match_MaxBits),a+l.length-this.Match_MaxBits),(u==-1||c>=u)&&(c=-1))):c=this.match_main(e,l,a),c==-1)s[o]=!1,n-=r[o].length2-r[o].length1;else{s[o]=!0,n=c-a;var d;if(u==-1?d=e.substring(c,c+l.length):d=e.substring(c,u+this.Match_MaxBits),l==d)e=e.substring(0,c)+this.diff_text2(r[o].diffs)+e.substring(c+l.length);else{var h=this.diff_main(l,d,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(h)/l.length>this.Patch_DeleteThreshold)s[o]=!1;else{this.diff_cleanupSemanticLossless(h);for(var p=0,f,_=0;_<r[o].diffs.length;_++){var v=r[o].diffs[_];v[0]!==ye&&(f=this.diff_xIndex(h,p)),v[0]===Ne?e=e.substring(0,c+f)+v[1]+e.substring(c+f):v[0]===Re&&(e=e.substring(0,c+f)+e.substring(c+this.diff_xIndex(h,p+v[1].length))),v[0]!==Re&&(p+=v[1].length)}}}}}return e=e.substring(t.length,e.length-t.length),[e,s]};re.prototype.patch_addPadding=function(r){for(var e=this.Patch_Margin,t="",n=1;n<=e;n++)t+=String.fromCharCode(n);for(var n=0;n<r.length;n++)r[n].start1+=e,r[n].start2+=e;var s=r[0],o=s.diffs;if(o.length==0||o[0][0]!=ye)o.unshift(new re.Diff(ye,t)),s.start1-=e,s.start2-=e,s.length1+=e,s.length2+=e;else if(e>o[0][1].length){var a=e-o[0][1].length;o[0][1]=t.substring(o[0][1].length)+o[0][1],s.start1-=a,s.start2-=a,s.length1+=a,s.length2+=a}if(s=r[r.length-1],o=s.diffs,o.length==0||o[o.length-1][0]!=ye)o.push(new re.Diff(ye,t)),s.length1+=e,s.length2+=e;else if(e>o[o.length-1][1].length){var a=e-o[o.length-1][1].length;o[o.length-1][1]+=t.substring(0,a),s.length1+=a,s.length2+=a}return t};re.prototype.patch_splitMax=function(r){for(var e=this.Match_MaxBits,t=0;t<r.length;t++)if(!(r[t].length1<=e)){var n=r[t];r.splice(t--,1);for(var s=n.start1,o=n.start2,a="";n.diffs.length!==0;){var l=new re.patch_obj,c=!0;for(l.start1=s-a.length,l.start2=o-a.length,a!==""&&(l.length1=l.length2=a.length,l.diffs.push(new re.Diff(ye,a)));n.diffs.length!==0&&l.length1<e-this.Patch_Margin;){var u=n.diffs[0][0],d=n.diffs[0][1];u===Ne?(l.length2+=d.length,o+=d.length,l.diffs.push(n.diffs.shift()),c=!1):u===Re&&l.diffs.length==1&&l.diffs[0][0]==ye&&d.length>2*e?(l.length1+=d.length,s+=d.length,c=!1,l.diffs.push(new re.Diff(u,d)),n.diffs.shift()):(d=d.substring(0,e-l.length1-this.Patch_Margin),l.length1+=d.length,s+=d.length,u===ye?(l.length2+=d.length,o+=d.length):c=!1,l.diffs.push(new re.Diff(u,d)),d==n.diffs[0][1]?n.diffs.shift():n.diffs[0][1]=n.diffs[0][1].substring(d.length))}a=this.diff_text2(l.diffs),a=a.substring(a.length-this.Patch_Margin);var h=this.diff_text1(n.diffs).substring(0,this.Patch_Margin);h!==""&&(l.length1+=h.length,l.length2+=h.length,l.diffs.length!==0&&l.diffs[l.diffs.length-1][0]===ye?l.diffs[l.diffs.length-1][1]+=h:l.diffs.push(new re.Diff(ye,h))),c||r.splice(++t,0,l)}}};re.prototype.patch_toText=function(r){for(var e=[],t=0;t<r.length;t++)e[t]=r[t];return e.join("")};re.prototype.patch_fromText=function(r){var e=[];if(!r)return e;for(var t=r.split(`
`),n=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;n<t.length;){var o=t[n].match(s);if(!o)throw new Error("Invalid patch string: "+t[n]);var a=new re.patch_obj;for(e.push(a),a.start1=parseInt(o[1],10),o[2]===""?(a.start1--,a.length1=1):o[2]=="0"?a.length1=0:(a.start1--,a.length1=parseInt(o[2],10)),a.start2=parseInt(o[3],10),o[4]===""?(a.start2--,a.length2=1):o[4]=="0"?a.length2=0:(a.start2--,a.length2=parseInt(o[4],10)),n++;n<t.length;){var l=t[n].charAt(0);try{var c=decodeURI(t[n].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+c)}if(l=="-")a.diffs.push(new re.Diff(Re,c));else if(l=="+")a.diffs.push(new re.Diff(Ne,c));else if(l==" ")a.diffs.push(new re.Diff(ye,c));else{if(l=="@")break;if(l!=="")throw new Error('Invalid patch mode "'+l+'" in: '+c)}n++}}return e};re.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0};re.patch_obj.prototype.toString=function(){var r,e;this.length1===0?r=this.start1+",0":this.length1==1?r=this.start1+1:r=this.start1+1+","+this.length1,this.length2===0?e=this.start2+",0":this.length2==1?e=this.start2+1:e=this.start2+1+","+this.length2;for(var t=["@@ -"+r+" +"+e+` @@
`],n,s=0;s<this.diffs.length;s++){switch(this.diffs[s][0]){case Ne:n="+";break;case Re:n="-";break;case ye:n=" ";break}t[s+1]=n+encodeURI(this.diffs[s][1])+`
`}return t.join("").replace(/%20/g," ")};Iy.exports={diff_match_patch:re,DIFF_INSERT:Ne,DIFF_DELETE:Re,DIFF_EQUAL:ye}});var Cp=M(kp=>{"use strict";Object.defineProperty(kp,"__esModule",{value:!0});kp.getComparator=lR;var yn=Be(),nR=Sy(),rR=Ay(),{diff_match_patch:iR,DIFF_INSERT:sR,DIFF_DELETE:oR,DIFF_EQUAL:aR}=Ry();function lR(r){return r==="image/png"?Fy.bind(null,"image/png"):r==="image/jpeg"?Fy.bind(null,"image/jpeg"):r==="text/plain"?Ly:cR}var My=5*1024;function cR(r,e){return typeof r=="string"?Ly(r,e):!r||!(r instanceof Buffer)?{errorMessage:"Actual result should be a Buffer or a string."}:Buffer.compare(r,e)?{errorMessage:"Buffers differ"}:null}function Fy(r,e,t,n={}){var s,o;if(!e||!(e instanceof Buffer))return{errorMessage:"Actual result should be a Buffer."};uR(t,r);let a=r==="image/png"?yn.PNG.sync.read(e):yn.jpegjs.decode(e,{maxMemoryUsageInMB:My}),l=r==="image/png"?yn.PNG.sync.read(t):yn.jpegjs.decode(t,{maxMemoryUsageInMB:My}),c={width:Math.max(l.width,a.width),height:Math.max(l.height,a.height)},u="";(l.width!==a.width||l.height!==a.height)&&(u=`Expected an image ${l.width}px by ${l.height}px, received ${a.width}px by ${a.height}px. `,a=Ny(a,c),l=Ny(l,c));let d=new yn.PNG({width:c.width,height:c.height}),h;if(n.comparator==="ssim-cie94")h=(0,nR.compare)(l.data,a.data,d.data,c.width,c.height,{maxColorDeltaE94:1});else if(((s=n.comparator)!==null&&s!==void 0?s:"pixelmatch")==="pixelmatch"){var p;h=rR(l.data,a.data,d.data,c.width,c.height,{threshold:(p=n.threshold)!==null&&p!==void 0?p:.2})}else throw new Error(`Configuration specifies unknown comparator "${n.comparator}"`);let f=n.maxDiffPixels,_=n.maxDiffPixelRatio!==void 0?l.width*l.height*n.maxDiffPixelRatio:void 0,v;f!==void 0&&_!==void 0?v=Math.min(f,_):v=(o=f??_)!==null&&o!==void 0?o:0;let w=Math.ceil(h/(l.width*l.height)*100)/100,m=h>v?`${h} pixels (ratio ${w.toFixed(2)} of all image pixels) are different.`:"";return m||u?{errorMessage:u+m,diff:yn.PNG.sync.write(d)}:null}function uR(r,e){if(e==="image/png"){let t=[137,80,78,71,13,10,26,10];if(r.length<t.length||!t.every((n,s)=>r[s]===n))throw new Error("could not decode image as PNG.")}else if(e==="image/jpeg"){let t=[255,216];if(r.length<t.length||!t.every((n,s)=>r[s]===n))throw new Error("could not decode image as JPEG.")}}function Ly(r,e){if(typeof r!="string")return{errorMessage:"Actual result should be a string"};let t=e.toString("utf-8");if(t===r)return null;let n=new iR,s=n.diff_main(t,r);return n.diff_cleanupSemantic(s),{errorMessage:dR(s)}}function dR(r){let e=[];for(let t=0;t<r.length;t++){let n=r[t][0],o=r[t][1];switch(n){case sR:e[t]=yn.colors.green(o);break;case oR:e[t]=yn.colors.reset(yn.colors.strikethrough(yn.colors.red(o)));break;case aR:e[t]=o;break}}return e.join("")}function Ny(r,e){if(r.width===e.width&&r.height===e.height)return r;let t=new Uint8Array(e.width*e.height*4);for(let n=0;n<e.height;n++)for(let s=0;s<e.width;s++){let o=(n*e.width+s)*4;if(n<r.height&&s<r.width){let a=(n*r.width+s)*4;t[o]=r.data[a],t[o+1]=r.data[a+1],t[o+2]=r.data[a+2],t[o+3]=r.data[a+3]}else t[o]=0,t[o+1]=0,t[o+2]=0,t[o+3]=0}return{data:Buffer.from(t),width:e.width,height:e.height}}});var Tp=M(cl=>{"use strict";Object.defineProperty(cl,"__esModule",{value:!0});cl.calculateSha1=fR;cl.createGuid=pR;var Dy=hR(require("crypto"));function hR(r){return r&&r.__esModule?r:{default:r}}function pR(){return Dy.default.randomBytes(16).toString("hex")}function fR(r){let e=Dy.default.createHash("sha1");return e.update(r),e.digest("hex")}});var Op=M(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.getAsBooleanFromENV=mR;Ni.getFromENV=By;Ni.getPackageManager=jy;Ni.getPackageManagerExecCommand=gR;function By(r){let e=process.env[r];return e=e===void 0?process.env[`npm_config_${r.toLowerCase()}`]:e,e=e===void 0?process.env[`npm_package_config_${r.toLowerCase()}`]:e,e}function mR(r){let e=By(r);return!!e&&e!=="false"&&e!=="0"}function jy(){let r=process.env.npm_config_user_agent||"";return r.includes("yarn")?"yarn":r.includes("pnpm")?"pnpm":"npm"}function gR(){let r=jy();return r==="yarn"?"yarn":r==="pnpm"?"pnpm exec":"npx"}});var Pp=M(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.assert=wR;Qr.debugAssert=vR;Qr.debugMode=bR;Qr.isUnderTest=Hy;Qr.setUnderTest=yR;var _R=Op();function wR(r,e){if(!r)throw new Error(e||"Assertion error")}function vR(r,e){if(Hy()&&!r)throw new Error(e)}var ul=(0,_R.getFromENV)("PWDEBUG")||"";function bR(){return ul==="console"?"console":ul==="0"||ul==="false"?"":ul?"inspector":""}var qy=!!process.env.PWTEST_UNDER_TEST;function yR(){qy=!0}function Hy(){return qy}});var Ze=M(dl=>{"use strict";Object.defineProperty(dl,"__esModule",{value:!0});dl.eventsHelper=void 0;var Ap=class{static addEventListener(e,t,n){return e.on(t,n),{emitter:e,eventName:t,handler:n}}static removeEventListeners(e){for(let t of e)t.emitter.removeListener(t.eventName,t.handler);e.splice(0,e.length)}},jz=dl.eventsHelper=Ap});var ht=M(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.canAccessFile=kR;Jt.copyFileAndMakeWritable=CR;Jt.fileUploadSizeLimit=Jt.existsAsync=void 0;Jt.mkdirIfNeeded=SR;Jt.removeFolders=ER;Jt.sanitizeForFilePath=TR;Jt.toPosixPath=OR;var Li=$y(require("fs")),Ip=$y(require("path"));function $y(r){return r&&r.__esModule?r:{default:r}}var Hz=Jt.fileUploadSizeLimit=50*1024*1024,xR=r=>new Promise(e=>Li.default.stat(r,t=>e(!t)));Jt.existsAsync=xR;async function SR(r){await Li.default.promises.mkdir(Ip.default.dirname(r),{recursive:!0}).catch(()=>{})}async function ER(r){return await Promise.all(r.map(e=>Li.default.promises.rm(e,{recursive:!0,force:!0,maxRetries:10}).catch(t=>t)))}function kR(r){if(!r)return!1;try{return Li.default.accessSync(r),!0}catch{return!1}}async function CR(r,e){await Li.default.promises.copyFile(r,e),await Li.default.promises.chmod(e,436)}function TR(r){return r.replace(/[\x00-\x2C\x2E-\x2F\x3A-\x40\x5B-\x60\x7B-\x7F]+/g,"-")}function OR(r){return r.split(Ip.default.sep).join(Ip.default.posix.sep)}});var Wy=M(hl=>{"use strict";Object.defineProperty(hl,"__esModule",{value:!0});hl.headersArrayToObject=AR;hl.headersObjectToArray=PR;function PR(r,e,t){t||(t=e);let n=[];for(let s in r){let o=r[s];if(o!==void 0)if(e){let a=s.toLowerCase()==="set-cookie"?t:e;for(let l of o.split(a))n.push({name:s,value:l.trim()})}else n.push({name:s,value:o})}return n}function AR(r,e){let t={};for(let{name:n,value:s}of r)t[e?n.toLowerCase():n]=s;return t}});var Rp=M(fl=>{"use strict";Object.defineProperty(fl,"__esModule",{value:!0});fl.getLinuxDistributionInfo=RR;fl.getLinuxDistributionInfoSync=MR;var Uy=IR(require("fs"));function IR(r){return r&&r.__esModule?r:{default:r}}var pl=!1,Di;async function RR(){if(process.platform==="linux"){if(!Di&&!pl)try{var r,e;let t=await Uy.default.promises.readFile("/etc/os-release","utf8"),n=zy(t);Di={id:(r=n.get("id"))!==null&&r!==void 0?r:"",version:(e=n.get("version_id"))!==null&&e!==void 0?e:""}}catch{pl=!0}return Di}}function MR(){if(process.platform==="linux"){if(!Di&&!pl)try{var r,e;let t=Uy.default.readFileSync("/etc/os-release","utf8"),n=zy(t);Di={id:(r=n.get("id"))!==null&&r!==void 0?r:"",version:(e=n.get("version_id"))!==null&&e!==void 0?e:""}}catch{pl=!0}return Di}}function zy(r){let e=new Map;for(let t of r.split(`
`)){let n=t.split("="),s=n.shift(),o=n.join("=").trim();o.startsWith('"')&&o.endsWith('"')&&(o=o.substring(1,o.length-1)),s&&e.set(s.toLowerCase(),o)}return e}});var go=M(Bi=>{"use strict";Object.defineProperty(Bi,"__esModule",{value:!0});Bi.isOfficiallySupportedPlatform=Bi.hostPlatform=void 0;var mo=NR(require("os")),FR=Rp();function NR(r){return r&&r.__esModule?r:{default:r}}function LR(){let r=mo.default.platform();if(r==="darwin"){let e=mo.default.release().split(".").map(n=>parseInt(n,10)),t="";return e[0]<18?t="mac10.13":e[0]===18?t="mac10.14":e[0]===19?t="mac10.15":(t="mac"+Math.min(e[0]-9,14),mo.default.cpus().some(s=>s.model.includes("Apple"))&&(t+="-arm64")),{hostPlatform:t,isOfficiallySupportedPlatform:!0}}if(r==="linux"){if(!["x64","arm64"].includes(mo.default.arch()))return{hostPlatform:"<unknown>",isOfficiallySupportedPlatform:!1};let e="-"+mo.default.arch(),t=(0,FR.getLinuxDistributionInfoSync)();if(t?.id==="ubuntu"||t?.id==="pop"||t?.id==="neon"||t?.id==="tuxedo"){let n=t?.id==="ubuntu";return parseInt(t.version,10)<=19?{hostPlatform:"ubuntu18.04"+e,isOfficiallySupportedPlatform:!1}:parseInt(t.version,10)<=21?{hostPlatform:"ubuntu20.04"+e,isOfficiallySupportedPlatform:n}:{hostPlatform:"ubuntu22.04"+e,isOfficiallySupportedPlatform:n}}if(t?.id==="linuxmint")return parseInt(t.version,10)<=20?{hostPlatform:"ubuntu20.04"+e,isOfficiallySupportedPlatform:!1}:{hostPlatform:"ubuntu22.04"+e,isOfficiallySupportedPlatform:!1};if(t?.id==="debian"||t?.id==="raspbian"){let n=t?.id==="debian";if(t?.version==="11")return{hostPlatform:"debian11"+e,isOfficiallySupportedPlatform:n};if(t?.version==="12")return{hostPlatform:"debian12"+e,isOfficiallySupportedPlatform:n};if(t?.version==="")return{hostPlatform:"debian12"+e,isOfficiallySupportedPlatform:n}}return{hostPlatform:"ubuntu20.04"+e,isOfficiallySupportedPlatform:!1}}return r==="win32"?{hostPlatform:"win64",isOfficiallySupportedPlatform:!0}:{hostPlatform:"<unknown>",isOfficiallySupportedPlatform:!1}}var{hostPlatform:DR,isOfficiallySupportedPlatform:BR}=LR();Bi.isOfficiallySupportedPlatform=BR;Bi.hostPlatform=DR});var Dp=M(ml=>{"use strict";Object.defineProperty(ml,"__esModule",{value:!0});ml.HttpServer=void 0;var Mp=Gy(require("fs")),Vy=Gy(require("path")),Fp=Be(),Np=Pp(),jR=xn(),qR=Qe(),HR=Tp();function Gy(r){return r&&r.__esModule?r:{default:r}}var Lp=class{constructor(){this._server=void 0,this._urlPrefixPrecise="",this._urlPrefixHumanReadable="",this._port=0,this._started=!1,this._routes=[],this._wsGuid=void 0,this._server=(0,jR.createHttpServer)(this._onRequest.bind(this))}server(){return this._server}routePrefix(e,t){this._routes.push({prefix:e,handler:t})}routePath(e,t){this._routes.push({exact:e,handler:t})}port(){return this._port}async _tryStart(e,t){let n=new qR.ManualPromise,s=o=>n.reject(o);this._server.on("error",s);try{this._server.listen(e,t),await Promise.race([new Promise(o=>this._server.once("listening",o)),n])}finally{this._server.removeListener("error",s)}}createWebSocket(e,t){(0,Np.assert)(!this._wsGuid,"can only create one main websocket transport per server"),this._wsGuid=t||(0,HR.createGuid)(),new Fp.wsServer({server:this._server,path:"/"+this._wsGuid}).on("connection",s=>{e.sendEvent=(o,a)=>s.send(JSON.stringify({method:o,params:a})),e.close=()=>s.close(),s.on("message",async o=>{let{id:a,method:l,params:c}=JSON.parse(String(o));try{let u=await e.dispatch(l,c);s.send(JSON.stringify({id:a,result:u}))}catch(u){s.send(JSON.stringify({id:a,error:String(u)}))}}),s.on("close",()=>e.onclose()),s.on("error",()=>e.onclose())})}wsGuid(){return this._wsGuid}async start(e={}){(0,Np.assert)(!this._started,"server already started"),this._started=!0;let t=e.host||"localhost";if(e.preferredPort)try{await this._tryStart(e.preferredPort,t)}catch(s){if(!s||!s.message||!s.message.includes("EADDRINUSE"))throw s;await this._tryStart(void 0,t)}else await this._tryStart(e.port,t);let n=this._server.address();if((0,Np.assert)(n,"Could not bind server socket"),typeof n=="string")this._urlPrefixPrecise=n,this._urlPrefixHumanReadable=n;else{this._port=n.port;let s=n.family==="IPv4"?n.address:`[${n.address}]`;this._urlPrefixPrecise=`http://${s}:${n.port}`,this._urlPrefixHumanReadable=`http://${t}:${n.port}`}}async stop(){await new Promise(e=>this._server.close(e))}urlPrefix(e){return e==="human-readable"?this._urlPrefixHumanReadable:this._urlPrefixPrecise}serveFile(e,t,n,s){try{for(let[o,a]of Object.entries(s||{}))t.setHeader(o,a);return e.headers.range?this._serveRangeFile(e,t,n):this._serveFile(t,n),!0}catch{return!1}}_serveFile(e,t){let n=Mp.default.readFileSync(t);e.statusCode=200;let s=Fp.mime.getType(Vy.default.extname(t))||"application/octet-stream";e.setHeader("Content-Type",s),e.setHeader("Content-Length",n.byteLength),e.end(n)}_serveRangeFile(e,t,n){let s=e.headers.range;if(!s||!s.startsWith("bytes=")||s.includes(", ")||[...s].filter(h=>h==="-").length!==1)return t.statusCode=400,t.end("Bad request");let[o,a]=s.replace(/bytes=/,"").split("-"),l,c,u=Mp.default.statSync(n).size;if(o!==""&&a===""?(l=+o,c=u-1):o===""&&a!==""?(l=u-+a,c=u-1):(l=+o,c=+a),Number.isNaN(l)||Number.isNaN(c)||l>=u||c>=u||l>c)return t.writeHead(416,{"Content-Range":`bytes */${u}`}),t.end();t.writeHead(206,{"Content-Range":`bytes ${l}-${c}/${u}`,"Accept-Ranges":"bytes","Content-Length":c-l+1,"Content-Type":Fp.mime.getType(Vy.default.extname(n))}),Mp.default.createReadStream(n,{start:l,end:c}).pipe(t)}_onRequest(e,t){if(t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Request-Method","*"),t.setHeader("Access-Control-Allow-Methods","OPTIONS, GET"),e.headers.origin&&t.setHeader("Access-Control-Allow-Headers",e.headers.origin),e.method==="OPTIONS"){t.writeHead(200),t.end();return}e.on("error",()=>t.end());try{if(!e.url){t.end();return}let n=new URL("http://localhost"+e.url);for(let s of this._routes)if(s.exact&&n.pathname===s.exact&&s.handler(e,t)||s.prefix&&n.pathname.startsWith(s.prefix)&&s.handler(e,t))return;t.statusCode=404,t.end()}catch{t.end()}}};ml.HttpServer=Lp});var Bp=M(gl=>{"use strict";Object.defineProperty(gl,"__esModule",{value:!0});gl.isJsonMimeType=$R;gl.isTextualMimeType=WR;function $R(r){return!!r.match(/^(application\/json|application\/.*?\+json|text\/(x-)?json)(;\s*charset=.*)?$/)}function WR(r){return!!r.match(/^(text\/.*?|application\/(json|(x-)?javascript|xml.*?|ecmascript|graphql|x-www-form-urlencoded)|image\/svg(\+xml)?|application\/.*?(\+json|\+xml))(;\s*charset=.*)?$/)}});var wl=M(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});_l.MultiMap=void 0;var Ky;Ky=Symbol.iterator;var jp=class{constructor(){this._map=void 0,this._map=new Map}set(e,t){let n=this._map.get(e);n||(n=[],this._map.set(e,n)),n.push(t)}get(e){return this._map.get(e)||[]}has(e){return this._map.has(e)}delete(e,t){let n=this._map.get(e);n&&n.includes(t)&&this._map.set(e,n.filter(s=>t!==s))}deleteAll(e){this._map.delete(e)}hasValue(e,t){let n=this._map.get(e);return n?n.includes(t):!1}get size(){return this._map.size}[Ky](){return this._map[Symbol.iterator]()}keys(){return this._map.keys()}values(){let e=[];for(let t of this.keys())e.push(...this.get(t));return e}clear(){this._map.clear()}};_l.MultiMap=jp});var sr=M(ir=>{"use strict";Object.defineProperty(ir,"__esModule",{value:!0});ir.envArrayToObject=ZR;ir.gracefullyCloseAll=_o;ir.gracefullyCloseSet=void 0;ir.gracefullyProcessExitDoNotHang=KR;ir.launchProcess=QR;var UR=GR(require("fs")),Jy=ex(require("child_process")),Xy=ex(require("readline")),zR=ie(),VR=ht();function Zy(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Zy=function(n){return n?t:e})(r)}function ex(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Zy(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function GR(r){return r&&r.__esModule?r:{default:r}}var bl=ir.gracefullyCloseSet=new Set,ji=new Set;async function _o(){await Promise.all(Array.from(bl).map(r=>r().catch(e=>{})))}function KR(r){setTimeout(()=>process.exit(r),3e4),_o().then(()=>{process.exit(r)})}function JR(){for(let r of ji)r()}var Yy=!1;function tx(){let r=()=>{(0,zR.isUnderTest)()?setTimeout(()=>process.exit(130),1e3):process.exit(130)};if(Yy){process.off("SIGINT",tx);for(let e of ji)e();r()}else Yy=!0,_o().then(()=>r())}function XR(){_o()}function YR(){_o()}var yl=new Set,nx={exit:JR,SIGINT:tx,SIGTERM:XR,SIGHUP:YR};function vl(r){yl.has(r)||(yl.add(r),process.on(r,nx[r]))}function Qy(){if(!ji.size){for(let r of yl)process.off(r,nx[r]);yl.clear()}}async function QR(r){let e=r.stdio==="pipe"?["ignore","pipe","pipe","pipe","pipe"]:["pipe","pipe","pipe"];r.log(`<launching> ${r.command} ${r.args?r.args.join(" "):""}`);let t={detached:process.platform!=="win32",env:r.env,cwd:r.cwd,shell:r.shell,stdio:e},n=Jy.spawn(r.command,r.args||[],t),s=async()=>{r.log(`[pid=${n.pid||"N/A"}] starting temporary directories cleanup`);let v=await(0,VR.removeFolders)(r.tempDirectories);for(let w=0;w<r.tempDirectories.length;++w)v[w]&&r.log(`[pid=${n.pid||"N/A"}] exception while removing ${r.tempDirectories[w]}: ${v[w]}`);r.log(`[pid=${n.pid||"N/A"}] finished temporary directories cleanup`)};if(n.on("error",()=>{}),!n.pid){let v,w=new Promise((m,g)=>v=m);return n.once("error",m=>{v(new Error("Failed to launch: "+m))}),s().then(()=>w).then(m=>Promise.reject(m))}r.log(`<launched> pid=${n.pid}`),Xy.createInterface({input:n.stdout}).on("line",v=>{r.log(`[pid=${n.pid}][out] `+v)}),Xy.createInterface({input:n.stderr}).on("line",v=>{r.log(`[pid=${n.pid}][err] `+v)});let l=!1,c=()=>{},u=new Promise(v=>c=v);n.once("exit",(v,w)=>{r.log(`[pid=${n.pid}] <process did exit: exitCode=${v}, signal=${w}>`),l=!0,bl.delete(h),ji.delete(f),Qy(),r.onExit(v,w),s().then(c)}),vl("exit"),r.handleSIGINT&&vl("SIGINT"),r.handleSIGTERM&&vl("SIGTERM"),r.handleSIGHUP&&vl("SIGHUP"),bl.add(h),ji.add(f);let d=!1;async function h(){if(d){r.log(`[pid=${n.pid}] <forcefully close>`),p(),await u;return}d=!0,r.log(`[pid=${n.pid}] <gracefully close start>`),await r.attemptToGracefullyClose().catch(()=>p()),await u,r.log(`[pid=${n.pid}] <gracefully close end>`)}function p(){if(bl.delete(h),ji.delete(f),Qy(),r.log(`[pid=${n.pid}] <kill>`),n.pid&&!n.killed&&!l){r.log(`[pid=${n.pid}] <will force kill>`);try{if(process.platform==="win32"){let v=Jy.spawnSync(`taskkill /pid ${n.pid} /T /F`,{shell:!0}),[w,m]=[v.stdout.toString(),v.stderr.toString()];w&&r.log(`[pid=${n.pid}] taskkill stdout: ${w}`),m&&r.log(`[pid=${n.pid}] taskkill stderr: ${m}`)}else process.kill(-n.pid,"SIGKILL")}catch(v){r.log(`[pid=${n.pid}] exception while trying to kill process: ${v}`)}}else r.log(`[pid=${n.pid}] <skipped force kill spawnedProcess.killed=${n.killed} processClosed=${l}>`)}function f(){p(),r.log(`[pid=${n.pid||"N/A"}] starting temporary directories cleanup`);for(let v of r.tempDirectories)try{UR.default.rmSync(v,{force:!0,recursive:!0,maxRetries:5})}catch(w){r.log(`[pid=${n.pid||"N/A"}] exception while removing ${v}: ${w}`)}r.log(`[pid=${n.pid||"N/A"}] finished temporary directories cleanup`)}function _(){return p(),u}return{launchedProcess:n,gracefullyClose:h,kill:_}}function ZR(r){let e={};for(let{name:t,value:n}of r)e[t]=n;return e}});var ox=M(Sl=>{"use strict";Object.defineProperty(Sl,"__esModule",{value:!0});Sl.startProfiling=tM;Sl.stopProfiling=nM;var rx=sx(require("fs")),eM=sx(require("path"));function ix(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(ix=function(n){return n?t:e})(r)}function sx(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=ix(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var xl=process.env.PWTEST_PROFILE_DIR||"",wo;async function tM(){xl&&(wo=new(require("inspector")).Session,wo.connect(),await new Promise(r=>{wo.post("Profiler.enable",()=>{wo.post("Profiler.start",r)})}))}async function nM(r){xl&&await new Promise(e=>wo.post("Profiler.stop",(t,{profile:n})=>{t||(rx.mkdirSync(xl,{recursive:!0}),rx.writeFileSync(eM.join(xl,r+".json"),JSON.stringify(n))),e()}))}});var Hp=M(El=>{"use strict";Object.defineProperty(El,"__esModule",{value:!0});El.Semaphore=void 0;var rM=Qe(),qp=class{constructor(e){this._max=void 0,this._acquired=0,this._queue=[],this._max=e}setMax(e){this._max=e}acquire(){let e=new rM.ManualPromise;return this._queue.push(e),this._flush(),e}release(){--this._acquired,this._flush()}_flush(){for(;this._acquired<this._max&&this._queue.length;)++this._acquired,this._queue.shift().resolve()}};El.Semaphore=qp});var kl=M($p=>{"use strict";Object.defineProperty($p,"__esModule",{value:!0});$p.spawnAsync=sM;var iM=require("child_process");function sM(r,e,t={}){let n=(0,iM.spawn)(r,e,Object.assign({windowsHide:!0},t));return new Promise(s=>{let o="",a="";n.stdout&&n.stdout.on("data",l=>o+=l.toString()),n.stderr&&n.stderr.on("data",l=>a+=l.toString()),n.on("close",l=>s({stdout:o,stderr:a,code:l})),n.on("error",l=>s({stdout:o,stderr:a,code:0,error:l}))})}});var ax=M(Wp=>{"use strict";Object.defineProperty(Wp,"__esModule",{value:!0});Wp.makeWaitForNextTask=oM;function oM(){if(process.versions.electron)return n=>setTimeout(n,0);if(parseInt(process.versions.node,10)>=11)return setImmediate;let r=!1,e=[],t=()=>{let n=e.shift();if(!n){r=!1;return}setImmediate(t),n()};return n=>{e.push(n),r||(r=!0,setImmediate(t))}}});var lx=M(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});Up.monotonicTime=lM;var aM=process.hrtime();function lM(){let[r,e]=process.hrtime(aM);return r*1e3+(e/1e3|0)/1e3}});var vo=M(Cl=>{"use strict";Object.defineProperty(Cl,"__esModule",{value:!0});Cl.pollAgainstDeadline=cM;Cl.raceAgainstDeadline=cx;var zp=ie();async function cx(r,e){let t;return Promise.race([r().then(n=>({result:n,timedOut:!1})),new Promise(n=>{let o=(e||2147483647)-(0,zp.monotonicTime)();t=setTimeout(()=>n({timedOut:!0}),o)})]).finally(()=>{clearTimeout(t)})}async function cM(r,e,t=[100,250,500,1e3]){var n;let s=(n=t.pop())!==null&&n!==void 0?n:1e3,o,a=()=>Promise.resolve().then(r);for(;;){var l;let c=(0,zp.monotonicTime)();if(e&&c>=e)break;let u=await cx(a,e);if(u.timedOut)break;if(o=u.result.result,!u.result.continuePolling)return{result:o,timedOut:!1};let d=(l=t.shift())!==null&&l!==void 0?l:s;if(e&&e<=(0,zp.monotonicTime)()+d)break;await new Promise(h=>setTimeout(h,d))}return{timedOut:!0,result:o}}});var ux=M(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});Vp.serializeClientSideCallMetadata=uM;function uM(r){let e=new Map,t=[];for(let n of r){if(!n.stack||!n.stack.length)continue;let s=[];for(let o of n.stack){let a=e.get(o.file);typeof a!="number"&&(a=e.size,e.set(o.file,a));let l=[a,o.line||0,o.column||0,o.function||""];s.push(l)}t.push([n.id,s])}return{files:[...e.keys()],stacks:t}}});var Gp=M((r8,dM)=>{dM.exports={name:"playwright-core",version:"1.44.1",description:"A high-level API to automate web browsers",repository:{type:"git",url:"git+https://github.com/microsoft/playwright.git"},homepage:"https://playwright.dev",engines:{node:">=16"},author:{name:"Microsoft Corporation"},license:"Apache-2.0",exports:{".":{types:"./index.d.ts",import:"./index.mjs",require:"./index.js",default:"./index.js"},"./package.json":"./package.json","./lib/outofprocess":"./lib/outofprocess.js","./lib/image_tools/stats":"./lib/image_tools/stats.js","./lib/image_tools/compare":"./lib/image_tools/compare.js","./lib/image_tools/imageChannel":"./lib/image_tools/imageChannel.js","./lib/image_tools/colorUtils":"./lib/image_tools/colorUtils.js","./lib/cli/program":"./lib/cli/program.js","./lib/server/registry/index":"./lib/server/registry/index.js","./lib/remote/playwrightServer":"./lib/remote/playwrightServer.js","./lib/server":"./lib/server/index.js","./lib/utils":"./lib/utils/index.js","./lib/utilsBundle":"./lib/utilsBundle.js","./lib/zipBundle":"./lib/zipBundle.js","./types/protocol":"./types/protocol.d.ts","./types/structs":"./types/structs.d.ts"},bin:{"playwright-core":"cli.js"},types:"types/types.d.ts"}});var Nn=M(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.getEmbedderName=hx;qi.getPlaywrightVersion=Kp;qi.getUserAgent=gM;qi.userAgentVersionMatchesErrorMessage=wM;var hM=require("child_process"),dx=mM(require("os")),pM=Rp(),fM=ol();function mM(r){return r&&r.__esModule?r:{default:r}}var bo;function gM(){if(bo)return bo;try{bo=_M()}catch{bo="Playwright/unknown"}return bo}function _M(){let r="unknown",e="unknown";if(process.platform==="win32"){let a=dx.default.release().split(".");r="windows",e=`${a[0]}.${a[1]}`}else if(process.platform==="darwin"){let a=(0,hM.execSync)("sw_vers -productVersion",{stdio:["ignore","pipe","ignore"]}).toString().trim().split(".");r="macOS",e=`${a[0]}.${a[1]}`}else if(process.platform==="linux"){let a=(0,pM.getLinuxDistributionInfoSync)();a?(r=a.id||"linux",e=a.version||"unknown"):r="linux"}let t=[];process.env.CI&&t.push("CI/1");let n=t.length?" "+t.join(" "):"",{embedderName:s,embedderVersion:o}=hx();return`Playwright/${Kp()} (${dx.default.arch()}; ${r} ${e}) ${s}/${o}${n}`}function hx(){let r="unknown",e="unknown";if(!process.env.PW_LANG_NAME)r="node",e=process.version.substring(1).split(".").slice(0,2).join(".");else if(["node","python","java","csharp"].includes(process.env.PW_LANG_NAME)){var t;r=process.env.PW_LANG_NAME,e=(t=process.env.PW_LANG_NAME_VERSION)!==null&&t!==void 0?t:"unknown"}return{embedderName:r,embedderVersion:e}}function Kp(r=!1){let e=process.env.PW_VERSION_OVERRIDE||Gp().version;return r?e.split(".").slice(0,2).join("."):e}function wM(r){let e=r.match(/^Playwright\/(\d+\.\d+\.\d+)/);if(!e)return;let t=e[1].split(".").slice(0,2).join("."),n=Kp(!0);if(t!==n)return(0,fM.wrapInASCIIBox)(["Playwright version mismatch:",`  - server version: v${n}`,`  - client version: v${t}`,"","If you are using VSCode extension, restart VSCode.","","If you are connecting to a remote service,","keep your local Playwright version in sync","with the remote service version.","","<3 Playwright Team"].join(`
`),1)}});var Le=M(Hi=>{"use strict";Object.defineProperty(Hi,"__esModule",{value:!0});Hi.debugLogger=Hi.RecentLogsCollector=void 0;var Jp=Be(),vM=bM(require("fs"));function bM(r){return r&&r.__esModule?r:{default:r}}var yM={api:45,protocol:34,install:34,download:34,browser:0,socks:92,error:160,channel:33,server:45,"server:channel":34,"server:metadata":33},Xp=class{constructor(){if(this._debuggers=new Map,process.env.DEBUG_FILE){let e=new RegExp(["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|"),"g"),t=vM.default.createWriteStream(process.env.DEBUG_FILE);Jp.debug.log=n=>{t.write(n.replace(e,"")),t.write(`
`)}}}log(e,t){let n=this._debuggers.get(e);n||(n=(0,Jp.debug)(`pw:${e}`),this._debuggers.set(e,n),n.color=yM[e]||0),n(t)}isEnabled(e){return Jp.debug.enabled(`pw:${e}`)}},s8=Hi.debugLogger=new Xp,Tl=150,Yp=class{constructor(){this._logs=[]}log(e){this._logs.push(e),this._logs.length===Tl*2&&this._logs.splice(0,Tl)}recentLogs(){return this._logs.length>Tl?this._logs.slice(-Tl):this._logs}};Hi.RecentLogsCollector=Yp});var Zp=M($i=>{"use strict";Object.defineProperty($i,"__esModule",{value:!0});$i.perMessageDeflate=$i.WSServer=void 0;var xM=ie(),SM=Be(),or=Le(),EM=0,px=Symbol("kConnection"),kM=$i.perMessageDeflate={zlibDeflateOptions:{level:3},zlibInflateOptions:{chunkSize:10*1024},threshold:10*1024},Qp=class{constructor(e){this._wsServer=void 0,this.server=void 0,this._delegate=void 0,this._delegate=e}async listen(e=0,t,n){or.debugLogger.log("server",`Server started at ${new Date}`);let s=(0,xM.createHttpServer)((a,l)=>{if(a.method==="GET"&&a.url==="/json"){l.setHeader("Content-Type","application/json"),l.end(JSON.stringify({wsEndpointPath:n}));return}l.end("Running")});s.on("error",a=>or.debugLogger.log("server",String(a))),this.server=s;let o=await new Promise((a,l)=>{s.listen(e,t,()=>{let c=s.address();if(!c){l(new Error("Could not bind server socket"));return}let u=typeof c=="string"?`${c}${n}`:`ws://${t||"localhost"}:${c.port}${n}`;a(u)}).on("error",l)});return or.debugLogger.log("server","Listening at "+o),this._wsServer=new SM.wsServer({noServer:!0,perMessageDeflate:kM}),this._delegate.onHeaders&&this._wsServer.on("headers",a=>this._delegate.onHeaders(a)),s.on("upgrade",(a,l,c)=>{var u,d,h;if(new URL("http://localhost"+a.url).pathname!==n){l.write(`HTTP/${a.httpVersion} 400 Bad Request\r
\r
`),l.destroy();return}let f=(u=(d=this._delegate).onUpgrade)===null||u===void 0?void 0:u.call(d,a,l);if(f){l.write(f.error),l.destroy();return}(h=this._wsServer)===null||h===void 0||h.handleUpgrade(a,l,c,_=>{var v;return(v=this._wsServer)===null||v===void 0?void 0:v.emit("connection",_,a)})}),this._wsServer.on("connection",(a,l)=>{or.debugLogger.log("server","Connected client ws.extension="+a.extensions);let c=new URL("http://localhost"+(l.url||"")),u=String(++EM);or.debugLogger.log("server",`[${u}] serving connection: ${l.url}`);let d=this._delegate.onConnection(l,c,a,u);a[px]=d}),o}async close(){var e,t;let n=this._wsServer;if(!n)return;or.debugLogger.log("server","closing websocket server");let s=new Promise(o=>n.close(o));await Promise.all(Array.from(n.clients).map(async o=>{let a=o[px];a&&await a.close();try{o.terminate()}catch{}})),await s,or.debugLogger.log("server","closing http server"),this.server&&await new Promise(o=>this.server.close(o)),this._wsServer=void 0,this.server=void 0,or.debugLogger.log("server","closed server"),await((e=(t=this._delegate).onClose)===null||e===void 0?void 0:e.call(t))}};$i.WSServer=Qp});var Pl=M((l8,bx)=>{"use strict";var CM=Object.create,Ol=Object.defineProperty,TM=Object.getOwnPropertyDescriptor,OM=Object.getOwnPropertyNames,PM=Object.getPrototypeOf,AM=Object.prototype.hasOwnProperty,st=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),IM=(r,e)=>{for(var t in e)Ol(r,t,{get:e[t],enumerable:!0})},fx=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of OM(e))!AM.call(r,s)&&s!==t&&Ol(r,s,{get:()=>e[s],enumerable:!(n=TM(e,s))||n.enumerable});return r},ef=(r,e,t)=>(t=r!=null?CM(PM(r)):{},fx(e||!r||!r.__esModule?Ol(t,"default",{value:r,enumerable:!0}):t,r)),RM=r=>fx(Ol({},"__esModule",{value:!0}),r),mx=st((r,e)=>{var t=require("buffer").Buffer,n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(n=new Int32Array(n));function s(c){if(t.isBuffer(c))return c;var u=typeof t.alloc=="function"&&typeof t.from=="function";if(typeof c=="number")return u?t.alloc(c):new t(c);if(typeof c=="string")return u?t.from(c):new t(c);throw new Error("input must be buffer, number, or string, received "+typeof c)}function o(c){var u=s(4);return u.writeInt32BE(c,0),u}function a(c,u){c=s(c),t.isBuffer(u)&&(u=u.readUInt32BE(0));for(var d=~~u^-1,h=0;h<c.length;h++)d=n[(d^c[h])&255]^d>>>8;return d^-1}function l(){return o(a.apply(null,arguments))}l.signed=function(){return a.apply(null,arguments)},l.unsigned=function(){return a.apply(null,arguments)>>>0},e.exports=l}),MM=st(r=>{var e=require("fs"),t=require("stream").Transform,n=require("stream").PassThrough,s=require("zlib"),o=require("util"),a=require("events").EventEmitter,l=mx();r.ZipFile=c,r.dateToDosDateTime=A,o.inherits(c,a);function c(){this.outputStream=new n,this.entries=[],this.outputStreamCursor=0,this.ended=!1,this.allDone=!1,this.forceZip64Eocd=!1}c.prototype.addFile=function(N,B,W){var $=this;B=g(B,!1),W==null&&(W={});var L=new b(B,!1,W);$.entries.push(L),e.stat(N,function(H,z){if(H)return $.emit("error",H);if(!z.isFile())return $.emit("error",new Error("not a file: "+N));L.uncompressedSize=z.size,W.mtime==null&&L.setLastModDate(z.mtime),W.mode==null&&L.setFileAttributesMode(z.mode),L.setFileDataPumpFunction(function(){var K=e.createReadStream(N);L.state=b.FILE_DATA_IN_PROGRESS,K.on("error",function(ae){$.emit("error",ae)}),h($,L,K)}),p($)})},c.prototype.addReadStream=function(N,B,W){var $=this;B=g(B,!1),W==null&&(W={});var L=new b(B,!1,W);$.entries.push(L),L.setFileDataPumpFunction(function(){L.state=b.FILE_DATA_IN_PROGRESS,h($,L,N)}),p($)},c.prototype.addBuffer=function(N,B,W){var $=this;if(B=g(B,!1),N.length>1073741823)throw new Error("buffer too large: "+N.length+" > 1073741823");if(W==null&&(W={}),W.size!=null)throw new Error("options.size not allowed");var L=new b(B,!1,W);L.uncompressedSize=N.length,L.crc32=l.unsigned(N),L.crcAndFileSizeKnown=!0,$.entries.push(L),L.compress?s.deflateRaw(N,function(z,K){H(K)}):H(N);function H(z){L.compressedSize=z.length,L.setFileDataPumpFunction(function(){d($,z),d($,L.getDataDescriptor()),L.state=b.FILE_DATA_DONE,setImmediate(function(){p($)})}),p($)}},c.prototype.addEmptyDirectory=function(N,B){var W=this;if(N=g(N,!0),B==null&&(B={}),B.size!=null)throw new Error("options.size not allowed");if(B.compress!=null)throw new Error("options.compress not allowed");var $=new b(N,!0,B);W.entries.push($),$.setFileDataPumpFunction(function(){d(W,$.getDataDescriptor()),$.state=b.FILE_DATA_DONE,p(W)}),p(W)};var u=te([80,75,5,6]);c.prototype.end=function(N,B){if(typeof N=="function"&&(B=N,N=null),N==null&&(N={}),!this.ended){if(this.ended=!0,this.finalSizeCallback=B,this.forceZip64Eocd=!!N.forceZip64Format,N.comment){if(typeof N.comment=="string"?this.comment=Y(N.comment):this.comment=N.comment,this.comment.length>65535)throw new Error("comment is too large");if(oe(this.comment,u))throw new Error("comment contains end of central directory record signature")}else this.comment=x;p(this)}};function d(N,B){N.outputStream.write(B),N.outputStreamCursor+=B.length}function h(N,B,W){var $=new J,L=new V,H=B.compress?new s.DeflateRaw:new n,z=new V;W.pipe($).pipe(L).pipe(H).pipe(z).pipe(N.outputStream,{end:!1}),z.on("end",function(){if(B.crc32=$.crc32,B.uncompressedSize==null)B.uncompressedSize=L.byteCount;else if(B.uncompressedSize!==L.byteCount)return N.emit("error",new Error("file data stream has unexpected number of bytes"));B.compressedSize=z.byteCount,N.outputStreamCursor+=B.compressedSize,d(N,B.getDataDescriptor()),B.state=b.FILE_DATA_DONE,p(N)})}function p(N){if(N.allDone)return;if(N.ended&&N.finalSizeCallback!=null){var B=f(N);B!=null&&(N.finalSizeCallback(B),N.finalSizeCallback=null)}var W=$();function $(){for(var H=0;H<N.entries.length;H++){var z=N.entries[H];if(z.state<b.FILE_DATA_DONE)return z}return null}if(W!=null){if(W.state<b.READY_TO_PUMP_FILE_DATA||W.state===b.FILE_DATA_IN_PROGRESS)return;W.relativeOffsetOfLocalHeader=N.outputStreamCursor;var L=W.getLocalFileHeader();d(N,L),W.doFileDataPump()}else N.ended&&(N.offsetOfStartOfCentralDirectory=N.outputStreamCursor,N.entries.forEach(function(H){var z=H.getCentralDirectoryRecord();d(N,z)}),d(N,m(N)),N.outputStream.end(),N.allDone=!0)}function f(N){for(var B=0,W=0,$=0;$<N.entries.length;$++){var L=N.entries[$];if(L.compress)return-1;if(L.state>=b.READY_TO_PUMP_FILE_DATA){if(L.uncompressedSize==null)return-1}else if(L.uncompressedSize==null)return null;L.relativeOffsetOfLocalHeader=B;var H=L.useZip64Format();B+=y+L.utf8FileName.length,B+=L.uncompressedSize,L.crcAndFileSizeKnown||(H?B+=I:B+=O),W+=P+L.utf8FileName.length+L.fileComment.length,H&&(W+=T)}var z=0;return(N.forceZip64Eocd||N.entries.length>=65535||W>=65535||B>=4294967295)&&(z+=_+v),z+=w+N.comment.length,B+W+z}var _=56,v=20,w=22;function m(N,B){var W=!1,$=N.entries.length;(N.forceZip64Eocd||N.entries.length>=65535)&&($=65535,W=!0);var L=N.outputStreamCursor-N.offsetOfStartOfCentralDirectory,H=L;(N.forceZip64Eocd||L>=4294967295)&&(H=4294967295,W=!0);var z=N.offsetOfStartOfCentralDirectory;if((N.forceZip64Eocd||N.offsetOfStartOfCentralDirectory>=4294967295)&&(z=4294967295,W=!0),B)return W?_+v+w:w;var K=Q(w+N.comment.length);if(K.writeUInt32LE(101010256,0),K.writeUInt16LE(0,4),K.writeUInt16LE(0,6),K.writeUInt16LE($,8),K.writeUInt16LE($,10),K.writeUInt32LE(H,12),K.writeUInt32LE(z,16),K.writeUInt16LE(N.comment.length,20),N.comment.copy(K,22),!W)return K;var ae=Q(_);ae.writeUInt32LE(101075792,0),R(ae,_-12,4),ae.writeUInt16LE(C,12),ae.writeUInt16LE(E,14),ae.writeUInt32LE(0,16),ae.writeUInt32LE(0,20),R(ae,N.entries.length,24),R(ae,N.entries.length,32),R(ae,L,40),R(ae,N.offsetOfStartOfCentralDirectory,48);var D=Q(v);return D.writeUInt32LE(117853008,0),D.writeUInt32LE(0,4),R(D,N.outputStreamCursor,8),D.writeUInt32LE(1,16),Buffer.concat([ae,D,K])}function g(N,B){if(N==="")throw new Error("empty metadataPath");if(N=N.replace(/\\/g,"/"),/^[a-zA-Z]:/.test(N)||/^\//.test(N))throw new Error("absolute path: "+N);if(N.split("/").indexOf("..")!==-1)throw new Error("invalid relative path: "+N);var W=/\/$/.test(N);if(B)W||(N+="/");else if(W)throw new Error("file path cannot end with '/': "+N);return N}var x=Q(0);function b(N,B,W){if(this.utf8FileName=te(N),this.utf8FileName.length>65535)throw new Error("utf8 file name too long. "+utf8FileName.length+" > 65535");if(this.isDirectory=B,this.state=b.WAITING_FOR_METADATA,this.setLastModDate(W.mtime!=null?W.mtime:new Date),W.mode!=null?this.setFileAttributesMode(W.mode):this.setFileAttributesMode(B?16893:33204),B?(this.crcAndFileSizeKnown=!0,this.crc32=0,this.uncompressedSize=0,this.compressedSize=0):(this.crcAndFileSizeKnown=!1,this.crc32=null,this.uncompressedSize=null,this.compressedSize=null,W.size!=null&&(this.uncompressedSize=W.size)),B?this.compress=!1:(this.compress=!0,W.compress!=null&&(this.compress=!!W.compress)),this.forceZip64Format=!!W.forceZip64Format,W.fileComment){if(typeof W.fileComment=="string"?this.fileComment=te(W.fileComment,"utf-8"):this.fileComment=W.fileComment,this.fileComment.length>65535)throw new Error("fileComment is too large")}else this.fileComment=x}b.WAITING_FOR_METADATA=0,b.READY_TO_PUMP_FILE_DATA=1,b.FILE_DATA_IN_PROGRESS=2,b.FILE_DATA_DONE=3,b.prototype.setLastModDate=function(N){var B=A(N);this.lastModFileTime=B.time,this.lastModFileDate=B.date},b.prototype.setFileAttributesMode=function(N){if((N&65535)!==N)throw new Error("invalid mode. expected: 0 <= "+N+" <= 65535");this.externalFileAttributes=N<<16>>>0},b.prototype.setFileDataPumpFunction=function(N){this.doFileDataPump=N,this.state=b.READY_TO_PUMP_FILE_DATA},b.prototype.useZip64Format=function(){return this.forceZip64Format||this.uncompressedSize!=null&&this.uncompressedSize>4294967294||this.compressedSize!=null&&this.compressedSize>4294967294||this.relativeOffsetOfLocalHeader!=null&&this.relativeOffsetOfLocalHeader>4294967294};var y=30,S=20,E=45,C=831,k=2048,F=8;b.prototype.getLocalFileHeader=function(){var N=0,B=0,W=0;this.crcAndFileSizeKnown&&(N=this.crc32,B=this.compressedSize,W=this.uncompressedSize);var $=Q(y),L=k;return this.crcAndFileSizeKnown||(L|=F),$.writeUInt32LE(67324752,0),$.writeUInt16LE(S,4),$.writeUInt16LE(L,6),$.writeUInt16LE(this.getCompressionMethod(),8),$.writeUInt16LE(this.lastModFileTime,10),$.writeUInt16LE(this.lastModFileDate,12),$.writeUInt32LE(N,14),$.writeUInt32LE(B,18),$.writeUInt32LE(W,22),$.writeUInt16LE(this.utf8FileName.length,26),$.writeUInt16LE(0,28),Buffer.concat([$,this.utf8FileName])};var O=16,I=24;b.prototype.getDataDescriptor=function(){if(this.crcAndFileSizeKnown)return x;if(this.useZip64Format()){var N=Q(I);return N.writeUInt32LE(134695760,0),N.writeUInt32LE(this.crc32,4),R(N,this.compressedSize,8),R(N,this.uncompressedSize,16),N}else{var N=Q(O);return N.writeUInt32LE(134695760,0),N.writeUInt32LE(this.crc32,4),N.writeUInt32LE(this.compressedSize,8),N.writeUInt32LE(this.uncompressedSize,12),N}};var P=46,T=28;b.prototype.getCentralDirectoryRecord=function(){var N=Q(P),B=k;this.crcAndFileSizeKnown||(B|=F);var W=this.compressedSize,$=this.uncompressedSize,L=this.relativeOffsetOfLocalHeader,H,z;return this.useZip64Format()?(W=4294967295,$=4294967295,L=4294967295,H=E,z=Q(T),z.writeUInt16LE(1,0),z.writeUInt16LE(T-4,2),R(z,this.uncompressedSize,4),R(z,this.compressedSize,12),R(z,this.relativeOffsetOfLocalHeader,20)):(H=S,z=x),N.writeUInt32LE(33639248,0),N.writeUInt16LE(C,4),N.writeUInt16LE(H,6),N.writeUInt16LE(B,8),N.writeUInt16LE(this.getCompressionMethod(),10),N.writeUInt16LE(this.lastModFileTime,12),N.writeUInt16LE(this.lastModFileDate,14),N.writeUInt32LE(this.crc32,16),N.writeUInt32LE(W,20),N.writeUInt32LE($,24),N.writeUInt16LE(this.utf8FileName.length,28),N.writeUInt16LE(z.length,30),N.writeUInt16LE(this.fileComment.length,32),N.writeUInt16LE(0,34),N.writeUInt16LE(0,36),N.writeUInt32LE(this.externalFileAttributes,38),N.writeUInt32LE(L,42),Buffer.concat([N,this.utf8FileName,z,this.fileComment])},b.prototype.getCompressionMethod=function(){var N=0,B=8;return this.compress?B:N};function A(N){var B=0;B|=N.getDate()&31,B|=(N.getMonth()+1&15)<<5,B|=(N.getFullYear()-1980&127)<<9;var W=0;return W|=Math.floor(N.getSeconds()/2),W|=(N.getMinutes()&63)<<5,W|=(N.getHours()&31)<<11,{date:B,time:W}}function R(N,B,W){var $=Math.floor(B/4294967296),L=B%4294967296;N.writeUInt32LE(L,W),N.writeUInt32LE($,W+4)}o.inherits(V,t);function V(N){t.call(this,N),this.byteCount=0}V.prototype._transform=function(N,B,W){this.byteCount+=N.length,W(null,N)},o.inherits(J,t);function J(N){t.call(this,N),this.crc32=0}J.prototype._transform=function(N,B,W){this.crc32=l.unsigned(N,this.crc32),W(null,N)};var q="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0\xA0";if(q.length!==256)throw new Error("assertion failure");var U=null;function Y(N){if(/^[\x20-\x7e]*$/.test(N))return te(N,"utf-8");if(U==null){U={};for(var B=0;B<q.length;B++)U[q[B]]=B}for(var W=Q(N.length),B=0;B<N.length;B++){var $=U[N[B]];if($==null)throw new Error("character not encodable in CP437: "+JSON.stringify(N[B]));W[B]=$}return W}function Q(N){Q=B;try{return Q(N)}catch{return Q=W,Q(N)}function B($){return Buffer.allocUnsafe($)}function W($){return new Buffer($)}}function te(N,B){te=W;try{return te(N,B)}catch{return te=$,te(N,B)}function W(L,H){return Buffer.from(L,H)}function $(L,H){return new Buffer(L,H)}}function oe(N,B){oe=W;try{return oe(N,B)}catch{return oe=$,oe(N,B)}function W(L,H){return L.includes(H)}function $(L,H){for(var z=0;z<=L.length-H.length;z++)for(var K=0;;K++){if(K===H.length)return!0;if(L[z+K]!==H[K])break}return!1}}}),FM=st((r,e)=>{e.exports=t;function t(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}t.prototype.go=function(o){this.pending<this.max?s(this,o):this.waiting.push(o)},t.prototype.wait=function(o){this.pending===0?o(this.error):this.listeners.push(o)},t.prototype.hold=function(){return n(this)};function n(o){o.pending+=1;var a=!1;return l;function l(u){if(a)throw new Error("callback called twice");if(a=!0,o.error=o.error||u,o.pending-=1,o.waiting.length>0&&o.pending<o.max)s(o,o.waiting.shift());else if(o.pending===0){var d=o.listeners;o.listeners=[],d.forEach(c)}}function c(u){u(o.error)}}function s(o,a){a(n(o))}}),NM=st(r=>{var e=require("fs"),t=require("util"),n=require("stream"),s=n.Readable,o=n.Writable,a=n.PassThrough,l=FM(),c=require("events").EventEmitter;r.createFromBuffer=f,r.createFromFd=_,r.BufferSlicer=p,r.FdSlicer=u,t.inherits(u,c);function u(v,w){w=w||{},c.call(this),this.fd=v,this.pend=new l,this.pend.max=1,this.refCount=0,this.autoClose=!!w.autoClose}u.prototype.read=function(v,w,m,g,x){var b=this;b.pend.go(function(y){e.read(b.fd,v,w,m,g,function(S,E,C){y(),x(S,E,C)})})},u.prototype.write=function(v,w,m,g,x){var b=this;b.pend.go(function(y){e.write(b.fd,v,w,m,g,function(S,E,C){y(),x(S,E,C)})})},u.prototype.createReadStream=function(v){return new d(this,v)},u.prototype.createWriteStream=function(v){return new h(this,v)},u.prototype.ref=function(){this.refCount+=1},u.prototype.unref=function(){var v=this;if(v.refCount-=1,v.refCount>0)return;if(v.refCount<0)throw new Error("invalid unref");v.autoClose&&e.close(v.fd,w);function w(m){m?v.emit("error",m):v.emit("close")}},t.inherits(d,s);function d(v,w){w=w||{},s.call(this,w),this.context=v,this.context.ref(),this.start=w.start||0,this.endOffset=w.end,this.pos=this.start,this.destroyed=!1}d.prototype._read=function(v){var w=this;if(!w.destroyed){var m=Math.min(w._readableState.highWaterMark,v);if(w.endOffset!=null&&(m=Math.min(m,w.endOffset-w.pos)),m<=0){w.destroyed=!0,w.push(null),w.context.unref();return}w.context.pend.go(function(g){if(w.destroyed)return g();var x=Buffer.alloc(m);e.read(w.context.fd,x,0,m,w.pos,function(b,y){b?w.destroy(b):y===0?(w.destroyed=!0,w.push(null),w.context.unref()):(w.pos+=y,w.push(x.slice(0,y))),g()})})}},d.prototype.destroy=function(v){this.destroyed||(v=v||new Error("stream destroyed"),this.destroyed=!0,this.emit("error",v),this.context.unref())},t.inherits(h,o);function h(v,w){w=w||{},o.call(this,w),this.context=v,this.context.ref(),this.start=w.start||0,this.endOffset=w.end==null?1/0:+w.end,this.bytesWritten=0,this.pos=this.start,this.destroyed=!1,this.on("finish",this.destroy.bind(this))}h.prototype._write=function(v,w,m){var g=this;if(!g.destroyed){if(g.pos+v.length>g.endOffset){var x=new Error("maximum file length exceeded");x.code="ETOOBIG",g.destroy(),m(x);return}g.context.pend.go(function(b){if(g.destroyed)return b();e.write(g.context.fd,v,0,v.length,g.pos,function(y,S){y?(g.destroy(),b(),m(y)):(g.bytesWritten+=S,g.pos+=S,g.emit("progress"),b(),m())})})}},h.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.context.unref())},t.inherits(p,c);function p(v,w){c.call(this),w=w||{},this.refCount=0,this.buffer=v,this.maxChunkSize=w.maxChunkSize||Number.MAX_SAFE_INTEGER}p.prototype.read=function(v,w,m,g,x){var b=g+m,y=b-this.buffer.length,S=y>0?y:m;this.buffer.copy(v,w,g,b),setImmediate(function(){x(null,S)})},p.prototype.write=function(v,w,m,g,x){v.copy(this.buffer,g,w,w+m),setImmediate(function(){x(null,m,v)})},p.prototype.createReadStream=function(v){v=v||{};var w=new a(v);w.destroyed=!1,w.start=v.start||0,w.endOffset=v.end,w.pos=w.endOffset||this.buffer.length;for(var m=this.buffer.slice(w.start,w.pos),g=0;;){var x=g+this.maxChunkSize;if(x>=m.length){g<m.length&&w.write(m.slice(g,m.length));break}w.write(m.slice(g,x)),g=x}return w.end(),w.destroy=function(){w.destroyed=!0},w},p.prototype.createWriteStream=function(v){var w=this;v=v||{};var m=new o(v);return m.start=v.start||0,m.endOffset=v.end==null?this.buffer.length:+v.end,m.bytesWritten=0,m.pos=m.start,m.destroyed=!1,m._write=function(g,x,b){if(!m.destroyed){var y=m.pos+g.length;if(y>m.endOffset){var S=new Error("maximum file length exceeded");S.code="ETOOBIG",m.destroyed=!0,b(S);return}g.copy(w.buffer,m.pos,0,g.length),m.bytesWritten+=g.length,m.pos=y,m.emit("progress"),b()}},m.destroy=function(){m.destroyed=!0},m},p.prototype.ref=function(){this.refCount+=1},p.prototype.unref=function(){if(this.refCount-=1,this.refCount<0)throw new Error("invalid unref")};function f(v,w){return new p(v,w)}function _(v,w){return new u(v,w)}}),gx=st(r=>{var e=require("fs"),t=require("zlib"),n=NM(),s=mx(),o=require("util"),a=require("events").EventEmitter,l=require("stream").Transform,c=require("stream").PassThrough,u=require("stream").Writable;r.open=d,r.fromFd=h,r.fromBuffer=p,r.fromRandomAccessReader=f,r.dosDateTimeToDate=g,r.validateFileName=x,r.ZipFile=_,r.Entry=m,r.RandomAccessReader=S;function d(P,T,A){typeof T=="function"&&(A=T,T=null),T==null&&(T={}),T.autoClose==null&&(T.autoClose=!0),T.lazyEntries==null&&(T.lazyEntries=!1),T.decodeStrings==null&&(T.decodeStrings=!0),T.validateEntrySizes==null&&(T.validateEntrySizes=!0),T.strictFileNames==null&&(T.strictFileNames=!1),A==null&&(A=I),e.open(P,"r",function(R,V){if(R)return A(R);h(V,T,function(J,q){J&&e.close(V,I),A(J,q)})})}function h(P,T,A){typeof T=="function"&&(A=T,T=null),T==null&&(T={}),T.autoClose==null&&(T.autoClose=!1),T.lazyEntries==null&&(T.lazyEntries=!1),T.decodeStrings==null&&(T.decodeStrings=!0),T.validateEntrySizes==null&&(T.validateEntrySizes=!0),T.strictFileNames==null&&(T.strictFileNames=!1),A==null&&(A=I),e.fstat(P,function(R,V){if(R)return A(R);var J=n.createFromFd(P,{autoClose:!0});f(J,V.size,T,A)})}function p(P,T,A){typeof T=="function"&&(A=T,T=null),T==null&&(T={}),T.autoClose=!1,T.lazyEntries==null&&(T.lazyEntries=!1),T.decodeStrings==null&&(T.decodeStrings=!0),T.validateEntrySizes==null&&(T.validateEntrySizes=!0),T.strictFileNames==null&&(T.strictFileNames=!1);var R=n.createFromBuffer(P,{maxChunkSize:65536});f(R,P.length,T,A)}function f(P,T,A,R){typeof A=="function"&&(R=A,A=null),A==null&&(A={}),A.autoClose==null&&(A.autoClose=!0),A.lazyEntries==null&&(A.lazyEntries=!1),A.decodeStrings==null&&(A.decodeStrings=!0);var V=!!A.decodeStrings;if(A.validateEntrySizes==null&&(A.validateEntrySizes=!0),A.strictFileNames==null&&(A.strictFileNames=!1),R==null&&(R=I),typeof T!="number")throw new Error("expected totalSize parameter to be a number");if(T>Number.MAX_SAFE_INTEGER)throw new Error("zip file too large. only file sizes up to 2^52 are supported due to JavaScript's Number type being an IEEE 754 double.");P.ref();var J=22,q=65535,U=Math.min(J+q,T),Y=O(U),Q=T-Y.length;b(P,Y,0,U,Q,function(te){if(te)return R(te);for(var oe=U-J;oe>=0;oe-=1)if(Y.readUInt32LE(oe)===101010256){var N=Y.slice(oe),B=N.readUInt16LE(4);if(B!==0)return R(new Error("multi-disk zip files are not supported: found disk number: "+B));var W=N.readUInt16LE(10),$=N.readUInt32LE(16),L=N.readUInt16LE(20),H=N.length-J;if(L!==H)return R(new Error("invalid comment length. expected: "+H+". found: "+L));var z=V?k(N,22,N.length,!1):N.slice(22);if(!(W===65535||$===4294967295))return R(null,new _(P,$,T,W,z,A.autoClose,A.lazyEntries,V,A.validateEntrySizes,A.strictFileNames));var K=O(20),ae=Q+oe-K.length;b(P,K,0,K.length,ae,function(D){if(D)return R(D);if(K.readUInt32LE(0)!==117853008)return R(new Error("invalid zip64 end of central directory locator signature"));var j=F(K,8),X=O(56);b(P,X,0,X.length,j,function(Z){return Z?R(Z):X.readUInt32LE(0)!==101075792?R(new Error("invalid zip64 end of central directory record signature")):(W=F(X,32),$=F(X,48),R(null,new _(P,$,T,W,z,A.autoClose,A.lazyEntries,V,A.validateEntrySizes,A.strictFileNames)))})});return}R(new Error("end of central directory record signature not found"))})}o.inherits(_,a);function _(P,T,A,R,V,J,q,U,Y,Q){var te=this;a.call(te),te.reader=P,te.reader.on("error",function(oe){w(te,oe)}),te.reader.once("close",function(){te.emit("close")}),te.readEntryCursor=T,te.fileSize=A,te.entryCount=R,te.comment=V,te.entriesRead=0,te.autoClose=!!J,te.lazyEntries=!!q,te.decodeStrings=!!U,te.validateEntrySizes=!!Y,te.strictFileNames=!!Q,te.isOpen=!0,te.emittedError=!1,te.lazyEntries||te._readEntry()}_.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.reader.unref())};function v(P,T){P.autoClose&&P.close(),w(P,T)}function w(P,T){P.emittedError||(P.emittedError=!0,P.emit("error",T))}_.prototype.readEntry=function(){if(!this.lazyEntries)throw new Error("readEntry() called without lazyEntries:true");this._readEntry()},_.prototype._readEntry=function(){var P=this;if(P.entryCount===P.entriesRead){setImmediate(function(){P.autoClose&&P.close(),!P.emittedError&&P.emit("end")});return}if(!P.emittedError){var T=O(46);b(P.reader,T,0,T.length,P.readEntryCursor,function(A){if(A)return v(P,A);if(!P.emittedError){var R=new m,V=T.readUInt32LE(0);if(V!==33639248)return v(P,new Error("invalid central directory file header signature: 0x"+V.toString(16)));if(R.versionMadeBy=T.readUInt16LE(4),R.versionNeededToExtract=T.readUInt16LE(6),R.generalPurposeBitFlag=T.readUInt16LE(8),R.compressionMethod=T.readUInt16LE(10),R.lastModFileTime=T.readUInt16LE(12),R.lastModFileDate=T.readUInt16LE(14),R.crc32=T.readUInt32LE(16),R.compressedSize=T.readUInt32LE(20),R.uncompressedSize=T.readUInt32LE(24),R.fileNameLength=T.readUInt16LE(28),R.extraFieldLength=T.readUInt16LE(30),R.fileCommentLength=T.readUInt16LE(32),R.internalFileAttributes=T.readUInt16LE(36),R.externalFileAttributes=T.readUInt32LE(38),R.relativeOffsetOfLocalHeader=T.readUInt32LE(42),R.generalPurposeBitFlag&64)return v(P,new Error("strong encryption is not supported"));P.readEntryCursor+=46,T=O(R.fileNameLength+R.extraFieldLength+R.fileCommentLength),b(P.reader,T,0,T.length,P.readEntryCursor,function(J){if(J)return v(P,J);if(!P.emittedError){var q=(R.generalPurposeBitFlag&2048)!==0;R.fileName=P.decodeStrings?k(T,0,R.fileNameLength,q):T.slice(0,R.fileNameLength);var U=R.fileNameLength+R.extraFieldLength,Y=T.slice(R.fileNameLength,U);R.extraFields=[];for(var Q=0;Q<Y.length-3;){var te=Y.readUInt16LE(Q+0),oe=Y.readUInt16LE(Q+2),N=Q+4,B=N+oe;if(B>Y.length)return v(P,new Error("extra field length exceeds extra field buffer size"));var W=O(oe);Y.copy(W,0,N,B),R.extraFields.push({id:te,data:W}),Q=B}if(R.fileComment=P.decodeStrings?k(T,U,U+R.fileCommentLength,q):T.slice(U,U+R.fileCommentLength),R.comment=R.fileComment,P.readEntryCursor+=T.length,P.entriesRead+=1,R.uncompressedSize===4294967295||R.compressedSize===4294967295||R.relativeOffsetOfLocalHeader===4294967295){for(var $=null,Q=0;Q<R.extraFields.length;Q++){var L=R.extraFields[Q];if(L.id===1){$=L.data;break}}if($==null)return v(P,new Error("expected zip64 extended information extra field"));var H=0;if(R.uncompressedSize===4294967295){if(H+8>$.length)return v(P,new Error("zip64 extended information extra field does not include uncompressed size"));R.uncompressedSize=F($,H),H+=8}if(R.compressedSize===4294967295){if(H+8>$.length)return v(P,new Error("zip64 extended information extra field does not include compressed size"));R.compressedSize=F($,H),H+=8}if(R.relativeOffsetOfLocalHeader===4294967295){if(H+8>$.length)return v(P,new Error("zip64 extended information extra field does not include relative header offset"));R.relativeOffsetOfLocalHeader=F($,H),H+=8}}if(P.decodeStrings)for(var Q=0;Q<R.extraFields.length;Q++){var L=R.extraFields[Q];if(L.id===28789){if(L.data.length<6||L.data.readUInt8(0)!==1)continue;var z=L.data.readUInt32LE(1);if(s.unsigned(T.slice(0,R.fileNameLength))!==z)continue;R.fileName=k(L.data,5,L.data.length,!0);break}}if(P.validateEntrySizes&&R.compressionMethod===0){var K=R.uncompressedSize;if(R.isEncrypted()&&(K+=12),R.compressedSize!==K){var ae="compressed/uncompressed size mismatch for stored file: "+R.compressedSize+" != "+R.uncompressedSize;return v(P,new Error(ae))}}if(P.decodeStrings){P.strictFileNames||(R.fileName=R.fileName.replace(/\\/g,"/"));var D=x(R.fileName,P.validateFileNameOptions);if(D!=null)return v(P,new Error(D))}P.emit("entry",R),P.lazyEntries||P._readEntry()}})}})}},_.prototype.openReadStream=function(P,T,A){var R=this,V=0,J=P.compressedSize;if(A==null)A=T,T={};else{if(T.decrypt!=null){if(!P.isEncrypted())throw new Error("options.decrypt can only be specified for encrypted entries");if(T.decrypt!==!1)throw new Error("invalid options.decrypt value: "+T.decrypt);if(P.isCompressed()&&T.decompress!==!1)throw new Error("entry is encrypted and compressed, and options.decompress !== false")}if(T.decompress!=null){if(!P.isCompressed())throw new Error("options.decompress can only be specified for compressed entries");if(!(T.decompress===!1||T.decompress===!0))throw new Error("invalid options.decompress value: "+T.decompress)}if(T.start!=null||T.end!=null){if(P.isCompressed()&&T.decompress!==!1)throw new Error("start/end range not allowed for compressed entry without options.decompress === false");if(P.isEncrypted()&&T.decrypt!==!1)throw new Error("start/end range not allowed for encrypted entry without options.decrypt === false")}if(T.start!=null){if(V=T.start,V<0)throw new Error("options.start < 0");if(V>P.compressedSize)throw new Error("options.start > entry.compressedSize")}if(T.end!=null){if(J=T.end,J<0)throw new Error("options.end < 0");if(J>P.compressedSize)throw new Error("options.end > entry.compressedSize");if(J<V)throw new Error("options.end < options.start")}}if(!R.isOpen)return A(new Error("closed"));if(P.isEncrypted()&&T.decrypt!==!1)return A(new Error("entry is encrypted, and options.decrypt !== false"));R.reader.ref();var q=O(30);b(R.reader,q,0,q.length,P.relativeOffsetOfLocalHeader,function(U){try{if(U)return A(U);var Y=q.readUInt32LE(0);if(Y!==67324752)return A(new Error("invalid local file header signature: 0x"+Y.toString(16)));var Q=q.readUInt16LE(26),te=q.readUInt16LE(28),oe=P.relativeOffsetOfLocalHeader+q.length+Q+te,N;if(P.compressionMethod===0)N=!1;else if(P.compressionMethod===8)N=T.decompress!=null?T.decompress:!0;else return A(new Error("unsupported compression method: "+P.compressionMethod));var B=oe,W=B+P.compressedSize;if(P.compressedSize!==0&&W>R.fileSize)return A(new Error("file data overflows file bounds: "+B+" + "+P.compressedSize+" > "+R.fileSize));var $=R.reader.createReadStream({start:B+V,end:B+J}),L=$;if(N){var H=!1,z=t.createInflateRaw();$.on("error",function(K){setImmediate(function(){H||z.emit("error",K)})}),$.pipe(z),R.validateEntrySizes?(L=new y(P.uncompressedSize),z.on("error",function(K){setImmediate(function(){H||L.emit("error",K)})}),z.pipe(L)):L=z,L.destroy=function(){H=!0,z!==L&&z.unpipe(L),$.unpipe(z),$.destroy()}}A(null,L)}finally{R.reader.unref()}})};function m(){}m.prototype.getLastModDate=function(){return g(this.lastModFileDate,this.lastModFileTime)},m.prototype.isEncrypted=function(){return(this.generalPurposeBitFlag&1)!==0},m.prototype.isCompressed=function(){return this.compressionMethod===8};function g(P,T){var A=P&31,R=(P>>5&15)-1,V=(P>>9&127)+1980,J=0,q=(T&31)*2,U=T>>5&63,Y=T>>11&31;return new Date(V,R,A,Y,U,q,J)}function x(P){return P.indexOf("\\")!==-1?"invalid characters in fileName: "+P:/^[a-zA-Z]:/.test(P)||/^\//.test(P)?"absolute path: "+P:P.split("/").indexOf("..")!==-1?"invalid relative path: "+P:null}function b(P,T,A,R,V,J){if(R===0)return setImmediate(function(){J(null,O(0))});P.read(T,A,R,V,function(q,U){if(q)return J(q);if(U<R)return J(new Error("unexpected EOF"));J()})}o.inherits(y,l);function y(P){l.call(this),this.actualByteCount=0,this.expectedByteCount=P}y.prototype._transform=function(P,T,A){if(this.actualByteCount+=P.length,this.actualByteCount>this.expectedByteCount){var R="too many bytes in the stream. expected "+this.expectedByteCount+". got at least "+this.actualByteCount;return A(new Error(R))}A(null,P)},y.prototype._flush=function(P){if(this.actualByteCount<this.expectedByteCount){var T="not enough bytes in the stream. expected "+this.expectedByteCount+". got only "+this.actualByteCount;return P(new Error(T))}P()},o.inherits(S,a);function S(){a.call(this),this.refCount=0}S.prototype.ref=function(){this.refCount+=1},S.prototype.unref=function(){var P=this;if(P.refCount-=1,P.refCount>0)return;if(P.refCount<0)throw new Error("invalid unref");P.close(T);function T(A){if(A)return P.emit("error",A);P.emit("close")}},S.prototype.createReadStream=function(P){var T=P.start,A=P.end;if(T===A){var R=new c;return setImmediate(function(){R.end()}),R}var V=this._readStreamForRange(T,A),J=!1,q=new E(this);V.on("error",function(Y){setImmediate(function(){J||q.emit("error",Y)})}),q.destroy=function(){V.unpipe(q),q.unref(),V.destroy()};var U=new y(A-T);return q.on("error",function(Y){setImmediate(function(){J||U.emit("error",Y)})}),U.destroy=function(){J=!0,q.unpipe(U),q.destroy()},V.pipe(q).pipe(U)},S.prototype._readStreamForRange=function(P,T){throw new Error("not implemented")},S.prototype.read=function(P,T,A,R,V){var J=this.createReadStream({start:R,end:R+A}),q=new u,U=0;q._write=function(Y,Q,te){Y.copy(P,T+U,0,Y.length),U+=Y.length,te()},q.on("finish",V),J.on("error",function(Y){V(Y)}),J.pipe(q)},S.prototype.close=function(P){setImmediate(P)},o.inherits(E,c);function E(P){c.call(this),this.context=P,this.context.ref(),this.unreffedYet=!1}E.prototype._flush=function(P){this.unref(),P()},E.prototype.unref=function(P){this.unreffedYet||(this.unreffedYet=!0,this.context.unref())};var C="\0\u263A\u263B\u2665\u2666\u2663\u2660\u2022\u25D8\u25CB\u25D9\u2642\u2640\u266A\u266B\u263C\u25BA\u25C4\u2195\u203C\xB6\xA7\u25AC\u21A8\u2191\u2193\u2192\u2190\u221F\u2194\u25B2\u25BC !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xC7\xFC\xE9\xE2\xE4\xE0\xE5\xE7\xEA\xEB\xE8\xEF\xEE\xEC\xC4\xC5\xC9\xE6\xC6\xF4\xF6\xF2\xFB\xF9\xFF\xD6\xDC\xA2\xA3\xA5\u20A7\u0192\xE1\xED\xF3\xFA\xF1\xD1\xAA\xBA\xBF\u2310\xAC\xBD\xBC\xA1\xAB\xBB\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255D\u255C\u255B\u2510\u2514\u2534\u252C\u251C\u2500\u253C\u255E\u255F\u255A\u2554\u2569\u2566\u2560\u2550\u256C\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256B\u256A\u2518\u250C\u2588\u2584\u258C\u2590\u2580\u03B1\xDF\u0393\u03C0\u03A3\u03C3\xB5\u03C4\u03A6\u0398\u03A9\u03B4\u221E\u03C6\u03B5\u2229\u2261\xB1\u2265\u2264\u2320\u2321\xF7\u2248\xB0\u2219\xB7\u221A\u207F\xB2\u25A0\xA0";function k(P,T,A,R){if(R)return P.toString("utf8",T,A);for(var V="",J=T;J<A;J++)V+=C[P[J]];return V}function F(P,T){var A=P.readUInt32LE(T),R=P.readUInt32LE(T+4);return R*4294967296+A}var O;typeof Buffer.allocUnsafe=="function"?O=function(P){return Buffer.allocUnsafe(P)}:O=function(P){return new Buffer(P)};function I(P){if(P)throw P}}),LM=st((r,e)=>{var t=1e3,n=t*60,s=n*60,o=s*24,a=o*7,l=o*365.25;e.exports=function(p,f){f=f||{};var _=typeof p;if(_==="string"&&p.length>0)return c(p);if(_==="number"&&isFinite(p))return f.long?d(p):u(p);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(p))};function c(p){if(p=String(p),!(p.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(p);if(f){var _=parseFloat(f[1]),v=(f[2]||"ms").toLowerCase();switch(v){case"years":case"year":case"yrs":case"yr":case"y":return _*l;case"weeks":case"week":case"w":return _*a;case"days":case"day":case"d":return _*o;case"hours":case"hour":case"hrs":case"hr":case"h":return _*s;case"minutes":case"minute":case"mins":case"min":case"m":return _*n;case"seconds":case"second":case"secs":case"sec":case"s":return _*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function u(p){var f=Math.abs(p);return f>=o?Math.round(p/o)+"d":f>=s?Math.round(p/s)+"h":f>=n?Math.round(p/n)+"m":f>=t?Math.round(p/t)+"s":p+"ms"}function d(p){var f=Math.abs(p);return f>=o?h(p,f,o,"day"):f>=s?h(p,f,s,"hour"):f>=n?h(p,f,n,"minute"):f>=t?h(p,f,t,"second"):p+" ms"}function h(p,f,_,v){var w=f>=_*1.5;return Math.round(p/_)+" "+v+(w?"s":"")}}),_x=st((r,e)=>{function t(n){o.debug=o,o.default=o,o.coerce=h,o.disable=c,o.enable=l,o.enabled=u,o.humanize=LM(),o.destroy=p,Object.keys(n).forEach(f=>{o[f]=n[f]}),o.names=[],o.skips=[],o.formatters={};function s(f){let _=0;for(let v=0;v<f.length;v++)_=(_<<5)-_+f.charCodeAt(v),_|=0;return o.colors[Math.abs(_)%o.colors.length]}o.selectColor=s;function o(f){let _,v=null,w,m;function g(...x){if(!g.enabled)return;let b=g,y=Number(new Date),S=y-(_||y);b.diff=S,b.prev=_,b.curr=y,_=y,x[0]=o.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let E=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(C,k)=>{if(C==="%%")return"%";E++;let F=o.formatters[k];if(typeof F=="function"){let O=x[E];C=F.call(b,O),x.splice(E,1),E--}return C}),o.formatArgs.call(b,x),(b.log||o.log).apply(b,x)}return g.namespace=f,g.useColors=o.useColors(),g.color=o.selectColor(f),g.extend=a,g.destroy=o.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>v!==null?v:(w!==o.namespaces&&(w=o.namespaces,m=o.enabled(f)),m),set:x=>{v=x}}),typeof o.init=="function"&&o.init(g),g}function a(f,_){let v=o(this.namespace+(typeof _>"u"?":":_)+f);return v.log=this.log,v}function l(f){o.save(f),o.namespaces=f,o.names=[],o.skips=[];let _,v=(typeof f=="string"?f:"").split(/[\s,]+/),w=v.length;for(_=0;_<w;_++)v[_]&&(f=v[_].replace(/\*/g,".*?"),f[0]==="-"?o.skips.push(new RegExp("^"+f.slice(1)+"$")):o.names.push(new RegExp("^"+f+"$")))}function c(){let f=[...o.names.map(d),...o.skips.map(d).map(_=>"-"+_)].join(",");return o.enable(""),f}function u(f){if(f[f.length-1]==="*")return!0;let _,v;for(_=0,v=o.skips.length;_<v;_++)if(o.skips[_].test(f))return!1;for(_=0,v=o.names.length;_<v;_++)if(o.names[_].test(f))return!0;return!1}function d(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function h(f){return f instanceof Error?f.stack||f.message:f}function p(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return o.enable(o.load()),o}e.exports=t}),DM=st((r,e)=>{r.formatArgs=n,r.save=s,r.load=o,r.useColors=t,r.storage=a(),r.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function t(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let u="color: "+this.color;c.splice(1,0,u,"color: inherit");let d=0,h=0;c[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(d++,p==="%c"&&(h=d))}),c.splice(h,0,u)}r.log=console.debug||console.log||(()=>{});function s(c){try{c?r.storage.setItem("debug",c):r.storage.removeItem("debug")}catch{}}function o(){let c;try{c=r.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function a(){try{return localStorage}catch{}}e.exports=_x()(r);var{formatters:l}=e.exports;l.j=function(c){try{return JSON.stringify(c)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}}),BM=st((r,e)=>{"use strict";e.exports=(t,n)=>{n=n||process.argv;let s=t.startsWith("-")?"":t.length===1?"-":"--",o=n.indexOf(s+t),a=n.indexOf("--");return o!==-1&&(a===-1?!0:o<a)}}),jM=st((r,e)=>{"use strict";var t=require("os"),n=BM(),s=process.env,o;n("no-color")||n("no-colors")||n("color=false")?o=!1:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(o=!0),"FORCE_COLOR"in s&&(o=s.FORCE_COLOR.length===0||parseInt(s.FORCE_COLOR,10)!==0);function a(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function l(u){if(o===!1)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!u.isTTY&&o!==!0)return 0;let d=o?1:0;if(process.platform==="win32"){let h=t.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(h[0])>=10&&Number(h[2])>=10586?Number(h[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(h=>h in s)||s.CI_NAME==="codeship"?1:d;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if(s.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in s){let h=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return h>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:(s.TERM,d)}function c(u){let d=l(u);return a(d)}e.exports={supportsColor:c,stdout:c(process.stdout),stderr:c(process.stderr)}}),qM=st((r,e)=>{var t=require("tty"),n=require("util");r.init=d,r.log=l,r.formatArgs=o,r.save=c,r.load=u,r.useColors=s,r.destroy=n.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),r.colors=[6,2,3,4,5,1];try{let p=jM();p&&(p.stderr||p).level>=2&&(r.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}r.inspectOpts=Object.keys(process.env).filter(p=>/^debug_/i.test(p)).reduce((p,f)=>{let _=f.substring(6).toLowerCase().replace(/_([a-z])/g,(w,m)=>m.toUpperCase()),v=process.env[f];return/^(yes|on|true|enabled)$/i.test(v)?v=!0:/^(no|off|false|disabled)$/i.test(v)?v=!1:v==="null"?v=null:v=Number(v),p[_]=v,p},{});function s(){return"colors"in r.inspectOpts?!!r.inspectOpts.colors:t.isatty(process.stderr.fd)}function o(p){let{namespace:f,useColors:_}=this;if(_){let v=this.color,w="\x1B[3"+(v<8?v:"8;5;"+v),m=`  ${w};1m${f} \x1B[0m`;p[0]=m+p[0].split(`
`).join(`
`+m),p.push(w+"m+"+e.exports.humanize(this.diff)+"\x1B[0m")}else p[0]=a()+f+" "+p[0]}function a(){return r.inspectOpts.hideDate?"":new Date().toISOString()+" "}function l(...p){return process.stderr.write(n.format(...p)+`
`)}function c(p){p?process.env.DEBUG=p:delete process.env.DEBUG}function u(){return process.env.DEBUG}function d(p){p.inspectOpts={};let f=Object.keys(r.inspectOpts);for(let _=0;_<f.length;_++)p.inspectOpts[f[_]]=r.inspectOpts[f[_]]}e.exports=_x()(r);var{formatters:h}=e.exports;h.o=function(p){return this.inspectOpts.colors=this.useColors,n.inspect(p,this.inspectOpts).split(`
`).map(f=>f.trim()).join(" ")},h.O=function(p){return this.inspectOpts.colors=this.useColors,n.inspect(p,this.inspectOpts)}}),HM=st((r,e)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?e.exports=DM():e.exports=qM()}),$M=st((r,e)=>{e.exports=t;function t(n,s){if(n&&s)return t(n)(s);if(typeof n!="function")throw new TypeError("need wrapper function");return Object.keys(n).forEach(function(a){o[a]=n[a]}),o;function o(){for(var a=new Array(arguments.length),l=0;l<a.length;l++)a[l]=arguments[l];var c=n.apply(this,a),u=a[a.length-1];return typeof c=="function"&&c!==u&&Object.keys(u).forEach(function(d){c[d]=u[d]}),c}}}),wx=st((r,e)=>{var t=$M();e.exports=t(n),e.exports.strict=t(s),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return s(this)},configurable:!0})});function n(o){var a=function(){return a.called?a.value:(a.called=!0,a.value=o.apply(this,arguments))};return a.called=!1,a}function s(o){var a=function(){if(a.called)throw new Error(a.onceError);return a.called=!0,a.value=o.apply(this,arguments)},l=o.name||"Function wrapped with `once`";return a.onceError=l+" shouldn't be called more than once",a.called=!1,a}}),WM=st((r,e)=>{var t=wx(),n=function(){},s=function(l){return l.setHeader&&typeof l.abort=="function"},o=function(l){return l.stdio&&Array.isArray(l.stdio)&&l.stdio.length===3},a=function(l,c,u){if(typeof c=="function")return a(l,null,c);c||(c={}),u=t(u||n);var d=l._writableState,h=l._readableState,p=c.readable||c.readable!==!1&&l.readable,f=c.writable||c.writable!==!1&&l.writable,_=!1,v=function(){l.writable||w()},w=function(){f=!1,p||u.call(l)},m=function(){p=!1,f||u.call(l)},g=function(E){u.call(l,E?new Error("exited with error code: "+E):null)},x=function(E){u.call(l,E)},b=function(){process.nextTick(y)},y=function(){if(!_){if(p&&!(h&&h.ended&&!h.destroyed))return u.call(l,new Error("premature close"));if(f&&!(d&&d.ended&&!d.destroyed))return u.call(l,new Error("premature close"))}},S=function(){l.req.on("finish",w)};return s(l)?(l.on("complete",w),l.on("abort",b),l.req?S():l.on("request",S)):f&&!d&&(l.on("end",v),l.on("close",v)),o(l)&&l.on("exit",g),l.on("end",m),l.on("finish",w),c.error!==!1&&l.on("error",x),l.on("close",b),function(){_=!0,l.removeListener("complete",w),l.removeListener("abort",b),l.removeListener("request",S),l.req&&l.req.removeListener("finish",w),l.removeListener("end",v),l.removeListener("close",v),l.removeListener("finish",w),l.removeListener("exit",g),l.removeListener("end",m),l.removeListener("error",x),l.removeListener("close",b)}};e.exports=a}),UM=st((r,e)=>{var t=wx(),n=WM(),s=require("fs"),o=function(){},a=/^v?\.0/.test(process.version),l=function(_){return typeof _=="function"},c=function(_){return!a||!s?!1:(_ instanceof(s.ReadStream||o)||_ instanceof(s.WriteStream||o))&&l(_.close)},u=function(_){return _.setHeader&&l(_.abort)},d=function(_,v,w,m){m=t(m);var g=!1;_.on("close",function(){g=!0}),n(_,{readable:v,writable:w},function(b){if(b)return m(b);g=!0,m()});var x=!1;return function(b){if(!g&&!x){if(x=!0,c(_))return _.close(o);if(u(_))return _.abort();if(l(_.destroy))return _.destroy();m(b||new Error("stream was destroyed"))}}},h=function(_){_()},p=function(_,v){return _.pipe(v)},f=function(){var _=Array.prototype.slice.call(arguments),v=l(_[_.length-1]||o)&&_.pop()||o;if(Array.isArray(_[0])&&(_=_[0]),_.length<2)throw new Error("pump requires two streams per minimum");var w,m=_.map(function(g,x){var b=x<_.length-1,y=x>0;return d(g,b,y,function(S){w||(w=S),S&&m.forEach(h),!b&&(m.forEach(h),v(w))})});return _.reduce(p)};e.exports=f}),zM=st((r,e)=>{"use strict";var{PassThrough:t}=require("stream");e.exports=n=>{n={...n};let{array:s}=n,{encoding:o}=n,a=o==="buffer",l=!1;s?l=!(o||a):o=o||"utf8",a&&(o=null);let c=new t({objectMode:l});o&&c.setEncoding(o);let u=0,d=[];return c.on("data",h=>{d.push(h),l?u=d.length:u+=h.length}),c.getBufferedValue=()=>s?d:a?Buffer.concat(d,u):d.join(""),c.getBufferedLength=()=>u,c}}),VM=st((r,e)=>{"use strict";var{constants:t}=require("buffer"),n=UM(),s=zM(),o=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function a(l,c){if(!l)return Promise.reject(new Error("Expected a stream"));c={maxBuffer:1/0,...c};let{maxBuffer:u}=c,d;return await new Promise((h,p)=>{let f=_=>{_&&d.getBufferedLength()<=t.MAX_LENGTH&&(_.bufferedData=d.getBufferedValue()),p(_)};d=n(l,s(c),_=>{if(_){f(_);return}h()}),d.on("data",()=>{d.getBufferedLength()>u&&f(new o)})}),d.getBufferedValue()}e.exports=a,e.exports.default=a,e.exports.buffer=(l,c)=>a(l,{...c,encoding:"buffer"}),e.exports.array=(l,c)=>a(l,{...c,array:!0}),e.exports.MaxBufferError=o}),GM=st((r,e)=>{var t=HM()("extract-zip"),{createWriteStream:n,promises:s}=require("fs"),o=VM(),a=require("path"),{promisify:l}=require("util"),c=require("stream"),u=gx(),d=l(u.open),h=l(c.pipeline),p=class{constructor(f,_){this.zipPath=f,this.opts=_}async extract(){return t("opening",this.zipPath,"with opts",this.opts),this.zipfile=await d(this.zipPath,{lazyEntries:!0}),this.canceled=!1,new Promise((f,_)=>{this.zipfile.on("error",v=>{this.canceled=!0,_(v)}),this.zipfile.readEntry(),this.zipfile.on("close",()=>{this.canceled||(t("zip extraction complete"),f())}),this.zipfile.on("entry",async v=>{if(this.canceled){t("skipping entry",v.fileName,{cancelled:this.canceled});return}if(t("zipfile entry",v.fileName),v.fileName.startsWith("__MACOSX/")){this.zipfile.readEntry();return}let w=a.dirname(a.join(this.opts.dir,v.fileName));try{await s.mkdir(w,{recursive:!0});let m=await s.realpath(w);if(a.relative(this.opts.dir,m).split(a.sep).includes(".."))throw new Error(`Out of bound path "${m}" found while processing file ${v.fileName}`);await this.extractEntry(v),t("finished processing",v.fileName),this.zipfile.readEntry()}catch(m){this.canceled=!0,this.zipfile.close(),_(m)}})})}async extractEntry(f){if(this.canceled){t("skipping entry extraction",f.fileName,{cancelled:this.canceled});return}this.opts.onEntry&&this.opts.onEntry(f,this.zipfile);let _=a.join(this.opts.dir,f.fileName),v=f.externalFileAttributes>>16&65535,w=61440,m=16384,g=40960,x=(v&w)===g,b=(v&w)===m;!b&&f.fileName.endsWith("/")&&(b=!0);let y=f.versionMadeBy>>8;b||(b=y===0&&f.externalFileAttributes===16),t("extracting entry",{filename:f.fileName,isDir:b,isSymlink:x});let S=this.getExtractedMode(v,b)&511,E=b?_:a.dirname(_),C={recursive:!0};if(b&&(C.mode=S),t("mkdir",{dir:E,...C}),await s.mkdir(E,C),b)return;t("opening read stream",_);let k=await l(this.zipfile.openReadStream.bind(this.zipfile))(f);if(x){let F=await o(k);t("creating symlink",F,_),await s.symlink(F,_)}else await h(k,n(_,{mode:S}))}getExtractedMode(f,_){let v=f;return v===0&&(_?(this.opts.defaultDirMode&&(v=parseInt(this.opts.defaultDirMode,10)),v||(v=493)):(this.opts.defaultFileMode&&(v=parseInt(this.opts.defaultFileMode,10)),v||(v=420))),v}};e.exports=async function(f,_){if(t("creating target directory",_.dir),!a.isAbsolute(_.dir))throw new Error("Target directory is expected to be absolute");return await s.mkdir(_.dir,{recursive:!0}),_.dir=await s.realpath(_.dir),new p(f,_).extract()}}),vx={};IM(vx,{extract:()=>YM,yauzl:()=>JM,yazl:()=>KM});bx.exports=RM(vx);var KM=ef(MM()),JM=ef(gx()),XM=ef(GM()),YM=XM.default});var yo=M(ar=>{"use strict";Object.defineProperty(ar,"__esModule",{value:!0});ar.yazl=ar.yauzl=ar.extract=void 0;var d8=ar.yazl=Pl().yazl,h8=ar.yauzl=Pl().yauzl,p8=ar.extract=Pl().extract});var nf=M(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});Al.ZipFile=void 0;var QM=yo(),tf=class{constructor(e){this._fileName=void 0,this._zipFile=void 0,this._entries=new Map,this._openedPromise=void 0,this._fileName=e,this._openedPromise=this._open()}async _open(){await new Promise((e,t)=>{QM.yauzl.open(this._fileName,{autoClose:!1},(n,s)=>{if(n){t(n);return}this._zipFile=s,this._zipFile.on("entry",o=>{this._entries.set(o.fileName,o)}),this._zipFile.on("end",e)})})}async entries(){return await this._openedPromise,[...this._entries.keys()]}async read(e){await this._openedPromise;let t=this._entries.get(e);if(!t)throw new Error(`${e} not found in file ${this._fileName}`);return new Promise((n,s)=>{this._zipFile.openReadStream(t,(o,a)=>{if(o||!a){s(o||"Entry not found");return}let l=[];a.on("data",c=>l.push(c)),a.on("end",()=>n(Buffer.concat(l)))})})}close(){var e;(e=this._zipFile)===null||e===void 0||e.close()}};Al.ZipFile=tf});var of=M(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.zones=void 0;var ZM=require("async_hooks"),rf=class{constructor(){this._asyncLocalStorage=new ZM.AsyncLocalStorage}run(e,t,n){let s=this._asyncLocalStorage.getStore(),o=new sf(s,e,t);return this._asyncLocalStorage.run(o,n)}zoneData(e){for(let t=this._asyncLocalStorage.getStore();t;t=t.previous)if(t.type===e)return t.data}exitZones(e){return this._asyncLocalStorage.run(void 0,e)}printZones(){let e=[];for(let t=this._asyncLocalStorage.getStore();t;t=t.previous){let n=t.type;t.type==="apiZone"&&(n+=`(${t.data.apiName})`),e.push(n)}console.log("zones: ",e.join(" -> "))}},sf=class{constructor(e,t,n){this.type=void 0,this.data=void 0,this.previous=void 0,this.type=t,this.data=n,this.previous=e}},g8=Il.zones=new rf});var Ex=M(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.WhitespaceToken=ce.URLToken=ce.SuffixMatchToken=ce.SubstringMatchToken=ce.StringValuedToken=ce.StringToken=ce.SemicolonToken=ce.PrefixMatchToken=ce.PercentageToken=ce.OpenSquareToken=ce.OpenParenToken=ce.OpenCurlyToken=ce.NumberToken=ce.InvalidCharacterError=ce.IncludeMatchToken=ce.IdentToken=ce.HashToken=ce.GroupingToken=ce.FunctionToken=ce.EOFToken=ce.DimensionToken=ce.DelimToken=ce.DashMatchToken=ce.CommaToken=ce.ColumnToken=ce.ColonToken=ce.CloseSquareToken=ce.CloseParenToken=ce.CloseCurlyToken=ce.CSSParserToken=ce.CDOToken=ce.CDCToken=ce.BadURLToken=ce.BadStringToken=ce.AtKeywordToken=void 0;ce.tokenize=aF;var et=function(r,e,t){return r>=e&&r<=t};function Mt(r){return et(r,48,57)}function yx(r){return Mt(r)||et(r,65,70)||et(r,97,102)}function eF(r){return et(r,65,90)}function tF(r){return et(r,97,122)}function nF(r){return eF(r)||tF(r)}function rF(r){return r>=128}function Rl(r){return nF(r)||rF(r)||r===95}function xx(r){return Rl(r)||Mt(r)||r===45}function iF(r){return et(r,0,8)||r===11||et(r,14,31)||r===127}function Wi(r){return r===10}function Ln(r){return Wi(r)||r===9||r===32}var sF=1114111,Vi=class extends Error{constructor(e){super(e),this.name="InvalidCharacterError"}};ce.InvalidCharacterError=Vi;function oF(r){let e=[];for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);if(n===13&&r.charCodeAt(t+1)===10&&(n=10,t++),(n===13||n===12)&&(n=10),n===0&&(n=65533),et(n,55296,56319)&&et(r.charCodeAt(t+1),56320,57343)){let s=n-55296,o=r.charCodeAt(t+1)-56320;n=Math.pow(2,16)+s*Math.pow(2,10)+o,t++}e.push(n)}return e}function ot(r){if(r<=65535)return String.fromCharCode(r);r-=Math.pow(2,16);let e=Math.floor(r/Math.pow(2,10))+55296,t=r%Math.pow(2,10)+56320;return String.fromCharCode(e)+String.fromCharCode(t)}function aF(r){let e=oF(r),t=-1,n=[],s,o=0,a=0,l=0,c=function(){o+=1,l=a,a=0},u={line:o,column:a},d=function(q){return q>=e.length?-1:e[q]},h=function(q){if(q===void 0&&(q=1),q>3)throw"Spec Error: no more than three codepoints of lookahead.";return d(t+q)},p=function(q){return q===void 0&&(q=1),t+=q,s=d(t),Wi(s)?c():a+=q,!0},f=function(){return t-=1,Wi(s)?(o-=1,a=l):a-=1,u.line=o,u.column=a,!0},_=function(q){return q===void 0&&(q=s),q===-1},v=function(){},w=function(){},m=function(){if(g(),p(),Ln(s)){for(;Ln(h());)p();return new Fl}else{if(s===34)return y();if(s===35)if(xx(h())||C(h(1),h(2))){let q=new tc("");return F(h(1),h(2),h(3))&&(q.type="id"),q.value=T(),q}else return new vt(s);else return s===36?h()===61?(p(),new Jl):new vt(s):s===39?y():s===40?new Ul:s===41?new zl:s===42?h()===61?(p(),new Xl):new vt(s):s===43?P()?(f(),x()):new vt(s):s===44?new jl:s===45?P()?(f(),x()):h(1)===45&&h(2)===62?(p(2),new Ll):O()?(f(),b()):new vt(s):s===46?P()?(f(),x()):new vt(s):s===58?new Dl:s===59?new Bl:s===60?h(1)===33&&h(2)===45&&h(3)===45?(p(3),new Nl):new vt(s):s===64?F(h(1),h(2),h(3))?new ec(T()):new vt(s):s===91?new $l:s===92?k()?(f(),b()):(w(),new vt(s)):s===93?new Wl:s===94?h()===61?(p(),new Kl):new vt(s):s===123?new ql:s===124?h()===61?(p(),new Gl):h()===124?(p(),new Yl):new vt(s):s===125?new Hl:s===126?h()===61?(p(),new Vl):new vt(s):Mt(s)?(f(),x()):Rl(s)?(f(),b()):_()?new Ql:new vt(s)}},g=function(){for(;h(1)===47&&h(2)===42;)for(p(2);;)if(p(),s===42&&h()===47){p();break}else if(_()){w();return}},x=function(){let q=A();if(F(h(1),h(2),h(3))){let U=new oc;return U.value=q.value,U.repr=q.repr,U.type=q.type,U.unit=T(),U}else if(h()===37){p();let U=new sc;return U.value=q.value,U.repr=q.repr,U}else{let U=new ic;return U.value=q.value,U.repr=q.repr,U.type=q.type,U}},b=function(){let q=T();if(q.toLowerCase()==="url"&&h()===40){for(p();Ln(h(1))&&Ln(h(2));)p();return h()===34||h()===39?new zi(q):Ln(h())&&(h(2)===34||h(2)===39)?new zi(q):S()}else return h()===40?(p(),new zi(q)):new Zl(q)},y=function(q){q===void 0&&(q=s);let U="";for(;p();){if(s===q||_())return new nc(U);if(Wi(s))return w(),f(),new Ml;s===92?_(h())?v():Wi(h())?p():U+=ot(E()):U+=ot(s)}throw new Error("Internal error")},S=function(){let q=new rc("");for(;Ln(h());)p();if(_(h()))return q;for(;p();){if(s===41||_())return q;if(Ln(s)){for(;Ln(h());)p();return h()===41||_(h())?(p(),q):(V(),new Ui)}else{if(s===34||s===39||s===40||iF(s))return w(),V(),new Ui;if(s===92)if(k())q.value+=ot(E());else return w(),V(),new Ui;else q.value+=ot(s)}}throw new Error("Internal error")},E=function(){if(p(),yx(s)){let q=[s];for(let Y=0;Y<5&&yx(h());Y++)p(),q.push(s);Ln(h())&&p();let U=parseInt(q.map(function(Y){return String.fromCharCode(Y)}).join(""),16);return U>sF&&(U=65533),U}else return _()?65533:s},C=function(q,U){return!(q!==92||Wi(U))},k=function(){return C(s,h())},F=function(q,U,Y){return q===45?Rl(U)||U===45||C(U,Y):Rl(q)?!0:q===92?C(q,U):!1},O=function(){return F(s,h(1),h(2))},I=function(q,U,Y){return q===43||q===45?!!(Mt(U)||U===46&&Mt(Y)):q===46?!!Mt(U):!!Mt(q)},P=function(){return I(s,h(1),h(2))},T=function(){let q="";for(;p();)if(xx(s))q+=ot(s);else if(k())q+=ot(E());else return f(),q;throw new Error("Internal parse error")},A=function(){let q="",U="integer";for((h()===43||h()===45)&&(p(),q+=ot(s));Mt(h());)p(),q+=ot(s);if(h(1)===46&&Mt(h(2)))for(p(),q+=ot(s),p(),q+=ot(s),U="number";Mt(h());)p(),q+=ot(s);let Y=h(1),Q=h(2),te=h(3);if((Y===69||Y===101)&&Mt(Q))for(p(),q+=ot(s),p(),q+=ot(s),U="number";Mt(h());)p(),q+=ot(s);else if((Y===69||Y===101)&&(Q===43||Q===45)&&Mt(te))for(p(),q+=ot(s),p(),q+=ot(s),p(),q+=ot(s),U="number";Mt(h());)p(),q+=ot(s);let oe=R(q);return{type:U,value:oe,repr:q}},R=function(q){return+q},V=function(){for(;p();){if(s===41||_())return;k()&&E(),v()}},J=0;for(;!_(h());)if(n.push(m()),J++,J>e.length*2)throw new Error("I'm infinite-looping!");return n}var je=class{constructor(){this.tokenType="",this.value=void 0}toJSON(){return{token:this.tokenType}}toString(){return this.tokenType}toSource(){return""+this}};ce.CSSParserToken=je;var Ml=class extends je{constructor(...e){super(...e),this.tokenType="BADSTRING"}};ce.BadStringToken=Ml;var Ui=class extends je{constructor(...e){super(...e),this.tokenType="BADURL"}};ce.BadURLToken=Ui;var Fl=class extends je{constructor(...e){super(...e),this.tokenType="WHITESPACE"}toString(){return"WS"}toSource(){return" "}};ce.WhitespaceToken=Fl;var Nl=class extends je{constructor(...e){super(...e),this.tokenType="CDO"}toSource(){return"<!--"}};ce.CDOToken=Nl;var Ll=class extends je{constructor(...e){super(...e),this.tokenType="CDC"}toSource(){return"-->"}};ce.CDCToken=Ll;var Dl=class extends je{constructor(...e){super(...e),this.tokenType=":"}};ce.ColonToken=Dl;var Bl=class extends je{constructor(...e){super(...e),this.tokenType=";"}};ce.SemicolonToken=Bl;var jl=class extends je{constructor(...e){super(...e),this.tokenType=","}};ce.CommaToken=jl;var Dn=class extends je{constructor(...e){super(...e),this.value="",this.mirror=""}};ce.GroupingToken=Dn;var ql=class extends Dn{constructor(){super(),this.tokenType="{",this.value="{",this.mirror="}"}};ce.OpenCurlyToken=ql;var Hl=class extends Dn{constructor(){super(),this.tokenType="}",this.value="}",this.mirror="{"}};ce.CloseCurlyToken=Hl;var $l=class extends Dn{constructor(){super(),this.tokenType="[",this.value="[",this.mirror="]"}};ce.OpenSquareToken=$l;var Wl=class extends Dn{constructor(){super(),this.tokenType="]",this.value="]",this.mirror="["}};ce.CloseSquareToken=Wl;var Ul=class extends Dn{constructor(){super(),this.tokenType="(",this.value="(",this.mirror=")"}};ce.OpenParenToken=Ul;var zl=class extends Dn{constructor(){super(),this.tokenType=")",this.value=")",this.mirror="("}};ce.CloseParenToken=zl;var Vl=class extends je{constructor(...e){super(...e),this.tokenType="~="}};ce.IncludeMatchToken=Vl;var Gl=class extends je{constructor(...e){super(...e),this.tokenType="|="}};ce.DashMatchToken=Gl;var Kl=class extends je{constructor(...e){super(...e),this.tokenType="^="}};ce.PrefixMatchToken=Kl;var Jl=class extends je{constructor(...e){super(...e),this.tokenType="$="}};ce.SuffixMatchToken=Jl;var Xl=class extends je{constructor(...e){super(...e),this.tokenType="*="}};ce.SubstringMatchToken=Xl;var Yl=class extends je{constructor(...e){super(...e),this.tokenType="||"}};ce.ColumnToken=Yl;var Ql=class extends je{constructor(...e){super(...e),this.tokenType="EOF"}toSource(){return""}};ce.EOFToken=Ql;var vt=class extends je{constructor(e){super(),this.tokenType="DELIM",this.value="",this.value=ot(e)}toString(){return"DELIM("+this.value+")"}toJSON(){let e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e}toSource(){return this.value==="\\"?`\\
`:this.value}};ce.DelimToken=vt;var Bn=class extends je{constructor(...e){super(...e),this.value=""}ASCIIMatch(e){return this.value.toLowerCase()===e.toLowerCase()}toJSON(){let e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e}};ce.StringValuedToken=Bn;var Zl=class extends Bn{constructor(e){super(),this.tokenType="IDENT",this.value=e}toString(){return"IDENT("+this.value+")"}toSource(){return xo(this.value)}};ce.IdentToken=Zl;var zi=class extends Bn{constructor(e){super(),this.tokenType="FUNCTION",this.mirror=void 0,this.value=e,this.mirror=")"}toString(){return"FUNCTION("+this.value+")"}toSource(){return xo(this.value)+"("}};ce.FunctionToken=zi;var ec=class extends Bn{constructor(e){super(),this.tokenType="AT-KEYWORD",this.value=e}toString(){return"AT("+this.value+")"}toSource(){return"@"+xo(this.value)}};ce.AtKeywordToken=ec;var tc=class extends Bn{constructor(e){super(),this.tokenType="HASH",this.type=void 0,this.value=e,this.type="unrestricted"}toString(){return"HASH("+this.value+")"}toJSON(){let e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.type=this.type,e}toSource(){return this.type==="id"?"#"+xo(this.value):"#"+lF(this.value)}};ce.HashToken=tc;var nc=class extends Bn{constructor(e){super(),this.tokenType="STRING",this.value=e}toString(){return'"'+Sx(this.value)+'"'}};ce.StringToken=nc;var rc=class extends Bn{constructor(e){super(),this.tokenType="URL",this.value=e}toString(){return"URL("+this.value+")"}toSource(){return'url("'+Sx(this.value)+'")'}};ce.URLToken=rc;var ic=class extends je{constructor(){super(),this.tokenType="NUMBER",this.type=void 0,this.repr=void 0,this.type="integer",this.repr=""}toString(){return this.type==="integer"?"INT("+this.value+")":"NUMBER("+this.value+")"}toJSON(){let e=super.toJSON();return e.value=this.value,e.type=this.type,e.repr=this.repr,e}toSource(){return this.repr}};ce.NumberToken=ic;var sc=class extends je{constructor(){super(),this.tokenType="PERCENTAGE",this.repr=void 0,this.repr=""}toString(){return"PERCENTAGE("+this.value+")"}toJSON(){let e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.repr=this.repr,e}toSource(){return this.repr+"%"}};ce.PercentageToken=sc;var oc=class extends je{constructor(){super(),this.tokenType="DIMENSION",this.type=void 0,this.repr=void 0,this.unit=void 0,this.type="integer",this.repr="",this.unit=""}toString(){return"DIM("+this.value+","+this.unit+")"}toJSON(){let e=this.constructor.prototype.constructor.prototype.toJSON.call(this);return e.value=this.value,e.type=this.type,e.repr=this.repr,e.unit=this.unit,e}toSource(){let e=this.repr,t=xo(this.unit);return t[0].toLowerCase()==="e"&&(t[1]==="-"||et(t.charCodeAt(1),48,57))&&(t="\\65 "+t.slice(1,t.length)),e+t}};ce.DimensionToken=oc;function xo(r){r=""+r;let e="",t=r.charCodeAt(0);for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);if(s===0)throw new Vi("Invalid character: the input contains U+0000.");et(s,1,31)||s===127||n===0&&et(s,48,57)||n===1&&et(s,48,57)&&t===45?e+="\\"+s.toString(16)+" ":s>=128||s===45||s===95||et(s,48,57)||et(s,65,90)||et(s,97,122)?e+=r[n]:e+="\\"+r[n]}return e}function lF(r){r=""+r;let e="";for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);if(n===0)throw new Vi("Invalid character: the input contains U+0000.");n>=128||n===45||n===95||et(n,48,57)||et(n,65,90)||et(n,97,122)?e+=r[t]:e+="\\"+n.toString(16)+" "}return e}function Sx(r){r=""+r;let e="";for(let t=0;t<r.length;t++){let n=r.charCodeAt(t);if(n===0)throw new Vi("Invalid character: the input contains U+0000.");et(n,1,31)||n===127?e+="\\"+n.toString(16)+" ":n===34||n===92?e+="\\"+r[t]:e+=r[t]}return e}});var Tx=M(ei=>{"use strict";Object.defineProperty(ei,"__esModule",{value:!0});ei.InvalidSelectorError=void 0;ei.isInvalidSelectorError=uF;ei.parseCSS=dF;ei.serializeSelector=Cx;var Ae=cF(Ex());function kx(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(kx=function(n){return n?t:e})(r)}function cF(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=kx(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Zr=class extends Error{};ei.InvalidSelectorError=Zr;function uF(r){return r instanceof Zr}function dF(r,e){let t;try{t=Ae.tokenize(r),t[t.length-1]instanceof Ae.EOFToken||t.push(new Ae.EOFToken)}catch(k){let F=k.message+` while parsing selector "${r}"`,O=(k.stack||"").indexOf(k.message);throw O!==-1&&(k.stack=k.stack.substring(0,O)+F+k.stack.substring(O+k.message.length)),k.message=F,k}let n=t.find(k=>k instanceof Ae.AtKeywordToken||k instanceof Ae.BadStringToken||k instanceof Ae.BadURLToken||k instanceof Ae.ColumnToken||k instanceof Ae.CDOToken||k instanceof Ae.CDCToken||k instanceof Ae.SemicolonToken||k instanceof Ae.OpenCurlyToken||k instanceof Ae.CloseCurlyToken||k instanceof Ae.URLToken||k instanceof Ae.PercentageToken);if(n)throw new Zr(`Unsupported token "${n.toSource()}" while parsing selector "${r}"`);let s=0,o=new Set;function a(){return new Zr(`Unexpected token "${t[s].toSource()}" while parsing selector "${r}"`)}function l(){for(;t[s]instanceof Ae.WhitespaceToken;)s++}function c(k=s){return t[k]instanceof Ae.IdentToken}function u(k=s){return t[k]instanceof Ae.StringToken}function d(k=s){return t[k]instanceof Ae.NumberToken}function h(k=s){return t[k]instanceof Ae.CommaToken}function p(k=s){return t[k]instanceof Ae.OpenParenToken}function f(k=s){return t[k]instanceof Ae.CloseParenToken}function _(k=s){return t[k]instanceof Ae.FunctionToken}function v(k=s){return t[k]instanceof Ae.DelimToken&&t[k].value==="*"}function w(k=s){return t[k]instanceof Ae.EOFToken}function m(k=s){return t[k]instanceof Ae.DelimToken&&[">","+","~"].includes(t[k].value)}function g(k=s){return h(k)||f(k)||w(k)||m(k)||t[k]instanceof Ae.WhitespaceToken}function x(){let k=[b()];for(;l(),!!h();)s++,k.push(b());return k}function b(){return l(),d()||u()?t[s++].value:y()}function y(){let k={simples:[]};for(l(),m()?k.simples.push({selector:{functions:[{name:"scope",args:[]}]},combinator:""}):k.simples.push({selector:S(),combinator:""});;){if(l(),m())k.simples[k.simples.length-1].combinator=t[s++].value,l();else if(g())break;k.simples.push({combinator:"",selector:S()})}return k}function S(){let k="",F=[];for(;!g();)if(c()||v())k+=t[s++].toSource();else if(t[s]instanceof Ae.HashToken)k+=t[s++].toSource();else if(t[s]instanceof Ae.DelimToken&&t[s].value===".")if(s++,c())k+="."+t[s++].toSource();else throw a();else if(t[s]instanceof Ae.ColonToken)if(s++,c())if(!e.has(t[s].value.toLowerCase()))k+=":"+t[s++].toSource();else{let O=t[s++].value.toLowerCase();F.push({name:O,args:[]}),o.add(O)}else if(_()){let O=t[s++].value.toLowerCase();if(e.has(O)?(F.push({name:O,args:x()}),o.add(O)):k+=`:${O}(${E()})`,l(),!f())throw a();s++}else throw a();else if(t[s]instanceof Ae.OpenSquareToken){for(k+="[",s++;!(t[s]instanceof Ae.CloseSquareToken)&&!w();)k+=t[s++].toSource();if(!(t[s]instanceof Ae.CloseSquareToken))throw a();k+="]",s++}else throw a();if(!k&&!F.length)throw a();return{css:k||void 0,functions:F}}function E(){let k="",F=1;for(;!w()&&((p()||_())&&F++,f()&&F--,!!F);)k+=t[s++].toSource();return k}let C=x();if(!w())throw a();if(C.some(k=>typeof k!="object"||!("simples"in k)))throw new Zr(`Error while parsing selector "${r}"`);return{selector:C,names:Array.from(o)}}function Cx(r){return r.map(e=>typeof e=="string"?`"${e}"`:typeof e=="number"?String(e):e.simples.map(({selector:t,combinator:n})=>{let s=t.css||"";return s=s+t.functions.map(o=>`:${o.name}(${Cx(o.args)})`).join(""),n&&(s+=" "+n),s}).join(" ")).join(", ")}});var ti=M(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});Object.defineProperty(cn,"InvalidSelectorError",{enumerable:!0,get:function(){return pt.InvalidSelectorError}});cn.customCSSNames=void 0;Object.defineProperty(cn,"isInvalidSelectorError",{enumerable:!0,get:function(){return pt.isInvalidSelectorError}});cn.parseAttributeSelector=wF;cn.parseSelector=cf;cn.splitSelectorByFrame=fF;cn.stringifySelector=lf;cn.visitAllSelectorParts=gF;var pt=Tx(),af=new Set(["internal:has","internal:has-not","internal:and","internal:or","internal:chain","left-of","right-of","above","below","near"]),hF=new Set(["left-of","right-of","above","below","near"]),pF=cn.customCSSNames=new Set(["not","is","where","has","scope","light","visible","text","text-matches","text-is","has-text","above","below","right-of","left-of","near","nth-match"]);function cf(r){let e=_F(r),t=[];for(let n of e.parts){if(n.name==="css"||n.name==="css:light"){n.name==="css:light"&&(n.body=":light("+n.body+")");let s=(0,pt.parseCSS)(n.body,pF);t.push({name:"css",body:s.selector,source:n.body});continue}if(af.has(n.name)){let s,o;try{let u=JSON.parse("["+n.body+"]");if(!Array.isArray(u)||u.length<1||u.length>2||typeof u[0]!="string")throw new pt.InvalidSelectorError(`Malformed selector: ${n.name}=`+n.body);if(s=u[0],u.length===2){if(typeof u[1]!="number"||!hF.has(n.name))throw new pt.InvalidSelectorError(`Malformed selector: ${n.name}=`+n.body);o=u[1]}}catch{throw new pt.InvalidSelectorError(`Malformed selector: ${n.name}=`+n.body)}let a={name:n.name,source:n.body,body:{parsed:cf(s),distance:o}},l=[...a.body.parsed.parts].reverse().find(u=>u.name==="internal:control"&&u.body==="enter-frame"),c=l?a.body.parsed.parts.indexOf(l):-1;c!==-1&&mF(a.body.parsed.parts.slice(0,c+1),t.slice(0,c+1))&&a.body.parsed.parts.splice(0,c+1),t.push(a);continue}t.push({...n,source:n.body})}if(af.has(t[0].name))throw new pt.InvalidSelectorError(`"${t[0].name}" selector cannot be first`);return{capture:e.capture,parts:t}}function fF(r){let e=cf(r),t=[],n={parts:[]},s=0;for(let o=0;o<e.parts.length;++o){let a=e.parts[o];if(a.name==="internal:control"&&a.body==="enter-frame"){if(!n.parts.length)throw new pt.InvalidSelectorError("Selector cannot start with entering frame, select the iframe first");t.push(n),n={parts:[]},s=o+1;continue}e.capture===o&&(n.capture=o-s),n.parts.push(a)}if(!n.parts.length)throw new pt.InvalidSelectorError(`Selector cannot end with entering frame, while parsing selector ${r}`);if(t.push(n),typeof e.capture=="number"&&typeof t[t.length-1].capture!="number")throw new pt.InvalidSelectorError("Can not capture the selector before diving into the frame. Only use * after the last frame has been selected");return t}function mF(r,e){return lf({parts:r})===lf({parts:e})}function lf(r,e){return typeof r=="string"?r:r.parts.map((t,n)=>{let s=!0;!e&&n!==r.capture&&(t.name==="css"||t.name==="xpath"&&t.source.startsWith("//")||t.source.startsWith(".."))&&(s=!1);let o=s?t.name+"=":"";return`${n===r.capture?"*":""}${o}${t.source}`}).join(" >> ")}function gF(r,e){let t=(n,s)=>{for(let o of n.parts)e(o,s),af.has(o.name)&&t(o.body.parsed,!0)};t(r,!1)}function _F(r){let e=0,t,n=0,s={parts:[]},o=()=>{let l=r.substring(n,e).trim(),c=l.indexOf("="),u,d;c!==-1&&l.substring(0,c).trim().match(/^[a-zA-Z_0-9-+:*]+$/)?(u=l.substring(0,c).trim(),d=l.substring(c+1)):l.length>1&&l[0]==='"'&&l[l.length-1]==='"'||l.length>1&&l[0]==="'"&&l[l.length-1]==="'"?(u="text",d=l):/^\(*\/\//.test(l)||l.startsWith("..")?(u="xpath",d=l):(u="css",d=l);let h=!1;if(u[0]==="*"&&(h=!0,u=u.substring(1)),s.parts.push({name:u,body:d}),h){if(s.capture!==void 0)throw new pt.InvalidSelectorError("Only one of the selectors can capture using * modifier");s.capture=s.parts.length-1}};if(!r.includes(">>"))return e=r.length,o(),s;let a=()=>{let c=r.substring(n,e).match(/^\s*text\s*=(.*)$/);return!!c&&!!c[1]};for(;e<r.length;){let l=r[e];l==="\\"&&e+1<r.length?e+=2:l===t?(t=void 0,e++):!t&&(l==='"'||l==="'"||l==="`")&&!a()?(t=l,e++):!t&&l===">"&&r[e+1]===">"?(o(),e+=2,n=e):e++}return o(),s}function wF(r,e){let t=0,n=r.length===0,s=()=>r[t]||"",o=()=>{let w=s();return++t,n=t>=r.length,w},a=w=>{throw n?new pt.InvalidSelectorError(`Unexpected end of selector while parsing selector \`${r}\``):new pt.InvalidSelectorError(`Error while parsing selector \`${r}\` - unexpected symbol "${s()}" at position ${t}`+(w?" during "+w:""))};function l(){for(;!n&&/\s/.test(s());)o()}function c(w){return w>="\x80"||w>="0"&&w<="9"||w>="A"&&w<="Z"||w>="a"&&w<="z"||w>="0"&&w<="9"||w==="_"||w==="-"}function u(){let w="";for(l();!n&&c(s());)w+=o();return w}function d(w){let m=o();for(m!==w&&a("parsing quoted string");!n&&s()!==w;)s()==="\\"&&o(),m+=o();return s()!==w&&a("parsing quoted string"),m+=o(),m}function h(){o()!=="/"&&a("parsing regular expression");let w="",m=!1;for(;!n;){if(s()==="\\")w+=o(),n&&a("parsing regular expression");else if(m&&s()==="]")m=!1;else if(!m&&s()==="[")m=!0;else if(!m&&s()==="/")break;w+=o()}o()!=="/"&&a("parsing regular expression");let g="";for(;!n&&s().match(/[dgimsuy]/);)g+=o();try{return new RegExp(w,g)}catch(x){throw new pt.InvalidSelectorError(`Error while parsing selector \`${r}\`: ${x.message}`)}}function p(){let w="";return l(),s()==="'"||s()==='"'?w=d(s()).slice(1,-1):w=u(),w||a("parsing property path"),w}function f(){l();let w="";return n||(w+=o()),!n&&w!=="="&&(w+=o()),["=","*=","^=","$=","|=","~="].includes(w)||a("parsing operator"),w}function _(){o();let w=[];for(w.push(p()),l();s()===".";)o(),w.push(p()),l();if(s()==="]")return o(),{name:w.join("."),jsonPath:w,op:"<truthy>",value:null,caseSensitive:!1};let m=f(),g,x=!0;if(l(),s()==="/"){if(m!=="=")throw new pt.InvalidSelectorError(`Error while parsing selector \`${r}\` - cannot use ${m} in attribute with regular expression`);g=h()}else if(s()==="'"||s()==='"')g=d(s()).slice(1,-1),l(),s()==="i"||s()==="I"?(x=!1,o()):(s()==="s"||s()==="S")&&(x=!0,o());else{for(g="";!n&&(c(s())||s()==="+"||s()===".");)g+=o();g==="true"?g=!0:g==="false"?g=!1:e||(g=+g,Number.isNaN(g)&&a("parsing attribute value"))}if(l(),s()!=="]"&&a("parsing attribute value"),o(),m!=="="&&typeof g!="string")throw new pt.InvalidSelectorError(`Error while parsing selector \`${r}\` - cannot use ${m} in attribute with non-string matching value - ${g}`);return{name:w.join("."),jsonPath:w,op:m,value:g,caseSensitive:x}}let v={name:"",attributes:[]};for(v.name=u(),l();s()==="[";)v.attributes.push(_()),l();if(n||a(void 0),!v.name&&!v.attributes.length)throw new pt.InvalidSelectorError(`Error while parsing selector \`${r}\` - selector cannot be empty`);return v}});var Xt=M(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.PythonLocatorFactory=Nt.JsonlLocatorFactory=Nt.JavaScriptLocatorFactory=Nt.JavaLocatorFactory=Nt.CSharpLocatorFactory=void 0;Nt.asLocator=vF;Nt.asLocators=Ox;var Ft=Ht(),Gi=ti();function vF(r,e,t=!1){return Ox(r,e,t)[0]}function Ox(r,e,t=!1,n=20,s){try{return Ki(new yF[r](s),(0,Gi.parseSelector)(e),t,n)}catch{return[e]}}function Ki(r,e,t=!1,n=20){let s=[...e.parts];for(let l=0;l<s.length-1;l++)if(s[l].name==="nth"&&s[l+1].name==="internal:control"&&s[l+1].body==="enter-frame"){let[c]=s.splice(l,1);s.splice(l+1,0,c)}let o=[],a=t?"frame-locator":"page";for(let l=0;l<s.length;l++){let c=s[l],u=a;if(a="locator",c.name==="nth"){c.body==="0"?o.push([r.generateLocator(u,"first",""),r.generateLocator(u,"nth","0")]):c.body==="-1"?o.push([r.generateLocator(u,"last",""),r.generateLocator(u,"nth","-1")]):o.push([r.generateLocator(u,"nth",c.body)]);continue}if(c.name==="internal:text"){let{exact:v,text:w}=So(c.body);o.push([r.generateLocator(u,"text",w,{exact:v})]);continue}if(c.name==="internal:has-text"){let{exact:v,text:w}=So(c.body);if(!v){o.push([r.generateLocator(u,"has-text",w,{exact:v})]);continue}}if(c.name==="internal:has-not-text"){let{exact:v,text:w}=So(c.body);if(!v){o.push([r.generateLocator(u,"has-not-text",w,{exact:v})]);continue}}if(c.name==="internal:has"){let v=Ki(r,c.body.parsed,!1,n);o.push(v.map(w=>r.generateLocator(u,"has",w)));continue}if(c.name==="internal:has-not"){let v=Ki(r,c.body.parsed,!1,n);o.push(v.map(w=>r.generateLocator(u,"hasNot",w)));continue}if(c.name==="internal:and"){let v=Ki(r,c.body.parsed,!1,n);o.push(v.map(w=>r.generateLocator(u,"and",w)));continue}if(c.name==="internal:or"){let v=Ki(r,c.body.parsed,!1,n);o.push(v.map(w=>r.generateLocator(u,"or",w)));continue}if(c.name==="internal:chain"){let v=Ki(r,c.body.parsed,!1,n);o.push(v.map(w=>r.generateLocator(u,"chain",w)));continue}if(c.name==="internal:label"){let{exact:v,text:w}=So(c.body);o.push([r.generateLocator(u,"label",w,{exact:v})]);continue}if(c.name==="internal:role"){let v=(0,Gi.parseAttributeSelector)(c.body,!0),w={attrs:[]};for(let m of v.attributes)m.name==="name"?(w.exact=m.caseSensitive,w.name=m.value):(m.name==="level"&&typeof m.value=="string"&&(m.value=+m.value),w.attrs.push({name:m.name==="include-hidden"?"includeHidden":m.name,value:m.value}));o.push([r.generateLocator(u,"role",v.name,w)]);continue}if(c.name==="internal:testid"){let v=(0,Gi.parseAttributeSelector)(c.body,!0),{value:w}=v.attributes[0];o.push([r.generateLocator(u,"test-id",w)]);continue}if(c.name==="internal:attr"){let v=(0,Gi.parseAttributeSelector)(c.body,!0),{name:w,value:m,caseSensitive:g}=v.attributes[0],x=m,b=!!g;if(w==="placeholder"){o.push([r.generateLocator(u,"placeholder",x,{exact:b})]);continue}if(w==="alt"){o.push([r.generateLocator(u,"alt",x,{exact:b})]);continue}if(w==="title"){o.push([r.generateLocator(u,"title",x,{exact:b})]);continue}}let d="default",h=s[l+1];h&&h.name==="internal:control"&&h.body==="enter-frame"&&(d="frame",a="frame-locator",l++);let p=(0,Gi.stringifySelector)({parts:[c]}),f=r.generateLocator(u,d,p);if(d==="default"&&h&&["internal:has-text","internal:has-not-text"].includes(h.name)){let{exact:v,text:w}=So(h.body);if(!v){let m=r.generateLocator("locator",h.name==="internal:has-text"?"has-text":"has-not-text",w,{exact:v}),g={};h.name==="internal:has-text"?g.hasText=w:g.hasNotText=w;let x=r.generateLocator(u,"default",p,g);o.push([r.chainLocators([f,m]),x]),l++;continue}}let _;if(["xpath","css"].includes(c.name)){let v=(0,Gi.stringifySelector)({parts:[c]},!0);_=r.generateLocator(u,d,v)}o.push([f,_].filter(Boolean))}return bF(r,o,n)}function bF(r,e,t){let n=e.map(()=>""),s=[],o=a=>{if(a===e.length)return s.push(r.chainLocators(n)),n.length<t;for(let l of e[a])if(n[a]=l,!o(a+1))return!1;return!0};return o(0),s}function So(r){let e=!1,t=r.match(/^\/(.*)\/([igm]*)$/);return t?{text:new RegExp(t[1],t[2])}:(r.endsWith('"')?(r=JSON.parse(r),e=!0):r.endsWith('"s')?(r=JSON.parse(r.substring(0,r.length-1)),e=!0):r.endsWith('"i')&&(r=JSON.parse(r.substring(0,r.length-1)),e=!1),{exact:e,text:r})}var ac=class{constructor(e){this.preferredQuote=e}generateLocator(e,t,n,s={}){switch(t){case"default":return s.hasText!==void 0?`locator(${this.quote(n)}, { hasText: ${this.toHasText(s.hasText)} })`:s.hasNotText!==void 0?`locator(${this.quote(n)}, { hasNotText: ${this.toHasText(s.hasNotText)} })`:`locator(${this.quote(n)})`;case"frame":return`frameLocator(${this.quote(n)})`;case"nth":return`nth(${n})`;case"first":return"first()";case"last":return"last()";case"role":let o=[];ft(s.name)?o.push(`name: ${this.regexToSourceString(s.name)}`):typeof s.name=="string"&&(o.push(`name: ${this.quote(s.name)}`),s.exact&&o.push("exact: true"));for(let{name:l,value:c}of s.attrs)o.push(`${l}: ${typeof c=="string"?this.quote(c):c}`);let a=o.length?`, { ${o.join(", ")} }`:"";return`getByRole(${this.quote(n)}${a})`;case"has-text":return`filter({ hasText: ${this.toHasText(n)} })`;case"has-not-text":return`filter({ hasNotText: ${this.toHasText(n)} })`;case"has":return`filter({ has: ${n} })`;case"hasNot":return`filter({ hasNot: ${n} })`;case"and":return`and(${n})`;case"or":return`or(${n})`;case"chain":return`locator(${n})`;case"test-id":return`getByTestId(${this.toTestIdValue(n)})`;case"text":return this.toCallWithExact("getByText",n,!!s.exact);case"alt":return this.toCallWithExact("getByAltText",n,!!s.exact);case"placeholder":return this.toCallWithExact("getByPlaceholder",n,!!s.exact);case"label":return this.toCallWithExact("getByLabel",n,!!s.exact);case"title":return this.toCallWithExact("getByTitle",n,!!s.exact);default:throw new Error("Unknown selector kind "+t)}}chainLocators(e){return e.join(".")}regexToSourceString(e){return(0,Ft.normalizeEscapedRegexQuotes)(String(e))}toCallWithExact(e,t,n){return ft(t)?`${e}(${this.regexToSourceString(t)})`:n?`${e}(${this.quote(t)}, { exact: true })`:`${e}(${this.quote(t)})`}toHasText(e){return ft(e)?this.regexToSourceString(e):this.quote(e)}toTestIdValue(e){return ft(e)?this.regexToSourceString(e):this.quote(e)}quote(e){var t;return(0,Ft.escapeWithQuotes)(e,(t=this.preferredQuote)!==null&&t!==void 0?t:"'")}};Nt.JavaScriptLocatorFactory=ac;var lc=class{generateLocator(e,t,n,s={}){switch(t){case"default":return s.hasText!==void 0?`locator(${this.quote(n)}, has_text=${this.toHasText(s.hasText)})`:s.hasNotText!==void 0?`locator(${this.quote(n)}, has_not_text=${this.toHasText(s.hasNotText)})`:`locator(${this.quote(n)})`;case"frame":return`frame_locator(${this.quote(n)})`;case"nth":return`nth(${n})`;case"first":return"first";case"last":return"last";case"role":let o=[];ft(s.name)?o.push(`name=${this.regexToString(s.name)}`):typeof s.name=="string"&&(o.push(`name=${this.quote(s.name)}`),s.exact&&o.push("exact=True"));for(let{name:l,value:c}of s.attrs){let u=typeof c=="string"?this.quote(c):c;typeof c=="boolean"&&(u=c?"True":"False"),o.push(`${(0,Ft.toSnakeCase)(l)}=${u}`)}let a=o.length?`, ${o.join(", ")}`:"";return`get_by_role(${this.quote(n)}${a})`;case"has-text":return`filter(has_text=${this.toHasText(n)})`;case"has-not-text":return`filter(has_not_text=${this.toHasText(n)})`;case"has":return`filter(has=${n})`;case"hasNot":return`filter(has_not=${n})`;case"and":return`and_(${n})`;case"or":return`or_(${n})`;case"chain":return`locator(${n})`;case"test-id":return`get_by_test_id(${this.toTestIdValue(n)})`;case"text":return this.toCallWithExact("get_by_text",n,!!s.exact);case"alt":return this.toCallWithExact("get_by_alt_text",n,!!s.exact);case"placeholder":return this.toCallWithExact("get_by_placeholder",n,!!s.exact);case"label":return this.toCallWithExact("get_by_label",n,!!s.exact);case"title":return this.toCallWithExact("get_by_title",n,!!s.exact);default:throw new Error("Unknown selector kind "+t)}}chainLocators(e){return e.join(".")}regexToString(e){let t=e.flags.includes("i")?", re.IGNORECASE":"";return`re.compile(r"${(0,Ft.normalizeEscapedRegexQuotes)(e.source).replace(/\\\//,"/").replace(/"/g,'\\"')}"${t})`}toCallWithExact(e,t,n){return ft(t)?`${e}(${this.regexToString(t)})`:n?`${e}(${this.quote(t)}, exact=True)`:`${e}(${this.quote(t)})`}toHasText(e){return ft(e)?this.regexToString(e):`${this.quote(e)}`}toTestIdValue(e){return ft(e)?this.regexToString(e):this.quote(e)}quote(e){return(0,Ft.escapeWithQuotes)(e,'"')}};Nt.PythonLocatorFactory=lc;var cc=class{generateLocator(e,t,n,s={}){let o;switch(e){case"page":o="Page";break;case"frame-locator":o="FrameLocator";break;case"locator":o="Locator";break}switch(t){case"default":return s.hasText!==void 0?`locator(${this.quote(n)}, new ${o}.LocatorOptions().setHasText(${this.toHasText(s.hasText)}))`:s.hasNotText!==void 0?`locator(${this.quote(n)}, new ${o}.LocatorOptions().setHasNotText(${this.toHasText(s.hasNotText)}))`:`locator(${this.quote(n)})`;case"frame":return`frameLocator(${this.quote(n)})`;case"nth":return`nth(${n})`;case"first":return"first()";case"last":return"last()";case"role":let a=[];ft(s.name)?a.push(`.setName(${this.regexToString(s.name)})`):typeof s.name=="string"&&(a.push(`.setName(${this.quote(s.name)})`),s.exact&&a.push(".setExact(true)"));for(let{name:c,value:u}of s.attrs)a.push(`.set${(0,Ft.toTitleCase)(c)}(${typeof u=="string"?this.quote(u):u})`);let l=a.length?`, new ${o}.GetByRoleOptions()${a.join("")}`:"";return`getByRole(AriaRole.${(0,Ft.toSnakeCase)(n).toUpperCase()}${l})`;case"has-text":return`filter(new ${o}.FilterOptions().setHasText(${this.toHasText(n)}))`;case"has-not-text":return`filter(new ${o}.FilterOptions().setHasNotText(${this.toHasText(n)}))`;case"has":return`filter(new ${o}.FilterOptions().setHas(${n}))`;case"hasNot":return`filter(new ${o}.FilterOptions().setHasNot(${n}))`;case"and":return`and(${n})`;case"or":return`or(${n})`;case"chain":return`locator(${n})`;case"test-id":return`getByTestId(${this.toTestIdValue(n)})`;case"text":return this.toCallWithExact(o,"getByText",n,!!s.exact);case"alt":return this.toCallWithExact(o,"getByAltText",n,!!s.exact);case"placeholder":return this.toCallWithExact(o,"getByPlaceholder",n,!!s.exact);case"label":return this.toCallWithExact(o,"getByLabel",n,!!s.exact);case"title":return this.toCallWithExact(o,"getByTitle",n,!!s.exact);default:throw new Error("Unknown selector kind "+t)}}chainLocators(e){return e.join(".")}regexToString(e){let t=e.flags.includes("i")?", Pattern.CASE_INSENSITIVE":"";return`Pattern.compile(${this.quote((0,Ft.normalizeEscapedRegexQuotes)(e.source))}${t})`}toCallWithExact(e,t,n,s){return ft(n)?`${t}(${this.regexToString(n)})`:s?`${t}(${this.quote(n)}, new ${e}.${(0,Ft.toTitleCase)(t)}Options().setExact(true))`:`${t}(${this.quote(n)})`}toHasText(e){return ft(e)?this.regexToString(e):this.quote(e)}toTestIdValue(e){return ft(e)?this.regexToString(e):this.quote(e)}quote(e){return(0,Ft.escapeWithQuotes)(e,'"')}};Nt.JavaLocatorFactory=cc;var uc=class{generateLocator(e,t,n,s={}){switch(t){case"default":return s.hasText!==void 0?`Locator(${this.quote(n)}, new() { ${this.toHasText(s.hasText)} })`:s.hasNotText!==void 0?`Locator(${this.quote(n)}, new() { ${this.toHasNotText(s.hasNotText)} })`:`Locator(${this.quote(n)})`;case"frame":return`FrameLocator(${this.quote(n)})`;case"nth":return`Nth(${n})`;case"first":return"First";case"last":return"Last";case"role":let o=[];ft(s.name)?o.push(`NameRegex = ${this.regexToString(s.name)}`):typeof s.name=="string"&&(o.push(`Name = ${this.quote(s.name)}`),s.exact&&o.push("Exact = true"));for(let{name:l,value:c}of s.attrs)o.push(`${(0,Ft.toTitleCase)(l)} = ${typeof c=="string"?this.quote(c):c}`);let a=o.length?`, new() { ${o.join(", ")} }`:"";return`GetByRole(AriaRole.${(0,Ft.toTitleCase)(n)}${a})`;case"has-text":return`Filter(new() { ${this.toHasText(n)} })`;case"has-not-text":return`Filter(new() { ${this.toHasNotText(n)} })`;case"has":return`Filter(new() { Has = ${n} })`;case"hasNot":return`Filter(new() { HasNot = ${n} })`;case"and":return`And(${n})`;case"or":return`Or(${n})`;case"chain":return`Locator(${n})`;case"test-id":return`GetByTestId(${this.toTestIdValue(n)})`;case"text":return this.toCallWithExact("GetByText",n,!!s.exact);case"alt":return this.toCallWithExact("GetByAltText",n,!!s.exact);case"placeholder":return this.toCallWithExact("GetByPlaceholder",n,!!s.exact);case"label":return this.toCallWithExact("GetByLabel",n,!!s.exact);case"title":return this.toCallWithExact("GetByTitle",n,!!s.exact);default:throw new Error("Unknown selector kind "+t)}}chainLocators(e){return e.join(".")}regexToString(e){let t=e.flags.includes("i")?", RegexOptions.IgnoreCase":"";return`new Regex(${this.quote((0,Ft.normalizeEscapedRegexQuotes)(e.source))}${t})`}toCallWithExact(e,t,n){return ft(t)?`${e}(${this.regexToString(t)})`:n?`${e}(${this.quote(t)}, new() { Exact = true })`:`${e}(${this.quote(t)})`}toHasText(e){return ft(e)?`HasTextRegex = ${this.regexToString(e)}`:`HasText = ${this.quote(e)}`}toTestIdValue(e){return ft(e)?this.regexToString(e):this.quote(e)}toHasNotText(e){return ft(e)?`HasNotTextRegex = ${this.regexToString(e)}`:`HasNotText = ${this.quote(e)}`}quote(e){return(0,Ft.escapeWithQuotes)(e,'"')}};Nt.CSharpLocatorFactory=uc;var dc=class{generateLocator(e,t,n,s={}){return JSON.stringify({kind:t,body:n,options:s})}chainLocators(e){let t=e.map(n=>JSON.parse(n));for(let n=0;n<t.length-1;++n)t[n].next=t[n+1];return JSON.stringify(t[0])}};Nt.JsonlLocatorFactory=dc;var yF={javascript:ac,python:lc,java:cc,csharp:uc,jsonl:dc};function ft(r){return r instanceof RegExp}});var ie=M(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});var uf=ol();Object.keys(uf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===uf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return uf[r]}})});var df=Cp();Object.keys(df).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===df[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return df[r]}})});var hf=Tp();Object.keys(hf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===hf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return hf[r]}})});var pf=Pp();Object.keys(pf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===pf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return pf[r]}})});var ff=Op();Object.keys(ff).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===ff[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return ff[r]}})});var mf=Ze();Object.keys(mf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===mf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return mf[r]}})});var gf=ht();Object.keys(gf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===gf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return gf[r]}})});var _f=up();Object.keys(_f).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===_f[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return _f[r]}})});var wf=Wy();Object.keys(wf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===wf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return wf[r]}})});var vf=go();Object.keys(vf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===vf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return vf[r]}})});var bf=Dp();Object.keys(bf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===bf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return bf[r]}})});var yf=Qe();Object.keys(yf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===yf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return yf[r]}})});var xf=Bp();Object.keys(xf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===xf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return xf[r]}})});var Sf=wl();Object.keys(Sf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Sf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Sf[r]}})});var Ef=xn();Object.keys(Ef).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Ef[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Ef[r]}})});var kf=sr();Object.keys(kf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===kf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return kf[r]}})});var Cf=ox();Object.keys(Cf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Cf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Cf[r]}})});var Tf=lp();Object.keys(Tf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Tf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Tf[r]}})});var Of=Hp();Object.keys(Of).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Of[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Of[r]}})});var Pf=kl();Object.keys(Pf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Pf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Pf[r]}})});var Af=Lt();Object.keys(Af).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Af[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Af[r]}})});var If=ax();Object.keys(If).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===If[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return If[r]}})});var Rf=lx();Object.keys(Rf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Rf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Rf[r]}})});var Mf=vo();Object.keys(Mf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Mf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Mf[r]}})});var Ff=ux();Object.keys(Ff).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Ff[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Ff[r]}})});var Nf=Nn();Object.keys(Nf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Nf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Nf[r]}})});var Lf=Zp();Object.keys(Lf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Lf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Lf[r]}})});var Df=nf();Object.keys(Df).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Df[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Df[r]}})});var Bf=of();Object.keys(Bf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===Bf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return Bf[r]}})});var jf=Xt();Object.keys(jf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===jf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return jf[r]}})});var qf=Ht();Object.keys(qf).forEach(function(r){r==="default"||r==="__esModule"||r in ne&&ne[r]===qf[r]||Object.defineProperty(ne,r,{enumerable:!0,get:function(){return qf[r]}})})});var Lt=M(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.addInternalStackPrefix=void 0;un.captureLibraryStackText=TF;un.captureLibraryStackTrace=Mx;un.captureRawStack=Rx;un.formatCallLog=PF;un.rewriteErrorMessage=kF;un.splitErrorMessage=OF;un.stringifyStackFrames=Fx;var xF=EF(require("path")),Px=Be(),SF=ie();function EF(r){return r&&r.__esModule?r:{default:r}}function kF(r,e){var t;let n=(((t=r.stack)===null||t===void 0?void 0:t.split(`
`))||[]).filter(o=>o.startsWith("    at "));r.message=e;let s=`${r.name}: ${r.message}`;return n.length&&(r.stack=`${s}
${n.join(`
`)}`),r}var Ax=xF.default.resolve(__dirname,"..",".."),Ix=[Ax],CF=r=>Ix.push(r);un.addInternalStackPrefix=CF;function Rx(){let r=Error.stackTraceLimit;Error.stackTraceLimit=50;let t=new Error().stack||"";return Error.stackTraceLimit=r,t.split(`
`)}function Mx(){let r=Rx(),e=(0,SF.isUnderTest)(),t=r.map(o=>{let a=(0,Px.parseStackTraceLine)(o);if(!a||!a.file)return null;let l=a.file.startsWith(Ax);return{frame:a,frameText:o,isPlaywrightLibrary:l}}).filter(Boolean),n="";for(let o=0;o<t.length-1;o++){let a=t[o];if(a.isPlaywrightLibrary&&!t[o+1].isPlaywrightLibrary){n=n||s(a.frame.function);break}}function s(o){if(!o)return"";let a=o.match(/(API|JS|CDP|[A-Z])(.*)/);return a?a[1].toLowerCase()+a[2]:o}return t=t.filter(o=>process.env.PWDEBUGIMPL?!0:!Ix.some(a=>o.frame.file.startsWith(a))),{frames:t.map(o=>o.frame),apiName:n}}function Fx(r){let e=[];for(let t of r)t.function?e.push(`    at ${t.function} (${t.file}:${t.line}:${t.column})`):e.push(`    at ${t.file}:${t.line}:${t.column}`);return e}function TF(){let r=Mx();return Fx(r.frames).join(`
`)}function OF(r){let e=r.indexOf(":");return{name:e!==-1?r.slice(0,e):"",message:e!==-1&&e+2<=r.length?r.substring(e+2):r}}function PF(r){return!r||!r.some(e=>!!e)?"":`
Call log:
  ${Px.colors.dim("- "+(r||[]).join(`
  - `))}
`}});var Qe=M(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.ManualPromise=Ji.LongStandingScope=void 0;var AF=Lt(),Lx,Dx;Lx=Symbol.species;Dx=Symbol.toStringTag;var hc=class extends Promise{constructor(){let e,t;super((n,s)=>{e=n,t=s}),this._resolve=void 0,this._reject=void 0,this._isDone=void 0,this._isDone=!1,this._resolve=e,this._reject=t}isDone(){return this._isDone}resolve(e){this._isDone=!0,this._resolve(e)}reject(e){this._isDone=!0,this._reject(e)}static get[Lx](){return Promise}get[Dx](){return"ManualPromise"}};Ji.ManualPromise=hc;var Hf=class{constructor(){this._terminateError=void 0,this._closeError=void 0,this._terminatePromises=new Map,this._isClosed=!1}reject(e){this._isClosed=!0,this._terminateError=e;for(let t of this._terminatePromises.keys())t.resolve(e)}close(e){this._isClosed=!0,this._closeError=e;for(let[t,n]of this._terminatePromises)t.resolve(Nx(e,n))}isClosed(){return this._isClosed}static async raceMultiple(e,t){return Promise.race(e.map(n=>n.race(t)))}async race(e){return this._race(Array.isArray(e)?e:[e],!1)}async safeRace(e,t){return this._race([e],!0,t)}async _race(e,t,n){let s=new hc,o=(0,AF.captureRawStack)();this._terminateError&&s.resolve(this._terminateError),this._closeError&&s.resolve(Nx(this._closeError,o)),this._terminatePromises.set(s,o);try{return await Promise.race([s.then(a=>t?n:Promise.reject(a)),...e])}finally{this._terminatePromises.delete(s)}}};Ji.LongStandingScope=Hf;function Nx(r,e){let t=new Error;return t.name=r.name,t.message=r.message,t.stack=[r.name+":"+r.message,...e].join(`
`),t}});var ko=M(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.createSocket=LF;ni.httpsHappyEyeballsAgent=ni.httpHappyEyeballsAgent=void 0;var IF=Eo(require("dns")),RF=Eo(require("http")),MF=Eo(require("https")),Xi=Eo(require("net")),Bx=Eo(require("tls")),FF=Qe();function jx(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(jx=function(n){return n?t:e})(r)}function Eo(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=jx(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var NF=300,$f=class extends RF.Agent{createConnection(e,t){if(Xi.isIP(zf(e)))return Xi.createConnection(e);Uf(e,t,!1).catch(n=>t?.(n))}},Wf=class extends MF.Agent{createConnection(e,t){if(Xi.isIP(zf(e)))return Bx.connect(e);Uf(e,t,!0).catch(n=>t?.(n))}},k8=ni.httpsHappyEyeballsAgent=new Wf,C8=ni.httpHappyEyeballsAgent=new $f;async function LF(r,e){return new Promise((t,n)=>{if(Xi.isIP(r)){let s=Xi.createConnection({host:r,port:e});s.on("connect",()=>t(s)),s.on("error",o=>n(o))}else Uf({host:r,port:e},(s,o)=>{s&&n(s),o&&t(o)},!1).catch(s=>n(s))})}async function Uf(r,e,t){let n=r.__testHookLookup||DF,s=zf(r),o=await n(s),a=new Set,l,c=0,u=(h,p)=>{var f;a.delete(h)&&(++c,(f=l)!==null&&f!==void 0||(l=p),c===o.length&&e?.(l))},d=new FF.ManualPromise;for(let{address:h}of o){let p=t?Bx.connect({...r,port:r.port,host:h,servername:s}):Xi.createConnection({...r,port:r.port,host:h});if(p.on("connect",()=>{d.resolve(),e?.(null,p),a.delete(p);for(let f of a)f.destroy();a.clear()}),p.on("timeout",()=>{p.destroy(),u(p,new Error("Connection timeout"))}),p.on("error",f=>u(p,f)),a.add(p),await Promise.race([d,new Promise(f=>setTimeout(f,NF))]),d.isDone())break}}async function DF(r){let e=await IF.promises.lookup(r,{all:!0,family:0,verbatim:!0}),t=e.filter(({family:o})=>o===6),n=e.filter(({family:o})=>o===4);if(t.length&&t[0]!==e[0]){let o=t;t=n,n=o}let s=[];for(let o=0;o<Math.max(t.length,n.length);o++)t[o]&&s.push(t[o]),n[o]&&s.push(n[o]);return s}function zf(r){if(r.hostname)return r.hostname;if(r.host)return r.host;throw new Error("Either options.hostname or options.host must be provided")}});var xn=M(Yt=>{"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});Yt.NET_DEFAULT_TIMEOUT=void 0;Yt.constructURLBasedOnBaseURL=Vx;Yt.createHttpServer=UF;Yt.createHttpsServer=zF;Yt.fetchData=qF;Yt.httpRequest=pc;Yt.isURLAvailable=VF;Yt.urlMatches=$F;Yt.urlMatchesEqual=HF;var Ux=Vf(require("http")),zx=Vf(require("https")),qx=Be(),Hx=Vf(require("url")),Co=lp(),BF=up(),$x=ko();function Vf(r){return r&&r.__esModule?r:{default:r}}var jF=Yt.NET_DEFAULT_TIMEOUT=3e4;function pc(r,e,t){var n;let s=Hx.default.parse(r.url),o={...s,agent:s.protocol==="https:"?$x.httpsHappyEyeballsAgent:$x.httpHappyEyeballsAgent,method:r.method||"GET",headers:r.headers};r.rejectUnauthorized!==void 0&&(o.rejectUnauthorized=r.rejectUnauthorized);let a=(n=r.timeout)!==null&&n!==void 0?n:jF,l=(0,qx.getProxyForUrl)(r.url);if(l){let d=Hx.default.parse(l);r.url.startsWith("http:")?o={path:s.href,host:d.hostname,port:d.port,headers:o.headers,method:o.method}:(d.secureProxy=d.protocol==="https:",o.agent=new qx.HttpsProxyAgent(d),o.rejectUnauthorized=!1)}let c=d=>{let h=d.statusCode||0;h>=300&&h<400&&d.headers.location?pc({...r,url:new URL(d.headers.location,r.url).toString()},e,t):e(d)},u=o.protocol==="https:"?zx.default.request(o,c):Ux.default.request(o,c);if(u.on("error",t),a!==void 0){let d=()=>{t(new Error(`Request to ${r.url} timed out after ${a}ms`)),u.abort()};if(a<=0){d();return}u.setTimeout(a,d)}u.end(r.data)}function qF(r,e){return new Promise((t,n)=>{pc(r,async s=>{if(s.statusCode!==200){let a=e?await e(r,s):new Error(`fetch failed: server returned code ${s.statusCode}. URL: ${r.url}`);n(a);return}let o="";s.on("data",a=>o+=a),s.on("error",a=>n(a)),s.on("end",()=>t(o))},n)})}function HF(r,e){return(0,Co.isRegExp)(r)&&(0,Co.isRegExp)(e)?r.source===e.source&&r.flags===e.flags:r===e}function $F(r,e,t){if(t===void 0||t==="")return!0;if((0,Co.isString)(t)&&!t.startsWith("*")&&(t=Vx(r,t)),(0,Co.isString)(t)&&(t=(0,BF.globToRegex)(t)),(0,Co.isRegExp)(t))return t.test(e);if(typeof t=="string"&&t===e)return!0;let n=WF(e);if(!n)return!1;if(typeof t=="string")return n.pathname===t;if(typeof t!="function")throw new Error("url parameter should be string, RegExp or function");return t(n)}function WF(r){try{return new URL(r)}catch{return null}}function Vx(r,e){try{return new URL(e,r).toString()}catch{return e}}function UF(...r){let e=Ux.default.createServer(...r);return Gx(e),e}function zF(...r){let e=zx.default.createServer(...r);return Gx(e),e}async function VF(r,e,t,n){let s=await Wx(r,e,t,n);if(s===404&&r.pathname==="/"){let o=new URL(r);o.pathname="/index.html",s=await Wx(o,e,t,n)}return s>=200&&s<404}async function Wx(r,e,t,n){return new Promise(s=>{t?.(`HTTP GET: ${r}`),pc({url:r.toString(),headers:{Accept:"*/*"},rejectUnauthorized:!e},o=>{var a;o.resume();let l=(a=o.statusCode)!==null&&a!==void 0?a:0;t?.(`HTTP Status: ${l}`),s(l)},o=>{o.code==="DEPTH_ZERO_SELF_SIGNED_CERT"&&n?.("[WebServer] Self-signed certificate detected. Try adding ignoreHTTPSErrors: true to config.webServer."),t?.(`Error while checking if ${r} is available: ${o.message}`),s(0)})})}function Gx(r){let e=new Set;r.on("connection",n=>{e.add(n),n.once("close",()=>e.delete(n))});let t=r.close;r.close=n=>{for(let s of e)s.destroy();return e.clear(),t.call(r,n)}}});var Kx=M(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.deps=void 0;var qe=fc.deps={"ubuntu20.04-x64":{tools:["xvfb","fonts-noto-color-emoji","ttf-unifont","libfontconfig","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","ttf-ubuntu-font-family"],chromium:["fonts-liberation","libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libegl1","libgbm1","libglib2.0-0","libgtk-3-0","libnspr4","libnss3","libpango-1.0-0","libx11-6","libx11-xcb1","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxrandr2","libxshmfence1"],firefox:["ffmpeg","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libglib2.0-0","libgtk-3-0","libpango-1.0-0","libpangocairo-1.0-0","libpangoft2-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrender1","libxt6","libxtst6"],webkit:["libenchant-2-2","libflite1","libx264-155","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libegl1","libenchant1c2a","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgdk-pixbuf2.0-0","libgl1","libgles2","libglib2.0-0","libgtk-3-0","libgudev-1.0-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libicu66","libjpeg-turbo8","libnghttp2-14","libnotify4","libopengl0","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libsecret-1-0","libvpx6","libwayland-client0","libwayland-egl1","libwayland-server0","libwebp6","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1","libatomic1","libevent-2.1-7"],lib2package:{"libflite.so.1":"libflite1","libflite_usenglish.so.1":"libflite1","libflite_cmu_grapheme_lang.so.1":"libflite1","libflite_cmu_grapheme_lex.so.1":"libflite1","libflite_cmu_indic_lang.so.1":"libflite1","libflite_cmu_indic_lex.so.1":"libflite1","libflite_cmulex.so.1":"libflite1","libflite_cmu_time_awb.so.1":"libflite1","libflite_cmu_us_awb.so.1":"libflite1","libflite_cmu_us_kal16.so.1":"libflite1","libflite_cmu_us_kal.so.1":"libflite1","libflite_cmu_us_rms.so.1":"libflite1","libflite_cmu_us_slt.so.1":"libflite1","libx264.so":"libx264-155","libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libenchant.so.1":"libenchant1c2a","libevdev.so.2":"libevdev2","libepoxy.so.0":"libepoxy0","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf2.0-0","libgdk-3.so.0":"libgtk-3-0","libgdk-x11-2.0.so.0":"libgtk2.0-0","libgio-2.0.so.0":"libglib2.0-0","libGL.so.1":"libgl1","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgthread-2.0.so.0":"libglib2.0-0","libgtk-3.so.0":"libgtk-3-0","libgtk-x11-2.0.so.0":"libgtk2.0-0","libgudev-1.0.so.0":"libgudev-1.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libicui18n.so.66":"libicu66","libicuuc.so.66":"libicu66","libjpeg.so.8":"libjpeg-turbo8","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libOpenGL.so.0":"libopengl0","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpangoft2-1.0.so.0":"libpangoft2-1.0-0","libpng16.so.16":"libpng16-16","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libvpx.so.6":"libvpx6","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebp.so.6":"libwebp6","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-dri3.so.0":"libxcb-dri3-0","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxslt.so.1":"libxslt1.1","libXt.so.6":"libxt6","libXtst.so.6":"libxtst6","libxshmfence.so.1":"libxshmfence1","libatomic.so.1":"libatomic1","libenchant-2.so.2":"libenchant-2-2","libevent-2.1.so.7":"libevent-2.1-7"}},"ubuntu22.04-x64":{tools:["xvfb","fonts-noto-color-emoji","fonts-unifont","libfontconfig1","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","fonts-freefont-ttf"],chromium:["libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libgbm1","libglib2.0-0","libnspr4","libnss3","libpango-1.0-0","libwayland-client0","libx11-6","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxkbcommon0","libxrandr2"],firefox:["ffmpeg","libasound2","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf-2.0-0","libglib2.0-0","libgtk-3-0","libpango-1.0-0","libpangocairo-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrandr2","libxrender1","libxtst6"],webkit:["libsoup-3.0-0","libenchant-2-2","gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libicu70","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libdbus-1-3","libdrm2","libegl1","libepoxy0","libevdev2","libffi7","libfontconfig1","libfreetype6","libgbm1","libgdk-pixbuf-2.0-0","libgles2","libglib2.0-0","libglx0","libgstreamer-gl1.0-0","libgstreamer-plugins-base1.0-0","libgstreamer1.0-0","libgtk-3-0","libgudev-1.0-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libjpeg-turbo8","liblcms2-2","libmanette-0.2-0","libnotify4","libopengl0","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libproxy1v5","libsecret-1-0","libwayland-client0","libwayland-egl1","libwayland-server0","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1","libx264-163","libatomic1","libevent-2.1-7"],lib2package:{"libsoup-3.0.so.0":"libsoup-3.0-0","libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libepoxy.so.0":"libepoxy0","libevdev.so.2":"libevdev2","libffi.so.7":"libffi7","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf-2.0-0","libgdk-3.so.0":"libgtk-3-0","libgio-2.0.so.0":"libglib2.0-0","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libGLX.so.0":"libglx0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgstallocators-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstapp-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstaudio-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstbase-1.0.so.0":"libgstreamer1.0-0","libgstfft-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstgl-1.0.so.0":"libgstreamer-gl1.0-0","libgstpbutils-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstreamer-1.0.so.0":"libgstreamer1.0-0","libgsttag-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstvideo-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgtk-3.so.0":"libgtk-3-0","libgudev-1.0.so.0":"libgudev-1.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libjpeg.so.8":"libjpeg-turbo8","liblcms2.so.2":"liblcms2-2","libmanette-0.2.so.0":"libmanette-0.2-0","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libOpenGL.so.0":"libopengl0","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpng16.so.16":"libpng16-16","libproxy.so.1":"libproxy1v5","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxslt.so.1":"libxslt1.1","libXtst.so.6":"libxtst6","libicui18n.so.60":"libicu70","libicuuc.so.66":"libicu70","libicui18n.so.66":"libicu70","libwebp.so.6":"libwebp6","libenchant-2.so.2":"libenchant-2-2","libx264.so":"libx264-163","libvpx.so.7":"libvpx7","libatomic.so.1":"libatomic1","libevent-2.1.so.7":"libevent-2.1-7"}},"debian11-x64":{tools:["xvfb","fonts-noto-color-emoji","fonts-unifont","libfontconfig1","libfreetype6","xfonts-cyrillic","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","fonts-freefont-ttf"],chromium:["libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libgbm1","libglib2.0-0","libnspr4","libnss3","libpango-1.0-0","libwayland-client0","libx11-6","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxkbcommon0","libxrandr2"],firefox:["libasound2","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf-2.0-0","libglib2.0-0","libgtk-3-0","libharfbuzz0b","libpango-1.0-0","libpangocairo-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrandr2","libxrender1","libxtst6"],webkit:["gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libdbus-1-3","libdrm2","libegl1","libenchant-2-2","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgbm1","libgdk-pixbuf-2.0-0","libgles2","libglib2.0-0","libglx0","libgstreamer-gl1.0-0","libgstreamer-plugins-base1.0-0","libgstreamer1.0-0","libgtk-3-0","libgudev-1.0-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libicu67","libjpeg62-turbo","liblcms2-2","libmanette-0.2-0","libnghttp2-14","libnotify4","libopengl0","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libproxy1v5","libsecret-1-0","libwayland-client0","libwayland-egl1","libwayland-server0","libwebp6","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1","libatomic1","libevent-2.1-7"],lib2package:{"libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo-gobject.so.2":"libcairo-gobject2","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdbus-glib-1.so.2":"libdbus-glib-1-2","libdrm.so.2":"libdrm2","libEGL.so.1":"libegl1","libenchant-2.so.2":"libenchant-2-2","libepoxy.so.0":"libepoxy0","libevdev.so.2":"libevdev2","libfontconfig.so.1":"libfontconfig1","libfreetype.so.6":"libfreetype6","libgbm.so.1":"libgbm1","libgdk_pixbuf-2.0.so.0":"libgdk-pixbuf-2.0-0","libgdk-3.so.0":"libgtk-3-0","libgio-2.0.so.0":"libglib2.0-0","libGLESv2.so.2":"libgles2","libglib-2.0.so.0":"libglib2.0-0","libGLX.so.0":"libglx0","libgmodule-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libgstallocators-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstapp-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstaudio-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstbase-1.0.so.0":"libgstreamer1.0-0","libgstfft-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstgl-1.0.so.0":"libgstreamer-gl1.0-0","libgstpbutils-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstreamer-1.0.so.0":"libgstreamer1.0-0","libgsttag-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgstvideo-1.0.so.0":"libgstreamer-plugins-base1.0-0","libgtk-3.so.0":"libgtk-3-0","libgudev-1.0.so.0":"libgudev-1.0-0","libharfbuzz-icu.so.0":"libharfbuzz-icu0","libharfbuzz.so.0":"libharfbuzz0b","libhyphen.so.0":"libhyphen0","libicui18n.so.67":"libicu67","libicuuc.so.67":"libicu67","libjpeg.so.62":"libjpeg62-turbo","liblcms2.so.2":"liblcms2-2","libmanette-0.2.so.0":"libmanette-0.2-0","libnotify.so.4":"libnotify4","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libOpenGL.so.0":"libopengl0","libopenjp2.so.7":"libopenjp2-7","libopus.so.0":"libopus0","libpango-1.0.so.0":"libpango-1.0-0","libpangocairo-1.0.so.0":"libpangocairo-1.0-0","libpng16.so.16":"libpng16-16","libproxy.so.1":"libproxy1v5","libsecret-1.so.0":"libsecret-1-0","libsmime3.so":"libnss3","libwayland-client.so.0":"libwayland-client0","libwayland-egl.so.1":"libwayland-egl1","libwayland-server.so.0":"libwayland-server0","libwebp.so.6":"libwebp6","libwebpdemux.so.2":"libwebpdemux2","libwoff2dec.so.1.0.2":"libwoff1","libX11-xcb.so.1":"libx11-xcb1","libX11.so.6":"libx11-6","libxcb-shm.so.0":"libxcb-shm0","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXcursor.so.1":"libxcursor1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libXi.so.6":"libxi6","libxkbcommon.so.0":"libxkbcommon0","libxml2.so.2":"libxml2","libXrandr.so.2":"libxrandr2","libXrender.so.1":"libxrender1","libxslt.so.1":"libxslt1.1","libXtst.so.6":"libxtst6","libatomic.so.1":"libatomic1","libevent-2.1.so.7":"libevent-2.1-7"}},"debian12-x64":{tools:["xvfb","fonts-noto-color-emoji","fonts-unifont","libfontconfig1","libfreetype6","xfonts-scalable","fonts-liberation","fonts-ipafont-gothic","fonts-wqy-zenhei","fonts-tlwg-loma-otf","fonts-freefont-ttf"],chromium:["libasound2","libatk-bridge2.0-0","libatk1.0-0","libatspi2.0-0","libcairo2","libcups2","libdbus-1-3","libdrm2","libgbm1","libglib2.0-0","libnspr4","libnss3","libpango-1.0-0","libx11-6","libxcb1","libxcomposite1","libxdamage1","libxext6","libxfixes3","libxkbcommon0","libxrandr2"],firefox:["libasound2","libatk1.0-0","libcairo-gobject2","libcairo2","libdbus-1-3","libdbus-glib-1-2","libfontconfig1","libfreetype6","libgdk-pixbuf-2.0-0","libglib2.0-0","libgtk-3-0","libharfbuzz0b","libpango-1.0-0","libpangocairo-1.0-0","libx11-6","libx11-xcb1","libxcb-shm0","libxcb1","libxcomposite1","libxcursor1","libxdamage1","libxext6","libxfixes3","libxi6","libxrandr2","libxrender1","libxtst6"],webkit:["libsoup-3.0-0","gstreamer1.0-libav","gstreamer1.0-plugins-bad","gstreamer1.0-plugins-base","gstreamer1.0-plugins-good","libatk-bridge2.0-0","libatk1.0-0","libcairo2","libdbus-1-3","libdrm2","libegl1","libenchant-2-2","libepoxy0","libevdev2","libfontconfig1","libfreetype6","libgbm1","libgdk-pixbuf-2.0-0","libgles2","libglib2.0-0","libglx0","libgstreamer-gl1.0-0","libgstreamer-plugins-base1.0-0","libgstreamer1.0-0","libgtk-3-0","libgudev-1.0-0","libharfbuzz-icu0","libharfbuzz0b","libhyphen0","libicu72","libjpeg62-turbo","liblcms2-2","libmanette-0.2-0","libnotify4","libopengl0","libopenjp2-7","libopus0","libpango-1.0-0","libpng16-16","libproxy1v5","libsecret-1-0","libwayland-client0","libwayland-egl1","libwayland-server0","libwebp7","libwebpdemux2","libwoff1","libx11-6","libxcomposite1","libxdamage1","libxkbcommon0","libxml2","libxslt1.1","libatomic1","libevent-2.1-7"],lib2package:{"libsoup-3.0.so.0":"libsoup-3.0-0","libasound.so.2":"libasound2","libatk-1.0.so.0":"libatk1.0-0","libatk-bridge-2.0.so.0":"libatk-bridge2.0-0","libatspi.so.0":"libatspi2.0-0","libcairo.so.2":"libcairo2","libcups.so.2":"libcups2","libdbus-1.so.3":"libdbus-1-3","libdrm.so.2":"libdrm2","libgbm.so.1":"libgbm1","libgio-2.0.so.0":"libglib2.0-0","libglib-2.0.so.0":"libglib2.0-0","libgobject-2.0.so.0":"libglib2.0-0","libnspr4.so":"libnspr4","libnss3.so":"libnss3","libnssutil3.so":"libnss3","libpango-1.0.so.0":"libpango-1.0-0","libsmime3.so":"libnss3","libX11.so.6":"libx11-6","libxcb.so.1":"libxcb1","libXcomposite.so.1":"libxcomposite1","libXdamage.so.1":"libxdamage1","libXext.so.6":"libxext6","libXfixes.so.3":"libxfixes3","libxkbcommon.so.0":"libxkbcommon0","libXrandr.so.2":"libxrandr2"}}};qe["ubuntu20.04-arm64"]={tools:[...qe["ubuntu20.04-x64"].tools],chromium:[...qe["ubuntu20.04-x64"].chromium],firefox:[...qe["ubuntu20.04-x64"].firefox],webkit:[...qe["ubuntu20.04-x64"].webkit],lib2package:{...qe["ubuntu20.04-x64"].lib2package}};qe["ubuntu22.04-arm64"]={tools:[...qe["ubuntu22.04-x64"].tools],chromium:[...qe["ubuntu22.04-x64"].chromium],firefox:[...qe["ubuntu22.04-x64"].firefox],webkit:[...qe["ubuntu22.04-x64"].webkit],lib2package:{...qe["ubuntu22.04-x64"].lib2package}};qe["debian11-arm64"]={tools:[...qe["debian11-x64"].tools],chromium:[...qe["debian11-x64"].chromium],firefox:[...qe["debian11-x64"].firefox],webkit:[...qe["debian11-x64"].webkit],lib2package:{...qe["debian11-x64"].lib2package}};qe["debian12-arm64"]={tools:[...qe["debian12-x64"].tools],chromium:[...qe["debian12-x64"].chromium],firefox:[...qe["debian12-x64"].firefox],webkit:[...qe["debian12-x64"].webkit],lib2package:{...qe["debian12-x64"].lib2package}}});var oS=M(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.dockerVersion=tS;Sn.installDependenciesLinux=ZF;Sn.installDependenciesWindows=QF;Sn.readDockerVersionSync=nS;Sn.transformCommandsForRoot=sS;Sn.validateDependenciesLinux=tN;Sn.validateDependenciesWindows=eN;Sn.writeDockerVersion=JF;var jn=Kf(require("fs")),lr=Kf(require("path")),To=eS(require("os")),GF=Kf(require("child_process")),KF=eS(ie()),Oo=kl(),gc=go(),Jx=qn(),Gf=Kx(),Xx=Nn();function Zx(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Zx=function(n){return n?t:e})(r)}function eS(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Zx(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function Kf(r){return r&&r.__esModule?r:{default:r}}var Yx=lr.default.join(__dirname,"..","..","..","bin"),Qx=process.env.PW_CLI_DISPLAY_VERSION||Gp().version,mc="/ms-playwright/.docker-info";async function JF(r){await jn.default.promises.mkdir(lr.default.dirname(mc),{recursive:!0}),await jn.default.promises.writeFile(mc,JSON.stringify(tS(r),null,2),"utf8"),await jn.default.promises.chmod(mc,511)}function tS(r){return{driverVersion:Qx,dockerImageName:r.replace("%version%",Qx)}}function nS(){try{let r=JSON.parse(jn.default.readFileSync(mc,"utf8"));return{...r,dockerImageNameTemplate:r.dockerImageName.replace(r.driverVersion,"%version%")}}catch{return null}}var XF=r=>process.platform==="win32"?r.endsWith(".exe"):jn.default.promises.access(r,jn.default.constants.X_OK).then(()=>!0).catch(()=>!1);function YF(){if(To.platform()!=="win32"||To.arch()!=="x64")return!1;let[r,e]=To.release().split(".").map(t=>parseInt(t,10));return r>6||r===6&&e>1}async function QF(r,e){if(r.has("chromium")){let t="powershell.exe",n=["-ExecutionPolicy","Bypass","-File",lr.default.join(Yx,"install_media_pack.ps1")];if(e){console.log(`${t} ${iS(n).join(" ")}`);return}let{code:s}=await(0,Oo.spawnAsync)(t,n,{cwd:Yx,stdio:"inherit"});if(s!==0)throw new Error("Failed to install windows dependencies!")}}async function ZF(r,e){let t=[],n=gc.hostPlatform;gc.isOfficiallySupportedPlatform||console.warn(`BEWARE: your OS is not officially supported by Playwright; installing dependencies for ${n} as a fallback.`);for(let d of r){let h=Gf.deps[n];if(!h){console.warn(`Cannot install dependencies for ${n}!`);return}t.push(...h[d])}let s=Array.from(new Set(t));e||console.log("Installing dependencies...");let o=[];o.push("apt-get update"),o.push(["apt-get","install","-y","--no-install-recommends",...s].join(" "));let{command:a,args:l,elevatedPermissions:c}=await sS(o);if(e){console.log(`${a} ${iS(l).join(" ")}`);return}c&&console.log("Switching to root user to install dependencies...");let u=GF.default.spawn(a,l,{stdio:"inherit"});await new Promise((d,h)=>{u.on("exit",p=>p===0?d():h(new Error(`Installation process exited with code: ${p}`))),u.on("error",h)})}async function eN(r){let e=r,t=[];for(let u of e)t.push(...await rS(u));let n=await Promise.all(t.map(u=>rN(u))),s=new Set;for(let u of n)for(let d of u)s.add(d);if(!s.size)return;let o=!1,a=!1;for(let u of s)u.startsWith("api-ms-win-crt")||u==="vcruntime140.dll"||u==="vcruntime140_1.dll"||u==="msvcp140.dll"?o=!0:(u==="mf.dll"||u==="mfplat.dll"||u==="msmpeg2vdec.dll"||u==="evr.dll"||u==="avrt.dll")&&(a=!0);let l=[];o&&l.push("Some of the Universal C Runtime files cannot be found on the system. You can fix","that by installing Microsoft Visual C++ Redistributable for Visual Studio from:","https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads",""),a&&l.push("Some of the Media Foundation files cannot be found on the system. If you are","on Windows Server try fixing this by running the following command in PowerShell","as Administrator:","","    Install-WindowsFeature Server-Media-Foundation","","For Windows N editions visit:","https://support.microsoft.com/en-us/help/3145500/media-feature-pack-list-for-windows-n-editions",""),l.push("Full list of missing libraries:",`    ${[...s].join(`
    `)}`,"");let c=`Host system is missing dependencies!

${l.join(`
`)}`;if(YF())throw new Error(c);console.warn("WARNING: running on unsupported windows version!"),console.warn(c)}async function tN(r,e,t){var n,s,o;let a=e,l=[];for(let w of a)l.push(...await rS(w));let c=await Promise.all(l.map(w=>iN(w,a))),u=new Set;for(let w of c)for(let m of w)u.add(m);for(let w of await sN(t))u.add(w);if(!u.size)return;let d=new Set(u),h=new Set,p=Gf.deps[gc.hostPlatform]?{...((n=Gf.deps[gc.hostPlatform])===null||n===void 0?void 0:n.lib2package)||{},...oN}:{};for(let w of u){let m=p[w];m&&(h.add(m),u.delete(w))}let f=(s=(o=process).getuid)!==null&&s!==void 0&&s.call(o)&&To.platform()!=="win32"?"sudo ":"",_=nS(),v=["Host system is missing dependencies to run browsers."];if(_&&!_.driverVersion.startsWith((0,Xx.getPlaywrightVersion)(!0)+".")){let w=(0,Xx.getPlaywrightVersion)(),m=_.dockerImageName.replace(_.driverVersion,w);v.push("This is most likely due to Docker image version not matching Playwright version:",`- Playwright  : ${w}`,`- Docker image: ${_.driverVersion}`,"","Either:",`- (recommended) use Docker image "${m}"`,"- (alternative 1) run the following command inside Docker to install missing dependencies:","",`    ${f}${(0,Jx.buildPlaywrightCLICommand)(r,"install-deps")}`,"","- (alternative 2) use apt inside Docker:","",`    ${f}apt-get install ${[...h].join(`\\
        `)}`,"","<3 Playwright Team")}else h.size&&!u.size?v.push("Please install them with the following command:","",`    ${f}${(0,Jx.buildPlaywrightCLICommand)(r,"install-deps")}`,"","Alternatively, use apt:",`    ${f}apt-get install ${[...h].join(`\\
        `)}`,"","<3 Playwright Team"):v.push("Missing libraries:",...[...d].map(w=>"    "+w));throw new Error(`
`+KF.wrapInASCIIBox(v.join(`
`),1))}function nN(r){switch(To.platform()){case"linux":return r.endsWith(".so")||r.includes(".so.");case"win32":return r.endsWith(".dll");default:return!1}}async function rS(r){if(!jn.default.existsSync(r))return[];let e=(await jn.default.promises.readdir(r)).map(o=>lr.default.resolve(r,o)),t=await Promise.all(e.map(o=>jn.default.promises.stat(o))),n=e.filter((o,a)=>t[a].isFile());return(await Promise.all(n.map(async o=>{let a=lr.default.basename(o).toLowerCase();return nN(a)||await XF(o)?o:!1}))).filter(Boolean)}async function rN(r){let e=lr.default.join(__dirname,"..","..","..","bin","PrintDeps.exe"),t=lr.default.dirname(r),{stdout:n,code:s}=await(0,Oo.spawnAsync)(e,[r],{cwd:t,env:{...process.env,LD_LIBRARY_PATH:process.env.LD_LIBRARY_PATH?`${process.env.LD_LIBRARY_PATH}:${t}`:t}});return s!==0?[]:n.split(`
`).map(a=>a.trim()).filter(a=>a.endsWith("not found")&&a.includes("=>")).map(a=>a.split("=>")[0].trim().toLowerCase())}async function iN(r,e){let t=lr.default.dirname(r),n=e.join(":");process.env.LD_LIBRARY_PATH&&(n=`${process.env.LD_LIBRARY_PATH}:${n}`);let{stdout:s,code:o}=await(0,Oo.spawnAsync)("ldd",[r],{cwd:t,env:{...process.env,LD_LIBRARY_PATH:n}});return o!==0?[]:s.split(`
`).map(l=>l.trim()).filter(l=>l.endsWith("not found")&&l.includes("=>")).map(l=>l.split("=>")[0].trim())}async function sN(r){if(!r.length)return[];let{stdout:e,code:t,error:n}=await(0,Oo.spawnAsync)("/sbin/ldconfig",["-p"],{});if(t!==0||n)return[];let s=o=>e.toLowerCase().includes(o.toLowerCase());return r.filter(o=>!s(o))}var oN={"libx264.so":"gstreamer1.0-libav"};function iS(r){return r.map(e=>e.includes(" ")?`"${e}"`:e)}async function sS(r){var e,t;return((e=(t=process).getuid)===null||e===void 0?void 0:e.call(t))===0?{command:"sh",args:["-c",`${r.join("&& ")}`],elevatedPermissions:!1}:(await(0,Oo.spawnAsync)("which",["sudo"])).code===0?{command:"sudo",args:["--","sh","-c",`${r.join("&& ")}`],elevatedPermissions:!0}:{command:"su",args:["root","-c",`${r.join("&& ")}`],elevatedPermissions:!0}}});var uS=M(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.downloadBrowserWithProgressBar=dN;bc.logPolitely=Xf;var wc=vc(require("fs")),aN=vc(require("os")),aS=vc(require("path")),lN=vc(require("child_process")),_c=ht(),Hn=Le(),cN=Qe(),lS=Be(),Jf=qn(),uN=Nn();function vc(r){return r&&r.__esModule?r:{default:r}}async function dN(r,e,t,n,s,o){if(await(0,_c.existsAsync)((0,Jf.browserDirectoryToMarkerFilePath)(e)))return Hn.debugLogger.log("install",`${r} is already downloaded.`),!1;let a=aS.default.join(aN.default.tmpdir(),s);try{for(let c=1;c<=3;++c){Hn.debugLogger.log("install",`downloading ${r} - attempt #${c}`);let u=n[(c-1)%n.length];Xf(`Downloading ${r}`+lS.colors.dim(` from ${u}`));let{error:d}=await hN(r,e,u,a,t,o);if(!d){Hn.debugLogger.log("install",`SUCCESS installing ${r}`);break}await(0,_c.existsAsync)(a)&&await wc.default.promises.unlink(a),await(0,_c.existsAsync)(e)&&await wc.default.promises.rmdir(e,{recursive:!0});let h=d?.message||"";if(Hn.debugLogger.log("install",`attempt #${c} - ERROR: ${h}`),c>=3)throw d}}catch(l){throw Hn.debugLogger.log("install",`FAILED installation ${r} with error: ${l}`),process.exitCode=1,l}finally{await(0,_c.existsAsync)(a)&&await wc.default.promises.unlink(a)}return Xf(`${r} downloaded to ${e}`),!0}function hN(r,e,t,n,s,o){let a=lN.default.fork(aS.default.join(__dirname,"oopDownloadBrowserMain.js")),l=new cN.ManualPromise,c=pN();a.on("message",d=>{d?.method==="log"&&Hn.debugLogger.log("install",d.params.message),d?.method==="progress"&&c(d.params.done,d.params.total)}),a.on("exit",d=>{if(d!==0){l.resolve({error:new Error(`Download failure, code=${d}`)});return}wc.default.existsSync((0,Jf.browserDirectoryToMarkerFilePath)(e))?l.resolve({error:null}):l.resolve({error:new Error(`Download failure, ${(0,Jf.browserDirectoryToMarkerFilePath)(e)} does not exist`)})}),a.on("error",d=>{l.resolve({error:d})}),Hn.debugLogger.log("install","running download:"),Hn.debugLogger.log("install",`-- from url: ${t}`),Hn.debugLogger.log("install",`-- to location: ${n}`);let u={title:r,browserDirectory:e,url:t,zipPath:n,executablePath:s,connectionTimeout:o,userAgent:(0,uN.getUserAgent)()};return a.send({method:"download",params:u}),l}function Xf(r){let e=process.env.npm_config_loglevel;["silent","error","warn"].indexOf(e||"")>-1||console.log(r)}function pN(){return process.stdout.isTTY?fN():mN()}function fN(){let r,e=0;return(t,n)=>{r||(r=new lS.progress(`${cS(n)} [:bar] :percent :etas`,{complete:"=",incomplete:" ",width:20,total:n}));let s=t-e;e=t,r.tick(s)}}function mN(){let t=-1;return(n,s)=>{let o=n/s,a=Math.floor(10*o);if(a>t){t=a;let l=String(o*100|0).padStart(3);console.log(`|${"\u25A0".repeat(a*8)}${" ".repeat((10-a)*8)}| ${l}% of ${cS(s)}`)}}}function cS(r){let e=r/1024/1024;return`${Math.round(e*10)/10} MiB`}});var dS=M((R8,gN)=>{gN.exports={comment:"Do not edit this file, use utils/roll_browser.js",browsers:[{name:"chromium",revision:"1117",installByDefault:!0,browserVersion:"125.0.6422.26"},{name:"chromium-tip-of-tree",revision:"1215",installByDefault:!1,browserVersion:"126.0.6439.0"},{name:"firefox",revision:"1449",installByDefault:!0,browserVersion:"125.0.1"},{name:"firefox-asan",revision:"1449",installByDefault:!1,browserVersion:"125.0.1"},{name:"firefox-beta",revision:"1449",installByDefault:!1,browserVersion:"126.0b1"},{name:"webkit",revision:"2003",installByDefault:!0,revisionOverrides:{"mac10.14":"1446","mac10.15":"1616",mac11:"1816","mac11-arm64":"1816"},browserVersion:"17.4"},{name:"ffmpeg",revision:"1009",installByDefault:!0},{name:"android",revision:"1000",installByDefault:!1}]}});var qn=M(Dt=>{"use strict";Object.defineProperty(Dt,"__esModule",{value:!0});Dt.Registry=void 0;Dt.browserDirectoryToMarkerFilePath=_S;Dt.buildPlaywrightCLICommand=Po;Dt.findChromiumChannel=EN;Dt.installBrowsersForNpmInstall=wS;Dt.installDefaultBrowsersForNpmInstall=SN;Dt.registryDirectory=Dt.registry=void 0;Object.defineProperty(Dt,"writeDockerVersion",{enumerable:!0,get:function(){return cr.writeDockerVersion}});var dr=nm(require("os")),ke=yN(require("path")),_N=nm(require("util")),$t=nm(require("fs")),wN=Be(),vN=xn(),bN=Nn(),bt=ie(),yc=ht(),ur=go(),hS=kl(),cr=oS(),xc=uS(),Yf=Le();function yN(r){return r&&r.__esModule?r:{default:r}}function mS(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(mS=function(n){return n?t:e})(r)}function nm(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=mS(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Qf=ke.default.join(__dirname,"..","..",".."),Zf=ke.default.join(__dirname,"..","..","..","bin"),Sc=["https://playwright.azureedge.net","https://playwright-akamai.azureedge.net","https://playwright-verizon.azureedge.net"];if(process.env.PW_TEST_CDN_THAT_SHOULD_WORK)for(let r=0;r<Sc.length;r++){let e=Sc[r];e!==process.env.PW_TEST_CDN_THAT_SHOULD_WORK&&(Sc[r]=e+".does-not-resolve.playwright.dev")}var em={chromium:{linux:["chrome-linux","chrome"],mac:["chrome-mac","Chromium.app","Contents","MacOS","Chromium"],win:["chrome-win","chrome.exe"]},firefox:{linux:["firefox","firefox"],mac:["firefox","Nightly.app","Contents","MacOS","firefox"],win:["firefox","firefox.exe"]},webkit:{linux:["pw_run.sh"],mac:["pw_run.sh"],win:["Playwright.exe"]},ffmpeg:{linux:["ffmpeg-linux"],mac:["ffmpeg-mac"],win:["ffmpeg-win64.exe"]}},xN={chromium:{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/chromium/%s/chromium-linux.zip","ubuntu22.04-x64":"builds/chromium/%s/chromium-linux.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","ubuntu22.04-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","debian11-x64":"builds/chromium/%s/chromium-linux.zip","debian11-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","debian12-x64":"builds/chromium/%s/chromium-linux.zip","debian12-arm64":"builds/chromium/%s/chromium-linux-arm64.zip","mac10.13":"builds/chromium/%s/chromium-mac.zip","mac10.14":"builds/chromium/%s/chromium-mac.zip","mac10.15":"builds/chromium/%s/chromium-mac.zip",mac11:"builds/chromium/%s/chromium-mac.zip","mac11-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",mac12:"builds/chromium/%s/chromium-mac.zip","mac12-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",mac13:"builds/chromium/%s/chromium-mac.zip","mac13-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",mac14:"builds/chromium/%s/chromium-mac.zip","mac14-arm64":"builds/chromium/%s/chromium-mac-arm64.zip",win64:"builds/chromium/%s/chromium-win64.zip"},"chromium-tip-of-tree":{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip","ubuntu22.04-x64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip","ubuntu22.04-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip","debian11-x64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip","debian11-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip","debian12-x64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux.zip","debian12-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-linux-arm64.zip","mac10.13":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac10.14":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac10.15":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip",mac11:"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac11-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip",mac12:"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac12-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip",mac13:"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac13-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip",mac14:"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac.zip","mac14-arm64":"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-mac-arm64.zip",win64:"builds/chromium-tip-of-tree/%s/chromium-tip-of-tree-win64.zip"},firefox:{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/firefox/%s/firefox-ubuntu-20.04.zip","ubuntu22.04-x64":"builds/firefox/%s/firefox-ubuntu-22.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/firefox/%s/firefox-ubuntu-20.04-arm64.zip","ubuntu22.04-arm64":"builds/firefox/%s/firefox-ubuntu-22.04-arm64.zip","debian11-x64":"builds/firefox/%s/firefox-debian-11.zip","debian11-arm64":"builds/firefox/%s/firefox-debian-11-arm64.zip","debian12-x64":"builds/firefox/%s/firefox-debian-12.zip","debian12-arm64":"builds/firefox/%s/firefox-debian-12-arm64.zip","mac10.13":"builds/firefox/%s/firefox-mac-13.zip","mac10.14":"builds/firefox/%s/firefox-mac-13.zip","mac10.15":"builds/firefox/%s/firefox-mac-13.zip",mac11:"builds/firefox/%s/firefox-mac-13.zip","mac11-arm64":"builds/firefox/%s/firefox-mac-13-arm64.zip",mac12:"builds/firefox/%s/firefox-mac-13.zip","mac12-arm64":"builds/firefox/%s/firefox-mac-13-arm64.zip",mac13:"builds/firefox/%s/firefox-mac-13.zip","mac13-arm64":"builds/firefox/%s/firefox-mac-13-arm64.zip",mac14:"builds/firefox/%s/firefox-mac-13.zip","mac14-arm64":"builds/firefox/%s/firefox-mac-13-arm64.zip",win64:"builds/firefox/%s/firefox-win64.zip"},"firefox-beta":{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/firefox-beta/%s/firefox-beta-ubuntu-20.04.zip","ubuntu22.04-x64":"builds/firefox-beta/%s/firefox-beta-ubuntu-22.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":void 0,"ubuntu22.04-arm64":"builds/firefox-beta/%s/firefox-beta-ubuntu-22.04-arm64.zip","debian11-x64":"builds/firefox-beta/%s/firefox-beta-debian-11.zip","debian11-arm64":"builds/firefox-beta/%s/firefox-beta-debian-11-arm64.zip","debian12-x64":"builds/firefox-beta/%s/firefox-beta-debian-12.zip","debian12-arm64":"builds/firefox-beta/%s/firefox-beta-debian-12-arm64.zip","mac10.13":"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac10.14":"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac10.15":"builds/firefox-beta/%s/firefox-beta-mac-13.zip",mac11:"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac11-arm64":"builds/firefox-beta/%s/firefox-beta-mac-13-arm64.zip",mac12:"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac12-arm64":"builds/firefox-beta/%s/firefox-beta-mac-13-arm64.zip",mac13:"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac13-arm64":"builds/firefox-beta/%s/firefox-beta-mac-13-arm64.zip",mac14:"builds/firefox-beta/%s/firefox-beta-mac-13.zip","mac14-arm64":"builds/firefox-beta/%s/firefox-beta-mac-13-arm64.zip",win64:"builds/firefox-beta/%s/firefox-beta-win64.zip"},"firefox-asan":{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":void 0,"ubuntu22.04-x64":"builds/firefox/%s/firefox-asan-ubuntu-22.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":void 0,"ubuntu22.04-arm64":void 0,"debian11-x64":void 0,"debian11-arm64":void 0,"debian12-x64":void 0,"debian12-arm64":void 0,"mac10.13":"builds/firefox/%s/firefox-asan-mac-13.zip","mac10.14":"builds/firefox/%s/firefox-asan-mac-13.zip","mac10.15":"builds/firefox/%s/firefox-asan-mac-13.zip",mac11:"builds/firefox/%s/firefox-asan-mac-13.zip","mac11-arm64":void 0,mac12:"builds/firefox/%s/firefox-asan-mac-13.zip","mac12-arm64":void 0,mac13:"builds/firefox/%s/firefox-asan-mac-13.zip","mac13-arm64":void 0,mac14:"builds/firefox/%s/firefox-asan-mac-13.zip","mac14-arm64":void 0,win64:void 0},webkit:{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/webkit/%s/webkit-ubuntu-20.04.zip","ubuntu22.04-x64":"builds/webkit/%s/webkit-ubuntu-22.04.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/webkit/%s/webkit-ubuntu-20.04-arm64.zip","ubuntu22.04-arm64":"builds/webkit/%s/webkit-ubuntu-22.04-arm64.zip","debian11-x64":"builds/webkit/%s/webkit-debian-11.zip","debian11-arm64":"builds/webkit/%s/webkit-debian-11-arm64.zip","debian12-x64":"builds/webkit/%s/webkit-debian-12.zip","debian12-arm64":"builds/webkit/%s/webkit-debian-12-arm64.zip","mac10.13":void 0,"mac10.14":"builds/deprecated-webkit-mac-10.14/%s/deprecated-webkit-mac-10.14.zip","mac10.15":"builds/deprecated-webkit-mac-10.15/%s/deprecated-webkit-mac-10.15.zip",mac11:"builds/webkit/%s/webkit-mac-11.zip","mac11-arm64":"builds/webkit/%s/webkit-mac-11-arm64.zip",mac12:"builds/webkit/%s/webkit-mac-12.zip","mac12-arm64":"builds/webkit/%s/webkit-mac-12-arm64.zip",mac13:"builds/webkit/%s/webkit-mac-13.zip","mac13-arm64":"builds/webkit/%s/webkit-mac-13-arm64.zip",mac14:"builds/webkit/%s/webkit-mac-14.zip","mac14-arm64":"builds/webkit/%s/webkit-mac-14-arm64.zip",win64:"builds/webkit/%s/webkit-win64.zip"},ffmpeg:{"<unknown>":void 0,"ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/ffmpeg/%s/ffmpeg-linux.zip","ubuntu22.04-x64":"builds/ffmpeg/%s/ffmpeg-linux.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","ubuntu22.04-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","debian11-x64":"builds/ffmpeg/%s/ffmpeg-linux.zip","debian11-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","debian12-x64":"builds/ffmpeg/%s/ffmpeg-linux.zip","debian12-arm64":"builds/ffmpeg/%s/ffmpeg-linux-arm64.zip","mac10.13":"builds/ffmpeg/%s/ffmpeg-mac.zip","mac10.14":"builds/ffmpeg/%s/ffmpeg-mac.zip","mac10.15":"builds/ffmpeg/%s/ffmpeg-mac.zip",mac11:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac11-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",mac12:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac12-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",mac13:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac13-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",mac14:"builds/ffmpeg/%s/ffmpeg-mac.zip","mac14-arm64":"builds/ffmpeg/%s/ffmpeg-mac-arm64.zip",win64:"builds/ffmpeg/%s/ffmpeg-win64.zip"},android:{"<unknown>":"builds/android/%s/android.zip","ubuntu18.04-x64":void 0,"ubuntu20.04-x64":"builds/android/%s/android.zip","ubuntu22.04-x64":"builds/android/%s/android.zip","ubuntu18.04-arm64":void 0,"ubuntu20.04-arm64":"builds/android/%s/android.zip","ubuntu22.04-arm64":"builds/android/%s/android.zip","debian11-x64":"builds/android/%s/android.zip","debian11-arm64":"builds/android/%s/android.zip","debian12-x64":"builds/android/%s/android.zip","debian12-arm64":"builds/android/%s/android.zip","mac10.13":"builds/android/%s/android.zip","mac10.14":"builds/android/%s/android.zip","mac10.15":"builds/android/%s/android.zip",mac11:"builds/android/%s/android.zip","mac11-arm64":"builds/android/%s/android.zip",mac12:"builds/android/%s/android.zip","mac12-arm64":"builds/android/%s/android.zip",mac13:"builds/android/%s/android.zip","mac13-arm64":"builds/android/%s/android.zip",mac14:"builds/android/%s/android.zip","mac14-arm64":"builds/android/%s/android.zip",win64:"builds/android/%s/android.zip"}},$n=Dt.registryDirectory=(()=>{let r,e=(0,bt.getFromENV)("PLAYWRIGHT_BROWSERS_PATH");if(e==="0")r=ke.default.join(__dirname,"..","..","..",".local-browsers");else if(e)r=e;else{let t;if(process.platform==="linux")t=process.env.XDG_CACHE_HOME||ke.default.join(dr.homedir(),".cache");else if(process.platform==="darwin")t=ke.default.join(dr.homedir(),"Library","Caches");else if(process.platform==="win32")t=process.env.LOCALAPPDATA||ke.default.join(dr.homedir(),"AppData","Local");else throw new Error("Unsupported platform: "+process.platform);r=ke.default.join(t,"ms-playwright")}return ke.default.isAbsolute(r)||(r=ke.default.resolve((0,bt.getFromENV)("INIT_CWD")||process.cwd(),r)),r})();function pS(r){let e=ke.default.basename(r);for(let t of gS)if(e.startsWith(t+"-"))return!0;return!1}function fS(r){return r.browsers.map(e=>{let t=e.name,n=(e.revisionOverrides||{})[ur.hostPlatform],s=n||e.revision,o=n?`${t}_${ur.hostPlatform}_special`:`${t}`;return{name:t,revision:s,browserVersion:n?void 0:e.browserVersion,installByDefault:!!e.installByDefault,dir:ke.default.join($n,o.replace(/-/g,"_")+"-"+s)}})}var gS=["chromium","firefox","webkit","ffmpeg","firefox-beta","chromium-tip-of-tree"],Ec=class{constructor(e){this._executables=void 0;let t=fS(e),n=(y,S)=>{let E;return process.platform==="linux"?E=em[S].linux:process.platform==="darwin"?E=em[S].mac:process.platform==="win32"&&(E=em[S].win),E?ke.default.join(y,...E):void 0},s=(y,S,E,C)=>{if(!S)throw new Error(`${y} is not supported on ${ur.hostPlatform}`);let k=Po(C,`install${E?"":" "+y}`);if(!(0,yc.canAccessFile)(S)){let F=(0,cr.readDockerVersionSync)(),O=F?(0,cr.dockerVersion)(F.dockerImageNameTemplate):null,P=F&&O&&F.dockerImageName!==O.dockerImageName?[`Looks like ${C==="javascript"?"Playwright Test or ":""}Playwright was just updated to ${O.driverVersion}.`,"Please update docker image as well.",`-  current: ${F.dockerImageName}`,`- required: ${O.dockerImageName}`,"","<3 Playwright Team"].join(`
`):[`Looks like ${C==="javascript"?"Playwright Test or ":""}Playwright was just installed or updated.`,`Please run the following command to download new browser${E?"s":""}:`,"",`    ${k}`,"","<3 Playwright Team"].join(`
`);throw new Error(`Executable doesn't exist at ${S}
${(0,bt.wrapInASCIIBox)(P,1)}`)}return S};this._executables=[];let o=t.find(y=>y.name==="chromium"),a=n(o.dir,"chromium");this._executables.push({type:"browser",name:"chromium",browserName:"chromium",directory:o.dir,executablePath:()=>a,executablePathOrDie:y=>s("chromium",a,o.installByDefault,y),installType:o.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"chromium",o.dir,["chrome-linux"],[],["chrome-win"]),downloadURLs:this._downloadURLs(o),browserVersion:o.browserVersion,_install:()=>this._downloadExecutable(o,a),_dependencyGroup:"chromium",_isHermeticInstallation:!0});let l=t.find(y=>y.name==="chromium-tip-of-tree"),c=n(l.dir,"chromium");this._executables.push({type:"tool",name:"chromium-tip-of-tree",browserName:"chromium",directory:l.dir,executablePath:()=>c,executablePathOrDie:y=>s("chromium-tip-of-tree",c,l.installByDefault,y),installType:l.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"chromium",l.dir,["chrome-linux"],[],["chrome-win"]),downloadURLs:this._downloadURLs(l),browserVersion:l.browserVersion,_install:()=>this._downloadExecutable(l,c),_dependencyGroup:"chromium",_isHermeticInstallation:!0}),this._executables.push(this._createChromiumChannel("chrome",{linux:"/opt/google/chrome/chrome",darwin:"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",win32:"\\Google\\Chrome\\Application\\chrome.exe"},()=>this._installChromiumChannel("chrome",{linux:"reinstall_chrome_stable_linux.sh",darwin:"reinstall_chrome_stable_mac.sh",win32:"reinstall_chrome_stable_win.ps1"}))),this._executables.push(this._createChromiumChannel("chrome-beta",{linux:"/opt/google/chrome-beta/chrome",darwin:"/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta",win32:"\\Google\\Chrome Beta\\Application\\chrome.exe"},()=>this._installChromiumChannel("chrome-beta",{linux:"reinstall_chrome_beta_linux.sh",darwin:"reinstall_chrome_beta_mac.sh",win32:"reinstall_chrome_beta_win.ps1"}))),this._executables.push(this._createChromiumChannel("chrome-dev",{linux:"/opt/google/chrome-unstable/chrome",darwin:"/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev",win32:"\\Google\\Chrome Dev\\Application\\chrome.exe"})),this._executables.push(this._createChromiumChannel("chrome-canary",{linux:"",darwin:"/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary",win32:"\\Google\\Chrome SxS\\Application\\chrome.exe"})),this._executables.push(this._createChromiumChannel("msedge",{linux:"/opt/microsoft/msedge/msedge",darwin:"/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge",win32:"\\Microsoft\\Edge\\Application\\msedge.exe"},()=>this._installMSEdgeChannel("msedge",{linux:"reinstall_msedge_stable_linux.sh",darwin:"reinstall_msedge_stable_mac.sh",win32:"reinstall_msedge_stable_win.ps1"}))),this._executables.push(this._createChromiumChannel("msedge-beta",{linux:"/opt/microsoft/msedge-beta/msedge",darwin:"/Applications/Microsoft Edge Beta.app/Contents/MacOS/Microsoft Edge Beta",win32:"\\Microsoft\\Edge Beta\\Application\\msedge.exe"},()=>this._installMSEdgeChannel("msedge-beta",{darwin:"reinstall_msedge_beta_mac.sh",linux:"reinstall_msedge_beta_linux.sh",win32:"reinstall_msedge_beta_win.ps1"}))),this._executables.push(this._createChromiumChannel("msedge-dev",{linux:"/opt/microsoft/msedge-dev/msedge",darwin:"/Applications/Microsoft Edge Dev.app/Contents/MacOS/Microsoft Edge Dev",win32:"\\Microsoft\\Edge Dev\\Application\\msedge.exe"},()=>this._installMSEdgeChannel("msedge-dev",{darwin:"reinstall_msedge_dev_mac.sh",linux:"reinstall_msedge_dev_linux.sh",win32:"reinstall_msedge_dev_win.ps1"}))),this._executables.push(this._createChromiumChannel("msedge-canary",{linux:"",darwin:"/Applications/Microsoft Edge Canary.app/Contents/MacOS/Microsoft Edge Canary",win32:"\\Microsoft\\Edge SxS\\Application\\msedge.exe"}));let u=t.find(y=>y.name==="firefox"),d=n(u.dir,"firefox");this._executables.push({type:"browser",name:"firefox",browserName:"firefox",directory:u.dir,executablePath:()=>d,executablePathOrDie:y=>s("firefox",d,u.installByDefault,y),installType:u.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"firefox",u.dir,["firefox"],[],["firefox"]),downloadURLs:this._downloadURLs(u),browserVersion:u.browserVersion,_install:()=>this._downloadExecutable(u,d),_dependencyGroup:"firefox",_isHermeticInstallation:!0});let h=t.find(y=>y.name==="firefox-asan"),p=n(h.dir,"firefox");this._executables.push({type:"browser",name:"firefox-asan",browserName:"firefox",directory:h.dir,executablePath:()=>p,executablePathOrDie:y=>s("firefox-asan",p,h.installByDefault,y),installType:h.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"firefox",h.dir,["firefox"],[],["firefox"]),downloadURLs:this._downloadURLs(h),browserVersion:h.browserVersion,_install:()=>this._downloadExecutable(h,p),_dependencyGroup:"firefox",_isHermeticInstallation:!0});let f=t.find(y=>y.name==="firefox-beta"),_=n(f.dir,"firefox");this._executables.push({type:"tool",name:"firefox-beta",browserName:"firefox",directory:f.dir,executablePath:()=>_,executablePathOrDie:y=>s("firefox-beta",_,f.installByDefault,y),installType:f.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"firefox",f.dir,["firefox"],[],["firefox"]),downloadURLs:this._downloadURLs(f),browserVersion:f.browserVersion,_install:()=>this._downloadExecutable(f,_),_dependencyGroup:"firefox",_isHermeticInstallation:!0});let v=t.find(y=>y.name==="webkit"),w=n(v.dir,"webkit"),m=[ke.default.join("minibrowser-gtk"),ke.default.join("minibrowser-gtk","bin"),ke.default.join("minibrowser-gtk","lib"),ke.default.join("minibrowser-gtk","sys","lib"),ke.default.join("minibrowser-wpe"),ke.default.join("minibrowser-wpe","bin"),ke.default.join("minibrowser-wpe","lib"),ke.default.join("minibrowser-wpe","sys","lib")];this._executables.push({type:"browser",name:"webkit",browserName:"webkit",directory:v.dir,executablePath:()=>w,executablePathOrDie:y=>s("webkit",w,v.installByDefault,y),installType:v.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:y=>this._validateHostRequirements(y,"webkit",v.dir,m,["libGLESv2.so.2","libx264.so"],[""]),downloadURLs:this._downloadURLs(v),browserVersion:v.browserVersion,_install:()=>this._downloadExecutable(v,w),_dependencyGroup:"webkit",_isHermeticInstallation:!0});let g=t.find(y=>y.name==="ffmpeg"),x=n(g.dir,"ffmpeg");this._executables.push({type:"tool",name:"ffmpeg",browserName:void 0,directory:g.dir,executablePath:()=>x,executablePathOrDie:y=>s("ffmpeg",x,g.installByDefault,y),installType:g.installByDefault?"download-by-default":"download-on-demand",_validateHostRequirements:()=>Promise.resolve(),downloadURLs:this._downloadURLs(g),_install:()=>this._downloadExecutable(g,x),_dependencyGroup:"tools",_isHermeticInstallation:!0});let b=t.find(y=>y.name==="android");this._executables.push({type:"tool",name:"android",browserName:void 0,directory:b.dir,executablePath:()=>{},executablePathOrDie:()=>"",installType:"download-on-demand",_validateHostRequirements:()=>Promise.resolve(),downloadURLs:this._downloadURLs(b),_install:()=>this._downloadExecutable(b),_dependencyGroup:"tools",_isHermeticInstallation:!0})}_createChromiumChannel(e,t,n){let s=(o,a)=>{let l=t[process.platform];if(!l){if(a)throw new Error(`Chromium distribution '${e}' is not supported on ${process.platform}`);return}let c=process.platform==="win32"?[process.env.LOCALAPPDATA,process.env.PROGRAMFILES,process.env["PROGRAMFILES(X86)"]].filter(Boolean):[""];for(let h of c){let p=ke.default.join(h,l);if((0,yc.canAccessFile)(p))return p}if(!a)return;let u=c.length?` at ${ke.default.join(c[0],l)}`:"",d=n?`
Run "${Po(o,"install "+e)}"`:"";throw new Error(`Chromium distribution '${e}' is not found${u}${d}`)};return{type:"channel",name:e,browserName:"chromium",directory:void 0,executablePath:o=>s(o,!1),executablePathOrDie:o=>s(o,!0),installType:n?"install-script":"none",_validateHostRequirements:()=>Promise.resolve(),_isHermeticInstallation:!1,_install:n}}executables(){return this._executables}findExecutable(e){return this._executables.find(t=>t.name===e)}defaultExecutables(){return this._executables.filter(e=>e.installType==="download-by-default")}_addRequirementsAndDedupe(e){let t=new Set;for(let n of e)t.add(n),n.browserName==="chromium"&&t.add(this.findExecutable("ffmpeg"));return Array.from(t)}async _validateHostRequirements(e,t,n,s,o,a){if(dr.platform()==="linux")return await(0,cr.validateDependenciesLinux)(e,s.map(l=>ke.default.join(n,l)),o);if(dr.platform()==="win32"&&dr.arch()==="x64")return await(0,cr.validateDependenciesWindows)(a.map(l=>ke.default.join(n,l)))}async installDeps(e,t){let n=this._addRequirementsAndDedupe(e),s=new Set;for(let o of n)o._dependencyGroup&&s.add(o._dependencyGroup);if(s.add("tools"),dr.platform()==="win32")return await(0,cr.installDependenciesWindows)(s,t);if(dr.platform()==="linux")return await(0,cr.installDependenciesLinux)(s,t)}async install(e,t){let n=this._addRequirementsAndDedupe(e);await $t.promises.mkdir($n,{recursive:!0});let s=ke.default.join($n,"__dirlock"),o=ke.default.join($n,".links"),a;try{a=await wN.lockfile.lock($n,{retries:{retries:20,factor:1.27579},onCompromised:l=>{throw new Error(`${l.message} Path: ${s}`)},lockfilePath:s}),await $t.promises.mkdir(o,{recursive:!0}),await $t.promises.writeFile(ke.default.join(o,(0,bt.calculateSha1)(Qf)),Qf),await this._validateInstallationCache(o);for(let l of n){if(!l._install)throw new Error(`ERROR: Playwright does not support installing ${l.name}`);let{embedderName:c}=(0,bN.getEmbedderName)();if(!(0,bt.getAsBooleanFromENV)("CI")&&!l._isHermeticInstallation&&!t&&l.executablePath(c)){let u=Po(c,"install --force "+l.name);throw new Error(`
`+(0,bt.wrapInASCIIBox)([`ATTENTION: "${l.name}" is already installed on the system!`,"",`"${l.name}" installation is not hermetic; installing newer version`,"requires *removal* of a current installation first.","",`To *uninstall* current version and re-install latest "${l.name}":`,"",`- Close all running instances of "${l.name}", if any`,'- Use "--force" to install browser:',"",`    ${u}`,"","<3 Playwright Team"].join(`
`),1))}await l._install()}}catch(l){if(l.code==="ELOCKED"){let c=process.platform==="win32"?"rm -R":"rm -rf";throw new Error(`
`+(0,bt.wrapInASCIIBox)(["An active lockfile is found at:","",`  ${s}`,"","Either:","- wait a few minutes if other Playwright is installing browsers in parallel","- remove lock manually with:","",`    ${c} ${s}`,"","<3 Playwright Team"].join(`
`),1))}else throw l}finally{a&&await a()}}async uninstall(e){let t=ke.default.join($n,".links");if(e){let n=await $t.promises.readdir(t).catch(()=>[]);for(let s of n)await $t.promises.unlink(ke.default.join(t,s))}else await $t.promises.unlink(ke.default.join(t,(0,bt.calculateSha1)(Qf))).catch(()=>{});return await this._validateInstallationCache(t),{numberOfBrowsersLeft:(await $t.promises.readdir($n).catch(()=>[])).filter(n=>pS(n)).length}}async validateHostRequirementsForExecutablesIfNeeded(e,t){if((0,bt.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS")){process.stderr.write("Skipping host requirements validation logic because `PLAYWRIGHT_SKIP_VALIDATE_HOST_REQUIREMENTS` env variable is set.\n");return}for(let n of e)await this._validateHostRequirementsForExecutableIfNeeded(n,t)}async _validateHostRequirementsForExecutableIfNeeded(e,t){if(!e.directory)return;let s=ke.default.join(e.directory,"DEPENDENCIES_VALIDATED");if(!await $t.promises.stat(s).then(o=>Date.now()-o.mtime.getTime()<2592e6).catch(()=>!1)){Yf.debugLogger.log("install",`validating host requirements for "${e.name}"`);try{await e._validateHostRequirements(t),Yf.debugLogger.log("install",`validation passed for ${e.name}`)}catch(o){throw Yf.debugLogger.log("install",`validation failed for ${e.name}`),o}await $t.promises.writeFile(s,"").catch(()=>{})}}_downloadURLs(e){let t=xN[e.name],n=t[ur.hostPlatform]||t["<unknown>"];if(!n)return[];let s=_N.format(n,e.revision),o=Sc.map(c=>`${c}/${s}`),a;e.name.startsWith("chromium")?a="PLAYWRIGHT_CHROMIUM_DOWNLOAD_HOST":e.name.startsWith("firefox")?a="PLAYWRIGHT_FIREFOX_DOWNLOAD_HOST":e.name.startsWith("webkit")&&(a="PLAYWRIGHT_WEBKIT_DOWNLOAD_HOST");let l=a&&(0,bt.getFromENV)(a)||(0,bt.getFromENV)("PLAYWRIGHT_DOWNLOAD_HOST");return l&&(o=[`${l}/${s}`]),o}async _downloadExecutable(e,t){let n=this._downloadURLs(e);if(!n.length)throw new Error(`ERROR: Playwright does not support ${e.name} on ${ur.hostPlatform}`);ur.isOfficiallySupportedPlatform||(0,xc.logPolitely)(`BEWARE: your OS is not officially supported by Playwright; downloading fallback build for ${ur.hostPlatform}.`);let s=e.name.split("-").map(u=>u==="ffmpeg"?"FFMPEG":u.charAt(0).toUpperCase()+u.slice(1)).join(" "),o=e.browserVersion?`${s} ${e.browserVersion} (playwright build v${e.revision})`:`${s} playwright build v${e.revision}`,a=`playwright-download-${e.name}-${ur.hostPlatform}-${e.revision}.zip`,c=+((0,bt.getFromENV)("PLAYWRIGHT_DOWNLOAD_CONNECTION_TIMEOUT")||"0")||3e4;await(0,xc.downloadBrowserWithProgressBar)(o,e.dir,t,n,a,c).catch(u=>{throw new Error(`Failed to download ${o}, caused by
${u.stack}`)})}async _installMSEdgeChannel(e,t){let n=[];if(process.platform!=="linux"){let s=tm(JSON.parse(await(0,vN.fetchData)({url:"https://edgeupdates.microsoft.com/api/products"}))),o={msedge:"Stable","msedge-beta":"Beta","msedge-dev":"Dev"}[e],a=s.find(d=>d.product===o),l={darwin:{platform:"MacOS",arch:"universal",artifact:"pkg"},win32:{platform:"Windows",arch:"x64",artifact:"msi"}}[process.platform],c=l?a.releases.find(d=>d.platform===l.platform&&d.architecture===l.arch&&d.artifacts.length>0):null,u=c?c.artifacts.find(d=>d.artifactname===l.artifact):null;if(u)n.push(u.location);else throw new Error(`Cannot install ${e} on ${process.platform}`)}await this._installChromiumChannel(e,t,n)}async _installChromiumChannel(e,t,n=[]){let s=t[process.platform];if(!s)throw new Error(`Cannot install ${e} on ${process.platform}`);let o=Zf;if(s.endsWith(".ps1")){let l=["-ExecutionPolicy","Bypass","-File",ke.default.join(Zf,s),...n],{code:c}=await(0,hS.spawnAsync)("powershell.exe",l,{cwd:o,stdio:"inherit"});if(c!==0)throw new Error(`Failed to install ${e}`)}else{let{command:l,args:c,elevatedPermissions:u}=await(0,cr.transformCommandsForRoot)([`bash "${ke.default.join(Zf,s)}" ${n.join("")}`]);u&&console.log("Switching to root user to install dependencies...");let{code:d}=await(0,hS.spawnAsync)(l,c,{cwd:o,stdio:"inherit"});if(d!==0)throw new Error(`Failed to install ${e}`)}}async _validateInstallationCache(e){let t=new Set;for(let n of await $t.promises.readdir(e)){let s=ke.default.join(e,n),o="";try{o=(await $t.promises.readFile(s)).toString();let a=require(ke.default.join(o,"browsers.json")),l=fS(a);for(let c of gS){let u=l.find(f=>f.name===c);if(!u)continue;let d=u.dir,h=parseInt(u.revision,10);(!(c==="chromium"&&(h>=786218||h<3e5)||c==="firefox"&&h>=1128||c==="webkit"&&h>=1307||c!=="firefox"&&c!=="chromium"&&c!=="webkit")||await(0,yc.existsAsync)(_S(d)))&&t.add(d)}}catch{await $t.promises.unlink(s).catch(l=>{})}}if(!(0,bt.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_BROWSER_GC")){let n=(await $t.promises.readdir($n)).map(o=>ke.default.join($n,o));n=n.filter(o=>pS(o));let s=new Set(n);for(let o of t)s.delete(o);for(let o of s)(0,xc.logPolitely)("Removing unused browser at "+o);await(0,yc.removeFolders)([...s])}}};Dt.Registry=Ec;function _S(r){return ke.default.join(r,"INSTALLATION_COMPLETE")}function Po(r,e){switch(r){case"python":return`playwright ${e}`;case"java":return`mvn exec:java -e -D exec.mainClass=com.microsoft.playwright.CLI -D exec.args="${e}"`;case"csharp":return`pwsh bin/Debug/netX/playwright.ps1 ${e}`;default:return`${(0,bt.getPackageManagerExecCommand)()} playwright ${e}`}}async function SN(){let r=kc.defaultExecutables().map(e=>e.name);return wS(r)}async function wS(r){if((0,bt.getAsBooleanFromENV)("PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD"))return(0,xc.logPolitely)("Skipping browsers download because `PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD` env variable is set"),!1;let e=[];for(let t of r){let n=kc.findExecutable(t);if(!n||n.installType==="none")throw new Error(`Cannot install ${t}`);e.push(n)}await kc.install(e,!1)}function EN(r){let e=null;for(let t of["chromium","chrome","msedge"])try{kc.findExecutable(t).executablePathOrDie(r),e=t==="chromium"?void 0:t;break}catch{}if(e===null){let n=["No chromium-based browser found on the system.","Please run the following command to download one:","",`    ${Po(r,"install chromium")}`,"","<3 Playwright Team"].join(`
`);throw new Error(`
`+(0,bt.wrapInASCIIBox)(n,1))}return e}function tm(r){if(typeof r!="object"||!r)return r;if(Array.isArray(r))return r.map(tm);let e={};for(let[t,n]of Object.entries(r))e[t.toLowerCase()]=tm(n);return e}var kc=Dt.registry=new Ec(dS())});var yS=M(Pe=>{"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.ValidationError=void 0;Pe.createMetadataValidator=TN;Pe.findValidator=CN;Pe.maybeFindValidator=vS;Pe.tUndefined=Pe.tType=Pe.tString=Pe.tOptional=Pe.tObject=Pe.tNumber=Pe.tEnum=Pe.tChannel=Pe.tBoolean=Pe.tBinary=Pe.tArray=Pe.tAny=Pe.scheme=void 0;var kN=ie(),mt=class extends Error{};Pe.ValidationError=mt;var rm=Pe.scheme={};function CN(r,e,t){let n=vS(r,e,t);if(!n)throw new mt(`Unknown scheme for ${t}: ${r}.${e}`);return n}function vS(r,e,t){let n=r+(t==="Initializer"?"":e[0].toUpperCase()+e.substring(1))+t;return rm[n]}function TN(){return bS(rm.Metadata)}var ON=(r,e,t)=>{if(r instanceof Number)return r.valueOf();if(typeof r=="number")return r;throw new mt(`${e}: expected number, got ${typeof r}`)};Pe.tNumber=ON;var PN=(r,e,t)=>{if(r instanceof Boolean)return r.valueOf();if(typeof r=="boolean")return r;throw new mt(`${e}: expected boolean, got ${typeof r}`)};Pe.tBoolean=PN;var AN=(r,e,t)=>{if(r instanceof String)return r.valueOf();if(typeof r=="string")return r;throw new mt(`${e}: expected string, got ${typeof r}`)};Pe.tString=AN;var IN=(r,e,t)=>{if(t.binary==="fromBase64"){if(r instanceof String)return Buffer.from(r.valueOf(),"base64");if(typeof r=="string")return Buffer.from(r,"base64");throw new mt(`${e}: expected base64-encoded buffer, got ${typeof r}`)}if(t.binary==="toBase64"){if(!(r instanceof Buffer))throw new mt(`${e}: expected Buffer, got ${typeof r}`);return r.toString("base64")}if(t.binary==="buffer"){if(!(r instanceof Buffer))throw new mt(`${e}: expected Buffer, got ${typeof r}`);return r}throw new mt(`Unsupported binary behavior "${t.binary}"`)};Pe.tBinary=IN;var RN=(r,e,t)=>{if(Object.is(r,void 0))return r;throw new mt(`${e}: expected undefined, got ${typeof r}`)};Pe.tUndefined=RN;var MN=(r,e,t)=>r;Pe.tAny=MN;var bS=r=>(e,t,n)=>Object.is(e,void 0)?e:r(e,t,n);Pe.tOptional=bS;var FN=r=>(e,t,n)=>{if(!Array.isArray(e))throw new mt(`${t}: expected array, got ${typeof e}`);return e.map((s,o)=>r(s,t+"["+o+"]",n))};Pe.tArray=FN;var NN=r=>(e,t,n)=>{if(Object.is(e,null))throw new mt(`${t}: expected object, got null`);if(typeof e!="object")throw new mt(`${t}: expected object, got ${typeof e}`);let s={};for(let[o,a]of Object.entries(r)){let l=a(e[o],t?t+"."+o:o,n);Object.is(l,void 0)||(s[o]=l)}if((0,kN.isUnderTest)())for(let[o,a]of Object.entries(e))o.startsWith("__testHook")&&(s[o]=a);return s};Pe.tObject=NN;var LN=r=>(e,t,n)=>{if(!r.includes(e))throw new mt(`${t}: expected one of (${r.join("|")})`);return e};Pe.tEnum=LN;var DN=r=>(e,t,n)=>n.tChannelImpl(r,e,t,n);Pe.tChannel=DN;var BN=r=>(e,t,n)=>{let s=rm[r];if(!s)throw new mt(t+': unknown type "'+r+'"');return s(e,t,n)};Pe.tType=BN});var Ao=M(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Object.defineProperty(Yi,"ValidationError",{enumerable:!0,get:function(){return i.ValidationError}});Object.defineProperty(Yi,"createMetadataValidator",{enumerable:!0,get:function(){return i.createMetadataValidator}});Object.defineProperty(Yi,"findValidator",{enumerable:!0,get:function(){return i.findValidator}});Object.defineProperty(Yi,"maybeFindValidator",{enumerable:!0,get:function(){return i.maybeFindValidator}});var i=yS();i.scheme.StackFrame=(0,i.tObject)({file:i.tString,line:i.tNumber,column:i.tNumber,function:(0,i.tOptional)(i.tString)});i.scheme.Metadata=(0,i.tObject)({location:(0,i.tOptional)((0,i.tObject)({file:i.tString,line:(0,i.tOptional)(i.tNumber),column:(0,i.tOptional)(i.tNumber)})),apiName:(0,i.tOptional)(i.tString),internal:(0,i.tOptional)(i.tBoolean),wallTime:(0,i.tOptional)(i.tNumber)});i.scheme.ClientSideCallMetadata=(0,i.tObject)({id:i.tNumber,stack:(0,i.tOptional)((0,i.tArray)((0,i.tType)("StackFrame")))});i.scheme.Point=(0,i.tObject)({x:i.tNumber,y:i.tNumber});i.scheme.Rect=(0,i.tObject)({x:i.tNumber,y:i.tNumber,width:i.tNumber,height:i.tNumber});i.scheme.SerializedValue=(0,i.tObject)({n:(0,i.tOptional)(i.tNumber),b:(0,i.tOptional)(i.tBoolean),s:(0,i.tOptional)(i.tString),v:(0,i.tOptional)((0,i.tEnum)(["null","undefined","NaN","Infinity","-Infinity","-0"])),d:(0,i.tOptional)(i.tString),u:(0,i.tOptional)(i.tString),bi:(0,i.tOptional)(i.tString),r:(0,i.tOptional)((0,i.tObject)({p:i.tString,f:i.tString})),a:(0,i.tOptional)((0,i.tArray)((0,i.tType)("SerializedValue"))),o:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({k:i.tString,v:(0,i.tType)("SerializedValue")}))),h:(0,i.tOptional)(i.tNumber),id:(0,i.tOptional)(i.tNumber),ref:(0,i.tOptional)(i.tNumber)});i.scheme.SerializedArgument=(0,i.tObject)({value:(0,i.tType)("SerializedValue"),handles:(0,i.tArray)((0,i.tChannel)("*"))});i.scheme.ExpectedTextValue=(0,i.tObject)({string:(0,i.tOptional)(i.tString),regexSource:(0,i.tOptional)(i.tString),regexFlags:(0,i.tOptional)(i.tString),matchSubstring:(0,i.tOptional)(i.tBoolean),ignoreCase:(0,i.tOptional)(i.tBoolean),normalizeWhiteSpace:(0,i.tOptional)(i.tBoolean)});i.scheme.AXNode=(0,i.tObject)({role:i.tString,name:i.tString,valueString:(0,i.tOptional)(i.tString),valueNumber:(0,i.tOptional)(i.tNumber),description:(0,i.tOptional)(i.tString),keyshortcuts:(0,i.tOptional)(i.tString),roledescription:(0,i.tOptional)(i.tString),valuetext:(0,i.tOptional)(i.tString),disabled:(0,i.tOptional)(i.tBoolean),expanded:(0,i.tOptional)(i.tBoolean),focused:(0,i.tOptional)(i.tBoolean),modal:(0,i.tOptional)(i.tBoolean),multiline:(0,i.tOptional)(i.tBoolean),multiselectable:(0,i.tOptional)(i.tBoolean),readonly:(0,i.tOptional)(i.tBoolean),required:(0,i.tOptional)(i.tBoolean),selected:(0,i.tOptional)(i.tBoolean),checked:(0,i.tOptional)((0,i.tEnum)(["checked","unchecked","mixed"])),pressed:(0,i.tOptional)((0,i.tEnum)(["pressed","released","mixed"])),level:(0,i.tOptional)(i.tNumber),valuemin:(0,i.tOptional)(i.tNumber),valuemax:(0,i.tOptional)(i.tNumber),autocomplete:(0,i.tOptional)(i.tString),haspopup:(0,i.tOptional)(i.tString),invalid:(0,i.tOptional)(i.tString),orientation:(0,i.tOptional)(i.tString),children:(0,i.tOptional)((0,i.tArray)((0,i.tType)("AXNode")))});i.scheme.SetNetworkCookie=(0,i.tObject)({name:i.tString,value:i.tString,url:(0,i.tOptional)(i.tString),domain:(0,i.tOptional)(i.tString),path:(0,i.tOptional)(i.tString),expires:(0,i.tOptional)(i.tNumber),httpOnly:(0,i.tOptional)(i.tBoolean),secure:(0,i.tOptional)(i.tBoolean),sameSite:(0,i.tOptional)((0,i.tEnum)(["Strict","Lax","None"]))});i.scheme.NetworkCookie=(0,i.tObject)({name:i.tString,value:i.tString,domain:i.tString,path:i.tString,expires:i.tNumber,httpOnly:i.tBoolean,secure:i.tBoolean,sameSite:(0,i.tEnum)(["Strict","Lax","None"])});i.scheme.NameValue=(0,i.tObject)({name:i.tString,value:i.tString});i.scheme.OriginStorage=(0,i.tObject)({origin:i.tString,localStorage:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.SerializedError=(0,i.tObject)({error:(0,i.tOptional)((0,i.tObject)({message:i.tString,name:i.tString,stack:(0,i.tOptional)(i.tString)})),value:(0,i.tOptional)((0,i.tType)("SerializedValue"))});i.scheme.RecordHarOptions=(0,i.tObject)({path:i.tString,content:(0,i.tOptional)((0,i.tEnum)(["embed","attach","omit"])),mode:(0,i.tOptional)((0,i.tEnum)(["full","minimal"])),urlGlob:(0,i.tOptional)(i.tString),urlRegexSource:(0,i.tOptional)(i.tString),urlRegexFlags:(0,i.tOptional)(i.tString)});i.scheme.FormField=(0,i.tObject)({name:i.tString,value:(0,i.tOptional)(i.tString),file:(0,i.tOptional)((0,i.tObject)({name:i.tString,mimeType:(0,i.tOptional)(i.tString),buffer:i.tBinary}))});i.scheme.APIRequestContextInitializer=(0,i.tObject)({tracing:(0,i.tChannel)(["Tracing"])});i.scheme.APIRequestContextFetchParams=(0,i.tObject)({url:i.tString,params:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),method:(0,i.tOptional)(i.tString),headers:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),postData:(0,i.tOptional)(i.tBinary),jsonData:(0,i.tOptional)(i.tString),formData:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),multipartData:(0,i.tOptional)((0,i.tArray)((0,i.tType)("FormField"))),timeout:(0,i.tOptional)(i.tNumber),failOnStatusCode:(0,i.tOptional)(i.tBoolean),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),maxRedirects:(0,i.tOptional)(i.tNumber)});i.scheme.APIRequestContextFetchResult=(0,i.tObject)({response:(0,i.tType)("APIResponse")});i.scheme.APIRequestContextFetchResponseBodyParams=(0,i.tObject)({fetchUid:i.tString});i.scheme.APIRequestContextFetchResponseBodyResult=(0,i.tObject)({binary:(0,i.tOptional)(i.tBinary)});i.scheme.APIRequestContextFetchLogParams=(0,i.tObject)({fetchUid:i.tString});i.scheme.APIRequestContextFetchLogResult=(0,i.tObject)({log:(0,i.tArray)(i.tString)});i.scheme.APIRequestContextStorageStateParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.APIRequestContextStorageStateResult=(0,i.tObject)({cookies:(0,i.tArray)((0,i.tType)("NetworkCookie")),origins:(0,i.tArray)((0,i.tType)("OriginStorage"))});i.scheme.APIRequestContextDisposeAPIResponseParams=(0,i.tObject)({fetchUid:i.tString});i.scheme.APIRequestContextDisposeAPIResponseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.APIRequestContextDisposeParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.APIRequestContextDisposeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.APIResponse=(0,i.tObject)({fetchUid:i.tString,url:i.tString,status:i.tNumber,statusText:i.tString,headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.LifecycleEvent=(0,i.tEnum)(["load","domcontentloaded","networkidle","commit"]);i.scheme.LocalUtilsInitializer=(0,i.tObject)({deviceDescriptors:(0,i.tArray)((0,i.tObject)({name:i.tString,descriptor:(0,i.tObject)({userAgent:i.tString,viewport:(0,i.tObject)({width:i.tNumber,height:i.tNumber}),screen:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),deviceScaleFactor:i.tNumber,isMobile:i.tBoolean,hasTouch:i.tBoolean,defaultBrowserType:(0,i.tEnum)(["chromium","firefox","webkit"])})}))});i.scheme.LocalUtilsZipParams=(0,i.tObject)({zipFile:i.tString,entries:(0,i.tArray)((0,i.tType)("NameValue")),stacksId:(0,i.tOptional)(i.tString),mode:(0,i.tEnum)(["write","append"]),includeSources:i.tBoolean});i.scheme.LocalUtilsZipResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.LocalUtilsHarOpenParams=(0,i.tObject)({file:i.tString});i.scheme.LocalUtilsHarOpenResult=(0,i.tObject)({harId:(0,i.tOptional)(i.tString),error:(0,i.tOptional)(i.tString)});i.scheme.LocalUtilsHarLookupParams=(0,i.tObject)({harId:i.tString,url:i.tString,method:i.tString,headers:(0,i.tArray)((0,i.tType)("NameValue")),postData:(0,i.tOptional)(i.tBinary),isNavigationRequest:i.tBoolean});i.scheme.LocalUtilsHarLookupResult=(0,i.tObject)({action:(0,i.tEnum)(["error","redirect","fulfill","noentry"]),message:(0,i.tOptional)(i.tString),redirectURL:(0,i.tOptional)(i.tString),status:(0,i.tOptional)(i.tNumber),headers:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),body:(0,i.tOptional)(i.tBinary)});i.scheme.LocalUtilsHarCloseParams=(0,i.tObject)({harId:i.tString});i.scheme.LocalUtilsHarCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.LocalUtilsHarUnzipParams=(0,i.tObject)({zipFile:i.tString,harFile:i.tString});i.scheme.LocalUtilsHarUnzipResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.LocalUtilsConnectParams=(0,i.tObject)({wsEndpoint:i.tString,headers:(0,i.tOptional)(i.tAny),exposeNetwork:(0,i.tOptional)(i.tString),slowMo:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber),socksProxyRedirectPortForTest:(0,i.tOptional)(i.tNumber)});i.scheme.LocalUtilsConnectResult=(0,i.tObject)({pipe:(0,i.tChannel)(["JsonPipe"]),headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.LocalUtilsTracingStartedParams=(0,i.tObject)({tracesDir:(0,i.tOptional)(i.tString),traceName:i.tString});i.scheme.LocalUtilsTracingStartedResult=(0,i.tObject)({stacksId:i.tString});i.scheme.LocalUtilsAddStackToTracingNoReplyParams=(0,i.tObject)({callData:(0,i.tType)("ClientSideCallMetadata")});i.scheme.LocalUtilsAddStackToTracingNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.LocalUtilsTraceDiscardedParams=(0,i.tObject)({stacksId:i.tString});i.scheme.LocalUtilsTraceDiscardedResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RootInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RootInitializeParams=(0,i.tObject)({sdkLanguage:(0,i.tEnum)(["javascript","python","java","csharp"])});i.scheme.RootInitializeResult=(0,i.tObject)({playwright:(0,i.tChannel)(["Playwright"])});i.scheme.PlaywrightInitializer=(0,i.tObject)({chromium:(0,i.tChannel)(["BrowserType"]),firefox:(0,i.tChannel)(["BrowserType"]),webkit:(0,i.tChannel)(["BrowserType"]),android:(0,i.tChannel)(["Android"]),electron:(0,i.tChannel)(["Electron"]),utils:(0,i.tOptional)((0,i.tChannel)(["LocalUtils"])),selectors:(0,i.tChannel)(["Selectors"]),preLaunchedBrowser:(0,i.tOptional)((0,i.tChannel)(["Browser"])),preConnectedAndroidDevice:(0,i.tOptional)((0,i.tChannel)(["AndroidDevice"])),socksSupport:(0,i.tOptional)((0,i.tChannel)(["SocksSupport"]))});i.scheme.PlaywrightNewRequestParams=(0,i.tObject)({baseURL:(0,i.tOptional)(i.tString),userAgent:(0,i.tOptional)(i.tString),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)})),timeout:(0,i.tOptional)(i.tNumber),storageState:(0,i.tOptional)((0,i.tObject)({cookies:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NetworkCookie"))),origins:(0,i.tOptional)((0,i.tArray)((0,i.tType)("OriginStorage")))})),tracesDir:(0,i.tOptional)(i.tString)});i.scheme.PlaywrightNewRequestResult=(0,i.tObject)({request:(0,i.tChannel)(["APIRequestContext"])});i.scheme.RecorderSource=(0,i.tObject)({isRecorded:i.tBoolean,id:i.tString,label:i.tString,text:i.tString,language:i.tString,highlight:(0,i.tArray)((0,i.tObject)({line:i.tNumber,type:i.tString})),revealLine:(0,i.tOptional)(i.tNumber),group:(0,i.tOptional)(i.tString)});i.scheme.DebugControllerInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerInspectRequestedEvent=(0,i.tObject)({selector:i.tString,locator:i.tString});i.scheme.DebugControllerSetModeRequestedEvent=(0,i.tObject)({mode:i.tString});i.scheme.DebugControllerStateChangedEvent=(0,i.tObject)({pageCount:i.tNumber});i.scheme.DebugControllerSourceChangedEvent=(0,i.tObject)({text:i.tString,header:(0,i.tOptional)(i.tString),footer:(0,i.tOptional)(i.tString),actions:(0,i.tOptional)((0,i.tArray)(i.tString))});i.scheme.DebugControllerPausedEvent=(0,i.tObject)({paused:i.tBoolean});i.scheme.DebugControllerInitializeParams=(0,i.tObject)({codegenId:i.tString,sdkLanguage:(0,i.tEnum)(["javascript","python","java","csharp"])});i.scheme.DebugControllerInitializeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerSetReportStateChangedParams=(0,i.tObject)({enabled:i.tBoolean});i.scheme.DebugControllerSetReportStateChangedResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerResetForReuseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerResetForReuseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerNavigateParams=(0,i.tObject)({url:i.tString});i.scheme.DebugControllerNavigateResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerSetRecorderModeParams=(0,i.tObject)({mode:(0,i.tEnum)(["inspecting","recording","none"]),testIdAttributeName:(0,i.tOptional)(i.tString)});i.scheme.DebugControllerSetRecorderModeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerHighlightParams=(0,i.tObject)({selector:i.tString});i.scheme.DebugControllerHighlightResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerHideHighlightParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerHideHighlightResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerResumeParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerResumeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerKillParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerKillResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerCloseAllBrowsersParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DebugControllerCloseAllBrowsersResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportSocksRequestedEvent=(0,i.tObject)({uid:i.tString,host:i.tString,port:i.tNumber});i.scheme.SocksSupportSocksDataEvent=(0,i.tObject)({uid:i.tString,data:i.tBinary});i.scheme.SocksSupportSocksClosedEvent=(0,i.tObject)({uid:i.tString});i.scheme.SocksSupportSocksConnectedParams=(0,i.tObject)({uid:i.tString,host:i.tString,port:i.tNumber});i.scheme.SocksSupportSocksConnectedResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportSocksFailedParams=(0,i.tObject)({uid:i.tString,errorCode:i.tString});i.scheme.SocksSupportSocksFailedResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportSocksDataParams=(0,i.tObject)({uid:i.tString,data:i.tBinary});i.scheme.SocksSupportSocksDataResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportSocksErrorParams=(0,i.tObject)({uid:i.tString,error:i.tString});i.scheme.SocksSupportSocksErrorResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SocksSupportSocksEndParams=(0,i.tObject)({uid:i.tString});i.scheme.SocksSupportSocksEndResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SelectorsInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SelectorsRegisterParams=(0,i.tObject)({name:i.tString,source:i.tString,contentScript:(0,i.tOptional)(i.tBoolean)});i.scheme.SelectorsRegisterResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.SelectorsSetTestIdAttributeNameParams=(0,i.tObject)({testIdAttributeName:i.tString});i.scheme.SelectorsSetTestIdAttributeNameResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserTypeInitializer=(0,i.tObject)({executablePath:i.tString,name:i.tString});i.scheme.BrowserTypeLaunchParams=(0,i.tObject)({channel:(0,i.tOptional)(i.tString),executablePath:(0,i.tOptional)(i.tString),args:(0,i.tOptional)((0,i.tArray)(i.tString)),ignoreAllDefaultArgs:(0,i.tOptional)(i.tBoolean),ignoreDefaultArgs:(0,i.tOptional)((0,i.tArray)(i.tString)),handleSIGINT:(0,i.tOptional)(i.tBoolean),handleSIGTERM:(0,i.tOptional)(i.tBoolean),handleSIGHUP:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),env:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),headless:(0,i.tOptional)(i.tBoolean),devtools:(0,i.tOptional)(i.tBoolean),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)})),downloadsPath:(0,i.tOptional)(i.tString),tracesDir:(0,i.tOptional)(i.tString),chromiumSandbox:(0,i.tOptional)(i.tBoolean),firefoxUserPrefs:(0,i.tOptional)(i.tAny),slowMo:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserTypeLaunchResult=(0,i.tObject)({browser:(0,i.tChannel)(["Browser"])});i.scheme.BrowserTypeLaunchPersistentContextParams=(0,i.tObject)({channel:(0,i.tOptional)(i.tString),executablePath:(0,i.tOptional)(i.tString),args:(0,i.tOptional)((0,i.tArray)(i.tString)),ignoreAllDefaultArgs:(0,i.tOptional)(i.tBoolean),ignoreDefaultArgs:(0,i.tOptional)((0,i.tArray)(i.tString)),handleSIGINT:(0,i.tOptional)(i.tBoolean),handleSIGTERM:(0,i.tOptional)(i.tBoolean),handleSIGHUP:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),env:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),headless:(0,i.tOptional)(i.tBoolean),devtools:(0,i.tOptional)(i.tBoolean),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)})),downloadsPath:(0,i.tOptional)(i.tString),tracesDir:(0,i.tOptional)(i.tString),chromiumSandbox:(0,i.tOptional)(i.tBoolean),firefoxUserPrefs:(0,i.tOptional)(i.tAny),noDefaultViewport:(0,i.tOptional)(i.tBoolean),viewport:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),screen:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),javaScriptEnabled:(0,i.tOptional)(i.tBoolean),bypassCSP:(0,i.tOptional)(i.tBoolean),userAgent:(0,i.tOptional)(i.tString),locale:(0,i.tOptional)(i.tString),timezoneId:(0,i.tOptional)(i.tString),geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)})),permissions:(0,i.tOptional)((0,i.tArray)(i.tString)),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),offline:(0,i.tOptional)(i.tBoolean),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),deviceScaleFactor:(0,i.tOptional)(i.tNumber),isMobile:(0,i.tOptional)(i.tBoolean),hasTouch:(0,i.tOptional)(i.tBoolean),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),reducedMotion:(0,i.tOptional)((0,i.tEnum)(["reduce","no-preference","no-override"])),forcedColors:(0,i.tOptional)((0,i.tEnum)(["active","none","no-override"])),acceptDownloads:(0,i.tOptional)((0,i.tEnum)(["accept","deny","internal-browser-default"])),baseURL:(0,i.tOptional)(i.tString),recordVideo:(0,i.tOptional)((0,i.tObject)({dir:i.tString,size:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber}))})),recordHar:(0,i.tOptional)((0,i.tType)("RecordHarOptions")),strictSelectors:(0,i.tOptional)(i.tBoolean),serviceWorkers:(0,i.tOptional)((0,i.tEnum)(["allow","block"])),userDataDir:i.tString,slowMo:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserTypeLaunchPersistentContextResult=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.BrowserTypeConnectOverCDPParams=(0,i.tObject)({endpointURL:i.tString,headers:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),slowMo:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserTypeConnectOverCDPResult=(0,i.tObject)({browser:(0,i.tChannel)(["Browser"]),defaultContext:(0,i.tOptional)((0,i.tChannel)(["BrowserContext"]))});i.scheme.BrowserInitializer=(0,i.tObject)({version:i.tString,name:i.tString});i.scheme.BrowserCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserCloseParams=(0,i.tObject)({reason:(0,i.tOptional)(i.tString)});i.scheme.BrowserCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserKillForTestsParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserKillForTestsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserDefaultUserAgentForTestParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserDefaultUserAgentForTestResult=(0,i.tObject)({userAgent:i.tString});i.scheme.BrowserNewContextParams=(0,i.tObject)({noDefaultViewport:(0,i.tOptional)(i.tBoolean),viewport:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),screen:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),javaScriptEnabled:(0,i.tOptional)(i.tBoolean),bypassCSP:(0,i.tOptional)(i.tBoolean),userAgent:(0,i.tOptional)(i.tString),locale:(0,i.tOptional)(i.tString),timezoneId:(0,i.tOptional)(i.tString),geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)})),permissions:(0,i.tOptional)((0,i.tArray)(i.tString)),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),offline:(0,i.tOptional)(i.tBoolean),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),deviceScaleFactor:(0,i.tOptional)(i.tNumber),isMobile:(0,i.tOptional)(i.tBoolean),hasTouch:(0,i.tOptional)(i.tBoolean),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),reducedMotion:(0,i.tOptional)((0,i.tEnum)(["reduce","no-preference","no-override"])),forcedColors:(0,i.tOptional)((0,i.tEnum)(["active","none","no-override"])),acceptDownloads:(0,i.tOptional)((0,i.tEnum)(["accept","deny","internal-browser-default"])),baseURL:(0,i.tOptional)(i.tString),recordVideo:(0,i.tOptional)((0,i.tObject)({dir:i.tString,size:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber}))})),recordHar:(0,i.tOptional)((0,i.tType)("RecordHarOptions")),strictSelectors:(0,i.tOptional)(i.tBoolean),serviceWorkers:(0,i.tOptional)((0,i.tEnum)(["allow","block"])),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)})),storageState:(0,i.tOptional)((0,i.tObject)({cookies:(0,i.tOptional)((0,i.tArray)((0,i.tType)("SetNetworkCookie"))),origins:(0,i.tOptional)((0,i.tArray)((0,i.tType)("OriginStorage")))}))});i.scheme.BrowserNewContextResult=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.BrowserNewContextForReuseParams=(0,i.tObject)({noDefaultViewport:(0,i.tOptional)(i.tBoolean),viewport:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),screen:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),javaScriptEnabled:(0,i.tOptional)(i.tBoolean),bypassCSP:(0,i.tOptional)(i.tBoolean),userAgent:(0,i.tOptional)(i.tString),locale:(0,i.tOptional)(i.tString),timezoneId:(0,i.tOptional)(i.tString),geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)})),permissions:(0,i.tOptional)((0,i.tArray)(i.tString)),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),offline:(0,i.tOptional)(i.tBoolean),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),deviceScaleFactor:(0,i.tOptional)(i.tNumber),isMobile:(0,i.tOptional)(i.tBoolean),hasTouch:(0,i.tOptional)(i.tBoolean),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),reducedMotion:(0,i.tOptional)((0,i.tEnum)(["reduce","no-preference","no-override"])),forcedColors:(0,i.tOptional)((0,i.tEnum)(["active","none","no-override"])),acceptDownloads:(0,i.tOptional)((0,i.tEnum)(["accept","deny","internal-browser-default"])),baseURL:(0,i.tOptional)(i.tString),recordVideo:(0,i.tOptional)((0,i.tObject)({dir:i.tString,size:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber}))})),recordHar:(0,i.tOptional)((0,i.tType)("RecordHarOptions")),strictSelectors:(0,i.tOptional)(i.tBoolean),serviceWorkers:(0,i.tOptional)((0,i.tEnum)(["allow","block"])),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)})),storageState:(0,i.tOptional)((0,i.tObject)({cookies:(0,i.tOptional)((0,i.tArray)((0,i.tType)("SetNetworkCookie"))),origins:(0,i.tOptional)((0,i.tArray)((0,i.tType)("OriginStorage")))}))});i.scheme.BrowserNewContextForReuseResult=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.BrowserStopPendingOperationsParams=(0,i.tObject)({reason:i.tString});i.scheme.BrowserStopPendingOperationsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserNewBrowserCDPSessionParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserNewBrowserCDPSessionResult=(0,i.tObject)({session:(0,i.tChannel)(["CDPSession"])});i.scheme.BrowserStartTracingParams=(0,i.tObject)({page:(0,i.tOptional)((0,i.tChannel)(["Page"])),screenshots:(0,i.tOptional)(i.tBoolean),categories:(0,i.tOptional)((0,i.tArray)(i.tString))});i.scheme.BrowserStartTracingResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserStopTracingParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserStopTracingResult=(0,i.tObject)({artifact:(0,i.tChannel)(["Artifact"])});i.scheme.EventTargetInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.EventTargetWaitForEventInfoParams=(0,i.tObject)({info:(0,i.tObject)({waitId:i.tString,phase:(0,i.tEnum)(["before","after","log"]),event:(0,i.tOptional)(i.tString),message:(0,i.tOptional)(i.tString),error:(0,i.tOptional)(i.tString)})});i.scheme.BrowserContextWaitForEventInfoParams=(0,i.tType)("EventTargetWaitForEventInfoParams");i.scheme.PageWaitForEventInfoParams=(0,i.tType)("EventTargetWaitForEventInfoParams");i.scheme.WebSocketWaitForEventInfoParams=(0,i.tType)("EventTargetWaitForEventInfoParams");i.scheme.ElectronApplicationWaitForEventInfoParams=(0,i.tType)("EventTargetWaitForEventInfoParams");i.scheme.AndroidDeviceWaitForEventInfoParams=(0,i.tType)("EventTargetWaitForEventInfoParams");i.scheme.EventTargetWaitForEventInfoResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextWaitForEventInfoResult=(0,i.tType)("EventTargetWaitForEventInfoResult");i.scheme.PageWaitForEventInfoResult=(0,i.tType)("EventTargetWaitForEventInfoResult");i.scheme.WebSocketWaitForEventInfoResult=(0,i.tType)("EventTargetWaitForEventInfoResult");i.scheme.ElectronApplicationWaitForEventInfoResult=(0,i.tType)("EventTargetWaitForEventInfoResult");i.scheme.AndroidDeviceWaitForEventInfoResult=(0,i.tType)("EventTargetWaitForEventInfoResult");i.scheme.BrowserContextInitializer=(0,i.tObject)({isChromium:i.tBoolean,requestContext:(0,i.tChannel)(["APIRequestContext"]),tracing:(0,i.tChannel)(["Tracing"])});i.scheme.BrowserContextBindingCallEvent=(0,i.tObject)({binding:(0,i.tChannel)(["BindingCall"])});i.scheme.BrowserContextConsoleEvent=(0,i.tObject)({type:i.tString,text:i.tString,args:(0,i.tArray)((0,i.tChannel)(["ElementHandle","JSHandle"])),location:(0,i.tObject)({url:i.tString,lineNumber:i.tNumber,columnNumber:i.tNumber}),page:(0,i.tChannel)(["Page"])});i.scheme.BrowserContextCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextDialogEvent=(0,i.tObject)({dialog:(0,i.tChannel)(["Dialog"])});i.scheme.BrowserContextPageEvent=(0,i.tObject)({page:(0,i.tChannel)(["Page"])});i.scheme.BrowserContextPageErrorEvent=(0,i.tObject)({error:(0,i.tType)("SerializedError"),page:(0,i.tChannel)(["Page"])});i.scheme.BrowserContextRouteEvent=(0,i.tObject)({route:(0,i.tChannel)(["Route"])});i.scheme.BrowserContextVideoEvent=(0,i.tObject)({artifact:(0,i.tChannel)(["Artifact"])});i.scheme.BrowserContextBackgroundPageEvent=(0,i.tObject)({page:(0,i.tChannel)(["Page"])});i.scheme.BrowserContextServiceWorkerEvent=(0,i.tObject)({worker:(0,i.tChannel)(["Worker"])});i.scheme.BrowserContextRequestEvent=(0,i.tObject)({request:(0,i.tChannel)(["Request"]),page:(0,i.tOptional)((0,i.tChannel)(["Page"]))});i.scheme.BrowserContextRequestFailedEvent=(0,i.tObject)({request:(0,i.tChannel)(["Request"]),failureText:(0,i.tOptional)(i.tString),responseEndTiming:i.tNumber,page:(0,i.tOptional)((0,i.tChannel)(["Page"]))});i.scheme.BrowserContextRequestFinishedEvent=(0,i.tObject)({request:(0,i.tChannel)(["Request"]),response:(0,i.tOptional)((0,i.tChannel)(["Response"])),responseEndTiming:i.tNumber,page:(0,i.tOptional)((0,i.tChannel)(["Page"]))});i.scheme.BrowserContextResponseEvent=(0,i.tObject)({response:(0,i.tChannel)(["Response"]),page:(0,i.tOptional)((0,i.tChannel)(["Page"]))});i.scheme.BrowserContextAddCookiesParams=(0,i.tObject)({cookies:(0,i.tArray)((0,i.tType)("SetNetworkCookie"))});i.scheme.BrowserContextAddCookiesResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextAddInitScriptParams=(0,i.tObject)({source:i.tString});i.scheme.BrowserContextAddInitScriptResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextClearCookiesParams=(0,i.tObject)({name:(0,i.tOptional)(i.tString),nameRegexSource:(0,i.tOptional)(i.tString),nameRegexFlags:(0,i.tOptional)(i.tString),domain:(0,i.tOptional)(i.tString),domainRegexSource:(0,i.tOptional)(i.tString),domainRegexFlags:(0,i.tOptional)(i.tString),path:(0,i.tOptional)(i.tString),pathRegexSource:(0,i.tOptional)(i.tString),pathRegexFlags:(0,i.tOptional)(i.tString)});i.scheme.BrowserContextClearCookiesResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextClearPermissionsParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextClearPermissionsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextCloseParams=(0,i.tObject)({reason:(0,i.tOptional)(i.tString)});i.scheme.BrowserContextCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextCookiesParams=(0,i.tObject)({urls:(0,i.tArray)(i.tString)});i.scheme.BrowserContextCookiesResult=(0,i.tObject)({cookies:(0,i.tArray)((0,i.tType)("NetworkCookie"))});i.scheme.BrowserContextExposeBindingParams=(0,i.tObject)({name:i.tString,needsHandle:(0,i.tOptional)(i.tBoolean)});i.scheme.BrowserContextExposeBindingResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextGrantPermissionsParams=(0,i.tObject)({permissions:(0,i.tArray)(i.tString),origin:(0,i.tOptional)(i.tString)});i.scheme.BrowserContextGrantPermissionsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextNewPageParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextNewPageResult=(0,i.tObject)({page:(0,i.tChannel)(["Page"])});i.scheme.BrowserContextSetDefaultNavigationTimeoutNoReplyParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserContextSetDefaultNavigationTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetDefaultTimeoutNoReplyParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserContextSetDefaultTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetExtraHTTPHeadersParams=(0,i.tObject)({headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.BrowserContextSetExtraHTTPHeadersResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetGeolocationParams=(0,i.tObject)({geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)}))});i.scheme.BrowserContextSetGeolocationResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetHTTPCredentialsParams=(0,i.tObject)({httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)}))});i.scheme.BrowserContextSetHTTPCredentialsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetNetworkInterceptionPatternsParams=(0,i.tObject)({patterns:(0,i.tArray)((0,i.tObject)({glob:(0,i.tOptional)(i.tString),regexSource:(0,i.tOptional)(i.tString),regexFlags:(0,i.tOptional)(i.tString)}))});i.scheme.BrowserContextSetNetworkInterceptionPatternsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextSetOfflineParams=(0,i.tObject)({offline:i.tBoolean});i.scheme.BrowserContextSetOfflineResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextStorageStateParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextStorageStateResult=(0,i.tObject)({cookies:(0,i.tArray)((0,i.tType)("NetworkCookie")),origins:(0,i.tArray)((0,i.tType)("OriginStorage"))});i.scheme.BrowserContextPauseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextPauseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextRecorderSupplementEnableParams=(0,i.tObject)({language:(0,i.tOptional)(i.tString),mode:(0,i.tOptional)((0,i.tEnum)(["inspecting","recording"])),pauseOnNextStatement:(0,i.tOptional)(i.tBoolean),testIdAttributeName:(0,i.tOptional)(i.tString),launchOptions:(0,i.tOptional)(i.tAny),contextOptions:(0,i.tOptional)(i.tAny),device:(0,i.tOptional)(i.tString),saveStorage:(0,i.tOptional)(i.tString),outputFile:(0,i.tOptional)(i.tString),handleSIGINT:(0,i.tOptional)(i.tBoolean),omitCallTracking:(0,i.tOptional)(i.tBoolean)});i.scheme.BrowserContextRecorderSupplementEnableResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BrowserContextNewCDPSessionParams=(0,i.tObject)({page:(0,i.tOptional)((0,i.tChannel)(["Page"])),frame:(0,i.tOptional)((0,i.tChannel)(["Frame"]))});i.scheme.BrowserContextNewCDPSessionResult=(0,i.tObject)({session:(0,i.tChannel)(["CDPSession"])});i.scheme.BrowserContextHarStartParams=(0,i.tObject)({page:(0,i.tOptional)((0,i.tChannel)(["Page"])),options:(0,i.tType)("RecordHarOptions")});i.scheme.BrowserContextHarStartResult=(0,i.tObject)({harId:i.tString});i.scheme.BrowserContextHarExportParams=(0,i.tObject)({harId:(0,i.tOptional)(i.tString)});i.scheme.BrowserContextHarExportResult=(0,i.tObject)({artifact:(0,i.tChannel)(["Artifact"])});i.scheme.BrowserContextCreateTempFileParams=(0,i.tObject)({name:i.tString,lastModifiedMs:(0,i.tOptional)(i.tNumber)});i.scheme.BrowserContextCreateTempFileResult=(0,i.tObject)({writableStream:(0,i.tChannel)(["WritableStream"])});i.scheme.BrowserContextUpdateSubscriptionParams=(0,i.tObject)({event:(0,i.tEnum)(["console","dialog","request","response","requestFinished","requestFailed"]),enabled:i.tBoolean});i.scheme.BrowserContextUpdateSubscriptionResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageInitializer=(0,i.tObject)({mainFrame:(0,i.tChannel)(["Frame"]),viewportSize:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),isClosed:i.tBoolean,opener:(0,i.tOptional)((0,i.tChannel)(["Page"]))});i.scheme.PageBindingCallEvent=(0,i.tObject)({binding:(0,i.tChannel)(["BindingCall"])});i.scheme.PageCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageCrashEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageDownloadEvent=(0,i.tObject)({url:i.tString,suggestedFilename:i.tString,artifact:(0,i.tChannel)(["Artifact"])});i.scheme.PageFileChooserEvent=(0,i.tObject)({element:(0,i.tChannel)(["ElementHandle"]),isMultiple:i.tBoolean});i.scheme.PageFrameAttachedEvent=(0,i.tObject)({frame:(0,i.tChannel)(["Frame"])});i.scheme.PageFrameDetachedEvent=(0,i.tObject)({frame:(0,i.tChannel)(["Frame"])});i.scheme.PageLocatorHandlerTriggeredEvent=(0,i.tObject)({uid:i.tNumber});i.scheme.PageRouteEvent=(0,i.tObject)({route:(0,i.tChannel)(["Route"])});i.scheme.PageVideoEvent=(0,i.tObject)({artifact:(0,i.tChannel)(["Artifact"])});i.scheme.PageWebSocketEvent=(0,i.tObject)({webSocket:(0,i.tChannel)(["WebSocket"])});i.scheme.PageWorkerEvent=(0,i.tObject)({worker:(0,i.tChannel)(["Worker"])});i.scheme.PageSetDefaultNavigationTimeoutNoReplyParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber)});i.scheme.PageSetDefaultNavigationTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageSetDefaultTimeoutNoReplyParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber)});i.scheme.PageSetDefaultTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageAddInitScriptParams=(0,i.tObject)({source:i.tString});i.scheme.PageAddInitScriptResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageCloseParams=(0,i.tObject)({runBeforeUnload:(0,i.tOptional)(i.tBoolean),reason:(0,i.tOptional)(i.tString)});i.scheme.PageCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageEmulateMediaParams=(0,i.tObject)({media:(0,i.tOptional)((0,i.tEnum)(["screen","print","no-override"])),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),reducedMotion:(0,i.tOptional)((0,i.tEnum)(["reduce","no-preference","no-override"])),forcedColors:(0,i.tOptional)((0,i.tEnum)(["active","none","no-override"]))});i.scheme.PageEmulateMediaResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageExposeBindingParams=(0,i.tObject)({name:i.tString,needsHandle:(0,i.tOptional)(i.tBoolean)});i.scheme.PageExposeBindingResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageGoBackParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber),waitUntil:(0,i.tOptional)((0,i.tType)("LifecycleEvent"))});i.scheme.PageGoBackResult=(0,i.tObject)({response:(0,i.tOptional)((0,i.tChannel)(["Response"]))});i.scheme.PageGoForwardParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber),waitUntil:(0,i.tOptional)((0,i.tType)("LifecycleEvent"))});i.scheme.PageGoForwardResult=(0,i.tObject)({response:(0,i.tOptional)((0,i.tChannel)(["Response"]))});i.scheme.PageRegisterLocatorHandlerParams=(0,i.tObject)({selector:i.tString,noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.PageRegisterLocatorHandlerResult=(0,i.tObject)({uid:i.tNumber});i.scheme.PageResolveLocatorHandlerNoReplyParams=(0,i.tObject)({uid:i.tNumber,remove:(0,i.tOptional)(i.tBoolean)});i.scheme.PageResolveLocatorHandlerNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageUnregisterLocatorHandlerParams=(0,i.tObject)({uid:i.tNumber});i.scheme.PageUnregisterLocatorHandlerResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageReloadParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber),waitUntil:(0,i.tOptional)((0,i.tType)("LifecycleEvent"))});i.scheme.PageReloadResult=(0,i.tObject)({response:(0,i.tOptional)((0,i.tChannel)(["Response"]))});i.scheme.PageExpectScreenshotParams=(0,i.tObject)({expected:(0,i.tOptional)(i.tBinary),timeout:(0,i.tOptional)(i.tNumber),isNot:i.tBoolean,locator:(0,i.tOptional)((0,i.tObject)({frame:(0,i.tChannel)(["Frame"]),selector:i.tString})),comparator:(0,i.tOptional)(i.tString),maxDiffPixels:(0,i.tOptional)(i.tNumber),maxDiffPixelRatio:(0,i.tOptional)(i.tNumber),threshold:(0,i.tOptional)(i.tNumber),fullPage:(0,i.tOptional)(i.tBoolean),clip:(0,i.tOptional)((0,i.tType)("Rect")),omitBackground:(0,i.tOptional)(i.tBoolean),caret:(0,i.tOptional)((0,i.tEnum)(["hide","initial"])),animations:(0,i.tOptional)((0,i.tEnum)(["disabled","allow"])),scale:(0,i.tOptional)((0,i.tEnum)(["css","device"])),mask:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({frame:(0,i.tChannel)(["Frame"]),selector:i.tString}))),maskColor:(0,i.tOptional)(i.tString),style:(0,i.tOptional)(i.tString)});i.scheme.PageExpectScreenshotResult=(0,i.tObject)({diff:(0,i.tOptional)(i.tBinary),errorMessage:(0,i.tOptional)(i.tString),actual:(0,i.tOptional)(i.tBinary),previous:(0,i.tOptional)(i.tBinary),log:(0,i.tOptional)((0,i.tArray)(i.tString))});i.scheme.PageScreenshotParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber),type:(0,i.tOptional)((0,i.tEnum)(["png","jpeg"])),quality:(0,i.tOptional)(i.tNumber),fullPage:(0,i.tOptional)(i.tBoolean),clip:(0,i.tOptional)((0,i.tType)("Rect")),omitBackground:(0,i.tOptional)(i.tBoolean),caret:(0,i.tOptional)((0,i.tEnum)(["hide","initial"])),animations:(0,i.tOptional)((0,i.tEnum)(["disabled","allow"])),scale:(0,i.tOptional)((0,i.tEnum)(["css","device"])),mask:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({frame:(0,i.tChannel)(["Frame"]),selector:i.tString}))),maskColor:(0,i.tOptional)(i.tString),style:(0,i.tOptional)(i.tString)});i.scheme.PageScreenshotResult=(0,i.tObject)({binary:i.tBinary});i.scheme.PageSetExtraHTTPHeadersParams=(0,i.tObject)({headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.PageSetExtraHTTPHeadersResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageSetNetworkInterceptionPatternsParams=(0,i.tObject)({patterns:(0,i.tArray)((0,i.tObject)({glob:(0,i.tOptional)(i.tString),regexSource:(0,i.tOptional)(i.tString),regexFlags:(0,i.tOptional)(i.tString)}))});i.scheme.PageSetNetworkInterceptionPatternsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageSetViewportSizeParams=(0,i.tObject)({viewportSize:(0,i.tObject)({width:i.tNumber,height:i.tNumber})});i.scheme.PageSetViewportSizeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageKeyboardDownParams=(0,i.tObject)({key:i.tString});i.scheme.PageKeyboardDownResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageKeyboardUpParams=(0,i.tObject)({key:i.tString});i.scheme.PageKeyboardUpResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageKeyboardInsertTextParams=(0,i.tObject)({text:i.tString});i.scheme.PageKeyboardInsertTextResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageKeyboardTypeParams=(0,i.tObject)({text:i.tString,delay:(0,i.tOptional)(i.tNumber)});i.scheme.PageKeyboardTypeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageKeyboardPressParams=(0,i.tObject)({key:i.tString,delay:(0,i.tOptional)(i.tNumber)});i.scheme.PageKeyboardPressResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageMouseMoveParams=(0,i.tObject)({x:i.tNumber,y:i.tNumber,steps:(0,i.tOptional)(i.tNumber)});i.scheme.PageMouseMoveResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageMouseDownParams=(0,i.tObject)({button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),clickCount:(0,i.tOptional)(i.tNumber)});i.scheme.PageMouseDownResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageMouseUpParams=(0,i.tObject)({button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),clickCount:(0,i.tOptional)(i.tNumber)});i.scheme.PageMouseUpResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageMouseClickParams=(0,i.tObject)({x:i.tNumber,y:i.tNumber,delay:(0,i.tOptional)(i.tNumber),button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),clickCount:(0,i.tOptional)(i.tNumber)});i.scheme.PageMouseClickResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageMouseWheelParams=(0,i.tObject)({deltaX:i.tNumber,deltaY:i.tNumber});i.scheme.PageMouseWheelResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageTouchscreenTapParams=(0,i.tObject)({x:i.tNumber,y:i.tNumber});i.scheme.PageTouchscreenTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageAccessibilitySnapshotParams=(0,i.tObject)({interestingOnly:(0,i.tOptional)(i.tBoolean),root:(0,i.tOptional)((0,i.tChannel)(["ElementHandle"]))});i.scheme.PageAccessibilitySnapshotResult=(0,i.tObject)({rootAXNode:(0,i.tOptional)((0,i.tType)("AXNode"))});i.scheme.PagePdfParams=(0,i.tObject)({scale:(0,i.tOptional)(i.tNumber),displayHeaderFooter:(0,i.tOptional)(i.tBoolean),headerTemplate:(0,i.tOptional)(i.tString),footerTemplate:(0,i.tOptional)(i.tString),printBackground:(0,i.tOptional)(i.tBoolean),landscape:(0,i.tOptional)(i.tBoolean),pageRanges:(0,i.tOptional)(i.tString),format:(0,i.tOptional)(i.tString),width:(0,i.tOptional)(i.tString),height:(0,i.tOptional)(i.tString),preferCSSPageSize:(0,i.tOptional)(i.tBoolean),margin:(0,i.tOptional)((0,i.tObject)({top:(0,i.tOptional)(i.tString),bottom:(0,i.tOptional)(i.tString),left:(0,i.tOptional)(i.tString),right:(0,i.tOptional)(i.tString)})),tagged:(0,i.tOptional)(i.tBoolean),outline:(0,i.tOptional)(i.tBoolean)});i.scheme.PagePdfResult=(0,i.tObject)({pdf:i.tBinary});i.scheme.PageStartJSCoverageParams=(0,i.tObject)({resetOnNavigation:(0,i.tOptional)(i.tBoolean),reportAnonymousScripts:(0,i.tOptional)(i.tBoolean)});i.scheme.PageStartJSCoverageResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageStopJSCoverageParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageStopJSCoverageResult=(0,i.tObject)({entries:(0,i.tArray)((0,i.tObject)({url:i.tString,scriptId:i.tString,source:(0,i.tOptional)(i.tString),functions:(0,i.tArray)((0,i.tObject)({functionName:i.tString,isBlockCoverage:i.tBoolean,ranges:(0,i.tArray)((0,i.tObject)({startOffset:i.tNumber,endOffset:i.tNumber,count:i.tNumber}))}))}))});i.scheme.PageStartCSSCoverageParams=(0,i.tObject)({resetOnNavigation:(0,i.tOptional)(i.tBoolean)});i.scheme.PageStartCSSCoverageResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageStopCSSCoverageParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageStopCSSCoverageResult=(0,i.tObject)({entries:(0,i.tArray)((0,i.tObject)({url:i.tString,text:(0,i.tOptional)(i.tString),ranges:(0,i.tArray)((0,i.tObject)({start:i.tNumber,end:i.tNumber}))}))});i.scheme.PageBringToFrontParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageBringToFrontResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.PageUpdateSubscriptionParams=(0,i.tObject)({event:(0,i.tEnum)(["console","dialog","fileChooser","request","response","requestFinished","requestFailed"]),enabled:i.tBoolean});i.scheme.PageUpdateSubscriptionResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameInitializer=(0,i.tObject)({url:i.tString,name:i.tString,parentFrame:(0,i.tOptional)((0,i.tChannel)(["Frame"])),loadStates:(0,i.tArray)((0,i.tType)("LifecycleEvent"))});i.scheme.FrameLoadstateEvent=(0,i.tObject)({add:(0,i.tOptional)((0,i.tType)("LifecycleEvent")),remove:(0,i.tOptional)((0,i.tType)("LifecycleEvent"))});i.scheme.FrameNavigatedEvent=(0,i.tObject)({url:i.tString,name:i.tString,newDocument:(0,i.tOptional)((0,i.tObject)({request:(0,i.tOptional)((0,i.tChannel)(["Request"]))})),error:(0,i.tOptional)(i.tString)});i.scheme.FrameEvalOnSelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.FrameEvalOnSelectorResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.FrameEvalOnSelectorAllParams=(0,i.tObject)({selector:i.tString,expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.FrameEvalOnSelectorAllResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.FrameAddScriptTagParams=(0,i.tObject)({url:(0,i.tOptional)(i.tString),content:(0,i.tOptional)(i.tString),type:(0,i.tOptional)(i.tString)});i.scheme.FrameAddScriptTagResult=(0,i.tObject)({element:(0,i.tChannel)(["ElementHandle"])});i.scheme.FrameAddStyleTagParams=(0,i.tObject)({url:(0,i.tOptional)(i.tString),content:(0,i.tOptional)(i.tString)});i.scheme.FrameAddStyleTagResult=(0,i.tObject)({element:(0,i.tChannel)(["ElementHandle"])});i.scheme.FrameBlurParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameBlurResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameCheckParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameCheckResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameClickParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),delay:(0,i.tOptional)(i.tNumber),button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),clickCount:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameClickResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameContentParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameContentResult=(0,i.tObject)({value:i.tString});i.scheme.FrameDragAndDropParams=(0,i.tObject)({source:i.tString,target:i.tString,force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean),sourcePosition:(0,i.tOptional)((0,i.tType)("Point")),targetPosition:(0,i.tOptional)((0,i.tType)("Point")),strict:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameDragAndDropResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameDblclickParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),delay:(0,i.tOptional)(i.tNumber),button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameDblclickResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameDispatchEventParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),type:i.tString,eventInit:(0,i.tType)("SerializedArgument"),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameDispatchEventResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameEvaluateExpressionParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),exposeUtilityScript:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.FrameEvaluateExpressionResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.FrameEvaluateExpressionHandleParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.FrameEvaluateExpressionHandleResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.FrameFillParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),value:i.tString,force:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameFillResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameFocusParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameFocusResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameFrameElementParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameFrameElementResult=(0,i.tObject)({element:(0,i.tChannel)(["ElementHandle"])});i.scheme.FrameHighlightParams=(0,i.tObject)({selector:i.tString});i.scheme.FrameHighlightResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameGetAttributeParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),name:i.tString,timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameGetAttributeResult=(0,i.tObject)({value:(0,i.tOptional)(i.tString)});i.scheme.FrameGotoParams=(0,i.tObject)({url:i.tString,timeout:(0,i.tOptional)(i.tNumber),waitUntil:(0,i.tOptional)((0,i.tType)("LifecycleEvent")),referer:(0,i.tOptional)(i.tString)});i.scheme.FrameGotoResult=(0,i.tObject)({response:(0,i.tOptional)((0,i.tChannel)(["Response"]))});i.scheme.FrameHoverParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameHoverResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameInnerHTMLParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameInnerHTMLResult=(0,i.tObject)({value:i.tString});i.scheme.FrameInnerTextParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameInnerTextResult=(0,i.tObject)({value:i.tString});i.scheme.FrameInputValueParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameInputValueResult=(0,i.tObject)({value:i.tString});i.scheme.FrameIsCheckedParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameIsCheckedResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FrameIsDisabledParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameIsDisabledResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FrameIsEnabledParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameIsEnabledResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FrameIsHiddenParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameIsHiddenResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FrameIsVisibleParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameIsVisibleResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FrameIsEditableParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameIsEditableResult=(0,i.tObject)({value:i.tBoolean});i.scheme.FramePressParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),key:i.tString,delay:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FramePressResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameQuerySelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameQuerySelectorResult=(0,i.tObject)({element:(0,i.tOptional)((0,i.tChannel)(["ElementHandle"]))});i.scheme.FrameQuerySelectorAllParams=(0,i.tObject)({selector:i.tString});i.scheme.FrameQuerySelectorAllResult=(0,i.tObject)({elements:(0,i.tArray)((0,i.tChannel)(["ElementHandle"]))});i.scheme.FrameQueryCountParams=(0,i.tObject)({selector:i.tString});i.scheme.FrameQueryCountResult=(0,i.tObject)({value:i.tNumber});i.scheme.FrameSelectOptionParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),elements:(0,i.tOptional)((0,i.tArray)((0,i.tChannel)(["ElementHandle"]))),options:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({valueOrLabel:(0,i.tOptional)(i.tString),value:(0,i.tOptional)(i.tString),label:(0,i.tOptional)(i.tString),index:(0,i.tOptional)(i.tNumber)}))),force:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameSelectOptionResult=(0,i.tObject)({values:(0,i.tArray)(i.tString)});i.scheme.FrameSetContentParams=(0,i.tObject)({html:i.tString,timeout:(0,i.tOptional)(i.tNumber),waitUntil:(0,i.tOptional)((0,i.tType)("LifecycleEvent"))});i.scheme.FrameSetContentResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameSetInputFilesParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),payloads:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({name:i.tString,mimeType:(0,i.tOptional)(i.tString),buffer:i.tBinary}))),localPaths:(0,i.tOptional)((0,i.tArray)(i.tString)),streams:(0,i.tOptional)((0,i.tArray)((0,i.tChannel)(["WritableStream"]))),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameSetInputFilesResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameTapParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameTextContentParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameTextContentResult=(0,i.tObject)({value:(0,i.tOptional)(i.tString)});i.scheme.FrameTitleParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameTitleResult=(0,i.tObject)({value:i.tString});i.scheme.FrameTypeParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),text:i.tString,delay:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameTypeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameUncheckParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameUncheckResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameWaitForTimeoutParams=(0,i.tObject)({timeout:i.tNumber});i.scheme.FrameWaitForTimeoutResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.FrameWaitForFunctionParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument"),timeout:(0,i.tOptional)(i.tNumber),pollingInterval:(0,i.tOptional)(i.tNumber)});i.scheme.FrameWaitForFunctionResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.FrameWaitForSelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),state:(0,i.tOptional)((0,i.tEnum)(["attached","detached","visible","hidden"])),omitReturnValue:(0,i.tOptional)(i.tBoolean)});i.scheme.FrameWaitForSelectorResult=(0,i.tObject)({element:(0,i.tOptional)((0,i.tChannel)(["ElementHandle"]))});i.scheme.FrameExpectParams=(0,i.tObject)({selector:i.tString,expression:i.tString,expressionArg:(0,i.tOptional)(i.tAny),expectedText:(0,i.tOptional)((0,i.tArray)((0,i.tType)("ExpectedTextValue"))),expectedNumber:(0,i.tOptional)(i.tNumber),expectedValue:(0,i.tOptional)((0,i.tType)("SerializedArgument")),useInnerText:(0,i.tOptional)(i.tBoolean),isNot:i.tBoolean,timeout:(0,i.tOptional)(i.tNumber)});i.scheme.FrameExpectResult=(0,i.tObject)({matches:i.tBoolean,received:(0,i.tOptional)((0,i.tType)("SerializedValue")),timedOut:(0,i.tOptional)(i.tBoolean),log:(0,i.tOptional)((0,i.tArray)(i.tString))});i.scheme.WorkerInitializer=(0,i.tObject)({url:i.tString});i.scheme.WorkerCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WorkerEvaluateExpressionParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.WorkerEvaluateExpressionResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.WorkerEvaluateExpressionHandleParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.WorkerEvaluateExpressionHandleResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.JSHandleInitializer=(0,i.tObject)({preview:i.tString});i.scheme.JSHandlePreviewUpdatedEvent=(0,i.tObject)({preview:i.tString});i.scheme.ElementHandlePreviewUpdatedEvent=(0,i.tType)("JSHandlePreviewUpdatedEvent");i.scheme.JSHandleDisposeParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleDisposeParams=(0,i.tType)("JSHandleDisposeParams");i.scheme.JSHandleDisposeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleDisposeResult=(0,i.tType)("JSHandleDisposeResult");i.scheme.JSHandleEvaluateExpressionParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElementHandleEvaluateExpressionParams=(0,i.tType)("JSHandleEvaluateExpressionParams");i.scheme.JSHandleEvaluateExpressionResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.ElementHandleEvaluateExpressionResult=(0,i.tType)("JSHandleEvaluateExpressionResult");i.scheme.JSHandleEvaluateExpressionHandleParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElementHandleEvaluateExpressionHandleParams=(0,i.tType)("JSHandleEvaluateExpressionHandleParams");i.scheme.JSHandleEvaluateExpressionHandleResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.ElementHandleEvaluateExpressionHandleResult=(0,i.tType)("JSHandleEvaluateExpressionHandleResult");i.scheme.JSHandleGetPropertyListParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleGetPropertyListParams=(0,i.tType)("JSHandleGetPropertyListParams");i.scheme.JSHandleGetPropertyListResult=(0,i.tObject)({properties:(0,i.tArray)((0,i.tObject)({name:i.tString,value:(0,i.tChannel)(["ElementHandle","JSHandle"])}))});i.scheme.ElementHandleGetPropertyListResult=(0,i.tType)("JSHandleGetPropertyListResult");i.scheme.JSHandleGetPropertyParams=(0,i.tObject)({name:i.tString});i.scheme.ElementHandleGetPropertyParams=(0,i.tType)("JSHandleGetPropertyParams");i.scheme.JSHandleGetPropertyResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.ElementHandleGetPropertyResult=(0,i.tType)("JSHandleGetPropertyResult");i.scheme.JSHandleJsonValueParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleJsonValueParams=(0,i.tType)("JSHandleJsonValueParams");i.scheme.JSHandleJsonValueResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.ElementHandleJsonValueResult=(0,i.tType)("JSHandleJsonValueResult");i.scheme.JSHandleObjectCountParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleObjectCountParams=(0,i.tType)("JSHandleObjectCountParams");i.scheme.JSHandleObjectCountResult=(0,i.tObject)({count:i.tNumber});i.scheme.ElementHandleObjectCountResult=(0,i.tType)("JSHandleObjectCountResult");i.scheme.ElementHandleInitializer=(0,i.tObject)({preview:i.tString});i.scheme.ElementHandleEvalOnSelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElementHandleEvalOnSelectorResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.ElementHandleEvalOnSelectorAllParams=(0,i.tObject)({selector:i.tString,expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElementHandleEvalOnSelectorAllResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.ElementHandleBoundingBoxParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleBoundingBoxResult=(0,i.tObject)({value:(0,i.tOptional)((0,i.tType)("Rect"))});i.scheme.ElementHandleCheckParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleCheckResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleClickParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),delay:(0,i.tOptional)(i.tNumber),button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),clickCount:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleClickResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleContentFrameParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleContentFrameResult=(0,i.tObject)({frame:(0,i.tOptional)((0,i.tChannel)(["Frame"]))});i.scheme.ElementHandleDblclickParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),delay:(0,i.tOptional)(i.tNumber),button:(0,i.tOptional)((0,i.tEnum)(["left","right","middle"])),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleDblclickResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleDispatchEventParams=(0,i.tObject)({type:i.tString,eventInit:(0,i.tType)("SerializedArgument")});i.scheme.ElementHandleDispatchEventResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleFillParams=(0,i.tObject)({value:i.tString,force:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleFillResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleFocusParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleFocusResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleGetAttributeParams=(0,i.tObject)({name:i.tString});i.scheme.ElementHandleGetAttributeResult=(0,i.tObject)({value:(0,i.tOptional)(i.tString)});i.scheme.ElementHandleHoverParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleHoverResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleInnerHTMLParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleInnerHTMLResult=(0,i.tObject)({value:i.tString});i.scheme.ElementHandleInnerTextParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleInnerTextResult=(0,i.tObject)({value:i.tString});i.scheme.ElementHandleInputValueParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleInputValueResult=(0,i.tObject)({value:i.tString});i.scheme.ElementHandleIsCheckedParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsCheckedResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleIsDisabledParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsDisabledResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleIsEditableParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsEditableResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleIsEnabledParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsEnabledResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleIsHiddenParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsHiddenResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleIsVisibleParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleIsVisibleResult=(0,i.tObject)({value:i.tBoolean});i.scheme.ElementHandleOwnerFrameParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleOwnerFrameResult=(0,i.tObject)({frame:(0,i.tOptional)((0,i.tChannel)(["Frame"]))});i.scheme.ElementHandlePressParams=(0,i.tObject)({key:i.tString,delay:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandlePressResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleQuerySelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleQuerySelectorResult=(0,i.tObject)({element:(0,i.tOptional)((0,i.tChannel)(["ElementHandle"]))});i.scheme.ElementHandleQuerySelectorAllParams=(0,i.tObject)({selector:i.tString});i.scheme.ElementHandleQuerySelectorAllResult=(0,i.tObject)({elements:(0,i.tArray)((0,i.tChannel)(["ElementHandle"]))});i.scheme.ElementHandleScreenshotParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber),type:(0,i.tOptional)((0,i.tEnum)(["png","jpeg"])),quality:(0,i.tOptional)(i.tNumber),omitBackground:(0,i.tOptional)(i.tBoolean),caret:(0,i.tOptional)((0,i.tEnum)(["hide","initial"])),animations:(0,i.tOptional)((0,i.tEnum)(["disabled","allow"])),scale:(0,i.tOptional)((0,i.tEnum)(["css","device"])),mask:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({frame:(0,i.tChannel)(["Frame"]),selector:i.tString}))),maskColor:(0,i.tOptional)(i.tString),style:(0,i.tOptional)(i.tString)});i.scheme.ElementHandleScreenshotResult=(0,i.tObject)({binary:i.tBinary});i.scheme.ElementHandleScrollIntoViewIfNeededParams=(0,i.tObject)({timeout:(0,i.tOptional)(i.tNumber)});i.scheme.ElementHandleScrollIntoViewIfNeededResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleSelectOptionParams=(0,i.tObject)({elements:(0,i.tOptional)((0,i.tArray)((0,i.tChannel)(["ElementHandle"]))),options:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({valueOrLabel:(0,i.tOptional)(i.tString),value:(0,i.tOptional)(i.tString),label:(0,i.tOptional)(i.tString),index:(0,i.tOptional)(i.tNumber)}))),force:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleSelectOptionResult=(0,i.tObject)({values:(0,i.tArray)(i.tString)});i.scheme.ElementHandleSelectTextParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.ElementHandleSelectTextResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleSetInputFilesParams=(0,i.tObject)({payloads:(0,i.tOptional)((0,i.tArray)((0,i.tObject)({name:i.tString,mimeType:(0,i.tOptional)(i.tString),buffer:i.tBinary}))),localPaths:(0,i.tOptional)((0,i.tArray)(i.tString)),streams:(0,i.tOptional)((0,i.tArray)((0,i.tChannel)(["WritableStream"]))),timeout:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleSetInputFilesResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleTapParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),modifiers:(0,i.tOptional)((0,i.tArray)((0,i.tEnum)(["Alt","Control","ControlOrMeta","Meta","Shift"]))),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleTextContentParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleTextContentResult=(0,i.tObject)({value:(0,i.tOptional)(i.tString)});i.scheme.ElementHandleTypeParams=(0,i.tObject)({text:i.tString,delay:(0,i.tOptional)(i.tNumber),noWaitAfter:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.ElementHandleTypeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleUncheckParams=(0,i.tObject)({force:(0,i.tOptional)(i.tBoolean),noWaitAfter:(0,i.tOptional)(i.tBoolean),position:(0,i.tOptional)((0,i.tType)("Point")),timeout:(0,i.tOptional)(i.tNumber),trial:(0,i.tOptional)(i.tBoolean)});i.scheme.ElementHandleUncheckResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleWaitForElementStateParams=(0,i.tObject)({state:(0,i.tEnum)(["visible","hidden","stable","enabled","disabled","editable"]),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.ElementHandleWaitForElementStateResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElementHandleWaitForSelectorParams=(0,i.tObject)({selector:i.tString,strict:(0,i.tOptional)(i.tBoolean),timeout:(0,i.tOptional)(i.tNumber),state:(0,i.tOptional)((0,i.tEnum)(["attached","detached","visible","hidden"]))});i.scheme.ElementHandleWaitForSelectorResult=(0,i.tObject)({element:(0,i.tOptional)((0,i.tChannel)(["ElementHandle"]))});i.scheme.RequestInitializer=(0,i.tObject)({frame:(0,i.tOptional)((0,i.tChannel)(["Frame"])),serviceWorker:(0,i.tOptional)((0,i.tChannel)(["Worker"])),url:i.tString,resourceType:i.tString,method:i.tString,postData:(0,i.tOptional)(i.tBinary),headers:(0,i.tArray)((0,i.tType)("NameValue")),isNavigationRequest:i.tBoolean,redirectedFrom:(0,i.tOptional)((0,i.tChannel)(["Request"]))});i.scheme.RequestResponseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RequestResponseResult=(0,i.tObject)({response:(0,i.tOptional)((0,i.tChannel)(["Response"]))});i.scheme.RequestRawRequestHeadersParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RequestRawRequestHeadersResult=(0,i.tObject)({headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.RouteInitializer=(0,i.tObject)({request:(0,i.tChannel)(["Request"])});i.scheme.RouteRedirectNavigationRequestParams=(0,i.tObject)({url:i.tString});i.scheme.RouteRedirectNavigationRequestResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RouteAbortParams=(0,i.tObject)({errorCode:(0,i.tOptional)(i.tString),requestUrl:i.tString});i.scheme.RouteAbortResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RouteContinueParams=(0,i.tObject)({url:(0,i.tOptional)(i.tString),method:(0,i.tOptional)(i.tString),headers:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),postData:(0,i.tOptional)(i.tBinary),requestUrl:i.tString,isFallback:i.tBoolean});i.scheme.RouteContinueResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.RouteFulfillParams=(0,i.tObject)({status:(0,i.tOptional)(i.tNumber),headers:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),body:(0,i.tOptional)(i.tString),isBase64:(0,i.tOptional)(i.tBoolean),fetchResponseUid:(0,i.tOptional)(i.tString),requestUrl:i.tString});i.scheme.RouteFulfillResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResourceTiming=(0,i.tObject)({startTime:i.tNumber,domainLookupStart:i.tNumber,domainLookupEnd:i.tNumber,connectStart:i.tNumber,secureConnectionStart:i.tNumber,connectEnd:i.tNumber,requestStart:i.tNumber,responseStart:i.tNumber});i.scheme.ResponseInitializer=(0,i.tObject)({request:(0,i.tChannel)(["Request"]),url:i.tString,status:i.tNumber,statusText:i.tString,headers:(0,i.tArray)((0,i.tType)("NameValue")),timing:(0,i.tType)("ResourceTiming"),fromServiceWorker:i.tBoolean});i.scheme.ResponseBodyParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResponseBodyResult=(0,i.tObject)({binary:i.tBinary});i.scheme.ResponseSecurityDetailsParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResponseSecurityDetailsResult=(0,i.tObject)({value:(0,i.tOptional)((0,i.tType)("SecurityDetails"))});i.scheme.ResponseServerAddrParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResponseServerAddrResult=(0,i.tObject)({value:(0,i.tOptional)((0,i.tType)("RemoteAddr"))});i.scheme.ResponseRawResponseHeadersParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResponseRawResponseHeadersResult=(0,i.tObject)({headers:(0,i.tArray)((0,i.tType)("NameValue"))});i.scheme.ResponseSizesParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ResponseSizesResult=(0,i.tObject)({sizes:(0,i.tType)("RequestSizes")});i.scheme.SecurityDetails=(0,i.tObject)({issuer:(0,i.tOptional)(i.tString),protocol:(0,i.tOptional)(i.tString),subjectName:(0,i.tOptional)(i.tString),validFrom:(0,i.tOptional)(i.tNumber),validTo:(0,i.tOptional)(i.tNumber)});i.scheme.RequestSizes=(0,i.tObject)({requestBodySize:i.tNumber,requestHeadersSize:i.tNumber,responseBodySize:i.tNumber,responseHeadersSize:i.tNumber});i.scheme.RemoteAddr=(0,i.tObject)({ipAddress:i.tString,port:i.tNumber});i.scheme.WebSocketInitializer=(0,i.tObject)({url:i.tString});i.scheme.WebSocketOpenEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WebSocketFrameSentEvent=(0,i.tObject)({opcode:i.tNumber,data:i.tString});i.scheme.WebSocketFrameReceivedEvent=(0,i.tObject)({opcode:i.tNumber,data:i.tString});i.scheme.WebSocketSocketErrorEvent=(0,i.tObject)({error:i.tString});i.scheme.WebSocketCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BindingCallInitializer=(0,i.tObject)({frame:(0,i.tChannel)(["Frame"]),name:i.tString,args:(0,i.tOptional)((0,i.tArray)((0,i.tType)("SerializedValue"))),handle:(0,i.tOptional)((0,i.tChannel)(["ElementHandle","JSHandle"]))});i.scheme.BindingCallRejectParams=(0,i.tObject)({error:(0,i.tType)("SerializedError")});i.scheme.BindingCallRejectResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.BindingCallResolveParams=(0,i.tObject)({result:(0,i.tType)("SerializedArgument")});i.scheme.BindingCallResolveResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DialogInitializer=(0,i.tObject)({page:(0,i.tOptional)((0,i.tChannel)(["Page"])),type:i.tString,message:i.tString,defaultValue:i.tString});i.scheme.DialogAcceptParams=(0,i.tObject)({promptText:(0,i.tOptional)(i.tString)});i.scheme.DialogAcceptResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DialogDismissParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.DialogDismissResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.TracingInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.TracingTracingStartParams=(0,i.tObject)({name:(0,i.tOptional)(i.tString),snapshots:(0,i.tOptional)(i.tBoolean),screenshots:(0,i.tOptional)(i.tBoolean),live:(0,i.tOptional)(i.tBoolean)});i.scheme.TracingTracingStartResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.TracingTracingStartChunkParams=(0,i.tObject)({name:(0,i.tOptional)(i.tString),title:(0,i.tOptional)(i.tString)});i.scheme.TracingTracingStartChunkResult=(0,i.tObject)({traceName:i.tString});i.scheme.TracingTracingStopChunkParams=(0,i.tObject)({mode:(0,i.tEnum)(["archive","discard","entries"])});i.scheme.TracingTracingStopChunkResult=(0,i.tObject)({artifact:(0,i.tOptional)((0,i.tChannel)(["Artifact"])),entries:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue")))});i.scheme.TracingTracingStopParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.TracingTracingStopResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactInitializer=(0,i.tObject)({absolutePath:i.tString});i.scheme.ArtifactPathAfterFinishedParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactPathAfterFinishedResult=(0,i.tObject)({value:i.tString});i.scheme.ArtifactSaveAsParams=(0,i.tObject)({path:i.tString});i.scheme.ArtifactSaveAsResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactSaveAsStreamParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactSaveAsStreamResult=(0,i.tObject)({stream:(0,i.tChannel)(["Stream"])});i.scheme.ArtifactFailureParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactFailureResult=(0,i.tObject)({error:(0,i.tOptional)(i.tString)});i.scheme.ArtifactStreamParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactStreamResult=(0,i.tObject)({stream:(0,i.tChannel)(["Stream"])});i.scheme.ArtifactCancelParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactCancelResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactDeleteParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ArtifactDeleteResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.StreamInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.StreamReadParams=(0,i.tObject)({size:(0,i.tOptional)(i.tNumber)});i.scheme.StreamReadResult=(0,i.tObject)({binary:i.tBinary});i.scheme.StreamCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.StreamCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WritableStreamInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WritableStreamWriteParams=(0,i.tObject)({binary:i.tBinary});i.scheme.WritableStreamWriteResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WritableStreamCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.WritableStreamCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.CDPSessionInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.CDPSessionEventEvent=(0,i.tObject)({method:i.tString,params:(0,i.tOptional)(i.tAny)});i.scheme.CDPSessionSendParams=(0,i.tObject)({method:i.tString,params:(0,i.tOptional)(i.tAny)});i.scheme.CDPSessionSendResult=(0,i.tObject)({result:i.tAny});i.scheme.CDPSessionDetachParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.CDPSessionDetachResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElectronInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElectronLaunchParams=(0,i.tObject)({executablePath:(0,i.tOptional)(i.tString),args:(0,i.tOptional)((0,i.tArray)(i.tString)),cwd:(0,i.tOptional)(i.tString),env:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),timeout:(0,i.tOptional)(i.tNumber),acceptDownloads:(0,i.tOptional)((0,i.tEnum)(["accept","deny","internal-browser-default"])),bypassCSP:(0,i.tOptional)(i.tBoolean),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)})),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),locale:(0,i.tOptional)(i.tString),offline:(0,i.tOptional)(i.tBoolean),recordHar:(0,i.tOptional)((0,i.tType)("RecordHarOptions")),recordVideo:(0,i.tOptional)((0,i.tObject)({dir:i.tString,size:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber}))})),strictSelectors:(0,i.tOptional)(i.tBoolean),timezoneId:(0,i.tOptional)(i.tString),tracesDir:(0,i.tOptional)(i.tString)});i.scheme.ElectronLaunchResult=(0,i.tObject)({electronApplication:(0,i.tChannel)(["ElectronApplication"])});i.scheme.ElectronApplicationInitializer=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.ElectronApplicationCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElectronApplicationConsoleEvent=(0,i.tObject)({type:i.tString,text:i.tString,args:(0,i.tArray)((0,i.tChannel)(["ElementHandle","JSHandle"])),location:(0,i.tObject)({url:i.tString,lineNumber:i.tNumber,columnNumber:i.tNumber})});i.scheme.ElectronApplicationBrowserWindowParams=(0,i.tObject)({page:(0,i.tChannel)(["Page"])});i.scheme.ElectronApplicationBrowserWindowResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.ElectronApplicationEvaluateExpressionParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElectronApplicationEvaluateExpressionResult=(0,i.tObject)({value:(0,i.tType)("SerializedValue")});i.scheme.ElectronApplicationEvaluateExpressionHandleParams=(0,i.tObject)({expression:i.tString,isFunction:(0,i.tOptional)(i.tBoolean),arg:(0,i.tType)("SerializedArgument")});i.scheme.ElectronApplicationEvaluateExpressionHandleResult=(0,i.tObject)({handle:(0,i.tChannel)(["ElementHandle","JSHandle"])});i.scheme.ElectronApplicationUpdateSubscriptionParams=(0,i.tObject)({event:(0,i.tEnum)(["console"]),enabled:i.tBoolean});i.scheme.ElectronApplicationUpdateSubscriptionResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElectronApplicationCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.ElectronApplicationCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDevicesParams=(0,i.tObject)({host:(0,i.tOptional)(i.tString),port:(0,i.tOptional)(i.tNumber),omitDriverInstall:(0,i.tOptional)(i.tBoolean)});i.scheme.AndroidDevicesResult=(0,i.tObject)({devices:(0,i.tArray)((0,i.tChannel)(["AndroidDevice"]))});i.scheme.AndroidSetDefaultTimeoutNoReplyParams=(0,i.tObject)({timeout:i.tNumber});i.scheme.AndroidSetDefaultTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidSocketInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidSocketDataEvent=(0,i.tObject)({data:i.tBinary});i.scheme.AndroidSocketCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidSocketWriteParams=(0,i.tObject)({data:i.tBinary});i.scheme.AndroidSocketWriteResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidSocketCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidSocketCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInitializer=(0,i.tObject)({model:i.tString,serial:i.tString});i.scheme.AndroidDeviceCloseEvent=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceWebViewAddedEvent=(0,i.tObject)({webView:(0,i.tType)("AndroidWebView")});i.scheme.AndroidDeviceWebViewRemovedEvent=(0,i.tObject)({socketName:i.tString});i.scheme.AndroidDeviceWaitParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),state:(0,i.tOptional)((0,i.tEnum)(["gone"])),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceWaitResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceFillParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),text:i.tString,timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceFillResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceTapParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),duration:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceDragParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),dest:(0,i.tType)("Point"),speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceDragResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceFlingParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),direction:(0,i.tEnum)(["up","down","left","right"]),speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceFlingResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceLongTapParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceLongTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDevicePinchCloseParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),percent:i.tNumber,speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDevicePinchCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDevicePinchOpenParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),percent:i.tNumber,speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDevicePinchOpenResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceScrollParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),direction:(0,i.tEnum)(["up","down","left","right"]),percent:i.tNumber,speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceScrollResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceSwipeParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),direction:(0,i.tEnum)(["up","down","left","right"]),percent:i.tNumber,speed:(0,i.tOptional)(i.tNumber),timeout:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDeviceSwipeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInfoParams=(0,i.tObject)({selector:(0,i.tType)("AndroidSelector")});i.scheme.AndroidDeviceInfoResult=(0,i.tObject)({info:(0,i.tType)("AndroidElementInfo")});i.scheme.AndroidDeviceScreenshotParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceScreenshotResult=(0,i.tObject)({binary:i.tBinary});i.scheme.AndroidDeviceInputTypeParams=(0,i.tObject)({text:i.tString});i.scheme.AndroidDeviceInputTypeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInputPressParams=(0,i.tObject)({key:i.tString});i.scheme.AndroidDeviceInputPressResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInputTapParams=(0,i.tObject)({point:(0,i.tType)("Point")});i.scheme.AndroidDeviceInputTapResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInputSwipeParams=(0,i.tObject)({segments:(0,i.tArray)((0,i.tType)("Point")),steps:i.tNumber});i.scheme.AndroidDeviceInputSwipeResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceInputDragParams=(0,i.tObject)({from:(0,i.tType)("Point"),to:(0,i.tType)("Point"),steps:i.tNumber});i.scheme.AndroidDeviceInputDragResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceLaunchBrowserParams=(0,i.tObject)({noDefaultViewport:(0,i.tOptional)(i.tBoolean),viewport:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),screen:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber})),ignoreHTTPSErrors:(0,i.tOptional)(i.tBoolean),javaScriptEnabled:(0,i.tOptional)(i.tBoolean),bypassCSP:(0,i.tOptional)(i.tBoolean),userAgent:(0,i.tOptional)(i.tString),locale:(0,i.tOptional)(i.tString),timezoneId:(0,i.tOptional)(i.tString),geolocation:(0,i.tOptional)((0,i.tObject)({longitude:i.tNumber,latitude:i.tNumber,accuracy:(0,i.tOptional)(i.tNumber)})),permissions:(0,i.tOptional)((0,i.tArray)(i.tString)),extraHTTPHeaders:(0,i.tOptional)((0,i.tArray)((0,i.tType)("NameValue"))),offline:(0,i.tOptional)(i.tBoolean),httpCredentials:(0,i.tOptional)((0,i.tObject)({username:i.tString,password:i.tString,origin:(0,i.tOptional)(i.tString)})),deviceScaleFactor:(0,i.tOptional)(i.tNumber),isMobile:(0,i.tOptional)(i.tBoolean),hasTouch:(0,i.tOptional)(i.tBoolean),colorScheme:(0,i.tOptional)((0,i.tEnum)(["dark","light","no-preference","no-override"])),reducedMotion:(0,i.tOptional)((0,i.tEnum)(["reduce","no-preference","no-override"])),forcedColors:(0,i.tOptional)((0,i.tEnum)(["active","none","no-override"])),acceptDownloads:(0,i.tOptional)((0,i.tEnum)(["accept","deny","internal-browser-default"])),baseURL:(0,i.tOptional)(i.tString),recordVideo:(0,i.tOptional)((0,i.tObject)({dir:i.tString,size:(0,i.tOptional)((0,i.tObject)({width:i.tNumber,height:i.tNumber}))})),recordHar:(0,i.tOptional)((0,i.tType)("RecordHarOptions")),strictSelectors:(0,i.tOptional)(i.tBoolean),serviceWorkers:(0,i.tOptional)((0,i.tEnum)(["allow","block"])),pkg:(0,i.tOptional)(i.tString),args:(0,i.tOptional)((0,i.tArray)(i.tString)),proxy:(0,i.tOptional)((0,i.tObject)({server:i.tString,bypass:(0,i.tOptional)(i.tString),username:(0,i.tOptional)(i.tString),password:(0,i.tOptional)(i.tString)}))});i.scheme.AndroidDeviceLaunchBrowserResult=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.AndroidDeviceOpenParams=(0,i.tObject)({command:i.tString});i.scheme.AndroidDeviceOpenResult=(0,i.tObject)({socket:(0,i.tChannel)(["AndroidSocket"])});i.scheme.AndroidDeviceShellParams=(0,i.tObject)({command:i.tString});i.scheme.AndroidDeviceShellResult=(0,i.tObject)({result:i.tBinary});i.scheme.AndroidDeviceInstallApkParams=(0,i.tObject)({file:i.tBinary,args:(0,i.tOptional)((0,i.tArray)(i.tString))});i.scheme.AndroidDeviceInstallApkResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDevicePushParams=(0,i.tObject)({file:i.tBinary,path:i.tString,mode:(0,i.tOptional)(i.tNumber)});i.scheme.AndroidDevicePushResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceSetDefaultTimeoutNoReplyParams=(0,i.tObject)({timeout:i.tNumber});i.scheme.AndroidDeviceSetDefaultTimeoutNoReplyResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceConnectToWebViewParams=(0,i.tObject)({socketName:i.tString});i.scheme.AndroidDeviceConnectToWebViewResult=(0,i.tObject)({context:(0,i.tChannel)(["BrowserContext"])});i.scheme.AndroidDeviceCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidDeviceCloseResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.AndroidWebView=(0,i.tObject)({pid:i.tNumber,pkg:i.tString,socketName:i.tString});i.scheme.AndroidSelector=(0,i.tObject)({checkable:(0,i.tOptional)(i.tBoolean),checked:(0,i.tOptional)(i.tBoolean),clazz:(0,i.tOptional)(i.tString),clickable:(0,i.tOptional)(i.tBoolean),depth:(0,i.tOptional)(i.tNumber),desc:(0,i.tOptional)(i.tString),enabled:(0,i.tOptional)(i.tBoolean),focusable:(0,i.tOptional)(i.tBoolean),focused:(0,i.tOptional)(i.tBoolean),hasChild:(0,i.tOptional)((0,i.tObject)({selector:(0,i.tType)("AndroidSelector")})),hasDescendant:(0,i.tOptional)((0,i.tObject)({selector:(0,i.tType)("AndroidSelector"),maxDepth:(0,i.tOptional)(i.tNumber)})),longClickable:(0,i.tOptional)(i.tBoolean),pkg:(0,i.tOptional)(i.tString),res:(0,i.tOptional)(i.tString),scrollable:(0,i.tOptional)(i.tBoolean),selected:(0,i.tOptional)(i.tBoolean),text:(0,i.tOptional)(i.tString)});i.scheme.AndroidElementInfo=(0,i.tObject)({children:(0,i.tOptional)((0,i.tArray)((0,i.tType)("AndroidElementInfo"))),clazz:i.tString,desc:i.tString,res:i.tString,pkg:i.tString,text:i.tString,bounds:(0,i.tType)("Rect"),checkable:i.tBoolean,checked:i.tBoolean,clickable:i.tBoolean,enabled:i.tBoolean,focusable:i.tBoolean,focused:i.tBoolean,longClickable:i.tBoolean,scrollable:i.tBoolean,selected:i.tBoolean});i.scheme.JsonPipeInitializer=(0,i.tOptional)((0,i.tObject)({}));i.scheme.JsonPipeMessageEvent=(0,i.tObject)({message:i.tAny});i.scheme.JsonPipeClosedEvent=(0,i.tObject)({reason:(0,i.tOptional)(i.tString)});i.scheme.JsonPipeSendParams=(0,i.tObject)({message:i.tAny});i.scheme.JsonPipeSendResult=(0,i.tOptional)((0,i.tObject)({}));i.scheme.JsonPipeCloseParams=(0,i.tOptional)((0,i.tObject)({}));i.scheme.JsonPipeCloseResult=(0,i.tOptional)((0,i.tObject)({}))});var Io=M(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.parseSerializedValue=jN;Cc.serializeValue=qN;function jN(r,e){return im(r,e,new Map)}function im(r,e,t){if(r.ref!==void 0)return t.get(r.ref);if(r.n!==void 0)return r.n;if(r.s!==void 0)return r.s;if(r.b!==void 0)return r.b;if(r.v!==void 0){if(r.v==="undefined")return;if(r.v==="null")return null;if(r.v==="NaN")return NaN;if(r.v==="Infinity")return 1/0;if(r.v==="-Infinity")return-1/0;if(r.v==="-0")return-0}if(r.d!==void 0)return new Date(r.d);if(r.u!==void 0)return new URL(r.u);if(r.bi!==void 0)return BigInt(r.bi);if(r.r!==void 0)return new RegExp(r.r.p,r.r.f);if(r.a!==void 0){let n=[];t.set(r.id,n);for(let s of r.a)n.push(im(s,e,t));return n}if(r.o!==void 0){let n={};t.set(r.id,n);for(let{k:s,v:o}of r.o)n[s]=im(o,e,t);return n}if(r.h!==void 0){if(e===void 0)throw new Error("Unexpected handle");return e[r.h]}throw new Error("Unexpected value")}function qN(r,e){return sm(r,e,{lastId:0,visited:new Map})}function sm(r,e,t){let n=e(r);if("fallThrough"in n)r=n.fallThrough;else return n;if(typeof r=="symbol")return{v:"undefined"};if(Object.is(r,void 0))return{v:"undefined"};if(Object.is(r,null))return{v:"null"};if(Object.is(r,NaN))return{v:"NaN"};if(Object.is(r,1/0))return{v:"Infinity"};if(Object.is(r,-1/0))return{v:"-Infinity"};if(Object.is(r,-0))return{v:"-0"};if(typeof r=="boolean")return{b:r};if(typeof r=="number")return{n:r};if(typeof r=="string")return{s:r};if(typeof r=="bigint")return{bi:r.toString()};if(xS(r)){let o=r;return"captureStackTrace"in globalThis.Error?{s:o.stack||""}:{s:`${o.name}: ${o.message}
${o.stack}`}}if($N(r))return{d:r.toJSON()};if(WN(r))return{u:r.toJSON()};if(HN(r))return{r:{p:r.source,f:r.flags}};let s=t.visited.get(r);if(s)return{ref:s};if(Array.isArray(r)){let o=[],a=++t.lastId;t.visited.set(r,a);for(let l=0;l<r.length;++l)o.push(sm(r[l],e,t));return{a:o,id:a}}if(typeof r=="object"){let o=[],a=++t.lastId;t.visited.set(r,a);for(let l of Object.keys(r))o.push({k:l,v:sm(r[l],e,t)});return{o,id:a}}throw new Error("Unexpected value")}function HN(r){return r instanceof RegExp||Object.prototype.toString.call(r)==="[object RegExp]"}function $N(r){return r instanceof Date||Object.prototype.toString.call(r)==="[object Date]"}function WN(r){return r instanceof URL||Object.prototype.toString.call(r)==="[object URL]"}function xS(r){let e=r?Object.getPrototypeOf(r):null;return r instanceof Error||e?.name==="Error"||e&&xS(e)}});var Bt=M(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.TimeoutError=Wn.TargetClosedError=void 0;Wn.isTargetClosedError=zN;Wn.parseError=GN;Wn.serializeError=VN;var UN=ie(),SS=Io(),Tc=class extends Error{constructor(e){super(e),this.name=this.constructor.name}},om=class extends Tc{};Wn.TimeoutError=om;var Oc=class extends Tc{constructor(e,t){super((e||"Target page, context or browser has been closed")+(t||""))}};Wn.TargetClosedError=Oc;function zN(r){return r instanceof Oc||r.name==="TargetClosedError"}function VN(r){return(0,UN.isError)(r)?{error:{message:r.message,stack:r.stack,name:r.name}}:{value:(0,SS.serializeValue)(r,e=>({fallThrough:e}))}}function GN(r){if(!r.error){if(r.value===void 0)throw new Error("Serialized error must have either an error or a value");return(0,SS.parseSerializedValue)(r.value,void 0)}let e=new Error(r.error.message);return e.stack=r.error.stack||"",e.name=r.error.name,e}});var De=M(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.SdkObject=void 0;hr.createInstrumentation=YN;hr.kTestSdkObjects=void 0;hr.serverSideCallMetadata=QN;var KN=require("events"),JN=ie(),XN=hr.kTestSdkObjects=new WeakSet,am=class extends KN.EventEmitter{constructor(e,t,n){super(),this.guid=void 0,this.attribution=void 0,this.instrumentation=void 0,this.guid=n||`${t||""}@${(0,JN.createGuid)()}`,this.setMaxListeners(0),this.attribution={...e.attribution},this.instrumentation=e.instrumentation,process.env._PW_INTERNAL_COUNT_SDK_OBJECTS&&XN.add(this)}};hr.SdkObject=am;function YN(){let r=new Map;return new Proxy({},{get:(e,t)=>typeof t!="string"?e[t]:t==="addListener"?(n,s)=>r.set(n,s):t==="removeListener"?n=>r.delete(n):t.startsWith("on")?async(n,...s)=>{for(let[l,c]of r){var o,a;(!c||n.attribution.context===c)&&await((o=(a=l)[t])===null||o===void 0?void 0:o.call(a,n,...s))}}:e[t]})}function QN(){return{id:"",startTime:0,endTime:0,wallTime:Date.now(),type:"Internal",method:"",params:{},log:[],isServerSide:!0}}});var Wt=M(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.ProtocolError=void 0;Qi.isProtocolError=eL;Qi.isSessionClosedError=tL;var ZN=Lt(),Ro=class extends Error{constructor(e,t,n){super(),this.type=void 0,this.method=void 0,this.logs=void 0,this.type=e,this.method=t,this.logs=n}setMessage(e){(0,ZN.rewriteErrorMessage)(this,`Protocol error (${this.method}): ${e}`)}browserLogMessage(){return this.logs?`
Browser logs:
`+this.logs:""}};Qi.ProtocolError=Ro;function eL(r){return r instanceof Ro}function tL(r){return r instanceof Ro&&(r.type==="closed"||r.type==="crashed")}});var He=M(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.dispatcherSymbol=Zt.RootDispatcher=Zt.DispatcherConnection=Zt.Dispatcher=void 0;Zt.existingDispatcher=oL;Zt.setMaxDispatchersForTest=aL;var nL=require("events"),En=Ao(),Qt=ie(),pr=Bt(),rL=De(),ES=Ze(),iL=Wt(),lm=Zt.dispatcherSymbol=Symbol("dispatcher"),sL=(0,En.createMetadataValidator)();function oL(r){return r[lm]}var CS;function aL(r){CS=r}function lL(r){var e,t;return(e=(t=CS)!==null&&t!==void 0?t:{JSHandle:1e5,ElementHandle:1e5}[r])!==null&&e!==void 0?e:1e4}var Mo=class extends nL.EventEmitter{constructor(e,t,n,s,o){super(),this._connection=void 0,this._parent=void 0,this._dispatchers=new Map,this._disposed=!1,this._eventListeners=[],this._guid=void 0,this._type=void 0,this._gcBucket=void 0,this._object=void 0,this._openScope=new Qt.LongStandingScope,this._connection=e instanceof Fo?e:e._connection,this._parent=e instanceof Fo?void 0:e;let a=t.guid;this._guid=a,this._type=n,this._object=t,this._gcBucket=o??n,t[lm]=this,this._connection.registerDispatcher(this),this._parent&&((0,Qt.assert)(!this._parent._dispatchers.has(a)),this._parent._dispatchers.set(a,this)),this._parent&&this._connection.sendCreate(this._parent,n,a,s),this._connection.maybeDisposeStaleDispatchers(this._gcBucket)}parentScope(){return this._parent}addObjectListener(e,t){this._eventListeners.push(ES.eventsHelper.addEventListener(this._object,e,t))}adopt(e){if(e._parent===this)return;e._parent._dispatchers.delete(e._guid),this._dispatchers.set(e._guid,e),e._parent=this,this._connection.sendAdopt(this,e)}async _handleCommand(e,t,n){let s=this[t](n,e);try{return await this._openScope.race(s)}catch(o){if(e.potentiallyClosesScope&&(0,pr.isTargetClosedError)(o))return await s;throw o}}_dispatchEvent(e,t){if(this._disposed){if((0,Qt.isUnderTest)())throw new Error(`${this._guid} is sending "${String(e)}" event after being disposed`);return}this._connection.sendEvent(this,e,t)}_dispose(e){this._disposeRecursively(new pr.TargetClosedError),this._connection.sendDispose(this,e)}_onDispose(){}_disposeRecursively(e){var t;(0,Qt.assert)(!this._disposed,`${this._guid} is disposed more than once`),this._onDispose(),this._disposed=!0,ES.eventsHelper.removeEventListeners(this._eventListeners),(t=this._parent)===null||t===void 0||t._dispatchers.delete(this._guid);let n=this._connection._dispatchersByBucket.get(this._gcBucket);n?.delete(this._guid),this._connection._dispatchers.delete(this._guid);for(let s of[...this._dispatchers.values()])s._disposeRecursively(e);this._dispatchers.clear(),delete this._object[lm],this._openScope.close(e)}_debugScopeState(){return{_guid:this._guid,objects:Array.from(this._dispatchers.values()).map(e=>e._debugScopeState())}}async waitForEventInfo(){}};Zt.Dispatcher=Mo;var cm=class extends Mo{constructor(e,t){super(e,{guid:""},"Root",{}),this._initialized=!1,this.createPlaywright=t}async initialize(e){return(0,Qt.assert)(this.createPlaywright),(0,Qt.assert)(!this._initialized),this._initialized=!0,{playwright:await this.createPlaywright(this,e)}}};Zt.RootDispatcher=cm;var Fo=class{constructor(e){this._dispatchers=new Map,this._dispatchersByBucket=new Map,this.onmessage=t=>{},this._waitOperations=new Map,this._isLocal=void 0,this._isLocal=!!e}sendEvent(e,t,n){n=(0,En.findValidator)(e._type,t,"Event")(n,"",{tChannelImpl:this._tChannelImplToWire.bind(this),binary:this._isLocal?"buffer":"toBase64"}),this.onmessage({guid:e._guid,method:t,params:n})}sendCreate(e,t,n,s){s=(0,En.findValidator)(t,"","Initializer")(s,"",{tChannelImpl:this._tChannelImplToWire.bind(this),binary:this._isLocal?"buffer":"toBase64"}),this.onmessage({guid:e._guid,method:"__create__",params:{type:t,initializer:s,guid:n}})}sendAdopt(e,t){this.onmessage({guid:e._guid,method:"__adopt__",params:{guid:t._guid}})}sendDispose(e,t){this.onmessage({guid:e._guid,method:"__dispose__",params:{reason:t}})}_tChannelImplFromWire(e,t,n,s){if(t&&typeof t=="object"&&typeof t.guid=="string"){let o=t.guid,a=this._dispatchers.get(o);if(!a)throw new En.ValidationError(`${n}: no object with guid ${o}`);if(e!=="*"&&!e.includes(a._type))throw new En.ValidationError(`${n}: object with guid ${o} has type ${a._type}, expected ${e.toString()}`);return a}throw new En.ValidationError(`${n}: expected guid for ${e.toString()}`)}_tChannelImplToWire(e,t,n,s){if(t instanceof Mo){if(e!=="*"&&!e.includes(t._type))throw new En.ValidationError(`${n}: dispatcher with guid ${t._guid} has type ${t._type}, expected ${e.toString()}`);return{guid:t._guid}}throw new En.ValidationError(`${n}: expected dispatcher ${e.toString()}`)}registerDispatcher(e){(0,Qt.assert)(!this._dispatchers.has(e._guid)),this._dispatchers.set(e._guid,e);let t=this._dispatchersByBucket.get(e._gcBucket);t||(t=new Set,this._dispatchersByBucket.set(e._gcBucket,t)),t.add(e._guid)}maybeDisposeStaleDispatchers(e){let t=lL(e),n=this._dispatchersByBucket.get(e);if(!n||n.size<=t)return;let s=[...n],o=t/10|0;this._dispatchersByBucket.set(e,new Set(s.slice(o)));for(let a=0;a<o;++a){let l=this._dispatchers.get(s[a]);l&&l._dispose("gc")}}async dispatch(e){var t,n,s;let{id:o,guid:a,method:l,params:c,metadata:u}=e,d=this._dispatchers.get(a);if(!d){this.onmessage({id:o,error:(0,pr.serializeError)(new pr.TargetClosedError)});return}let h,p;try{if(h=(0,En.findValidator)(d._type,l,"Params")(c,"",{tChannelImpl:this._tChannelImplFromWire.bind(this),binary:this._isLocal?"buffer":"fromBase64"}),p=sL(u,"",{tChannelImpl:this._tChannelImplFromWire.bind(this),binary:this._isLocal?"buffer":"fromBase64"}),typeof d[l]!="function")throw new Error(`Mismatching dispatcher: "${d._type}" does not implement "${l}"`)}catch(w){this.onmessage({id:o,error:(0,pr.serializeError)(w)});return}let f=d._object instanceof rL.SdkObject?d._object:void 0,_={id:`call@${o}`,wallTime:p.wallTime||Date.now(),location:p.location,apiName:p.apiName,internal:p.internal,objectId:f?.guid,pageId:f==null||(t=f.attribution)===null||t===void 0||(t=t.page)===null||t===void 0?void 0:t.guid,frameId:f==null||(n=f.attribution)===null||n===void 0||(n=n.frame)===null||n===void 0?void 0:n.guid,startTime:(0,Qt.monotonicTime)(),endTime:0,type:d._type,method:l,params:c||{},log:[]};if(f&&c!==null&&c!==void 0&&(s=c.info)!==null&&s!==void 0&&s.waitId){let w=c.info;switch(w.phase){case"before":{this._waitOperations.set(w.waitId,_),await f.instrumentation.onBeforeCall(f,_),this.onmessage({id:o});return}case"log":{let m=this._waitOperations.get(w.waitId);m.log.push(w.message),f.instrumentation.onCallLog(f,m,"api",w.message),this.onmessage({id:o});return}case"after":{let m=this._waitOperations.get(w.waitId);m.endTime=(0,Qt.monotonicTime)(),m.error=w.error?{error:{name:"Error",message:w.error}}:void 0,this._waitOperations.delete(w.waitId),await f.instrumentation.onAfterCall(f,m),this.onmessage({id:o});return}}}await f?.instrumentation.onBeforeCall(f,_);let v={id:o};try{let w=await d._handleCommand(_,l,h),m=(0,En.findValidator)(d._type,l,"Result");v.result=m(w,"",{tChannelImpl:this._tChannelImplToWire.bind(this),binary:this._isLocal?"buffer":"toBase64"}),_.result=w}catch(w){if((0,pr.isTargetClosedError)(w)&&f){let m=kS(f);m&&(0,Qt.rewriteErrorMessage)(w,m)}else if((0,iL.isProtocolError)(w))if(w.type==="closed"){let m=f?kS(f):void 0;w=new pr.TargetClosedError(m,w.browserLogMessage())}else w.type==="crashed"&&(0,Qt.rewriteErrorMessage)(w,"Target crashed "+w.browserLogMessage());v.error=(0,pr.serializeError)(w),_.error=v.error}finally{_.endTime=(0,Qt.monotonicTime)(),await f?.instrumentation.onAfterCall(f,_)}v.error&&(v.log=_.log),this.onmessage(v)}};Zt.DispatcherConnection=Fo;function kS(r){var e,t,n;return((e=r.attribution.page)===null||e===void 0?void 0:e._closeReason)||((t=r.attribution.context)===null||t===void 0?void 0:t._closeReason)||((n=r.attribution.browser)===null||n===void 0?void 0:n._closeReason)}});var en=M(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.TimeoutSettings=fr.DEFAULT_TIMEOUT=fr.DEFAULT_LAUNCH_TIMEOUT=void 0;var Pc=ie(),um=fr.DEFAULT_TIMEOUT=3e4,cL=fr.DEFAULT_LAUNCH_TIMEOUT=3*60*1e3,dm=class{constructor(e){this._parent=void 0,this._defaultTimeout=void 0,this._defaultNavigationTimeout=void 0,this._parent=e}setDefaultTimeout(e){this._defaultTimeout=e}setDefaultNavigationTimeout(e){this._defaultNavigationTimeout=e}defaultNavigationTimeout(){return this._defaultNavigationTimeout}defaultTimeout(){return this._defaultTimeout}navigationTimeout(e){return typeof e.timeout=="number"?e.timeout:this._defaultNavigationTimeout!==void 0?this._defaultNavigationTimeout:(0,Pc.debugMode)()?0:this._defaultTimeout!==void 0?this._defaultTimeout:this._parent?this._parent.navigationTimeout(e):um}timeout(e){return typeof e.timeout=="number"?e.timeout:(0,Pc.debugMode)()?0:this._defaultTimeout!==void 0?this._defaultTimeout:this._parent?this._parent.timeout(e):um}static timeout(e){return typeof e.timeout=="number"?e.timeout:(0,Pc.debugMode)()?0:um}static launchTimeout(e){return typeof e.timeout=="number"?e.timeout:(0,Pc.debugMode)()?0:cL}};fr.TimeoutSettings=dm});var yt=M(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.helper=void 0;var TS=Le(),Ac=Ze(),hm=process.env.MAX_LOG_LENGTH?+process.env.MAX_LOG_LENGTH:1/0,pm=class{static completeUserURL(e){return(e.startsWith("localhost")||e.startsWith("127.0.0.1"))&&(e="http://"+e),e}static enclosingIntRect(e){let t=Math.floor(e.x+.001),n=Math.floor(e.y+.001),s=Math.ceil(e.x+e.width-.001),o=Math.ceil(e.y+e.height-.001);return{x:t,y:n,width:s-t,height:o-n}}static enclosingIntSize(e){return{width:Math.floor(e.width+.001),height:Math.floor(e.height+.001)}}static getViewportSizeFromWindowFeatures(e){let t=e.find(a=>a.startsWith("width=")),n=e.find(a=>a.startsWith("height=")),s=t?parseInt(t.substring(6),10):NaN,o=n?parseInt(n.substring(7),10):NaN;return!Number.isNaN(s)&&!Number.isNaN(o)?{width:s,height:o}:null}static waitForEvent(e,t,n,s){let o=[],a=new Promise((c,u)=>{o.push(Ac.eventsHelper.addEventListener(t,n,d=>{try{if(s&&!s(d))return;Ac.eventsHelper.removeEventListeners(o),c(d)}catch(h){Ac.eventsHelper.removeEventListeners(o),u(h)}}))}),l=()=>Ac.eventsHelper.removeEventListeners(o);return e&&e.cleanupWhenAborted(l),{promise:a,dispose:l}}static secondsToRoundishMillis(e){return(e*1e6|0)/1e3}static millisToRoundishMillis(e){return(e*1e3|0)/1e3}static debugProtocolLogger(e){return(t,n)=>{if(e&&e(t,n),TS.debugLogger.isEnabled("protocol")){let s=JSON.stringify(n);s.length>hm&&(s=s.substring(0,hm/2)+" <<<<<( LOG TRUNCATED )>>>>> "+s.substring(s.length-hm/2)),TS.debugLogger.log("protocol",(t==="send"?"SEND \u25BA ":"\u25C0 RECV ")+s)}}}static formatBrowserLogs(e,t){return!t&&!e.length?"":`
`+(t?t+`
`:"")+e.join(`
`)}},$8=Ic.helper=pm});var Ct=M(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.WebSocket=tt.STATUS_TEXTS=tt.Route=tt.Response=tt.Request=void 0;tt.filterCookies=dL;tt.kMaxCookieExpiresDateInSeconds=void 0;tt.mergeHeaders=gL;tt.parsedURL=fL;tt.rewriteCookies=pL;tt.singleHeader=mL;tt.stripFragmentFromUrl=OS;var dn=ie(),Un=Qe(),Mc=De(),uL=No(),fm=$e();function dL(r,e){let t=e.map(n=>new URL(n));return r.filter(n=>{if(!t.length)return!0;for(let s of t){let o=n.domain;if(o.startsWith(".")||(o="."+o),!!("."+s.hostname).endsWith(o)&&s.pathname.startsWith(n.path)&&!(s.protocol!=="https:"&&s.hostname!=="localhost"&&n.secure))return!0}return!1})}var hL=tt.kMaxCookieExpiresDateInSeconds=253402300799;function pL(r){return r.map(e=>{(0,dn.assert)(e.url||e.domain&&e.path,"Cookie should have a url or a domain/path pair"),(0,dn.assert)(!(e.url&&e.domain),"Cookie should have either url or domain"),(0,dn.assert)(!(e.url&&e.path),"Cookie should have either url or path"),(0,dn.assert)(!(e.expires&&e.expires<0&&e.expires!==-1),"Cookie should have a valid expires, only -1 or a positive number for the unix timestamp in seconds is allowed"),(0,dn.assert)(!(e.expires&&e.expires>0&&e.expires>hL),"Cookie should have a valid expires, only -1 or a positive number for the unix timestamp in seconds is allowed");let t={...e};if(t.url){(0,dn.assert)(t.url!=="about:blank",`Blank page can not have cookie "${e.name}"`),(0,dn.assert)(!t.url.startsWith("data:"),`Data URL page can not have cookie "${e.name}"`);let n=new URL(t.url);t.domain=n.hostname,t.path=n.pathname.substring(0,n.pathname.lastIndexOf("/")+1),t.secure=n.protocol==="https:"}return t})}function fL(r){try{return new URL(r)}catch{return null}}function OS(r){return r.includes("#")?r.substring(0,r.indexOf("#")):r}var mm=class extends Mc.SdkObject{constructor(e,t,n,s,o,a,l,c,u,d){super(t||e,"request"),this._response=null,this._redirectedFrom=void 0,this._redirectedTo=null,this._documentId=void 0,this._isFavicon=void 0,this._failureText=null,this._url=void 0,this._resourceType=void 0,this._method=void 0,this._postData=void 0,this._headers=void 0,this._headersMap=new Map,this._frame=null,this._serviceWorker=null,this._context=void 0,this._rawRequestHeadersPromise=new Un.ManualPromise,this._waitForResponsePromise=new Un.ManualPromise,this._responseEndTiming=-1,this._overrides=void 0,(0,dn.assert)(!a.startsWith("data:"),"Data urls should not fire requests"),this._context=e,this._frame=t,this._serviceWorker=n,this._redirectedFrom=s,s&&(s._redirectedTo=this),this._documentId=o,this._url=OS(a),this._resourceType=l,this._method=c,this._postData=u,this._headers=d,this._updateHeadersMap(),this._isFavicon=a.endsWith("/favicon.ico")||!!(s!=null&&s._isFavicon)}_setFailureText(e){this._failureText=e,this._waitForResponsePromise.resolve(null)}_setOverrides(e){this._overrides=e,this._updateHeadersMap()}_updateHeadersMap(){for(let{name:e,value:t}of this.headers())this._headersMap.set(e.toLowerCase(),t)}_hasOverrides(){return!!this._overrides}url(){var e;return((e=this._overrides)===null||e===void 0?void 0:e.url)||this._url}resourceType(){return this._resourceType}method(){var e;return((e=this._overrides)===null||e===void 0?void 0:e.method)||this._method}postDataBuffer(){var e;return((e=this._overrides)===null||e===void 0?void 0:e.postData)||this._postData}headers(){var e;return((e=this._overrides)===null||e===void 0?void 0:e.headers)||this._headers}headerValue(e){return this._headersMap.get(e)}setRawRequestHeaders(e){this._rawRequestHeadersPromise.isDone()||this._rawRequestHeadersPromise.resolve(e||this._headers)}async rawRequestHeaders(){var e;return((e=this._overrides)===null||e===void 0?void 0:e.headers)||this._rawRequestHeadersPromise}response(){return this._waitForResponsePromise}_existingResponse(){return this._response}_setResponse(e){this._response=e,this._waitForResponsePromise.resolve(e)}_finalRequest(){return this._redirectedTo?this._redirectedTo._finalRequest():this}frame(){return this._frame}serviceWorker(){return this._serviceWorker}isNavigationRequest(){return!!this._documentId}redirectedFrom(){return this._redirectedFrom}failure(){return this._failureText===null?null:{errorText:this._failureText}}bodySize(){var e;return((e=this.postDataBuffer())===null||e===void 0?void 0:e.length)||0}async requestHeadersSize(){let e=4;e+=this.method().length,e+=new URL(this.url()).pathname.length,e+=8;let t=await this.rawRequestHeaders();for(let n of t)e+=n.name.length+n.value.length+4;return e}};tt.Request=mm;var gm=class extends Mc.SdkObject{constructor(e,t){super(e._frame||e._context,"route"),this._request=void 0,this._delegate=void 0,this._handled=!1,this._request=e,this._delegate=t,this._request._context.addRouteInFlight(this)}request(){return this._request}async abort(e="failed"){this._startHandling(),this._request._context.emit(fm.BrowserContext.Events.RequestAborted,this._request),await this._delegate.abort(e),this._endHandling()}async redirectNavigationRequest(e){this._startHandling(),(0,dn.assert)(this._request.isNavigationRequest()),this._request.frame().redirectNavigation(e,this._request._documentId,this._request.headerValue("referer"))}async fulfill(e){this._startHandling();let t=e.body,n=e.isBase64||!1;if(t===void 0)if(e.fetchResponseUid){let o=this._request._context.fetchRequest.fetchResponses.get(e.fetchResponseUid)||uL.APIRequestContext.findResponseBody(e.fetchResponseUid);(0,dn.assert)(o,"Fetch response has been disposed"),t=o.toString("base64"),n=!0}else t="",n=!1;let s=[...e.headers||[]];this._maybeAddCorsHeaders(s),this._request._context.emit(fm.BrowserContext.Events.RequestFulfilled,this._request),await this._delegate.fulfill({status:e.status||200,headers:s,body:t,isBase64:n}),this._endHandling()}_maybeAddCorsHeaders(e){let t=this._request.headerValue("origin");if(!t)return;let n=new URL(this._request.url());!n.protocol.startsWith("http")||n.origin===t.trim()||e.find(({name:o})=>o==="access-control-allow-origin")||(e.push({name:"access-control-allow-origin",value:t}),e.push({name:"access-control-allow-credentials",value:"true"}),e.push({name:"vary",value:"Origin"}))}async continue(e){if(this._startHandling(),e.url){let t=new URL(e.url);if(new URL(this._request.url()).protocol!==t.protocol)throw new Error("New URL must have same protocol as overridden URL")}this._request._setOverrides(e),e.isFallback||this._request._context.emit(fm.BrowserContext.Events.RequestContinued,this._request),await this._delegate.continue(this._request,e),this._endHandling()}_startHandling(){(0,dn.assert)(!this._handled,"Route is already handled!"),this._handled=!0}_endHandling(){this._request._context.removeRouteInFlight(this)}};tt.Route=gm;var _m=class extends Mc.SdkObject{constructor(e,t,n,s,o,a,l,c){super(e.frame()||e._context,"response"),this._request=void 0,this._contentPromise=null,this._finishedPromise=new Un.ManualPromise,this._status=void 0,this._statusText=void 0,this._url=void 0,this._headers=void 0,this._headersMap=new Map,this._getResponseBodyCallback=void 0,this._timing=void 0,this._serverAddrPromise=new Un.ManualPromise,this._securityDetailsPromise=new Un.ManualPromise,this._rawResponseHeadersPromise=new Un.ManualPromise,this._httpVersion=void 0,this._fromServiceWorker=void 0,this._encodedBodySizePromise=new Un.ManualPromise,this._transferSizePromise=new Un.ManualPromise,this._responseHeadersSizePromise=new Un.ManualPromise,this._request=e,this._timing=o,this._status=t,this._statusText=n,this._url=e.url(),this._headers=s;for(let{name:u,value:d}of this._headers)this._headersMap.set(u.toLowerCase(),d);this._getResponseBodyCallback=a,this._request._setResponse(this),this._httpVersion=c,this._fromServiceWorker=l}_serverAddrFinished(e){this._serverAddrPromise.resolve(e)}_securityDetailsFinished(e){this._securityDetailsPromise.resolve(e)}_requestFinished(e){this._request._responseEndTiming=Math.max(e,this._timing.responseStart),this._timing.requestStart===-1&&(this._timing.requestStart=this._request._responseEndTiming),this._finishedPromise.resolve()}_setHttpVersion(e){this._httpVersion=e}url(){return this._url}status(){return this._status}statusText(){return this._statusText}headers(){return this._headers}headerValue(e){return this._headersMap.get(e)}async rawResponseHeaders(){return this._rawResponseHeadersPromise}setRawResponseHeaders(e){this._rawResponseHeadersPromise.isDone()||this._rawResponseHeadersPromise.resolve(e||this._headers)}setTransferSize(e){this._transferSizePromise.resolve(e)}setEncodedBodySize(e){this._encodedBodySizePromise.resolve(e)}setResponseHeadersSize(e){this._responseHeadersSizePromise.resolve(e)}timing(){return this._timing}async serverAddr(){return await this._serverAddrPromise||null}async securityDetails(){return await this._securityDetailsPromise||null}body(){return this._contentPromise||(this._contentPromise=this._finishedPromise.then(async()=>{if(this._status>=300&&this._status<=399)throw new Error("Response body is unavailable for redirect responses");return this._getResponseBodyCallback()})),this._contentPromise}request(){return this._request}frame(){return this._request.frame()}httpVersion(){return!this._httpVersion||this._httpVersion==="http/1.1"?"HTTP/1.1":this._httpVersion==="h2"?"HTTP/2.0":this._httpVersion}fromServiceWorker(){return this._fromServiceWorker}async responseHeadersSize(){let e=await this._responseHeadersSizePromise;if(e!==null)return e;let t=4;t+=8,t+=3,t+=this.statusText().length;let n=await this._rawResponseHeadersPromise;for(let s of n)t+=s.name.length+s.value.length+4;return t+=2,t}async sizes(){let e=await this._request.requestHeadersSize(),t=await this.responseHeadersSize(),n=await this._encodedBodySizePromise;if(n===null){var s;let l=(s=(await this._rawResponseHeadersPromise).find(c=>c.name.toLowerCase()==="content-length"))===null||s===void 0?void 0:s.value;n=l?+l:0}let o=await this._transferSizePromise;return o===null&&(o=t+n),{requestBodySize:this._request.bodySize(),requestHeadersSize:e,responseBodySize:n,responseHeadersSize:t,transferSize:o}}};tt.Response=_m;var Rc=class r extends Mc.SdkObject{constructor(e,t){super(e,"ws"),this._url=void 0,this._notified=!1,this._url=t}markAsNotified(){return this._notified?!1:(this._notified=!0,!0)}url(){return this._url}frameSent(e,t){this.emit(r.Events.FrameSent,{opcode:e,data:t})}frameReceived(e,t){this.emit(r.Events.FrameReceived,{opcode:e,data:t})}error(e){this.emit(r.Events.SocketError,e)}closed(){this.emit(r.Events.Close)}};tt.WebSocket=Rc;Rc.Events={Close:"close",SocketError:"socketerror",FrameReceived:"framereceived",FrameSent:"framesent"};var U8=tt.STATUS_TEXTS={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Switch Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};function mL(r,e){return[{name:r,value:e}]}function gL(r){let e=new Map,t=new Map;for(let s of r)if(s)for(let{name:o,value:a}of s){let l=o.toLowerCase();t.set(l,o),e.set(l,a)}let n=[];for(let[s,o]of e)n.push({name:t.get(s),value:o});return n}});var PS=M(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.source=void 0;var V8=Fc.source=`
var __commonJS = obj => {
  let required = false;
  let result;
  return function __require() {
    if (!required) {
      required = true;
      let fn;
      for (const name in obj) { fn = obj[name]; break; }
      const module = { exports: {} };
      fn(module.exports, module);
      result = module.exports;
    }
    return result;
  }
};
var __export = (target, all) => {for (var name in all) target[name] = all[name];};
var __toESM = mod => ({ ...mod, 'default': mod });
var __toCommonJS = mod => ({ ...mod, __esModule: true });


// packages/playwright-core/src/server/injected/injectedScript.ts
var injectedScript_exports = {};
__export(injectedScript_exports, {
  InjectedScript: () => InjectedScript
});
module.exports = __toCommonJS(injectedScript_exports);

// packages/playwright-core/src/server/injected/xpathSelectorEngine.ts
var XPathEngine = {
  queryAll(root, selector) {
    if (selector.startsWith("/") && root.nodeType !== Node.DOCUMENT_NODE)
      selector = "." + selector;
    const result = [];
    const document = root.ownerDocument || root;
    if (!document)
      return result;
    const it = document.evaluate(selector, root, null, XPathResult.ORDERED_NODE_ITERATOR_TYPE);
    for (let node = it.iterateNext(); node; node = it.iterateNext()) {
      if (node.nodeType === Node.ELEMENT_NODE)
        result.push(node);
    }
    return result;
  }
};

// packages/playwright-core/src/server/injected/domUtils.ts
var browserNameForWorkarounds = "";
function setBrowserName(name) {
  browserNameForWorkarounds = name;
}
function isInsideScope(scope, element) {
  while (element) {
    if (scope.contains(element))
      return true;
    element = enclosingShadowHost(element);
  }
  return false;
}
function parentElementOrShadowHost(element) {
  if (element.parentElement)
    return element.parentElement;
  if (!element.parentNode)
    return;
  if (element.parentNode.nodeType === 11 && element.parentNode.host)
    return element.parentNode.host;
}
function enclosingShadowRootOrDocument(element) {
  let node = element;
  while (node.parentNode)
    node = node.parentNode;
  if (node.nodeType === 11 || node.nodeType === 9)
    return node;
}
function enclosingShadowHost(element) {
  while (element.parentElement)
    element = element.parentElement;
  return parentElementOrShadowHost(element);
}
function closestCrossShadow(element, css, scope) {
  while (element) {
    const closest = element.closest(css);
    if (scope && closest !== scope && (closest == null ? void 0 : closest.contains(scope)))
      return;
    if (closest)
      return closest;
    element = enclosingShadowHost(element);
  }
}
function getElementComputedStyle(element, pseudo) {
  return element.ownerDocument && element.ownerDocument.defaultView ? element.ownerDocument.defaultView.getComputedStyle(element, pseudo) : void 0;
}
function isElementStyleVisibilityVisible(element, style) {
  style = style != null ? style : getElementComputedStyle(element);
  if (!style)
    return true;
  if (Element.prototype.checkVisibility && browserNameForWorkarounds !== "webkit") {
    if (!element.checkVisibility({ checkOpacity: false, checkVisibilityCSS: false }))
      return false;
  } else {
    const detailsOrSummary = element.closest("details,summary");
    if (detailsOrSummary !== element && (detailsOrSummary == null ? void 0 : detailsOrSummary.nodeName) === "DETAILS" && !detailsOrSummary.open)
      return false;
  }
  if (style.visibility !== "visible")
    return false;
  return true;
}
function isElementVisible(element) {
  const style = getElementComputedStyle(element);
  if (!style)
    return true;
  if (style.display === "contents") {
    for (let child = element.firstChild; child; child = child.nextSibling) {
      if (child.nodeType === 1 && isElementVisible(child))
        return true;
      if (child.nodeType === 3 && isVisibleTextNode(child))
        return true;
    }
    return false;
  }
  if (!isElementStyleVisibilityVisible(element, style))
    return false;
  const rect = element.getBoundingClientRect();
  return rect.width > 0 && rect.height > 0;
}
function isVisibleTextNode(node) {
  const range = node.ownerDocument.createRange();
  range.selectNode(node);
  const rect = range.getBoundingClientRect();
  return rect.width > 0 && rect.height > 0;
}
function elementSafeTagName(element) {
  if (element instanceof HTMLFormElement)
    return "FORM";
  return element.tagName.toUpperCase();
}

// packages/playwright-core/src/utils/isomorphic/stringUtils.ts
function escapeWithQuotes(text, char = "'") {
  const stringified = JSON.stringify(text);
  const escapedText = stringified.substring(1, stringified.length - 1).replace(/\\\\"/g, '"');
  if (char === "'")
    return char + escapedText.replace(/[']/g, "\\\\'") + char;
  if (char === '"')
    return char + escapedText.replace(/["]/g, '\\\\"') + char;
  if (char === "\`")
    return char + escapedText.replace(/[\`]/g, "\`") + char;
  throw new Error("Invalid escape char");
}
function toTitleCase(name) {
  return name.charAt(0).toUpperCase() + name.substring(1);
}
function toSnakeCase(name) {
  return name.replace(/([a-z0-9])([A-Z])/g, "$1_$2").replace(/([A-Z])([A-Z][a-z])/g, "$1_$2").toLowerCase();
}
function cssEscape(s) {
  let result = "";
  for (let i = 0; i < s.length; i++)
    result += cssEscapeOne(s, i);
  return result;
}
function quoteCSSAttributeValue(text) {
  return \`"\${cssEscape(text).replace(/\\\\ /g, " ")}"\`;
}
function cssEscapeOne(s, i) {
  const c = s.charCodeAt(i);
  if (c === 0)
    return "\\uFFFD";
  if (c >= 1 && c <= 31 || c >= 48 && c <= 57 && (i === 0 || i === 1 && s.charCodeAt(0) === 45))
    return "\\\\" + c.toString(16) + " ";
  if (i === 0 && c === 45 && s.length === 1)
    return "\\\\" + s.charAt(i);
  if (c >= 128 || c === 45 || c === 95 || c >= 48 && c <= 57 || c >= 65 && c <= 90 || c >= 97 && c <= 122)
    return s.charAt(i);
  return "\\\\" + s.charAt(i);
}
function normalizeWhiteSpace(text) {
  return text.replace(/\\u200b/g, "").trim().replace(/\\s+/g, " ");
}
function normalizeEscapedRegexQuotes(source) {
  return source.replace(/(^|[^\\\\])(\\\\\\\\)*\\\\(['"\`])/g, "$1$2$3");
}
function escapeRegexForSelector(re) {
  if (re.unicode || re.unicodeSets)
    return String(re);
  return String(re).replace(/(^|[^\\\\])(\\\\\\\\)*(["'\`])/g, "$1$2\\\\$3").replace(/>>/g, "\\\\>\\\\>");
}
function escapeForTextSelector(text, exact) {
  if (typeof text !== "string")
    return escapeRegexForSelector(text);
  return \`\${JSON.stringify(text)}\${exact ? "s" : "i"}\`;
}
function escapeForAttributeSelector(value, exact) {
  if (typeof value !== "string")
    return escapeRegexForSelector(value);
  return \`"\${value.replace(/\\\\/g, "\\\\\\\\").replace(/["]/g, '\\\\"')}"\${exact ? "s" : "i"}\`;
}
function trimString(input, cap, suffix = "") {
  if (input.length <= cap)
    return input;
  const chars = [...input];
  if (chars.length > cap)
    return chars.slice(0, cap - suffix.length).join("") + suffix;
  return chars.join("");
}
function trimStringWithEllipsis(input, cap) {
  return trimString(input, cap, "\\u2026");
}
function escapeRegExp(s) {
  return s.replace(/[.*+?^\${}()|[\\]\\\\]/g, "\\\\$&");
}

// packages/playwright-core/src/server/injected/roleUtils.ts
function hasExplicitAccessibleName(e) {
  return e.hasAttribute("aria-label") || e.hasAttribute("aria-labelledby");
}
var kAncestorPreventingLandmark = "article:not([role]), aside:not([role]), main:not([role]), nav:not([role]), section:not([role]), [role=article], [role=complementary], [role=main], [role=navigation], [role=region]";
var kGlobalAriaAttributes = /* @__PURE__ */ new Map([
  ["aria-atomic", void 0],
  ["aria-busy", void 0],
  ["aria-controls", void 0],
  ["aria-current", void 0],
  ["aria-describedby", void 0],
  ["aria-details", void 0],
  // Global use deprecated in ARIA 1.2
  // ['aria-disabled', undefined],
  ["aria-dropeffect", void 0],
  // Global use deprecated in ARIA 1.2
  // ['aria-errormessage', undefined],
  ["aria-flowto", void 0],
  ["aria-grabbed", void 0],
  // Global use deprecated in ARIA 1.2
  // ['aria-haspopup', undefined],
  ["aria-hidden", void 0],
  // Global use deprecated in ARIA 1.2
  // ['aria-invalid', undefined],
  ["aria-keyshortcuts", void 0],
  ["aria-label", /* @__PURE__ */ new Set(["caption", "code", "deletion", "emphasis", "generic", "insertion", "paragraph", "presentation", "strong", "subscript", "superscript"])],
  ["aria-labelledby", /* @__PURE__ */ new Set(["caption", "code", "deletion", "emphasis", "generic", "insertion", "paragraph", "presentation", "strong", "subscript", "superscript"])],
  ["aria-live", void 0],
  ["aria-owns", void 0],
  ["aria-relevant", void 0],
  ["aria-roledescription", /* @__PURE__ */ new Set(["generic"])]
]);
function hasGlobalAriaAttribute(element, forRole) {
  return [...kGlobalAriaAttributes].some(([attr, prohibited]) => {
    return !(prohibited == null ? void 0 : prohibited.has(forRole || "")) && element.hasAttribute(attr);
  });
}
function hasTabIndex(element) {
  return !Number.isNaN(Number(String(element.getAttribute("tabindex"))));
}
function isFocusable(element) {
  return !isNativelyDisabled(element) && (isNativelyFocusable(element) || hasTabIndex(element));
}
function isNativelyFocusable(element) {
  const tagName = elementSafeTagName(element);
  if (["BUTTON", "DETAILS", "SELECT", "TEXTAREA"].includes(tagName))
    return true;
  if (tagName === "A" || tagName === "AREA")
    return element.hasAttribute("href");
  if (tagName === "INPUT")
    return !element.hidden;
  return false;
}
var kImplicitRoleByTagName = {
  "A": (e) => {
    return e.hasAttribute("href") ? "link" : null;
  },
  "AREA": (e) => {
    return e.hasAttribute("href") ? "link" : null;
  },
  "ARTICLE": () => "article",
  "ASIDE": () => "complementary",
  "BLOCKQUOTE": () => "blockquote",
  "BUTTON": () => "button",
  "CAPTION": () => "caption",
  "CODE": () => "code",
  "DATALIST": () => "listbox",
  "DD": () => "definition",
  "DEL": () => "deletion",
  "DETAILS": () => "group",
  "DFN": () => "term",
  "DIALOG": () => "dialog",
  "DT": () => "term",
  "EM": () => "emphasis",
  "FIELDSET": () => "group",
  "FIGURE": () => "figure",
  "FOOTER": (e) => closestCrossShadow(e, kAncestorPreventingLandmark) ? null : "contentinfo",
  "FORM": (e) => hasExplicitAccessibleName(e) ? "form" : null,
  "H1": () => "heading",
  "H2": () => "heading",
  "H3": () => "heading",
  "H4": () => "heading",
  "H5": () => "heading",
  "H6": () => "heading",
  "HEADER": (e) => closestCrossShadow(e, kAncestorPreventingLandmark) ? null : "banner",
  "HR": () => "separator",
  "HTML": () => "document",
  "IMG": (e) => e.getAttribute("alt") === "" && !e.getAttribute("title") && !hasGlobalAriaAttribute(e) && !hasTabIndex(e) ? "presentation" : "img",
  "INPUT": (e) => {
    const type = e.type.toLowerCase();
    if (type === "search")
      return e.hasAttribute("list") ? "combobox" : "searchbox";
    if (["email", "tel", "text", "url", ""].includes(type)) {
      const list = getIdRefs(e, e.getAttribute("list"))[0];
      return list && elementSafeTagName(list) === "DATALIST" ? "combobox" : "textbox";
    }
    if (type === "hidden")
      return "";
    return {
      "button": "button",
      "checkbox": "checkbox",
      "image": "button",
      "number": "spinbutton",
      "radio": "radio",
      "range": "slider",
      "reset": "button",
      "submit": "button"
    }[type] || "textbox";
  },
  "INS": () => "insertion",
  "LI": () => "listitem",
  "MAIN": () => "main",
  "MARK": () => "mark",
  "MATH": () => "math",
  "MENU": () => "list",
  "METER": () => "meter",
  "NAV": () => "navigation",
  "OL": () => "list",
  "OPTGROUP": () => "group",
  "OPTION": () => "option",
  "OUTPUT": () => "status",
  "P": () => "paragraph",
  "PROGRESS": () => "progressbar",
  "SECTION": (e) => hasExplicitAccessibleName(e) ? "region" : null,
  "SELECT": (e) => e.hasAttribute("multiple") || e.size > 1 ? "listbox" : "combobox",
  "STRONG": () => "strong",
  "SUB": () => "subscript",
  "SUP": () => "superscript",
  // For <svg> we default to Chrome behavior:
  // - Chrome reports 'img'.
  // - Firefox reports 'diagram' that is not in official ARIA spec yet.
  // - Safari reports 'no role', but still computes accessible name.
  "SVG": () => "img",
  "TABLE": () => "table",
  "TBODY": () => "rowgroup",
  "TD": (e) => {
    const table = closestCrossShadow(e, "table");
    const role = table ? getExplicitAriaRole(table) : "";
    return role === "grid" || role === "treegrid" ? "gridcell" : "cell";
  },
  "TEXTAREA": () => "textbox",
  "TFOOT": () => "rowgroup",
  "TH": (e) => {
    if (e.getAttribute("scope") === "col")
      return "columnheader";
    if (e.getAttribute("scope") === "row")
      return "rowheader";
    const table = closestCrossShadow(e, "table");
    const role = table ? getExplicitAriaRole(table) : "";
    return role === "grid" || role === "treegrid" ? "gridcell" : "cell";
  },
  "THEAD": () => "rowgroup",
  "TIME": () => "time",
  "TR": () => "row",
  "UL": () => "list"
};
var kPresentationInheritanceParents = {
  "DD": ["DL", "DIV"],
  "DIV": ["DL"],
  "DT": ["DL", "DIV"],
  "LI": ["OL", "UL"],
  "TBODY": ["TABLE"],
  "TD": ["TR"],
  "TFOOT": ["TABLE"],
  "TH": ["TR"],
  "THEAD": ["TABLE"],
  "TR": ["THEAD", "TBODY", "TFOOT", "TABLE"]
};
function getImplicitAriaRole(element) {
  var _a;
  const implicitRole = ((_a = kImplicitRoleByTagName[elementSafeTagName(element)]) == null ? void 0 : _a.call(kImplicitRoleByTagName, element)) || "";
  if (!implicitRole)
    return null;
  let ancestor = element;
  while (ancestor) {
    const parent = parentElementOrShadowHost(ancestor);
    const parents = kPresentationInheritanceParents[elementSafeTagName(ancestor)];
    if (!parents || !parent || !parents.includes(elementSafeTagName(parent)))
      break;
    const parentExplicitRole = getExplicitAriaRole(parent);
    if ((parentExplicitRole === "none" || parentExplicitRole === "presentation") && !hasPresentationConflictResolution(parent, parentExplicitRole))
      return parentExplicitRole;
    ancestor = parent;
  }
  return implicitRole;
}
var allRoles = [
  "alert",
  "alertdialog",
  "application",
  "article",
  "banner",
  "blockquote",
  "button",
  "caption",
  "cell",
  "checkbox",
  "code",
  "columnheader",
  "combobox",
  "command",
  "complementary",
  "composite",
  "contentinfo",
  "definition",
  "deletion",
  "dialog",
  "directory",
  "document",
  "emphasis",
  "feed",
  "figure",
  "form",
  "generic",
  "grid",
  "gridcell",
  "group",
  "heading",
  "img",
  "input",
  "insertion",
  "landmark",
  "link",
  "list",
  "listbox",
  "listitem",
  "log",
  "main",
  "marquee",
  "math",
  "meter",
  "menu",
  "menubar",
  "menuitem",
  "menuitemcheckbox",
  "menuitemradio",
  "navigation",
  "none",
  "note",
  "option",
  "paragraph",
  "presentation",
  "progressbar",
  "radio",
  "radiogroup",
  "range",
  "region",
  "roletype",
  "row",
  "rowgroup",
  "rowheader",
  "scrollbar",
  "search",
  "searchbox",
  "section",
  "sectionhead",
  "select",
  "separator",
  "slider",
  "spinbutton",
  "status",
  "strong",
  "structure",
  "subscript",
  "superscript",
  "switch",
  "tab",
  "table",
  "tablist",
  "tabpanel",
  "term",
  "textbox",
  "time",
  "timer",
  "toolbar",
  "tooltip",
  "tree",
  "treegrid",
  "treeitem",
  "widget",
  "window"
];
var abstractRoles = ["command", "composite", "input", "landmark", "range", "roletype", "section", "sectionhead", "select", "structure", "widget", "window"];
var validRoles = allRoles.filter((role) => !abstractRoles.includes(role));
function getExplicitAriaRole(element) {
  const roles = (element.getAttribute("role") || "").split(" ").map((role) => role.trim());
  return roles.find((role) => validRoles.includes(role)) || null;
}
function hasPresentationConflictResolution(element, role) {
  return hasGlobalAriaAttribute(element, role) || isFocusable(element);
}
function getAriaRole(element) {
  const explicitRole = getExplicitAriaRole(element);
  if (!explicitRole)
    return getImplicitAriaRole(element);
  if (explicitRole === "none" || explicitRole === "presentation") {
    const implicitRole = getImplicitAriaRole(element);
    if (hasPresentationConflictResolution(element, implicitRole))
      return implicitRole;
  }
  return explicitRole;
}
function getAriaBoolean(attr) {
  return attr === null ? void 0 : attr.toLowerCase() === "true";
}
function isElementHiddenForAria(element) {
  if (["STYLE", "SCRIPT", "NOSCRIPT", "TEMPLATE"].includes(elementSafeTagName(element)))
    return true;
  const style = getElementComputedStyle(element);
  const isSlot = element.nodeName === "SLOT";
  if ((style == null ? void 0 : style.display) === "contents" && !isSlot) {
    for (let child = element.firstChild; child; child = child.nextSibling) {
      if (child.nodeType === 1 && !isElementHiddenForAria(child))
        return false;
      if (child.nodeType === 3 && isVisibleTextNode(child))
        return false;
    }
    return true;
  }
  const isOptionInsideSelect = element.nodeName === "OPTION" && !!element.closest("select");
  if (!isOptionInsideSelect && !isSlot && !isElementStyleVisibilityVisible(element, style))
    return true;
  return belongsToDisplayNoneOrAriaHiddenOrNonSlotted(element);
}
function belongsToDisplayNoneOrAriaHiddenOrNonSlotted(element) {
  let hidden = cacheIsHidden == null ? void 0 : cacheIsHidden.get(element);
  if (hidden === void 0) {
    hidden = false;
    if (element.parentElement && element.parentElement.shadowRoot && !element.assignedSlot)
      hidden = true;
    if (!hidden) {
      const style = getElementComputedStyle(element);
      hidden = !style || style.display === "none" || getAriaBoolean(element.getAttribute("aria-hidden")) === true;
    }
    if (!hidden) {
      const parent = parentElementOrShadowHost(element);
      if (parent)
        hidden = belongsToDisplayNoneOrAriaHiddenOrNonSlotted(parent);
    }
    cacheIsHidden == null ? void 0 : cacheIsHidden.set(element, hidden);
  }
  return hidden;
}
function getIdRefs(element, ref) {
  if (!ref)
    return [];
  const root = enclosingShadowRootOrDocument(element);
  if (!root)
    return [];
  try {
    const ids = ref.split(" ").filter((id) => !!id);
    const set = /* @__PURE__ */ new Set();
    for (const id of ids) {
      const firstElement = root.querySelector("#" + CSS.escape(id));
      if (firstElement)
        set.add(firstElement);
    }
    return [...set];
  } catch (e) {
    return [];
  }
}
function trimFlatString(s) {
  return s.trim();
}
function asFlatString(s) {
  return s.split("\\xA0").map((chunk) => chunk.replace(/\\r\\n/g, "\\n").replace(/\\s\\s*/g, " ")).join("\\xA0").trim();
}
function queryInAriaOwned(element, selector) {
  const result = [...element.querySelectorAll(selector)];
  for (const owned of getIdRefs(element, element.getAttribute("aria-owns"))) {
    if (owned.matches(selector))
      result.push(owned);
    result.push(...owned.querySelectorAll(selector));
  }
  return result;
}
function getPseudoContent(element, pseudo) {
  const cache = pseudo === "::before" ? cachePseudoContentBefore : cachePseudoContentAfter;
  if (cache == null ? void 0 : cache.has(element))
    return (cache == null ? void 0 : cache.get(element)) || "";
  const pseudoStyle = getElementComputedStyle(element, pseudo);
  const content = getPseudoContentImpl(pseudoStyle);
  if (cache)
    cache.set(element, content);
  return content;
}
function getPseudoContentImpl(pseudoStyle) {
  if (!pseudoStyle)
    return "";
  const content = pseudoStyle.content;
  if (content[0] === "'" && content[content.length - 1] === "'" || content[0] === '"' && content[content.length - 1] === '"') {
    const unquoted = content.substring(1, content.length - 1);
    const display = pseudoStyle.display || "inline";
    if (display !== "inline")
      return " " + unquoted + " ";
    return unquoted;
  }
  return "";
}
function getAriaLabelledByElements(element) {
  const ref = element.getAttribute("aria-labelledby");
  if (ref === null)
    return null;
  return getIdRefs(element, ref);
}
function allowsNameFromContent(role, targetDescendant) {
  const alwaysAllowsNameFromContent = ["button", "cell", "checkbox", "columnheader", "gridcell", "heading", "link", "menuitem", "menuitemcheckbox", "menuitemradio", "option", "radio", "row", "rowheader", "switch", "tab", "tooltip", "treeitem"].includes(role);
  const descendantAllowsNameFromContent = targetDescendant && ["", "caption", "code", "contentinfo", "definition", "deletion", "emphasis", "insertion", "list", "listitem", "mark", "none", "paragraph", "presentation", "region", "row", "rowgroup", "section", "strong", "subscript", "superscript", "table", "term", "time"].includes(role);
  return alwaysAllowsNameFromContent || descendantAllowsNameFromContent;
}
function getElementAccessibleName(element, includeHidden) {
  const cache = includeHidden ? cacheAccessibleNameHidden : cacheAccessibleName;
  let accessibleName = cache == null ? void 0 : cache.get(element);
  if (accessibleName === void 0) {
    accessibleName = "";
    const elementProhibitsNaming = ["caption", "code", "definition", "deletion", "emphasis", "generic", "insertion", "mark", "paragraph", "presentation", "strong", "subscript", "suggestion", "superscript", "term", "time"].includes(getAriaRole(element) || "");
    if (!elementProhibitsNaming) {
      accessibleName = asFlatString(getTextAlternativeInternal(element, {
        includeHidden,
        visitedElements: /* @__PURE__ */ new Set(),
        embeddedInDescribedBy: void 0,
        embeddedInLabelledBy: void 0,
        embeddedInLabel: void 0,
        embeddedInNativeTextAlternative: void 0,
        embeddedInTargetElement: "self"
      }));
    }
    cache == null ? void 0 : cache.set(element, accessibleName);
  }
  return accessibleName;
}
function getElementAccessibleDescription(element, includeHidden) {
  const cache = includeHidden ? cacheAccessibleDescriptionHidden : cacheAccessibleDescription;
  let accessibleDescription = cache == null ? void 0 : cache.get(element);
  if (accessibleDescription === void 0) {
    accessibleDescription = "";
    if (element.hasAttribute("aria-describedby")) {
      const describedBy = getIdRefs(element, element.getAttribute("aria-describedby"));
      accessibleDescription = asFlatString(describedBy.map((ref) => getTextAlternativeInternal(ref, {
        includeHidden,
        visitedElements: /* @__PURE__ */ new Set(),
        embeddedInLabelledBy: void 0,
        embeddedInLabel: void 0,
        embeddedInNativeTextAlternative: void 0,
        embeddedInTargetElement: "none",
        embeddedInDescribedBy: { element: ref, hidden: isElementHiddenForAria(ref) }
      })).join(" "));
    } else if (element.hasAttribute("aria-description")) {
      accessibleDescription = asFlatString(element.getAttribute("aria-description") || "");
    } else {
      accessibleDescription = asFlatString(element.getAttribute("title") || "");
    }
    cache == null ? void 0 : cache.set(element, accessibleDescription);
  }
  return accessibleDescription;
}
function getTextAlternativeInternal(element, options) {
  var _a, _b, _c, _d;
  if (options.visitedElements.has(element))
    return "";
  const childOptions = {
    ...options,
    embeddedInTargetElement: options.embeddedInTargetElement === "self" ? "descendant" : options.embeddedInTargetElement
  };
  if (!options.includeHidden && !((_a = options.embeddedInLabelledBy) == null ? void 0 : _a.hidden) && !((_b = options.embeddedInDescribedBy) == null ? void 0 : _b.hidden) && !((_c = options == null ? void 0 : options.embeddedInNativeTextAlternative) == null ? void 0 : _c.hidden) && !((_d = options == null ? void 0 : options.embeddedInLabel) == null ? void 0 : _d.hidden) && isElementHiddenForAria(element)) {
    options.visitedElements.add(element);
    return "";
  }
  const labelledBy = getAriaLabelledByElements(element);
  if (!options.embeddedInLabelledBy) {
    const accessibleName = (labelledBy || []).map((ref) => getTextAlternativeInternal(ref, {
      ...options,
      embeddedInLabelledBy: { element: ref, hidden: isElementHiddenForAria(ref) },
      embeddedInDescribedBy: void 0,
      embeddedInTargetElement: "none",
      embeddedInLabel: void 0,
      embeddedInNativeTextAlternative: void 0
    })).join(" ");
    if (accessibleName)
      return accessibleName;
  }
  const role = getAriaRole(element) || "";
  const tagName = elementSafeTagName(element);
  if (!!options.embeddedInLabel || !!options.embeddedInLabelledBy || options.embeddedInTargetElement === "descendant") {
    const isOwnLabel = [...element.labels || []].includes(element);
    const isOwnLabelledBy = (labelledBy || []).includes(element);
    if (!isOwnLabel && !isOwnLabelledBy) {
      if (role === "textbox") {
        options.visitedElements.add(element);
        if (tagName === "INPUT" || tagName === "TEXTAREA")
          return element.value;
        return element.textContent || "";
      }
      if (["combobox", "listbox"].includes(role)) {
        options.visitedElements.add(element);
        let selectedOptions;
        if (tagName === "SELECT") {
          selectedOptions = [...element.selectedOptions];
          if (!selectedOptions.length && element.options.length)
            selectedOptions.push(element.options[0]);
        } else {
          const listbox = role === "combobox" ? queryInAriaOwned(element, "*").find((e) => getAriaRole(e) === "listbox") : element;
          selectedOptions = listbox ? queryInAriaOwned(listbox, '[aria-selected="true"]').filter((e) => getAriaRole(e) === "option") : [];
        }
        if (!selectedOptions.length && tagName === "INPUT") {
          return element.value;
        }
        return selectedOptions.map((option) => getTextAlternativeInternal(option, childOptions)).join(" ");
      }
      if (["progressbar", "scrollbar", "slider", "spinbutton", "meter"].includes(role)) {
        options.visitedElements.add(element);
        if (element.hasAttribute("aria-valuetext"))
          return element.getAttribute("aria-valuetext") || "";
        if (element.hasAttribute("aria-valuenow"))
          return element.getAttribute("aria-valuenow") || "";
        return element.getAttribute("value") || "";
      }
      if (["menu"].includes(role)) {
        options.visitedElements.add(element);
        return "";
      }
    }
  }
  const ariaLabel = element.getAttribute("aria-label") || "";
  if (trimFlatString(ariaLabel)) {
    options.visitedElements.add(element);
    return ariaLabel;
  }
  if (!["presentation", "none"].includes(role)) {
    if (tagName === "INPUT" && ["button", "submit", "reset"].includes(element.type)) {
      options.visitedElements.add(element);
      const value = element.value || "";
      if (trimFlatString(value))
        return value;
      if (element.type === "submit")
        return "Submit";
      if (element.type === "reset")
        return "Reset";
      const title = element.getAttribute("title") || "";
      return title;
    }
    if (tagName === "INPUT" && element.type === "image") {
      options.visitedElements.add(element);
      const labels = element.labels || [];
      if (labels.length && !options.embeddedInLabelledBy)
        return getAccessibleNameFromAssociatedLabels(labels, options);
      const alt = element.getAttribute("alt") || "";
      if (trimFlatString(alt))
        return alt;
      const title = element.getAttribute("title") || "";
      if (trimFlatString(title))
        return title;
      return "Submit";
    }
    if (!labelledBy && tagName === "BUTTON") {
      options.visitedElements.add(element);
      const labels = element.labels || [];
      if (labels.length)
        return getAccessibleNameFromAssociatedLabels(labels, options);
    }
    if (!labelledBy && tagName === "OUTPUT") {
      options.visitedElements.add(element);
      const labels = element.labels || [];
      if (labels.length)
        return getAccessibleNameFromAssociatedLabels(labels, options);
      return element.getAttribute("title") || "";
    }
    if (!labelledBy && (tagName === "TEXTAREA" || tagName === "SELECT" || tagName === "INPUT")) {
      options.visitedElements.add(element);
      const labels = element.labels || [];
      if (labels.length)
        return getAccessibleNameFromAssociatedLabels(labels, options);
      const usePlaceholder = tagName === "INPUT" && ["text", "password", "search", "tel", "email", "url"].includes(element.type) || tagName === "TEXTAREA";
      const placeholder = element.getAttribute("placeholder") || "";
      const title = element.getAttribute("title") || "";
      if (!usePlaceholder || title)
        return title;
      return placeholder;
    }
    if (!labelledBy && tagName === "FIELDSET") {
      options.visitedElements.add(element);
      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {
        if (elementSafeTagName(child) === "LEGEND") {
          return getTextAlternativeInternal(child, {
            ...childOptions,
            embeddedInNativeTextAlternative: { element: child, hidden: isElementHiddenForAria(child) }
          });
        }
      }
      const title = element.getAttribute("title") || "";
      return title;
    }
    if (!labelledBy && tagName === "FIGURE") {
      options.visitedElements.add(element);
      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {
        if (elementSafeTagName(child) === "FIGCAPTION") {
          return getTextAlternativeInternal(child, {
            ...childOptions,
            embeddedInNativeTextAlternative: { element: child, hidden: isElementHiddenForAria(child) }
          });
        }
      }
      const title = element.getAttribute("title") || "";
      return title;
    }
    if (tagName === "IMG") {
      options.visitedElements.add(element);
      const alt = element.getAttribute("alt") || "";
      if (trimFlatString(alt))
        return alt;
      const title = element.getAttribute("title") || "";
      return title;
    }
    if (tagName === "TABLE") {
      options.visitedElements.add(element);
      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {
        if (elementSafeTagName(child) === "CAPTION") {
          return getTextAlternativeInternal(child, {
            ...childOptions,
            embeddedInNativeTextAlternative: { element: child, hidden: isElementHiddenForAria(child) }
          });
        }
      }
      const summary = element.getAttribute("summary") || "";
      if (summary)
        return summary;
    }
    if (tagName === "AREA") {
      options.visitedElements.add(element);
      const alt = element.getAttribute("alt") || "";
      if (trimFlatString(alt))
        return alt;
      const title = element.getAttribute("title") || "";
      return title;
    }
    if (tagName === "SVG" || element.ownerSVGElement) {
      options.visitedElements.add(element);
      for (let child = element.firstElementChild; child; child = child.nextElementSibling) {
        if (elementSafeTagName(child) === "TITLE" && child.ownerSVGElement) {
          return getTextAlternativeInternal(child, {
            ...childOptions,
            embeddedInLabelledBy: { element: child, hidden: isElementHiddenForAria(child) }
          });
        }
      }
    }
    if (element.ownerSVGElement && tagName === "A") {
      const title = element.getAttribute("xlink:title") || "";
      if (trimFlatString(title)) {
        options.visitedElements.add(element);
        return title;
      }
    }
  }
  const shouldNameFromContentForSummary = tagName === "SUMMARY" && !["presentation", "none"].includes(role);
  if (allowsNameFromContent(role, options.embeddedInTargetElement === "descendant") || shouldNameFromContentForSummary || !!options.embeddedInLabelledBy || !!options.embeddedInDescribedBy || !!options.embeddedInLabel || !!options.embeddedInNativeTextAlternative) {
    options.visitedElements.add(element);
    const tokens = [];
    const visit = (node, skipSlotted) => {
      var _a2;
      if (skipSlotted && node.assignedSlot)
        return;
      if (node.nodeType === 1) {
        const display = ((_a2 = getElementComputedStyle(node)) == null ? void 0 : _a2.display) || "inline";
        let token = getTextAlternativeInternal(node, childOptions);
        if (display !== "inline" || node.nodeName === "BR")
          token = " " + token + " ";
        tokens.push(token);
      } else if (node.nodeType === 3) {
        tokens.push(node.textContent || "");
      }
    };
    tokens.push(getPseudoContent(element, "::before"));
    const assignedNodes = element.nodeName === "SLOT" ? element.assignedNodes() : [];
    if (assignedNodes.length) {
      for (const child of assignedNodes)
        visit(child, false);
    } else {
      for (let child = element.firstChild; child; child = child.nextSibling)
        visit(child, true);
      if (element.shadowRoot) {
        for (let child = element.shadowRoot.firstChild; child; child = child.nextSibling)
          visit(child, true);
      }
      for (const owned of getIdRefs(element, element.getAttribute("aria-owns")))
        visit(owned, true);
    }
    tokens.push(getPseudoContent(element, "::after"));
    const accessibleName = tokens.join("");
    const maybeTrimmedAccessibleName = options.embeddedInTargetElement === "self" ? trimFlatString(accessibleName) : accessibleName;
    if (maybeTrimmedAccessibleName)
      return accessibleName;
  }
  if (!["presentation", "none"].includes(role) || tagName === "IFRAME") {
    options.visitedElements.add(element);
    const title = element.getAttribute("title") || "";
    if (trimFlatString(title))
      return title;
  }
  options.visitedElements.add(element);
  return "";
}
var kAriaSelectedRoles = ["gridcell", "option", "row", "tab", "rowheader", "columnheader", "treeitem"];
function getAriaSelected(element) {
  if (elementSafeTagName(element) === "OPTION")
    return element.selected;
  if (kAriaSelectedRoles.includes(getAriaRole(element) || ""))
    return getAriaBoolean(element.getAttribute("aria-selected")) === true;
  return false;
}
var kAriaCheckedRoles = ["checkbox", "menuitemcheckbox", "option", "radio", "switch", "menuitemradio", "treeitem"];
function getAriaChecked(element) {
  const result = getChecked(element, true);
  return result === "error" ? false : result;
}
function getChecked(element, allowMixed) {
  const tagName = elementSafeTagName(element);
  if (allowMixed && tagName === "INPUT" && element.indeterminate)
    return "mixed";
  if (tagName === "INPUT" && ["checkbox", "radio"].includes(element.type))
    return element.checked;
  if (kAriaCheckedRoles.includes(getAriaRole(element) || "")) {
    const checked = element.getAttribute("aria-checked");
    if (checked === "true")
      return true;
    if (allowMixed && checked === "mixed")
      return "mixed";
    return false;
  }
  return "error";
}
var kAriaPressedRoles = ["button"];
function getAriaPressed(element) {
  if (kAriaPressedRoles.includes(getAriaRole(element) || "")) {
    const pressed = element.getAttribute("aria-pressed");
    if (pressed === "true")
      return true;
    if (pressed === "mixed")
      return "mixed";
  }
  return false;
}
var kAriaExpandedRoles = ["application", "button", "checkbox", "combobox", "gridcell", "link", "listbox", "menuitem", "row", "rowheader", "tab", "treeitem", "columnheader", "menuitemcheckbox", "menuitemradio", "rowheader", "switch"];
function getAriaExpanded(element) {
  if (elementSafeTagName(element) === "DETAILS")
    return element.open;
  if (kAriaExpandedRoles.includes(getAriaRole(element) || "")) {
    const expanded = element.getAttribute("aria-expanded");
    if (expanded === null)
      return "none";
    if (expanded === "true")
      return true;
    return false;
  }
  return "none";
}
var kAriaLevelRoles = ["heading", "listitem", "row", "treeitem"];
function getAriaLevel(element) {
  const native = { "H1": 1, "H2": 2, "H3": 3, "H4": 4, "H5": 5, "H6": 6 }[elementSafeTagName(element)];
  if (native)
    return native;
  if (kAriaLevelRoles.includes(getAriaRole(element) || "")) {
    const attr = element.getAttribute("aria-level");
    const value = attr === null ? Number.NaN : Number(attr);
    if (Number.isInteger(value) && value >= 1)
      return value;
  }
  return 0;
}
var kAriaDisabledRoles = ["application", "button", "composite", "gridcell", "group", "input", "link", "menuitem", "scrollbar", "separator", "tab", "checkbox", "columnheader", "combobox", "grid", "listbox", "menu", "menubar", "menuitemcheckbox", "menuitemradio", "option", "radio", "radiogroup", "row", "rowheader", "searchbox", "select", "slider", "spinbutton", "switch", "tablist", "textbox", "toolbar", "tree", "treegrid", "treeitem"];
function getAriaDisabled(element) {
  return isNativelyDisabled(element) || hasExplicitAriaDisabled(element);
}
function isNativelyDisabled(element) {
  const isNativeFormControl = ["BUTTON", "INPUT", "SELECT", "TEXTAREA", "OPTION", "OPTGROUP"].includes(element.tagName);
  return isNativeFormControl && (element.hasAttribute("disabled") || belongsToDisabledFieldSet(element));
}
function belongsToDisabledFieldSet(element) {
  if (!element)
    return false;
  if (elementSafeTagName(element) === "FIELDSET" && element.hasAttribute("disabled"))
    return true;
  return belongsToDisabledFieldSet(element.parentElement);
}
function hasExplicitAriaDisabled(element) {
  if (!element)
    return false;
  if (kAriaDisabledRoles.includes(getAriaRole(element) || "")) {
    const attribute = (element.getAttribute("aria-disabled") || "").toLowerCase();
    if (attribute === "true")
      return true;
    if (attribute === "false")
      return false;
  }
  return hasExplicitAriaDisabled(parentElementOrShadowHost(element));
}
function getAccessibleNameFromAssociatedLabels(labels, options) {
  return [...labels].map((label) => getTextAlternativeInternal(label, {
    ...options,
    embeddedInLabel: { element: label, hidden: isElementHiddenForAria(label) },
    embeddedInNativeTextAlternative: void 0,
    embeddedInLabelledBy: void 0,
    embeddedInDescribedBy: void 0,
    embeddedInTargetElement: "none"
  })).filter((accessibleName) => !!accessibleName).join(" ");
}
var cacheAccessibleName;
var cacheAccessibleNameHidden;
var cacheAccessibleDescription;
var cacheAccessibleDescriptionHidden;
var cacheIsHidden;
var cachePseudoContentBefore;
var cachePseudoContentAfter;
var cachesCounter = 0;
function beginAriaCaches() {
  ++cachesCounter;
  cacheAccessibleName != null ? cacheAccessibleName : cacheAccessibleName = /* @__PURE__ */ new Map();
  cacheAccessibleNameHidden != null ? cacheAccessibleNameHidden : cacheAccessibleNameHidden = /* @__PURE__ */ new Map();
  cacheAccessibleDescription != null ? cacheAccessibleDescription : cacheAccessibleDescription = /* @__PURE__ */ new Map();
  cacheAccessibleDescriptionHidden != null ? cacheAccessibleDescriptionHidden : cacheAccessibleDescriptionHidden = /* @__PURE__ */ new Map();
  cacheIsHidden != null ? cacheIsHidden : cacheIsHidden = /* @__PURE__ */ new Map();
  cachePseudoContentBefore != null ? cachePseudoContentBefore : cachePseudoContentBefore = /* @__PURE__ */ new Map();
  cachePseudoContentAfter != null ? cachePseudoContentAfter : cachePseudoContentAfter = /* @__PURE__ */ new Map();
}
function endAriaCaches() {
  if (!--cachesCounter) {
    cacheAccessibleName = void 0;
    cacheAccessibleNameHidden = void 0;
    cacheAccessibleDescription = void 0;
    cacheAccessibleDescriptionHidden = void 0;
    cacheIsHidden = void 0;
    cachePseudoContentBefore = void 0;
    cachePseudoContentAfter = void 0;
  }
}

// packages/playwright-core/src/server/injected/selectorUtils.ts
function matchesComponentAttribute(obj, attr) {
  for (const token of attr.jsonPath) {
    if (obj !== void 0 && obj !== null)
      obj = obj[token];
  }
  return matchesAttributePart(obj, attr);
}
function matchesAttributePart(value, attr) {
  const objValue = typeof value === "string" && !attr.caseSensitive ? value.toUpperCase() : value;
  const attrValue = typeof attr.value === "string" && !attr.caseSensitive ? attr.value.toUpperCase() : attr.value;
  if (attr.op === "<truthy>")
    return !!objValue;
  if (attr.op === "=") {
    if (attrValue instanceof RegExp)
      return typeof objValue === "string" && !!objValue.match(attrValue);
    return objValue === attrValue;
  }
  if (typeof objValue !== "string" || typeof attrValue !== "string")
    return false;
  if (attr.op === "*=")
    return objValue.includes(attrValue);
  if (attr.op === "^=")
    return objValue.startsWith(attrValue);
  if (attr.op === "$=")
    return objValue.endsWith(attrValue);
  if (attr.op === "|=")
    return objValue === attrValue || objValue.startsWith(attrValue + "-");
  if (attr.op === "~=")
    return objValue.split(" ").includes(attrValue);
  return false;
}
function shouldSkipForTextMatching(element) {
  const document = element.ownerDocument;
  return element.nodeName === "SCRIPT" || element.nodeName === "NOSCRIPT" || element.nodeName === "STYLE" || document.head && document.head.contains(element);
}
function elementText(cache, root) {
  let value = cache.get(root);
  if (value === void 0) {
    value = { full: "", normalized: "", immediate: [] };
    if (!shouldSkipForTextMatching(root)) {
      let currentImmediate = "";
      if (root instanceof HTMLInputElement && (root.type === "submit" || root.type === "button")) {
        value = { full: root.value, normalized: normalizeWhiteSpace(root.value), immediate: [root.value] };
      } else {
        for (let child = root.firstChild; child; child = child.nextSibling) {
          if (child.nodeType === Node.TEXT_NODE) {
            value.full += child.nodeValue || "";
            currentImmediate += child.nodeValue || "";
          } else {
            if (currentImmediate)
              value.immediate.push(currentImmediate);
            currentImmediate = "";
            if (child.nodeType === Node.ELEMENT_NODE)
              value.full += elementText(cache, child).full;
          }
        }
        if (currentImmediate)
          value.immediate.push(currentImmediate);
        if (root.shadowRoot)
          value.full += elementText(cache, root.shadowRoot).full;
        if (value.full)
          value.normalized = normalizeWhiteSpace(value.full);
      }
    }
    cache.set(root, value);
  }
  return value;
}
function elementMatchesText(cache, element, matcher) {
  if (shouldSkipForTextMatching(element))
    return "none";
  if (!matcher(elementText(cache, element)))
    return "none";
  for (let child = element.firstChild; child; child = child.nextSibling) {
    if (child.nodeType === Node.ELEMENT_NODE && matcher(elementText(cache, child)))
      return "selfAndChildren";
  }
  if (element.shadowRoot && matcher(elementText(cache, element.shadowRoot)))
    return "selfAndChildren";
  return "self";
}
function getElementLabels(textCache, element) {
  const labels = getAriaLabelledByElements(element);
  if (labels)
    return labels.map((label) => elementText(textCache, label));
  const ariaLabel = element.getAttribute("aria-label");
  if (ariaLabel !== null && !!ariaLabel.trim())
    return [{ full: ariaLabel, normalized: normalizeWhiteSpace(ariaLabel), immediate: [ariaLabel] }];
  const isNonHiddenInput = element.nodeName === "INPUT" && element.type !== "hidden";
  if (["BUTTON", "METER", "OUTPUT", "PROGRESS", "SELECT", "TEXTAREA"].includes(element.nodeName) || isNonHiddenInput) {
    const labels2 = element.labels;
    if (labels2)
      return [...labels2].map((label) => elementText(textCache, label));
  }
  return [];
}

// packages/playwright-core/src/utils/isomorphic/cssTokenizer.ts
var between = function(num, first, last) {
  return num >= first && num <= last;
};
function digit(code) {
  return between(code, 48, 57);
}
function hexdigit(code) {
  return digit(code) || between(code, 65, 70) || between(code, 97, 102);
}
function uppercaseletter(code) {
  return between(code, 65, 90);
}
function lowercaseletter(code) {
  return between(code, 97, 122);
}
function letter(code) {
  return uppercaseletter(code) || lowercaseletter(code);
}
function nonascii(code) {
  return code >= 128;
}
function namestartchar(code) {
  return letter(code) || nonascii(code) || code === 95;
}
function namechar(code) {
  return namestartchar(code) || digit(code) || code === 45;
}
function nonprintable(code) {
  return between(code, 0, 8) || code === 11 || between(code, 14, 31) || code === 127;
}
function newline(code) {
  return code === 10;
}
function whitespace(code) {
  return newline(code) || code === 9 || code === 32;
}
var maximumallowedcodepoint = 1114111;
var InvalidCharacterError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "InvalidCharacterError";
  }
};
function preprocess(str) {
  const codepoints = [];
  for (let i = 0; i < str.length; i++) {
    let code = str.charCodeAt(i);
    if (code === 13 && str.charCodeAt(i + 1) === 10) {
      code = 10;
      i++;
    }
    if (code === 13 || code === 12)
      code = 10;
    if (code === 0)
      code = 65533;
    if (between(code, 55296, 56319) && between(str.charCodeAt(i + 1), 56320, 57343)) {
      const lead = code - 55296;
      const trail = str.charCodeAt(i + 1) - 56320;
      code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;
      i++;
    }
    codepoints.push(code);
  }
  return codepoints;
}
function stringFromCode(code) {
  if (code <= 65535)
    return String.fromCharCode(code);
  code -= Math.pow(2, 16);
  const lead = Math.floor(code / Math.pow(2, 10)) + 55296;
  const trail = code % Math.pow(2, 10) + 56320;
  return String.fromCharCode(lead) + String.fromCharCode(trail);
}
function tokenize(str1) {
  const str = preprocess(str1);
  let i = -1;
  const tokens = [];
  let code;
  let line = 0;
  let column = 0;
  let lastLineLength = 0;
  const incrLineno = function() {
    line += 1;
    lastLineLength = column;
    column = 0;
  };
  const locStart = { line, column };
  const codepoint = function(i2) {
    if (i2 >= str.length)
      return -1;
    return str[i2];
  };
  const next = function(num) {
    if (num === void 0)
      num = 1;
    if (num > 3)
      throw "Spec Error: no more than three codepoints of lookahead.";
    return codepoint(i + num);
  };
  const consume = function(num) {
    if (num === void 0)
      num = 1;
    i += num;
    code = codepoint(i);
    if (newline(code))
      incrLineno();
    else
      column += num;
    return true;
  };
  const reconsume = function() {
    i -= 1;
    if (newline(code)) {
      line -= 1;
      column = lastLineLength;
    } else {
      column -= 1;
    }
    locStart.line = line;
    locStart.column = column;
    return true;
  };
  const eof = function(codepoint2) {
    if (codepoint2 === void 0)
      codepoint2 = code;
    return codepoint2 === -1;
  };
  const donothing = function() {
  };
  const parseerror = function() {
  };
  const consumeAToken = function() {
    consumeComments();
    consume();
    if (whitespace(code)) {
      while (whitespace(next()))
        consume();
      return new WhitespaceToken();
    } else if (code === 34) {
      return consumeAStringToken();
    } else if (code === 35) {
      if (namechar(next()) || areAValidEscape(next(1), next(2))) {
        const token = new HashToken("");
        if (wouldStartAnIdentifier(next(1), next(2), next(3)))
          token.type = "id";
        token.value = consumeAName();
        return token;
      } else {
        return new DelimToken(code);
      }
    } else if (code === 36) {
      if (next() === 61) {
        consume();
        return new SuffixMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 39) {
      return consumeAStringToken();
    } else if (code === 40) {
      return new OpenParenToken();
    } else if (code === 41) {
      return new CloseParenToken();
    } else if (code === 42) {
      if (next() === 61) {
        consume();
        return new SubstringMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 43) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 44) {
      return new CommaToken();
    } else if (code === 45) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else if (next(1) === 45 && next(2) === 62) {
        consume(2);
        return new CDCToken();
      } else if (startsWithAnIdentifier()) {
        reconsume();
        return consumeAnIdentlikeToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 46) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 58) {
      return new ColonToken();
    } else if (code === 59) {
      return new SemicolonToken();
    } else if (code === 60) {
      if (next(1) === 33 && next(2) === 45 && next(3) === 45) {
        consume(3);
        return new CDOToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 64) {
      if (wouldStartAnIdentifier(next(1), next(2), next(3)))
        return new AtKeywordToken(consumeAName());
      else
        return new DelimToken(code);
    } else if (code === 91) {
      return new OpenSquareToken();
    } else if (code === 92) {
      if (startsWithAValidEscape()) {
        reconsume();
        return consumeAnIdentlikeToken();
      } else {
        parseerror();
        return new DelimToken(code);
      }
    } else if (code === 93) {
      return new CloseSquareToken();
    } else if (code === 94) {
      if (next() === 61) {
        consume();
        return new PrefixMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 123) {
      return new OpenCurlyToken();
    } else if (code === 124) {
      if (next() === 61) {
        consume();
        return new DashMatchToken();
      } else if (next() === 124) {
        consume();
        return new ColumnToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 125) {
      return new CloseCurlyToken();
    } else if (code === 126) {
      if (next() === 61) {
        consume();
        return new IncludeMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (digit(code)) {
      reconsume();
      return consumeANumericToken();
    } else if (namestartchar(code)) {
      reconsume();
      return consumeAnIdentlikeToken();
    } else if (eof()) {
      return new EOFToken();
    } else {
      return new DelimToken(code);
    }
  };
  const consumeComments = function() {
    while (next(1) === 47 && next(2) === 42) {
      consume(2);
      while (true) {
        consume();
        if (code === 42 && next() === 47) {
          consume();
          break;
        } else if (eof()) {
          parseerror();
          return;
        }
      }
    }
  };
  const consumeANumericToken = function() {
    const num = consumeANumber();
    if (wouldStartAnIdentifier(next(1), next(2), next(3))) {
      const token = new DimensionToken();
      token.value = num.value;
      token.repr = num.repr;
      token.type = num.type;
      token.unit = consumeAName();
      return token;
    } else if (next() === 37) {
      consume();
      const token = new PercentageToken();
      token.value = num.value;
      token.repr = num.repr;
      return token;
    } else {
      const token = new NumberToken();
      token.value = num.value;
      token.repr = num.repr;
      token.type = num.type;
      return token;
    }
  };
  const consumeAnIdentlikeToken = function() {
    const str2 = consumeAName();
    if (str2.toLowerCase() === "url" && next() === 40) {
      consume();
      while (whitespace(next(1)) && whitespace(next(2)))
        consume();
      if (next() === 34 || next() === 39)
        return new FunctionToken(str2);
      else if (whitespace(next()) && (next(2) === 34 || next(2) === 39))
        return new FunctionToken(str2);
      else
        return consumeAURLToken();
    } else if (next() === 40) {
      consume();
      return new FunctionToken(str2);
    } else {
      return new IdentToken(str2);
    }
  };
  const consumeAStringToken = function(endingCodePoint) {
    if (endingCodePoint === void 0)
      endingCodePoint = code;
    let string = "";
    while (consume()) {
      if (code === endingCodePoint || eof()) {
        return new StringToken(string);
      } else if (newline(code)) {
        parseerror();
        reconsume();
        return new BadStringToken();
      } else if (code === 92) {
        if (eof(next()))
          donothing();
        else if (newline(next()))
          consume();
        else
          string += stringFromCode(consumeEscape());
      } else {
        string += stringFromCode(code);
      }
    }
    throw new Error("Internal error");
  };
  const consumeAURLToken = function() {
    const token = new URLToken("");
    while (whitespace(next()))
      consume();
    if (eof(next()))
      return token;
    while (consume()) {
      if (code === 41 || eof()) {
        return token;
      } else if (whitespace(code)) {
        while (whitespace(next()))
          consume();
        if (next() === 41 || eof(next())) {
          consume();
          return token;
        } else {
          consumeTheRemnantsOfABadURL();
          return new BadURLToken();
        }
      } else if (code === 34 || code === 39 || code === 40 || nonprintable(code)) {
        parseerror();
        consumeTheRemnantsOfABadURL();
        return new BadURLToken();
      } else if (code === 92) {
        if (startsWithAValidEscape()) {
          token.value += stringFromCode(consumeEscape());
        } else {
          parseerror();
          consumeTheRemnantsOfABadURL();
          return new BadURLToken();
        }
      } else {
        token.value += stringFromCode(code);
      }
    }
    throw new Error("Internal error");
  };
  const consumeEscape = function() {
    consume();
    if (hexdigit(code)) {
      const digits = [code];
      for (let total = 0; total < 5; total++) {
        if (hexdigit(next())) {
          consume();
          digits.push(code);
        } else {
          break;
        }
      }
      if (whitespace(next()))
        consume();
      let value = parseInt(digits.map(function(x) {
        return String.fromCharCode(x);
      }).join(""), 16);
      if (value > maximumallowedcodepoint)
        value = 65533;
      return value;
    } else if (eof()) {
      return 65533;
    } else {
      return code;
    }
  };
  const areAValidEscape = function(c1, c2) {
    if (c1 !== 92)
      return false;
    if (newline(c2))
      return false;
    return true;
  };
  const startsWithAValidEscape = function() {
    return areAValidEscape(code, next());
  };
  const wouldStartAnIdentifier = function(c1, c2, c3) {
    if (c1 === 45)
      return namestartchar(c2) || c2 === 45 || areAValidEscape(c2, c3);
    else if (namestartchar(c1))
      return true;
    else if (c1 === 92)
      return areAValidEscape(c1, c2);
    else
      return false;
  };
  const startsWithAnIdentifier = function() {
    return wouldStartAnIdentifier(code, next(1), next(2));
  };
  const wouldStartANumber = function(c1, c2, c3) {
    if (c1 === 43 || c1 === 45) {
      if (digit(c2))
        return true;
      if (c2 === 46 && digit(c3))
        return true;
      return false;
    } else if (c1 === 46) {
      if (digit(c2))
        return true;
      return false;
    } else if (digit(c1)) {
      return true;
    } else {
      return false;
    }
  };
  const startsWithANumber = function() {
    return wouldStartANumber(code, next(1), next(2));
  };
  const consumeAName = function() {
    let result = "";
    while (consume()) {
      if (namechar(code)) {
        result += stringFromCode(code);
      } else if (startsWithAValidEscape()) {
        result += stringFromCode(consumeEscape());
      } else {
        reconsume();
        return result;
      }
    }
    throw new Error("Internal parse error");
  };
  const consumeANumber = function() {
    let repr = "";
    let type = "integer";
    if (next() === 43 || next() === 45) {
      consume();
      repr += stringFromCode(code);
    }
    while (digit(next())) {
      consume();
      repr += stringFromCode(code);
    }
    if (next(1) === 46 && digit(next(2))) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    }
    const c1 = next(1), c2 = next(2), c3 = next(3);
    if ((c1 === 69 || c1 === 101) && digit(c2)) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    } else if ((c1 === 69 || c1 === 101) && (c2 === 43 || c2 === 45) && digit(c3)) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    }
    const value = convertAStringToANumber(repr);
    return { type, value, repr };
  };
  const convertAStringToANumber = function(string) {
    return +string;
  };
  const consumeTheRemnantsOfABadURL = function() {
    while (consume()) {
      if (code === 41 || eof()) {
        return;
      } else if (startsWithAValidEscape()) {
        consumeEscape();
        donothing();
      } else {
        donothing();
      }
    }
  };
  let iterationCount = 0;
  while (!eof(next())) {
    tokens.push(consumeAToken());
    iterationCount++;
    if (iterationCount > str.length * 2)
      throw new Error("I'm infinite-looping!");
  }
  return tokens;
}
var CSSParserToken = class {
  constructor() {
    this.tokenType = "";
  }
  toJSON() {
    return { token: this.tokenType };
  }
  toString() {
    return this.tokenType;
  }
  toSource() {
    return "" + this;
  }
};
var BadStringToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "BADSTRING";
  }
};
var BadURLToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "BADURL";
  }
};
var WhitespaceToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "WHITESPACE";
  }
  toString() {
    return "WS";
  }
  toSource() {
    return " ";
  }
};
var CDOToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "CDO";
  }
  toSource() {
    return "<!--";
  }
};
var CDCToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "CDC";
  }
  toSource() {
    return "-->";
  }
};
var ColonToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ":";
  }
};
var SemicolonToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ";";
  }
};
var CommaToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ",";
  }
};
var GroupingToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.value = "";
    this.mirror = "";
  }
};
var OpenCurlyToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "{";
    this.value = "{";
    this.mirror = "}";
  }
};
var CloseCurlyToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "}";
    this.value = "}";
    this.mirror = "{";
  }
};
var OpenSquareToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "[";
    this.value = "[";
    this.mirror = "]";
  }
};
var CloseSquareToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "]";
    this.value = "]";
    this.mirror = "[";
  }
};
var OpenParenToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "(";
    this.value = "(";
    this.mirror = ")";
  }
};
var CloseParenToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = ")";
    this.value = ")";
    this.mirror = "(";
  }
};
var IncludeMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "~=";
  }
};
var DashMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "|=";
  }
};
var PrefixMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "^=";
  }
};
var SuffixMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "$=";
  }
};
var SubstringMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "*=";
  }
};
var ColumnToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "||";
  }
};
var EOFToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "EOF";
  }
  toSource() {
    return "";
  }
};
var DelimToken = class extends CSSParserToken {
  constructor(code) {
    super();
    this.tokenType = "DELIM";
    this.value = "";
    this.value = stringFromCode(code);
  }
  toString() {
    return "DELIM(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    return json;
  }
  toSource() {
    if (this.value === "\\\\")
      return "\\\\\\n";
    else
      return this.value;
  }
};
var StringValuedToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.value = "";
  }
  ASCIIMatch(str) {
    return this.value.toLowerCase() === str.toLowerCase();
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    return json;
  }
};
var IdentToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "IDENT";
    this.value = val;
  }
  toString() {
    return "IDENT(" + this.value + ")";
  }
  toSource() {
    return escapeIdent(this.value);
  }
};
var FunctionToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "FUNCTION";
    this.value = val;
    this.mirror = ")";
  }
  toString() {
    return "FUNCTION(" + this.value + ")";
  }
  toSource() {
    return escapeIdent(this.value) + "(";
  }
};
var AtKeywordToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "AT-KEYWORD";
    this.value = val;
  }
  toString() {
    return "AT(" + this.value + ")";
  }
  toSource() {
    return "@" + escapeIdent(this.value);
  }
};
var HashToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "HASH";
    this.value = val;
    this.type = "unrestricted";
  }
  toString() {
    return "HASH(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.type = this.type;
    return json;
  }
  toSource() {
    if (this.type === "id")
      return "#" + escapeIdent(this.value);
    else
      return "#" + escapeHash(this.value);
  }
};
var StringToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "STRING";
    this.value = val;
  }
  toString() {
    return '"' + escapeString(this.value) + '"';
  }
};
var URLToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "URL";
    this.value = val;
  }
  toString() {
    return "URL(" + this.value + ")";
  }
  toSource() {
    return 'url("' + escapeString(this.value) + '")';
  }
};
var NumberToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "NUMBER";
    this.type = "integer";
    this.repr = "";
  }
  toString() {
    if (this.type === "integer")
      return "INT(" + this.value + ")";
    return "NUMBER(" + this.value + ")";
  }
  toJSON() {
    const json = super.toJSON();
    json.value = this.value;
    json.type = this.type;
    json.repr = this.repr;
    return json;
  }
  toSource() {
    return this.repr;
  }
};
var PercentageToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "PERCENTAGE";
    this.repr = "";
  }
  toString() {
    return "PERCENTAGE(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.repr = this.repr;
    return json;
  }
  toSource() {
    return this.repr + "%";
  }
};
var DimensionToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "DIMENSION";
    this.type = "integer";
    this.repr = "";
    this.unit = "";
  }
  toString() {
    return "DIM(" + this.value + "," + this.unit + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.type = this.type;
    json.repr = this.repr;
    json.unit = this.unit;
    return json;
  }
  toSource() {
    const source = this.repr;
    let unit = escapeIdent(this.unit);
    if (unit[0].toLowerCase() === "e" && (unit[1] === "-" || between(unit.charCodeAt(1), 48, 57))) {
      unit = "\\\\65 " + unit.slice(1, unit.length);
    }
    return source + unit;
  }
};
function escapeIdent(string) {
  string = "" + string;
  let result = "";
  const firstcode = string.charCodeAt(0);
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (between(code, 1, 31) || code === 127 || i === 0 && between(code, 48, 57) || i === 1 && between(code, 48, 57) && firstcode === 45)
      result += "\\\\" + code.toString(16) + " ";
    else if (code >= 128 || code === 45 || code === 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122))
      result += string[i];
    else
      result += "\\\\" + string[i];
  }
  return result;
}
function escapeHash(string) {
  string = "" + string;
  let result = "";
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (code >= 128 || code === 45 || code === 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122))
      result += string[i];
    else
      result += "\\\\" + code.toString(16) + " ";
  }
  return result;
}
function escapeString(string) {
  string = "" + string;
  let result = "";
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (between(code, 1, 31) || code === 127)
      result += "\\\\" + code.toString(16) + " ";
    else if (code === 34 || code === 92)
      result += "\\\\" + string[i];
    else
      result += string[i];
  }
  return result;
}

// packages/playwright-core/src/utils/isomorphic/cssParser.ts
var InvalidSelectorError = class extends Error {
};
function parseCSS(selector, customNames) {
  let tokens;
  try {
    tokens = tokenize(selector);
    if (!(tokens[tokens.length - 1] instanceof EOFToken))
      tokens.push(new EOFToken());
  } catch (e) {
    const newMessage = e.message + \` while parsing selector "\${selector}"\`;
    const index = (e.stack || "").indexOf(e.message);
    if (index !== -1)
      e.stack = e.stack.substring(0, index) + newMessage + e.stack.substring(index + e.message.length);
    e.message = newMessage;
    throw e;
  }
  const unsupportedToken = tokens.find((token) => {
    return token instanceof AtKeywordToken || token instanceof BadStringToken || token instanceof BadURLToken || token instanceof ColumnToken || token instanceof CDOToken || token instanceof CDCToken || token instanceof SemicolonToken || // TODO: Consider using these for something, e.g. to escape complex strings.
    // For example :xpath{ (//div/bar[@attr="foo"])[2]/baz }
    // Or this way :xpath( {complex-xpath-goes-here("hello")} )
    token instanceof OpenCurlyToken || token instanceof CloseCurlyToken || // TODO: Consider treating these as strings?
    token instanceof URLToken || token instanceof PercentageToken;
  });
  if (unsupportedToken)
    throw new InvalidSelectorError(\`Unsupported token "\${unsupportedToken.toSource()}" while parsing selector "\${selector}"\`);
  let pos = 0;
  const names = /* @__PURE__ */ new Set();
  function unexpected() {
    return new InvalidSelectorError(\`Unexpected token "\${tokens[pos].toSource()}" while parsing selector "\${selector}"\`);
  }
  function skipWhitespace() {
    while (tokens[pos] instanceof WhitespaceToken)
      pos++;
  }
  function isIdent(p = pos) {
    return tokens[p] instanceof IdentToken;
  }
  function isString(p = pos) {
    return tokens[p] instanceof StringToken;
  }
  function isNumber(p = pos) {
    return tokens[p] instanceof NumberToken;
  }
  function isComma(p = pos) {
    return tokens[p] instanceof CommaToken;
  }
  function isOpenParen(p = pos) {
    return tokens[p] instanceof OpenParenToken;
  }
  function isCloseParen(p = pos) {
    return tokens[p] instanceof CloseParenToken;
  }
  function isFunction(p = pos) {
    return tokens[p] instanceof FunctionToken;
  }
  function isStar(p = pos) {
    return tokens[p] instanceof DelimToken && tokens[p].value === "*";
  }
  function isEOF(p = pos) {
    return tokens[p] instanceof EOFToken;
  }
  function isClauseCombinator(p = pos) {
    return tokens[p] instanceof DelimToken && [">", "+", "~"].includes(tokens[p].value);
  }
  function isSelectorClauseEnd(p = pos) {
    return isComma(p) || isCloseParen(p) || isEOF(p) || isClauseCombinator(p) || tokens[p] instanceof WhitespaceToken;
  }
  function consumeFunctionArguments() {
    const result2 = [consumeArgument()];
    while (true) {
      skipWhitespace();
      if (!isComma())
        break;
      pos++;
      result2.push(consumeArgument());
    }
    return result2;
  }
  function consumeArgument() {
    skipWhitespace();
    if (isNumber())
      return tokens[pos++].value;
    if (isString())
      return tokens[pos++].value;
    return consumeComplexSelector();
  }
  function consumeComplexSelector() {
    const result2 = { simples: [] };
    skipWhitespace();
    if (isClauseCombinator()) {
      result2.simples.push({ selector: { functions: [{ name: "scope", args: [] }] }, combinator: "" });
    } else {
      result2.simples.push({ selector: consumeSimpleSelector(), combinator: "" });
    }
    while (true) {
      skipWhitespace();
      if (isClauseCombinator()) {
        result2.simples[result2.simples.length - 1].combinator = tokens[pos++].value;
        skipWhitespace();
      } else if (isSelectorClauseEnd()) {
        break;
      }
      result2.simples.push({ combinator: "", selector: consumeSimpleSelector() });
    }
    return result2;
  }
  function consumeSimpleSelector() {
    let rawCSSString = "";
    const functions = [];
    while (!isSelectorClauseEnd()) {
      if (isIdent() || isStar()) {
        rawCSSString += tokens[pos++].toSource();
      } else if (tokens[pos] instanceof HashToken) {
        rawCSSString += tokens[pos++].toSource();
      } else if (tokens[pos] instanceof DelimToken && tokens[pos].value === ".") {
        pos++;
        if (isIdent())
          rawCSSString += "." + tokens[pos++].toSource();
        else
          throw unexpected();
      } else if (tokens[pos] instanceof ColonToken) {
        pos++;
        if (isIdent()) {
          if (!customNames.has(tokens[pos].value.toLowerCase())) {
            rawCSSString += ":" + tokens[pos++].toSource();
          } else {
            const name = tokens[pos++].value.toLowerCase();
            functions.push({ name, args: [] });
            names.add(name);
          }
        } else if (isFunction()) {
          const name = tokens[pos++].value.toLowerCase();
          if (!customNames.has(name)) {
            rawCSSString += \`:\${name}(\${consumeBuiltinFunctionArguments()})\`;
          } else {
            functions.push({ name, args: consumeFunctionArguments() });
            names.add(name);
          }
          skipWhitespace();
          if (!isCloseParen())
            throw unexpected();
          pos++;
        } else {
          throw unexpected();
        }
      } else if (tokens[pos] instanceof OpenSquareToken) {
        rawCSSString += "[";
        pos++;
        while (!(tokens[pos] instanceof CloseSquareToken) && !isEOF())
          rawCSSString += tokens[pos++].toSource();
        if (!(tokens[pos] instanceof CloseSquareToken))
          throw unexpected();
        rawCSSString += "]";
        pos++;
      } else {
        throw unexpected();
      }
    }
    if (!rawCSSString && !functions.length)
      throw unexpected();
    return { css: rawCSSString || void 0, functions };
  }
  function consumeBuiltinFunctionArguments() {
    let s = "";
    let balance = 1;
    while (!isEOF()) {
      if (isOpenParen() || isFunction())
        balance++;
      if (isCloseParen())
        balance--;
      if (!balance)
        break;
      s += tokens[pos++].toSource();
    }
    return s;
  }
  const result = consumeFunctionArguments();
  if (!isEOF())
    throw unexpected();
  if (result.some((arg) => typeof arg !== "object" || !("simples" in arg)))
    throw new InvalidSelectorError(\`Error while parsing selector "\${selector}"\`);
  return { selector: result, names: Array.from(names) };
}

// packages/playwright-core/src/utils/isomorphic/selectorParser.ts
var kNestedSelectorNames = /* @__PURE__ */ new Set(["internal:has", "internal:has-not", "internal:and", "internal:or", "internal:chain", "left-of", "right-of", "above", "below", "near"]);
var kNestedSelectorNamesWithDistance = /* @__PURE__ */ new Set(["left-of", "right-of", "above", "below", "near"]);
var customCSSNames = /* @__PURE__ */ new Set(["not", "is", "where", "has", "scope", "light", "visible", "text", "text-matches", "text-is", "has-text", "above", "below", "right-of", "left-of", "near", "nth-match"]);
function parseSelector(selector) {
  const parsedStrings = parseSelectorString(selector);
  const parts = [];
  for (const part of parsedStrings.parts) {
    if (part.name === "css" || part.name === "css:light") {
      if (part.name === "css:light")
        part.body = ":light(" + part.body + ")";
      const parsedCSS = parseCSS(part.body, customCSSNames);
      parts.push({
        name: "css",
        body: parsedCSS.selector,
        source: part.body
      });
      continue;
    }
    if (kNestedSelectorNames.has(part.name)) {
      let innerSelector;
      let distance;
      try {
        const unescaped = JSON.parse("[" + part.body + "]");
        if (!Array.isArray(unescaped) || unescaped.length < 1 || unescaped.length > 2 || typeof unescaped[0] !== "string")
          throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
        innerSelector = unescaped[0];
        if (unescaped.length === 2) {
          if (typeof unescaped[1] !== "number" || !kNestedSelectorNamesWithDistance.has(part.name))
            throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
          distance = unescaped[1];
        }
      } catch (e) {
        throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
      }
      const nested = { name: part.name, source: part.body, body: { parsed: parseSelector(innerSelector), distance } };
      const lastFrame = [...nested.body.parsed.parts].reverse().find((part2) => part2.name === "internal:control" && part2.body === "enter-frame");
      const lastFrameIndex = lastFrame ? nested.body.parsed.parts.indexOf(lastFrame) : -1;
      if (lastFrameIndex !== -1 && selectorPartsEqual(nested.body.parsed.parts.slice(0, lastFrameIndex + 1), parts.slice(0, lastFrameIndex + 1)))
        nested.body.parsed.parts.splice(0, lastFrameIndex + 1);
      parts.push(nested);
      continue;
    }
    parts.push({ ...part, source: part.body });
  }
  if (kNestedSelectorNames.has(parts[0].name))
    throw new InvalidSelectorError(\`"\${parts[0].name}" selector cannot be first\`);
  return {
    capture: parsedStrings.capture,
    parts
  };
}
function selectorPartsEqual(list1, list2) {
  return stringifySelector({ parts: list1 }) === stringifySelector({ parts: list2 });
}
function stringifySelector(selector, forceEngineName) {
  if (typeof selector === "string")
    return selector;
  return selector.parts.map((p, i) => {
    let includeEngine = true;
    if (!forceEngineName && i !== selector.capture) {
      if (p.name === "css")
        includeEngine = false;
      else if (p.name === "xpath" && p.source.startsWith("//") || p.source.startsWith(".."))
        includeEngine = false;
    }
    const prefix = includeEngine ? p.name + "=" : "";
    return \`\${i === selector.capture ? "*" : ""}\${prefix}\${p.source}\`;
  }).join(" >> ");
}
function visitAllSelectorParts(selector, visitor) {
  const visit = (selector2, nested) => {
    for (const part of selector2.parts) {
      visitor(part, nested);
      if (kNestedSelectorNames.has(part.name))
        visit(part.body.parsed, true);
    }
  };
  visit(selector, false);
}
function parseSelectorString(selector) {
  let index = 0;
  let quote;
  let start = 0;
  const result = { parts: [] };
  const append = () => {
    const part = selector.substring(start, index).trim();
    const eqIndex = part.indexOf("=");
    let name;
    let body;
    if (eqIndex !== -1 && part.substring(0, eqIndex).trim().match(/^[a-zA-Z_0-9-+:*]+$/)) {
      name = part.substring(0, eqIndex).trim();
      body = part.substring(eqIndex + 1);
    } else if (part.length > 1 && part[0] === '"' && part[part.length - 1] === '"') {
      name = "text";
      body = part;
    } else if (part.length > 1 && part[0] === "'" && part[part.length - 1] === "'") {
      name = "text";
      body = part;
    } else if (/^\\(*\\/\\//.test(part) || part.startsWith("..")) {
      name = "xpath";
      body = part;
    } else {
      name = "css";
      body = part;
    }
    let capture = false;
    if (name[0] === "*") {
      capture = true;
      name = name.substring(1);
    }
    result.parts.push({ name, body });
    if (capture) {
      if (result.capture !== void 0)
        throw new InvalidSelectorError(\`Only one of the selectors can capture using * modifier\`);
      result.capture = result.parts.length - 1;
    }
  };
  if (!selector.includes(">>")) {
    index = selector.length;
    append();
    return result;
  }
  const shouldIgnoreTextSelectorQuote = () => {
    const prefix = selector.substring(start, index);
    const match = prefix.match(/^\\s*text\\s*=(.*)$/);
    return !!match && !!match[1];
  };
  while (index < selector.length) {
    const c = selector[index];
    if (c === "\\\\" && index + 1 < selector.length) {
      index += 2;
    } else if (c === quote) {
      quote = void 0;
      index++;
    } else if (!quote && (c === '"' || c === "'" || c === "\`") && !shouldIgnoreTextSelectorQuote()) {
      quote = c;
      index++;
    } else if (!quote && c === ">" && selector[index + 1] === ">") {
      append();
      index += 2;
      start = index;
    } else {
      index++;
    }
  }
  append();
  return result;
}
function parseAttributeSelector(selector, allowUnquotedStrings) {
  let wp = 0;
  let EOL = selector.length === 0;
  const next = () => selector[wp] || "";
  const eat1 = () => {
    const result2 = next();
    ++wp;
    EOL = wp >= selector.length;
    return result2;
  };
  const syntaxError = (stage) => {
    if (EOL)
      throw new InvalidSelectorError(\`Unexpected end of selector while parsing selector \\\`\${selector}\\\`\`);
    throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - unexpected symbol "\${next()}" at position \${wp}\` + (stage ? " during " + stage : ""));
  };
  function skipSpaces() {
    while (!EOL && /\\s/.test(next()))
      eat1();
  }
  function isCSSNameChar(char) {
    return char >= "\\x80" || char >= "0" && char <= "9" || char >= "A" && char <= "Z" || char >= "a" && char <= "z" || char >= "0" && char <= "9" || char === "_" || char === "-";
  }
  function readIdentifier() {
    let result2 = "";
    skipSpaces();
    while (!EOL && isCSSNameChar(next()))
      result2 += eat1();
    return result2;
  }
  function readQuotedString(quote) {
    let result2 = eat1();
    if (result2 !== quote)
      syntaxError("parsing quoted string");
    while (!EOL && next() !== quote) {
      if (next() === "\\\\")
        eat1();
      result2 += eat1();
    }
    if (next() !== quote)
      syntaxError("parsing quoted string");
    result2 += eat1();
    return result2;
  }
  function readRegularExpression() {
    if (eat1() !== "/")
      syntaxError("parsing regular expression");
    let source = "";
    let inClass = false;
    while (!EOL) {
      if (next() === "\\\\") {
        source += eat1();
        if (EOL)
          syntaxError("parsing regular expression");
      } else if (inClass && next() === "]") {
        inClass = false;
      } else if (!inClass && next() === "[") {
        inClass = true;
      } else if (!inClass && next() === "/") {
        break;
      }
      source += eat1();
    }
    if (eat1() !== "/")
      syntaxError("parsing regular expression");
    let flags = "";
    while (!EOL && next().match(/[dgimsuy]/))
      flags += eat1();
    try {
      return new RegExp(source, flags);
    } catch (e) {
      throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\`: \${e.message}\`);
    }
  }
  function readAttributeToken() {
    let token = "";
    skipSpaces();
    if (next() === \`'\` || next() === \`"\`)
      token = readQuotedString(next()).slice(1, -1);
    else
      token = readIdentifier();
    if (!token)
      syntaxError("parsing property path");
    return token;
  }
  function readOperator() {
    skipSpaces();
    let op = "";
    if (!EOL)
      op += eat1();
    if (!EOL && op !== "=")
      op += eat1();
    if (!["=", "*=", "^=", "$=", "|=", "~="].includes(op))
      syntaxError("parsing operator");
    return op;
  }
  function readAttribute() {
    eat1();
    const jsonPath = [];
    jsonPath.push(readAttributeToken());
    skipSpaces();
    while (next() === ".") {
      eat1();
      jsonPath.push(readAttributeToken());
      skipSpaces();
    }
    if (next() === "]") {
      eat1();
      return { name: jsonPath.join("."), jsonPath, op: "<truthy>", value: null, caseSensitive: false };
    }
    const operator = readOperator();
    let value = void 0;
    let caseSensitive = true;
    skipSpaces();
    if (next() === "/") {
      if (operator !== "=")
        throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - cannot use \${operator} in attribute with regular expression\`);
      value = readRegularExpression();
    } else if (next() === \`'\` || next() === \`"\`) {
      value = readQuotedString(next()).slice(1, -1);
      skipSpaces();
      if (next() === "i" || next() === "I") {
        caseSensitive = false;
        eat1();
      } else if (next() === "s" || next() === "S") {
        caseSensitive = true;
        eat1();
      }
    } else {
      value = "";
      while (!EOL && (isCSSNameChar(next()) || next() === "+" || next() === "."))
        value += eat1();
      if (value === "true") {
        value = true;
      } else if (value === "false") {
        value = false;
      } else {
        if (!allowUnquotedStrings) {
          value = +value;
          if (Number.isNaN(value))
            syntaxError("parsing attribute value");
        }
      }
    }
    skipSpaces();
    if (next() !== "]")
      syntaxError("parsing attribute value");
    eat1();
    if (operator !== "=" && typeof value !== "string")
      throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - cannot use \${operator} in attribute with non-string matching value - \${value}\`);
    return { name: jsonPath.join("."), jsonPath, op: operator, value, caseSensitive };
  }
  const result = {
    name: "",
    attributes: []
  };
  result.name = readIdentifier();
  skipSpaces();
  while (next() === "[") {
    result.attributes.push(readAttribute());
    skipSpaces();
  }
  if (!EOL)
    syntaxError(void 0);
  if (!result.name && !result.attributes.length)
    throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - selector cannot be empty\`);
  return result;
}

// packages/playwright-core/src/server/injected/reactSelectorEngine.ts
function getFunctionComponentName(component) {
  return component.displayName || component.name || "Anonymous";
}
function getComponentName(reactElement) {
  if (reactElement.type) {
    switch (typeof reactElement.type) {
      case "function":
        return getFunctionComponentName(reactElement.type);
      case "string":
        return reactElement.type;
      case "object":
        return reactElement.type.displayName || (reactElement.type.render ? getFunctionComponentName(reactElement.type.render) : "");
    }
  }
  if (reactElement._currentElement) {
    const elementType = reactElement._currentElement.type;
    if (typeof elementType === "string")
      return elementType;
    if (typeof elementType === "function")
      return elementType.displayName || elementType.name || "Anonymous";
  }
  return "";
}
function getComponentKey(reactElement) {
  var _a, _b;
  return (_b = reactElement.key) != null ? _b : (_a = reactElement._currentElement) == null ? void 0 : _a.key;
}
function getChildren(reactElement) {
  if (reactElement.child) {
    const children = [];
    for (let child = reactElement.child; child; child = child.sibling)
      children.push(child);
    return children;
  }
  if (!reactElement._currentElement)
    return [];
  const isKnownElement = (reactElement2) => {
    var _a;
    const elementType = (_a = reactElement2._currentElement) == null ? void 0 : _a.type;
    return typeof elementType === "function" || typeof elementType === "string";
  };
  if (reactElement._renderedComponent) {
    const child = reactElement._renderedComponent;
    return isKnownElement(child) ? [child] : [];
  }
  if (reactElement._renderedChildren)
    return [...Object.values(reactElement._renderedChildren)].filter(isKnownElement);
  return [];
}
function getProps(reactElement) {
  var _a;
  const props = (
    // React 16+
    reactElement.memoizedProps || // React 15
    ((_a = reactElement._currentElement) == null ? void 0 : _a.props)
  );
  if (!props || typeof props === "string")
    return props;
  const result = { ...props };
  delete result.children;
  return result;
}
function buildComponentsTree(reactElement) {
  var _a;
  const treeNode = {
    key: getComponentKey(reactElement),
    name: getComponentName(reactElement),
    children: getChildren(reactElement).map(buildComponentsTree),
    rootElements: [],
    props: getProps(reactElement)
  };
  const rootElement = (
    // React 16+
    // @see https://github.com/baruchvlz/resq/blob/5c15a5e04d3f7174087248f5a158c3d6dcc1ec72/src/utils.js#L29
    reactElement.stateNode || // React 15
    reactElement._hostNode || ((_a = reactElement._renderedComponent) == null ? void 0 : _a._hostNode)
  );
  if (rootElement instanceof Element) {
    treeNode.rootElements.push(rootElement);
  } else {
    for (const child of treeNode.children)
      treeNode.rootElements.push(...child.rootElements);
  }
  return treeNode;
}
function filterComponentsTree(treeNode, searchFn, result = []) {
  if (searchFn(treeNode))
    result.push(treeNode);
  for (const child of treeNode.children)
    filterComponentsTree(child, searchFn, result);
  return result;
}
function findReactRoots(root, roots = []) {
  const document = root.ownerDocument || root;
  const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT);
  do {
    const node = walker.currentNode;
    const reactNode = node;
    const rootKey = Object.keys(reactNode).find((key) => key.startsWith("__reactContainer") && reactNode[key] !== null);
    if (rootKey) {
      roots.push(reactNode[rootKey].stateNode.current);
    } else {
      const legacyRootKey = "_reactRootContainer";
      if (reactNode.hasOwnProperty(legacyRootKey) && reactNode[legacyRootKey] !== null) {
        roots.push(reactNode[legacyRootKey]._internalRoot.current);
      }
    }
    if (node instanceof Element && node.hasAttribute("data-reactroot")) {
      for (const key of Object.keys(node)) {
        if (key.startsWith("__reactInternalInstance") || key.startsWith("__reactFiber"))
          roots.push(node[key]);
      }
    }
    const shadowRoot = node instanceof Element ? node.shadowRoot : null;
    if (shadowRoot)
      findReactRoots(shadowRoot, roots);
  } while (walker.nextNode());
  return roots;
}
var ReactEngine = {
  queryAll(scope, selector) {
    const { name, attributes } = parseAttributeSelector(selector, false);
    const reactRoots = findReactRoots(scope.ownerDocument || scope);
    const trees = reactRoots.map((reactRoot) => buildComponentsTree(reactRoot));
    const treeNodes = trees.map((tree) => filterComponentsTree(tree, (treeNode) => {
      var _a;
      const props = (_a = treeNode.props) != null ? _a : {};
      if (treeNode.key !== void 0)
        props.key = treeNode.key;
      if (name && treeNode.name !== name)
        return false;
      if (treeNode.rootElements.some((domNode) => !isInsideScope(scope, domNode)))
        return false;
      for (const attr of attributes) {
        if (!matchesComponentAttribute(props, attr))
          return false;
      }
      return true;
    })).flat();
    const allRootElements = /* @__PURE__ */ new Set();
    for (const treeNode of treeNodes) {
      for (const domNode of treeNode.rootElements)
        allRootElements.add(domNode);
    }
    return [...allRootElements];
  }
};

// packages/playwright-core/src/server/injected/vueSelectorEngine.ts
function basename(filename, ext) {
  const normalized = filename.replace(/^[a-zA-Z]:/, "").replace(/\\\\/g, "/");
  let result = normalized.substring(normalized.lastIndexOf("/") + 1);
  if (ext && result.endsWith(ext))
    result = result.substring(0, result.length - ext.length);
  return result;
}
function toUpper(_, c) {
  return c ? c.toUpperCase() : "";
}
var classifyRE = /(?:^|[-_/])(\\w)/g;
var classify = (str) => {
  return str && str.replace(classifyRE, toUpper);
};
function buildComponentsTreeVue3(instance) {
  function getComponentTypeName(options) {
    const name = options.name || options._componentTag || options.__playwright_guessedName;
    if (name)
      return name;
    const file = options.__file;
    if (file)
      return classify(basename(file, ".vue"));
  }
  function saveComponentName(instance2, key) {
    instance2.type.__playwright_guessedName = key;
    return key;
  }
  function getInstanceName(instance2) {
    var _a, _b, _c, _d;
    const name = getComponentTypeName(instance2.type || {});
    if (name)
      return name;
    if (instance2.root === instance2)
      return "Root";
    for (const key in (_b = (_a = instance2.parent) == null ? void 0 : _a.type) == null ? void 0 : _b.components) {
      if (((_c = instance2.parent) == null ? void 0 : _c.type.components[key]) === instance2.type)
        return saveComponentName(instance2, key);
    }
    for (const key in (_d = instance2.appContext) == null ? void 0 : _d.components) {
      if (instance2.appContext.components[key] === instance2.type)
        return saveComponentName(instance2, key);
    }
    return "Anonymous Component";
  }
  function isBeingDestroyed(instance2) {
    return instance2._isBeingDestroyed || instance2.isUnmounted;
  }
  function isFragment(instance2) {
    return instance2.subTree.type.toString() === "Symbol(Fragment)";
  }
  function getInternalInstanceChildren(subTree) {
    const list = [];
    if (subTree.component)
      list.push(subTree.component);
    if (subTree.suspense)
      list.push(...getInternalInstanceChildren(subTree.suspense.activeBranch));
    if (Array.isArray(subTree.children)) {
      subTree.children.forEach((childSubTree) => {
        if (childSubTree.component)
          list.push(childSubTree.component);
        else
          list.push(...getInternalInstanceChildren(childSubTree));
      });
    }
    return list.filter((child) => {
      var _a;
      return !isBeingDestroyed(child) && !((_a = child.type.devtools) == null ? void 0 : _a.hide);
    });
  }
  function getRootElementsFromComponentInstance(instance2) {
    if (isFragment(instance2))
      return getFragmentRootElements(instance2.subTree);
    return [instance2.subTree.el];
  }
  function getFragmentRootElements(vnode) {
    if (!vnode.children)
      return [];
    const list = [];
    for (let i = 0, l = vnode.children.length; i < l; i++) {
      const childVnode = vnode.children[i];
      if (childVnode.component)
        list.push(...getRootElementsFromComponentInstance(childVnode.component));
      else if (childVnode.el)
        list.push(childVnode.el);
    }
    return list;
  }
  function buildComponentsTree2(instance2) {
    return {
      name: getInstanceName(instance2),
      children: getInternalInstanceChildren(instance2.subTree).map(buildComponentsTree2),
      rootElements: getRootElementsFromComponentInstance(instance2),
      props: instance2.props
    };
  }
  return buildComponentsTree2(instance);
}
function buildComponentsTreeVue2(instance) {
  function getComponentName2(options) {
    const name = options.displayName || options.name || options._componentTag;
    if (name)
      return name;
    const file = options.__file;
    if (file)
      return classify(basename(file, ".vue"));
  }
  function getInstanceName(instance2) {
    const name = getComponentName2(instance2.$options || instance2.fnOptions || {});
    if (name)
      return name;
    return instance2.$root === instance2 ? "Root" : "Anonymous Component";
  }
  function getInternalInstanceChildren(instance2) {
    if (instance2.$children)
      return instance2.$children;
    if (Array.isArray(instance2.subTree.children))
      return instance2.subTree.children.filter((vnode) => !!vnode.component).map((vnode) => vnode.component);
    return [];
  }
  function buildComponentsTree2(instance2) {
    return {
      name: getInstanceName(instance2),
      children: getInternalInstanceChildren(instance2).map(buildComponentsTree2),
      rootElements: [instance2.$el],
      props: instance2._props
    };
  }
  return buildComponentsTree2(instance);
}
function filterComponentsTree2(treeNode, searchFn, result = []) {
  if (searchFn(treeNode))
    result.push(treeNode);
  for (const child of treeNode.children)
    filterComponentsTree2(child, searchFn, result);
  return result;
}
function findVueRoots(root, roots = []) {
  const document = root.ownerDocument || root;
  const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT);
  const vue2Roots = /* @__PURE__ */ new Set();
  do {
    const node = walker.currentNode;
    if (node.__vue__)
      vue2Roots.add(node.__vue__.$root);
    if (node.__vue_app__ && node._vnode && node._vnode.component)
      roots.push({ root: node._vnode.component, version: 3 });
    const shadowRoot = node instanceof Element ? node.shadowRoot : null;
    if (shadowRoot)
      findVueRoots(shadowRoot, roots);
  } while (walker.nextNode());
  for (const vue2root of vue2Roots) {
    roots.push({
      version: 2,
      root: vue2root
    });
  }
  return roots;
}
var VueEngine = {
  queryAll(scope, selector) {
    const document = scope.ownerDocument || scope;
    const { name, attributes } = parseAttributeSelector(selector, false);
    const vueRoots = findVueRoots(document);
    const trees = vueRoots.map((vueRoot) => vueRoot.version === 3 ? buildComponentsTreeVue3(vueRoot.root) : buildComponentsTreeVue2(vueRoot.root));
    const treeNodes = trees.map((tree) => filterComponentsTree2(tree, (treeNode) => {
      if (name && treeNode.name !== name)
        return false;
      if (treeNode.rootElements.some((rootElement) => !isInsideScope(scope, rootElement)))
        return false;
      for (const attr of attributes) {
        if (!matchesComponentAttribute(treeNode.props, attr))
          return false;
      }
      return true;
    })).flat();
    const allRootElements = /* @__PURE__ */ new Set();
    for (const treeNode of treeNodes) {
      for (const rootElement of treeNode.rootElements)
        allRootElements.add(rootElement);
    }
    return [...allRootElements];
  }
};

// packages/playwright-core/src/server/injected/roleSelectorEngine.ts
var kSupportedAttributes = ["selected", "checked", "pressed", "expanded", "level", "disabled", "name", "include-hidden"];
kSupportedAttributes.sort();
function validateSupportedRole(attr, roles, role) {
  if (!roles.includes(role))
    throw new Error(\`"\${attr}" attribute is only supported for roles: \${roles.slice().sort().map((role2) => \`"\${role2}"\`).join(", ")}\`);
}
function validateSupportedValues(attr, values) {
  if (attr.op !== "<truthy>" && !values.includes(attr.value))
    throw new Error(\`"\${attr.name}" must be one of \${values.map((v) => JSON.stringify(v)).join(", ")}\`);
}
function validateSupportedOp(attr, ops) {
  if (!ops.includes(attr.op))
    throw new Error(\`"\${attr.name}" does not support "\${attr.op}" matcher\`);
}
function validateAttributes(attrs, role) {
  const options = { role };
  for (const attr of attrs) {
    switch (attr.name) {
      case "checked": {
        validateSupportedRole(attr.name, kAriaCheckedRoles, role);
        validateSupportedValues(attr, [true, false, "mixed"]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.checked = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      case "pressed": {
        validateSupportedRole(attr.name, kAriaPressedRoles, role);
        validateSupportedValues(attr, [true, false, "mixed"]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.pressed = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      case "selected": {
        validateSupportedRole(attr.name, kAriaSelectedRoles, role);
        validateSupportedValues(attr, [true, false]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.selected = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      case "expanded": {
        validateSupportedRole(attr.name, kAriaExpandedRoles, role);
        validateSupportedValues(attr, [true, false]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.expanded = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      case "level": {
        validateSupportedRole(attr.name, kAriaLevelRoles, role);
        if (typeof attr.value === "string")
          attr.value = +attr.value;
        if (attr.op !== "=" || typeof attr.value !== "number" || Number.isNaN(attr.value))
          throw new Error(\`"level" attribute must be compared to a number\`);
        options.level = attr.value;
        break;
      }
      case "disabled": {
        validateSupportedValues(attr, [true, false]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.disabled = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      case "name": {
        if (attr.op === "<truthy>")
          throw new Error(\`"name" attribute must have a value\`);
        if (typeof attr.value !== "string" && !(attr.value instanceof RegExp))
          throw new Error(\`"name" attribute must be a string or a regular expression\`);
        options.name = attr.value;
        options.nameOp = attr.op;
        options.exact = attr.caseSensitive;
        break;
      }
      case "include-hidden": {
        validateSupportedValues(attr, [true, false]);
        validateSupportedOp(attr, ["<truthy>", "="]);
        options.includeHidden = attr.op === "<truthy>" ? true : attr.value;
        break;
      }
      default: {
        throw new Error(\`Unknown attribute "\${attr.name}", must be one of \${kSupportedAttributes.map((a) => \`"\${a}"\`).join(", ")}.\`);
      }
    }
  }
  return options;
}
function queryRole(scope, options, internal) {
  const result = [];
  const match = (element) => {
    if (getAriaRole(element) !== options.role)
      return;
    if (options.selected !== void 0 && getAriaSelected(element) !== options.selected)
      return;
    if (options.checked !== void 0 && getAriaChecked(element) !== options.checked)
      return;
    if (options.pressed !== void 0 && getAriaPressed(element) !== options.pressed)
      return;
    if (options.expanded !== void 0 && getAriaExpanded(element) !== options.expanded)
      return;
    if (options.level !== void 0 && getAriaLevel(element) !== options.level)
      return;
    if (options.disabled !== void 0 && getAriaDisabled(element) !== options.disabled)
      return;
    if (!options.includeHidden) {
      const isHidden = isElementHiddenForAria(element);
      if (isHidden)
        return;
    }
    if (options.name !== void 0) {
      const accessibleName = normalizeWhiteSpace(getElementAccessibleName(element, !!options.includeHidden));
      if (typeof options.name === "string")
        options.name = normalizeWhiteSpace(options.name);
      if (internal && !options.exact && options.nameOp === "=")
        options.nameOp = "*=";
      if (!matchesAttributePart(accessibleName, { name: "", jsonPath: [], op: options.nameOp || "=", value: options.name, caseSensitive: !!options.exact }))
        return;
    }
    result.push(element);
  };
  const query = (root) => {
    const shadows = [];
    if (root.shadowRoot)
      shadows.push(root.shadowRoot);
    for (const element of root.querySelectorAll("*")) {
      match(element);
      if (element.shadowRoot)
        shadows.push(element.shadowRoot);
    }
    shadows.forEach(query);
  };
  query(scope);
  return result;
}
function createRoleEngine(internal) {
  return {
    queryAll: (scope, selector) => {
      const parsed = parseAttributeSelector(selector, true);
      const role = parsed.name.toLowerCase();
      if (!role)
        throw new Error(\`Role must not be empty\`);
      const options = validateAttributes(parsed.attributes, role);
      beginAriaCaches();
      try {
        return queryRole(scope, options, internal);
      } finally {
        endAriaCaches();
      }
    }
  };
}

// packages/playwright-core/src/server/injected/layoutSelectorUtils.ts
function boxRightOf(box1, box2, maxDistance) {
  const distance = box1.left - box2.right;
  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)
    return;
  return distance + Math.max(box2.bottom - box1.bottom, 0) + Math.max(box1.top - box2.top, 0);
}
function boxLeftOf(box1, box2, maxDistance) {
  const distance = box2.left - box1.right;
  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)
    return;
  return distance + Math.max(box2.bottom - box1.bottom, 0) + Math.max(box1.top - box2.top, 0);
}
function boxAbove(box1, box2, maxDistance) {
  const distance = box2.top - box1.bottom;
  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)
    return;
  return distance + Math.max(box1.left - box2.left, 0) + Math.max(box2.right - box1.right, 0);
}
function boxBelow(box1, box2, maxDistance) {
  const distance = box1.top - box2.bottom;
  if (distance < 0 || maxDistance !== void 0 && distance > maxDistance)
    return;
  return distance + Math.max(box1.left - box2.left, 0) + Math.max(box2.right - box1.right, 0);
}
function boxNear(box1, box2, maxDistance) {
  const kThreshold = maxDistance === void 0 ? 50 : maxDistance;
  let score = 0;
  if (box1.left - box2.right >= 0)
    score += box1.left - box2.right;
  if (box2.left - box1.right >= 0)
    score += box2.left - box1.right;
  if (box2.top - box1.bottom >= 0)
    score += box2.top - box1.bottom;
  if (box1.top - box2.bottom >= 0)
    score += box1.top - box2.bottom;
  return score > kThreshold ? void 0 : score;
}
var kLayoutSelectorNames = ["left-of", "right-of", "above", "below", "near"];
function layoutSelectorScore(name, element, inner, maxDistance) {
  const box = element.getBoundingClientRect();
  const scorer = { "left-of": boxLeftOf, "right-of": boxRightOf, "above": boxAbove, "below": boxBelow, "near": boxNear }[name];
  let bestScore;
  for (const e of inner) {
    if (e === element)
      continue;
    const score = scorer(box, e.getBoundingClientRect(), maxDistance);
    if (score === void 0)
      continue;
    if (bestScore === void 0 || score < bestScore)
      bestScore = score;
  }
  return bestScore;
}

// packages/playwright-core/src/server/injected/selectorEvaluator.ts
var SelectorEvaluatorImpl = class {
  constructor(extraEngines) {
    this._engines = /* @__PURE__ */ new Map();
    this._cacheQueryCSS = /* @__PURE__ */ new Map();
    this._cacheMatches = /* @__PURE__ */ new Map();
    this._cacheQuery = /* @__PURE__ */ new Map();
    this._cacheMatchesSimple = /* @__PURE__ */ new Map();
    this._cacheMatchesParents = /* @__PURE__ */ new Map();
    this._cacheCallMatches = /* @__PURE__ */ new Map();
    this._cacheCallQuery = /* @__PURE__ */ new Map();
    this._cacheQuerySimple = /* @__PURE__ */ new Map();
    this._cacheText = /* @__PURE__ */ new Map();
    this._retainCacheCounter = 0;
    for (const [name, engine] of extraEngines)
      this._engines.set(name, engine);
    this._engines.set("not", notEngine);
    this._engines.set("is", isEngine);
    this._engines.set("where", isEngine);
    this._engines.set("has", hasEngine);
    this._engines.set("scope", scopeEngine);
    this._engines.set("light", lightEngine);
    this._engines.set("visible", visibleEngine);
    this._engines.set("text", textEngine);
    this._engines.set("text-is", textIsEngine);
    this._engines.set("text-matches", textMatchesEngine);
    this._engines.set("has-text", hasTextEngine);
    this._engines.set("right-of", createLayoutEngine("right-of"));
    this._engines.set("left-of", createLayoutEngine("left-of"));
    this._engines.set("above", createLayoutEngine("above"));
    this._engines.set("below", createLayoutEngine("below"));
    this._engines.set("near", createLayoutEngine("near"));
    this._engines.set("nth-match", nthMatchEngine);
    const allNames = [...this._engines.keys()];
    allNames.sort();
    const parserNames = [...customCSSNames];
    parserNames.sort();
    if (allNames.join("|") !== parserNames.join("|"))
      throw new Error(\`Please keep customCSSNames in sync with evaluator engines: \${allNames.join("|")} vs \${parserNames.join("|")}\`);
  }
  begin() {
    ++this._retainCacheCounter;
  }
  end() {
    --this._retainCacheCounter;
    if (!this._retainCacheCounter) {
      this._cacheQueryCSS.clear();
      this._cacheMatches.clear();
      this._cacheQuery.clear();
      this._cacheMatchesSimple.clear();
      this._cacheMatchesParents.clear();
      this._cacheCallMatches.clear();
      this._cacheCallQuery.clear();
      this._cacheQuerySimple.clear();
      this._cacheText.clear();
    }
  }
  _cached(cache, main, rest, cb) {
    if (!cache.has(main))
      cache.set(main, []);
    const entries = cache.get(main);
    const entry = entries.find((e) => rest.every((value, index) => e.rest[index] === value));
    if (entry)
      return entry.result;
    const result = cb();
    entries.push({ rest, result });
    return result;
  }
  _checkSelector(s) {
    const wellFormed = typeof s === "object" && s && (Array.isArray(s) || "simples" in s && s.simples.length);
    if (!wellFormed)
      throw new Error(\`Malformed selector "\${s}"\`);
    return s;
  }
  matches(element, s, context) {
    const selector = this._checkSelector(s);
    this.begin();
    try {
      return this._cached(this._cacheMatches, element, [selector, context.scope, context.pierceShadow, context.originalScope], () => {
        if (Array.isArray(selector))
          return this._matchesEngine(isEngine, element, selector, context);
        if (this._hasScopeClause(selector))
          context = this._expandContextForScopeMatching(context);
        if (!this._matchesSimple(element, selector.simples[selector.simples.length - 1].selector, context))
          return false;
        return this._matchesParents(element, selector, selector.simples.length - 2, context);
      });
    } finally {
      this.end();
    }
  }
  query(context, s) {
    const selector = this._checkSelector(s);
    this.begin();
    try {
      return this._cached(this._cacheQuery, selector, [context.scope, context.pierceShadow, context.originalScope], () => {
        if (Array.isArray(selector))
          return this._queryEngine(isEngine, context, selector);
        if (this._hasScopeClause(selector))
          context = this._expandContextForScopeMatching(context);
        const previousScoreMap = this._scoreMap;
        this._scoreMap = /* @__PURE__ */ new Map();
        let elements = this._querySimple(context, selector.simples[selector.simples.length - 1].selector);
        elements = elements.filter((element) => this._matchesParents(element, selector, selector.simples.length - 2, context));
        if (this._scoreMap.size) {
          elements.sort((a, b) => {
            const aScore = this._scoreMap.get(a);
            const bScore = this._scoreMap.get(b);
            if (aScore === bScore)
              return 0;
            if (aScore === void 0)
              return 1;
            if (bScore === void 0)
              return -1;
            return aScore - bScore;
          });
        }
        this._scoreMap = previousScoreMap;
        return elements;
      });
    } finally {
      this.end();
    }
  }
  _markScore(element, score) {
    if (this._scoreMap)
      this._scoreMap.set(element, score);
  }
  _hasScopeClause(selector) {
    return selector.simples.some((simple) => simple.selector.functions.some((f) => f.name === "scope"));
  }
  _expandContextForScopeMatching(context) {
    if (context.scope.nodeType !== 1)
      return context;
    const scope = parentElementOrShadowHost(context.scope);
    if (!scope)
      return context;
    return { ...context, scope, originalScope: context.originalScope || context.scope };
  }
  _matchesSimple(element, simple, context) {
    return this._cached(this._cacheMatchesSimple, element, [simple, context.scope, context.pierceShadow, context.originalScope], () => {
      if (element === context.scope)
        return false;
      if (simple.css && !this._matchesCSS(element, simple.css))
        return false;
      for (const func of simple.functions) {
        if (!this._matchesEngine(this._getEngine(func.name), element, func.args, context))
          return false;
      }
      return true;
    });
  }
  _querySimple(context, simple) {
    if (!simple.functions.length)
      return this._queryCSS(context, simple.css || "*");
    return this._cached(this._cacheQuerySimple, simple, [context.scope, context.pierceShadow, context.originalScope], () => {
      let css = simple.css;
      const funcs = simple.functions;
      if (css === "*" && funcs.length)
        css = void 0;
      let elements;
      let firstIndex = -1;
      if (css !== void 0) {
        elements = this._queryCSS(context, css);
      } else {
        firstIndex = funcs.findIndex((func) => this._getEngine(func.name).query !== void 0);
        if (firstIndex === -1)
          firstIndex = 0;
        elements = this._queryEngine(this._getEngine(funcs[firstIndex].name), context, funcs[firstIndex].args);
      }
      for (let i = 0; i < funcs.length; i++) {
        if (i === firstIndex)
          continue;
        const engine = this._getEngine(funcs[i].name);
        if (engine.matches !== void 0)
          elements = elements.filter((e) => this._matchesEngine(engine, e, funcs[i].args, context));
      }
      for (let i = 0; i < funcs.length; i++) {
        if (i === firstIndex)
          continue;
        const engine = this._getEngine(funcs[i].name);
        if (engine.matches === void 0)
          elements = elements.filter((e) => this._matchesEngine(engine, e, funcs[i].args, context));
      }
      return elements;
    });
  }
  _matchesParents(element, complex, index, context) {
    if (index < 0)
      return true;
    return this._cached(this._cacheMatchesParents, element, [complex, index, context.scope, context.pierceShadow, context.originalScope], () => {
      const { selector: simple, combinator } = complex.simples[index];
      if (combinator === ">") {
        const parent = parentElementOrShadowHostInContext(element, context);
        if (!parent || !this._matchesSimple(parent, simple, context))
          return false;
        return this._matchesParents(parent, complex, index - 1, context);
      }
      if (combinator === "+") {
        const previousSibling = previousSiblingInContext(element, context);
        if (!previousSibling || !this._matchesSimple(previousSibling, simple, context))
          return false;
        return this._matchesParents(previousSibling, complex, index - 1, context);
      }
      if (combinator === "") {
        let parent = parentElementOrShadowHostInContext(element, context);
        while (parent) {
          if (this._matchesSimple(parent, simple, context)) {
            if (this._matchesParents(parent, complex, index - 1, context))
              return true;
            if (complex.simples[index - 1].combinator === "")
              break;
          }
          parent = parentElementOrShadowHostInContext(parent, context);
        }
        return false;
      }
      if (combinator === "~") {
        let previousSibling = previousSiblingInContext(element, context);
        while (previousSibling) {
          if (this._matchesSimple(previousSibling, simple, context)) {
            if (this._matchesParents(previousSibling, complex, index - 1, context))
              return true;
            if (complex.simples[index - 1].combinator === "~")
              break;
          }
          previousSibling = previousSiblingInContext(previousSibling, context);
        }
        return false;
      }
      if (combinator === ">=") {
        let parent = element;
        while (parent) {
          if (this._matchesSimple(parent, simple, context)) {
            if (this._matchesParents(parent, complex, index - 1, context))
              return true;
            if (complex.simples[index - 1].combinator === "")
              break;
          }
          parent = parentElementOrShadowHostInContext(parent, context);
        }
        return false;
      }
      throw new Error(\`Unsupported combinator "\${combinator}"\`);
    });
  }
  _matchesEngine(engine, element, args, context) {
    if (engine.matches)
      return this._callMatches(engine, element, args, context);
    if (engine.query)
      return this._callQuery(engine, args, context).includes(element);
    throw new Error(\`Selector engine should implement "matches" or "query"\`);
  }
  _queryEngine(engine, context, args) {
    if (engine.query)
      return this._callQuery(engine, args, context);
    if (engine.matches)
      return this._queryCSS(context, "*").filter((element) => this._callMatches(engine, element, args, context));
    throw new Error(\`Selector engine should implement "matches" or "query"\`);
  }
  _callMatches(engine, element, args, context) {
    return this._cached(this._cacheCallMatches, element, [engine, context.scope, context.pierceShadow, context.originalScope, ...args], () => {
      return engine.matches(element, args, context, this);
    });
  }
  _callQuery(engine, args, context) {
    return this._cached(this._cacheCallQuery, engine, [context.scope, context.pierceShadow, context.originalScope, ...args], () => {
      return engine.query(context, args, this);
    });
  }
  _matchesCSS(element, css) {
    return element.matches(css);
  }
  _queryCSS(context, css) {
    return this._cached(this._cacheQueryCSS, css, [context.scope, context.pierceShadow, context.originalScope], () => {
      let result = [];
      function query(root) {
        result = result.concat([...root.querySelectorAll(css)]);
        if (!context.pierceShadow)
          return;
        if (root.shadowRoot)
          query(root.shadowRoot);
        for (const element of root.querySelectorAll("*")) {
          if (element.shadowRoot)
            query(element.shadowRoot);
        }
      }
      query(context.scope);
      return result;
    });
  }
  _getEngine(name) {
    const engine = this._engines.get(name);
    if (!engine)
      throw new Error(\`Unknown selector engine "\${name}"\`);
    return engine;
  }
};
var isEngine = {
  matches(element, args, context, evaluator) {
    if (args.length === 0)
      throw new Error(\`"is" engine expects non-empty selector list\`);
    return args.some((selector) => evaluator.matches(element, selector, context));
  },
  query(context, args, evaluator) {
    if (args.length === 0)
      throw new Error(\`"is" engine expects non-empty selector list\`);
    let elements = [];
    for (const arg of args)
      elements = elements.concat(evaluator.query(context, arg));
    return args.length === 1 ? elements : sortInDOMOrder(elements);
  }
};
var hasEngine = {
  matches(element, args, context, evaluator) {
    if (args.length === 0)
      throw new Error(\`"has" engine expects non-empty selector list\`);
    return evaluator.query({ ...context, scope: element }, args).length > 0;
  }
  // TODO: we can implement efficient "query" by matching "args" and returning
  // all parents/descendants, just have to be careful with the ":scope" matching.
};
var scopeEngine = {
  matches(element, args, context, evaluator) {
    if (args.length !== 0)
      throw new Error(\`"scope" engine expects no arguments\`);
    const actualScope = context.originalScope || context.scope;
    if (actualScope.nodeType === 9)
      return element === actualScope.documentElement;
    return element === actualScope;
  },
  query(context, args, evaluator) {
    if (args.length !== 0)
      throw new Error(\`"scope" engine expects no arguments\`);
    const actualScope = context.originalScope || context.scope;
    if (actualScope.nodeType === 9) {
      const root = actualScope.documentElement;
      return root ? [root] : [];
    }
    if (actualScope.nodeType === 1)
      return [actualScope];
    return [];
  }
};
var notEngine = {
  matches(element, args, context, evaluator) {
    if (args.length === 0)
      throw new Error(\`"not" engine expects non-empty selector list\`);
    return !evaluator.matches(element, args, context);
  }
};
var lightEngine = {
  query(context, args, evaluator) {
    return evaluator.query({ ...context, pierceShadow: false }, args);
  },
  matches(element, args, context, evaluator) {
    return evaluator.matches(element, args, { ...context, pierceShadow: false });
  }
};
var visibleEngine = {
  matches(element, args, context, evaluator) {
    if (args.length)
      throw new Error(\`"visible" engine expects no arguments\`);
    return isElementVisible(element);
  }
};
var textEngine = {
  matches(element, args, context, evaluator) {
    if (args.length !== 1 || typeof args[0] !== "string")
      throw new Error(\`"text" engine expects a single string\`);
    const text = normalizeWhiteSpace(args[0]).toLowerCase();
    const matcher = (elementText2) => elementText2.normalized.toLowerCase().includes(text);
    return elementMatchesText(evaluator._cacheText, element, matcher) === "self";
  }
};
var textIsEngine = {
  matches(element, args, context, evaluator) {
    if (args.length !== 1 || typeof args[0] !== "string")
      throw new Error(\`"text-is" engine expects a single string\`);
    const text = normalizeWhiteSpace(args[0]);
    const matcher = (elementText2) => {
      if (!text && !elementText2.immediate.length)
        return true;
      return elementText2.immediate.some((s) => normalizeWhiteSpace(s) === text);
    };
    return elementMatchesText(evaluator._cacheText, element, matcher) !== "none";
  }
};
var textMatchesEngine = {
  matches(element, args, context, evaluator) {
    if (args.length === 0 || typeof args[0] !== "string" || args.length > 2 || args.length === 2 && typeof args[1] !== "string")
      throw new Error(\`"text-matches" engine expects a regexp body and optional regexp flags\`);
    const re = new RegExp(args[0], args.length === 2 ? args[1] : void 0);
    const matcher = (elementText2) => re.test(elementText2.full);
    return elementMatchesText(evaluator._cacheText, element, matcher) === "self";
  }
};
var hasTextEngine = {
  matches(element, args, context, evaluator) {
    if (args.length !== 1 || typeof args[0] !== "string")
      throw new Error(\`"has-text" engine expects a single string\`);
    if (shouldSkipForTextMatching(element))
      return false;
    const text = normalizeWhiteSpace(args[0]).toLowerCase();
    const matcher = (elementText2) => elementText2.normalized.toLowerCase().includes(text);
    return matcher(elementText(evaluator._cacheText, element));
  }
};
function createLayoutEngine(name) {
  return {
    matches(element, args, context, evaluator) {
      const maxDistance = args.length && typeof args[args.length - 1] === "number" ? args[args.length - 1] : void 0;
      const queryArgs = maxDistance === void 0 ? args : args.slice(0, args.length - 1);
      if (args.length < 1 + (maxDistance === void 0 ? 0 : 1))
        throw new Error(\`"\${name}" engine expects a selector list and optional maximum distance in pixels\`);
      const inner = evaluator.query(context, queryArgs);
      const score = layoutSelectorScore(name, element, inner, maxDistance);
      if (score === void 0)
        return false;
      evaluator._markScore(element, score);
      return true;
    }
  };
}
var nthMatchEngine = {
  query(context, args, evaluator) {
    let index = args[args.length - 1];
    if (args.length < 2)
      throw new Error(\`"nth-match" engine expects non-empty selector list and an index argument\`);
    if (typeof index !== "number" || index < 1)
      throw new Error(\`"nth-match" engine expects a one-based index as the last argument\`);
    const elements = isEngine.query(context, args.slice(0, args.length - 1), evaluator);
    index--;
    return index < elements.length ? [elements[index]] : [];
  }
};
function parentElementOrShadowHostInContext(element, context) {
  if (element === context.scope)
    return;
  if (!context.pierceShadow)
    return element.parentElement || void 0;
  return parentElementOrShadowHost(element);
}
function previousSiblingInContext(element, context) {
  if (element === context.scope)
    return;
  return element.previousElementSibling || void 0;
}
function sortInDOMOrder(elements) {
  const elementToEntry = /* @__PURE__ */ new Map();
  const roots = [];
  const result = [];
  function append(element) {
    let entry = elementToEntry.get(element);
    if (entry)
      return entry;
    const parent = parentElementOrShadowHost(element);
    if (parent) {
      const parentEntry = append(parent);
      parentEntry.children.push(element);
    } else {
      roots.push(element);
    }
    entry = { children: [], taken: false };
    elementToEntry.set(element, entry);
    return entry;
  }
  for (const e of elements)
    append(e).taken = true;
  function visit(element) {
    const entry = elementToEntry.get(element);
    if (entry.taken)
      result.push(element);
    if (entry.children.length > 1) {
      const set = new Set(entry.children);
      entry.children = [];
      let child = element.firstElementChild;
      while (child && entry.children.length < set.size) {
        if (set.has(child))
          entry.children.push(child);
        child = child.nextElementSibling;
      }
      child = element.shadowRoot ? element.shadowRoot.firstElementChild : null;
      while (child && entry.children.length < set.size) {
        if (set.has(child))
          entry.children.push(child);
        child = child.nextElementSibling;
      }
    }
    entry.children.forEach(visit);
  }
  roots.forEach(visit);
  return result;
}

// packages/playwright-core/src/server/injected/selectorGenerator.ts
var cacheAllowText = /* @__PURE__ */ new Map();
var cacheDisallowText = /* @__PURE__ */ new Map();
var kTextScoreRange = 10;
var kExactPenalty = kTextScoreRange / 2;
var kTestIdScore = 1;
var kOtherTestIdScore = 2;
var kIframeByAttributeScore = 10;
var kBeginPenalizedScore = 50;
var kPlaceholderScore = 100;
var kLabelScore = 120;
var kRoleWithNameScore = 140;
var kAltTextScore = 160;
var kTextScore = 180;
var kTitleScore = 200;
var kTextScoreRegex = 250;
var kPlaceholderScoreExact = kPlaceholderScore + kExactPenalty;
var kLabelScoreExact = kLabelScore + kExactPenalty;
var kRoleWithNameScoreExact = kRoleWithNameScore + kExactPenalty;
var kAltTextScoreExact = kAltTextScore + kExactPenalty;
var kTextScoreExact = kTextScore + kExactPenalty;
var kTitleScoreExact = kTitleScore + kExactPenalty;
var kEndPenalizedScore = 300;
var kCSSIdScore = 500;
var kRoleWithoutNameScore = 510;
var kCSSInputTypeNameScore = 520;
var kCSSTagNameScore = 530;
var kNthScore = 1e4;
var kCSSFallbackScore = 1e7;
var kScoreThresholdForTextExpect = 1e3;
function generateSelector(injectedScript, targetElement, options) {
  var _a;
  injectedScript._evaluator.begin();
  beginAriaCaches();
  try {
    let selectors = [];
    if (options.forTextExpect) {
      let targetTokens = cssFallback(injectedScript, targetElement.ownerDocument.documentElement, options);
      for (let element = targetElement; element; element = parentElementOrShadowHost(element)) {
        const tokens = generateSelectorFor(injectedScript, element, { ...options, noText: true });
        if (!tokens)
          continue;
        const score = combineScores(tokens);
        if (score <= kScoreThresholdForTextExpect) {
          targetTokens = tokens;
          break;
        }
      }
      selectors = [joinTokens(targetTokens)];
    } else {
      targetElement = closestCrossShadow(targetElement, "button,select,input,[role=button],[role=checkbox],[role=radio],a,[role=link]", options.root) || targetElement;
      if (options.multiple) {
        const withText = generateSelectorFor(injectedScript, targetElement, options);
        const withoutText = generateSelectorFor(injectedScript, targetElement, { ...options, noText: true });
        let tokens = [withText, withoutText];
        cacheAllowText.clear();
        cacheDisallowText.clear();
        if (withText && hasCSSIdToken(withText))
          tokens.push(generateSelectorFor(injectedScript, targetElement, { ...options, noCSSId: true }));
        if (withoutText && hasCSSIdToken(withoutText))
          tokens.push(generateSelectorFor(injectedScript, targetElement, { ...options, noText: true, noCSSId: true }));
        tokens = tokens.filter(Boolean);
        if (!tokens.length) {
          const css = cssFallback(injectedScript, targetElement, options);
          tokens.push(css);
          if (hasCSSIdToken(css))
            tokens.push(cssFallback(injectedScript, targetElement, { ...options, noCSSId: true }));
        }
        selectors = [...new Set(tokens.map((t) => joinTokens(t)))];
      } else {
        const targetTokens = generateSelectorFor(injectedScript, targetElement, options) || cssFallback(injectedScript, targetElement, options);
        selectors = [joinTokens(targetTokens)];
      }
    }
    const selector = selectors[0];
    const parsedSelector = injectedScript.parseSelector(selector);
    return {
      selector,
      selectors,
      elements: injectedScript.querySelectorAll(parsedSelector, (_a = options.root) != null ? _a : targetElement.ownerDocument)
    };
  } finally {
    cacheAllowText.clear();
    cacheDisallowText.clear();
    endAriaCaches();
    injectedScript._evaluator.end();
  }
}
function filterRegexTokens(textCandidates) {
  return textCandidates.filter((c) => c[0].selector[0] !== "/");
}
function generateSelectorFor(injectedScript, targetElement, options) {
  if (options.root && !isInsideScope(options.root, targetElement))
    throw new Error(\`Target element must belong to the root's subtree\`);
  if (targetElement === options.root)
    return [{ engine: "css", selector: ":scope", score: 1 }];
  if (targetElement.ownerDocument.documentElement === targetElement)
    return [{ engine: "css", selector: "html", score: 1 }];
  const calculate = (element, allowText) => {
    var _a;
    const allowNthMatch = element === targetElement;
    let textCandidates = allowText ? buildTextCandidates(injectedScript, element, element === targetElement) : [];
    if (element !== targetElement) {
      textCandidates = filterRegexTokens(textCandidates);
    }
    const noTextCandidates = buildNoTextCandidates(injectedScript, element, options).filter((token) => !options.omitInternalEngines || !token.engine.startsWith("internal:")).map((token) => [token]);
    let result = chooseFirstSelector(injectedScript, (_a = options.root) != null ? _a : targetElement.ownerDocument, element, [...textCandidates, ...noTextCandidates], allowNthMatch);
    textCandidates = filterRegexTokens(textCandidates);
    const checkWithText = (textCandidatesToUse) => {
      const allowParentText = allowText && !textCandidatesToUse.length;
      const candidates = [...textCandidatesToUse, ...noTextCandidates].filter((c) => {
        if (!result)
          return true;
        return combineScores(c) < combineScores(result);
      });
      let bestPossibleInParent = candidates[0];
      if (!bestPossibleInParent)
        return;
      for (let parent = parentElementOrShadowHost(element); parent && parent !== options.root; parent = parentElementOrShadowHost(parent)) {
        const parentTokens = calculateCached(parent, allowParentText);
        if (!parentTokens)
          continue;
        if (result && combineScores([...parentTokens, ...bestPossibleInParent]) >= combineScores(result))
          continue;
        bestPossibleInParent = chooseFirstSelector(injectedScript, parent, element, candidates, allowNthMatch);
        if (!bestPossibleInParent)
          return;
        const combined = [...parentTokens, ...bestPossibleInParent];
        if (!result || combineScores(combined) < combineScores(result))
          result = combined;
      }
    };
    checkWithText(textCandidates);
    if (element === targetElement && textCandidates.length)
      checkWithText([]);
    return result;
  };
  const calculateCached = (element, allowText) => {
    const cache = allowText ? cacheAllowText : cacheDisallowText;
    let value = cache.get(element);
    if (value === void 0) {
      value = calculate(element, allowText);
      cache.set(element, value);
    }
    return value;
  };
  return calculate(targetElement, !options.noText);
}
function buildNoTextCandidates(injectedScript, element, options) {
  const candidates = [];
  {
    for (const attr of ["data-testid", "data-test-id", "data-test"]) {
      if (attr !== options.testIdAttributeName && element.getAttribute(attr))
        candidates.push({ engine: "css", selector: \`[\${attr}=\${quoteCSSAttributeValue(element.getAttribute(attr))}]\`, score: kOtherTestIdScore });
    }
    if (!options.noCSSId) {
      const idAttr = element.getAttribute("id");
      if (idAttr && !isGuidLike(idAttr))
        candidates.push({ engine: "css", selector: makeSelectorForId(idAttr), score: kCSSIdScore });
    }
    candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: kCSSTagNameScore });
  }
  if (element.nodeName === "IFRAME") {
    for (const attribute of ["name", "title"]) {
      if (element.getAttribute(attribute))
        candidates.push({ engine: "css", selector: \`\${cssEscape(element.nodeName.toLowerCase())}[\${attribute}=\${quoteCSSAttributeValue(element.getAttribute(attribute))}]\`, score: kIframeByAttributeScore });
    }
    if (element.getAttribute(options.testIdAttributeName))
      candidates.push({ engine: "css", selector: \`[\${options.testIdAttributeName}=\${quoteCSSAttributeValue(element.getAttribute(options.testIdAttributeName))}]\`, score: kTestIdScore });
    penalizeScoreForLength([candidates]);
    return candidates;
  }
  if (element.getAttribute(options.testIdAttributeName))
    candidates.push({ engine: "internal:testid", selector: \`[\${options.testIdAttributeName}=\${escapeForAttributeSelector(element.getAttribute(options.testIdAttributeName), true)}]\`, score: kTestIdScore });
  if (element.nodeName === "INPUT" || element.nodeName === "TEXTAREA") {
    const input = element;
    if (input.placeholder) {
      candidates.push({ engine: "internal:attr", selector: \`[placeholder=\${escapeForAttributeSelector(input.placeholder, true)}]\`, score: kPlaceholderScoreExact });
      for (const alternative of suitableTextAlternatives(input.placeholder))
        candidates.push({ engine: "internal:attr", selector: \`[placeholder=\${escapeForAttributeSelector(alternative.text, false)}]\`, score: kPlaceholderScore - alternative.scoreBouns });
    }
  }
  const labels = getElementLabels(injectedScript._evaluator._cacheText, element);
  for (const label of labels) {
    const labelText = label.normalized;
    candidates.push({ engine: "internal:label", selector: escapeForTextSelector(labelText, true), score: kLabelScoreExact });
    for (const alternative of suitableTextAlternatives(labelText))
      candidates.push({ engine: "internal:label", selector: escapeForTextSelector(alternative.text, false), score: kLabelScore - alternative.scoreBouns });
  }
  const ariaRole = getAriaRole(element);
  if (ariaRole && !["none", "presentation"].includes(ariaRole))
    candidates.push({ engine: "internal:role", selector: ariaRole, score: kRoleWithoutNameScore });
  if (element.getAttribute("name") && ["BUTTON", "FORM", "FIELDSET", "FRAME", "IFRAME", "INPUT", "KEYGEN", "OBJECT", "OUTPUT", "SELECT", "TEXTAREA", "MAP", "META", "PARAM"].includes(element.nodeName))
    candidates.push({ engine: "css", selector: \`\${cssEscape(element.nodeName.toLowerCase())}[name=\${quoteCSSAttributeValue(element.getAttribute("name"))}]\`, score: kCSSInputTypeNameScore });
  if (["INPUT", "TEXTAREA"].includes(element.nodeName) && element.getAttribute("type") !== "hidden") {
    if (element.getAttribute("type"))
      candidates.push({ engine: "css", selector: \`\${cssEscape(element.nodeName.toLowerCase())}[type=\${quoteCSSAttributeValue(element.getAttribute("type"))}]\`, score: kCSSInputTypeNameScore });
  }
  if (["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName) && element.getAttribute("type") !== "hidden")
    candidates.push({ engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: kCSSInputTypeNameScore + 1 });
  penalizeScoreForLength([candidates]);
  return candidates;
}
function buildTextCandidates(injectedScript, element, isTargetNode) {
  if (element.nodeName === "SELECT")
    return [];
  const candidates = [];
  const title = element.getAttribute("title");
  if (title) {
    candidates.push([{ engine: "internal:attr", selector: \`[title=\${escapeForAttributeSelector(title, true)}]\`, score: kTitleScoreExact }]);
    for (const alternative of suitableTextAlternatives(title))
      candidates.push([{ engine: "internal:attr", selector: \`[title=\${escapeForAttributeSelector(alternative.text, false)}]\`, score: kTitleScore - alternative.scoreBouns }]);
  }
  const alt = element.getAttribute("alt");
  if (alt && ["APPLET", "AREA", "IMG", "INPUT"].includes(element.nodeName)) {
    candidates.push([{ engine: "internal:attr", selector: \`[alt=\${escapeForAttributeSelector(alt, true)}]\`, score: kAltTextScoreExact }]);
    for (const alternative of suitableTextAlternatives(alt))
      candidates.push([{ engine: "internal:attr", selector: \`[alt=\${escapeForAttributeSelector(alternative.text, false)}]\`, score: kAltTextScore - alternative.scoreBouns }]);
  }
  const text = elementText(injectedScript._evaluator._cacheText, element).normalized;
  if (text) {
    const alternatives = suitableTextAlternatives(text);
    if (isTargetNode) {
      if (text.length <= 80)
        candidates.push([{ engine: "internal:text", selector: escapeForTextSelector(text, true), score: kTextScoreExact }]);
      for (const alternative of alternatives)
        candidates.push([{ engine: "internal:text", selector: escapeForTextSelector(alternative.text, false), score: kTextScore - alternative.scoreBouns }]);
    }
    const cssToken = { engine: "css", selector: cssEscape(element.nodeName.toLowerCase()), score: kCSSTagNameScore };
    for (const alternative of alternatives)
      candidates.push([cssToken, { engine: "internal:has-text", selector: escapeForTextSelector(alternative.text, false), score: kTextScore - alternative.scoreBouns }]);
    if (text.length <= 80)
      candidates.push([cssToken, { engine: "internal:has-text", selector: "/^" + escapeRegExp(text) + "$/", score: kTextScoreRegex }]);
  }
  const ariaRole = getAriaRole(element);
  if (ariaRole && !["none", "presentation"].includes(ariaRole)) {
    const ariaName = getElementAccessibleName(element, false);
    if (ariaName) {
      candidates.push([{ engine: "internal:role", selector: \`\${ariaRole}[name=\${escapeForAttributeSelector(ariaName, true)}]\`, score: kRoleWithNameScoreExact }]);
      for (const alternative of suitableTextAlternatives(ariaName))
        candidates.push([{ engine: "internal:role", selector: \`\${ariaRole}[name=\${escapeForAttributeSelector(alternative.text, false)}]\`, score: kRoleWithNameScore - alternative.scoreBouns }]);
    }
  }
  penalizeScoreForLength(candidates);
  return candidates;
}
function makeSelectorForId(id) {
  return /^[a-zA-Z][a-zA-Z0-9\\-\\_]+$/.test(id) ? "#" + id : \`[id="\${cssEscape(id)}"]\`;
}
function hasCSSIdToken(tokens) {
  return tokens.some((token) => token.engine === "css" && (token.selector.startsWith("#") || token.selector.startsWith('[id="')));
}
function cssFallback(injectedScript, targetElement, options) {
  var _a;
  const root = (_a = options.root) != null ? _a : targetElement.ownerDocument;
  const tokens = [];
  function uniqueCSSSelector(prefix) {
    const path = tokens.slice();
    if (prefix)
      path.unshift(prefix);
    const selector = path.join(" > ");
    const parsedSelector = injectedScript.parseSelector(selector);
    const node = injectedScript.querySelector(parsedSelector, root, false);
    return node === targetElement ? selector : void 0;
  }
  function makeStrict(selector) {
    const token = { engine: "css", selector, score: kCSSFallbackScore };
    const parsedSelector = injectedScript.parseSelector(selector);
    const elements = injectedScript.querySelectorAll(parsedSelector, root);
    if (elements.length === 1)
      return [token];
    const nth = { engine: "nth", selector: String(elements.indexOf(targetElement)), score: kNthScore };
    return [token, nth];
  }
  for (let element = targetElement; element && element !== root; element = parentElementOrShadowHost(element)) {
    const nodeName = element.nodeName.toLowerCase();
    let bestTokenForLevel = "";
    if (element.id && !options.noCSSId) {
      const token = makeSelectorForId(element.id);
      const selector = uniqueCSSSelector(token);
      if (selector)
        return makeStrict(selector);
      bestTokenForLevel = token;
    }
    const parent = element.parentNode;
    const classes = [...element.classList];
    for (let i = 0; i < classes.length; ++i) {
      const token = "." + cssEscape(classes.slice(0, i + 1).join("."));
      const selector = uniqueCSSSelector(token);
      if (selector)
        return makeStrict(selector);
      if (!bestTokenForLevel && parent) {
        const sameClassSiblings = parent.querySelectorAll(token);
        if (sameClassSiblings.length === 1)
          bestTokenForLevel = token;
      }
    }
    if (parent) {
      const siblings = [...parent.children];
      const sameTagSiblings = siblings.filter((sibling) => sibling.nodeName.toLowerCase() === nodeName);
      const token = sameTagSiblings.indexOf(element) === 0 ? cssEscape(nodeName) : \`\${cssEscape(nodeName)}:nth-child(\${1 + siblings.indexOf(element)})\`;
      const selector = uniqueCSSSelector(token);
      if (selector)
        return makeStrict(selector);
      if (!bestTokenForLevel)
        bestTokenForLevel = token;
    } else if (!bestTokenForLevel) {
      bestTokenForLevel = cssEscape(nodeName);
    }
    tokens.unshift(bestTokenForLevel);
  }
  return makeStrict(uniqueCSSSelector());
}
function penalizeScoreForLength(groups) {
  for (const group of groups) {
    for (const token of group) {
      if (token.score > kBeginPenalizedScore && token.score < kEndPenalizedScore)
        token.score += Math.min(kTextScoreRange, token.selector.length / 10 | 0);
    }
  }
}
function joinTokens(tokens) {
  const parts = [];
  let lastEngine = "";
  for (const { engine, selector } of tokens) {
    if (parts.length && (lastEngine !== "css" || engine !== "css" || selector.startsWith(":nth-match(")))
      parts.push(">>");
    lastEngine = engine;
    if (engine === "css")
      parts.push(selector);
    else
      parts.push(\`\${engine}=\${selector}\`);
  }
  return parts.join(" ");
}
function combineScores(tokens) {
  let score = 0;
  for (let i = 0; i < tokens.length; i++)
    score += tokens[i].score * (tokens.length - i);
  return score;
}
function chooseFirstSelector(injectedScript, scope, targetElement, selectors, allowNthMatch) {
  const joined = selectors.map((tokens) => ({ tokens, score: combineScores(tokens) }));
  joined.sort((a, b) => a.score - b.score);
  let bestWithIndex = null;
  for (const { tokens } of joined) {
    const parsedSelector = injectedScript.parseSelector(joinTokens(tokens));
    const result = injectedScript.querySelectorAll(parsedSelector, scope);
    if (result[0] === targetElement && result.length === 1) {
      return tokens;
    }
    const index = result.indexOf(targetElement);
    if (!allowNthMatch || bestWithIndex || index === -1 || result.length > 5)
      continue;
    const nth = { engine: "nth", selector: String(index), score: kNthScore };
    bestWithIndex = [...tokens, nth];
  }
  return bestWithIndex;
}
function isGuidLike(id) {
  let lastCharacterType;
  let transitionCount = 0;
  for (let i = 0; i < id.length; ++i) {
    const c = id[i];
    let characterType;
    if (c === "-" || c === "_")
      continue;
    if (c >= "a" && c <= "z")
      characterType = "lower";
    else if (c >= "A" && c <= "Z")
      characterType = "upper";
    else if (c >= "0" && c <= "9")
      characterType = "digit";
    else
      characterType = "other";
    if (characterType === "lower" && lastCharacterType === "upper") {
      lastCharacterType = characterType;
      continue;
    }
    if (lastCharacterType && lastCharacterType !== characterType)
      ++transitionCount;
    lastCharacterType = characterType;
  }
  return transitionCount >= id.length / 4;
}
function trimWordBoundary(text, maxLength) {
  if (text.length <= maxLength)
    return text;
  text = text.substring(0, maxLength);
  const match = text.match(/^(.*)\\b(.+?)$/);
  if (!match)
    return "";
  return match[1].trimEnd();
}
function suitableTextAlternatives(text) {
  let result = [];
  {
    const match = text.match(/^([\\d.,]+)[^.,\\w]/);
    const leadingNumberLength = match ? match[1].length : 0;
    if (leadingNumberLength) {
      const alt = text.substring(leadingNumberLength).trimStart();
      result.push({ text: alt, scoreBouns: alt.length <= 30 ? 2 : 1 });
    }
  }
  {
    const match = text.match(/[^.,\\w]([\\d.,]+)$/);
    const trailingNumberLength = match ? match[1].length : 0;
    if (trailingNumberLength) {
      const alt = text.substring(0, text.length - trailingNumberLength).trimEnd();
      result.push({ text: alt, scoreBouns: alt.length <= 30 ? 2 : 1 });
    }
  }
  if (text.length <= 30) {
    result.push({ text, scoreBouns: 0 });
  } else {
    result.push({ text: trimWordBoundary(text, 80), scoreBouns: 0 });
    result.push({ text: trimWordBoundary(text, 30), scoreBouns: 1 });
  }
  result = result.filter((r) => r.text);
  if (!result.length)
    result.push({ text: text.substring(0, 80), scoreBouns: 0 });
  return result;
}

// packages/playwright-core/src/utils/isomorphic/locatorGenerators.ts
function asLocator(lang, selector, isFrameLocator = false) {
  return asLocators(lang, selector, isFrameLocator)[0];
}
function asLocators(lang, selector, isFrameLocator = false, maxOutputSize = 20, preferredQuote) {
  try {
    return innerAsLocators(new generators[lang](preferredQuote), parseSelector(selector), isFrameLocator, maxOutputSize);
  } catch (e) {
    return [selector];
  }
}
function innerAsLocators(factory, parsed, isFrameLocator = false, maxOutputSize = 20) {
  const parts = [...parsed.parts];
  for (let index = 0; index < parts.length - 1; index++) {
    if (parts[index].name === "nth" && parts[index + 1].name === "internal:control" && parts[index + 1].body === "enter-frame") {
      const [nth] = parts.splice(index, 1);
      parts.splice(index + 1, 0, nth);
    }
  }
  const tokens = [];
  let nextBase = isFrameLocator ? "frame-locator" : "page";
  for (let index = 0; index < parts.length; index++) {
    const part = parts[index];
    const base = nextBase;
    nextBase = "locator";
    if (part.name === "nth") {
      if (part.body === "0")
        tokens.push([factory.generateLocator(base, "first", ""), factory.generateLocator(base, "nth", "0")]);
      else if (part.body === "-1")
        tokens.push([factory.generateLocator(base, "last", ""), factory.generateLocator(base, "nth", "-1")]);
      else
        tokens.push([factory.generateLocator(base, "nth", part.body)]);
      continue;
    }
    if (part.name === "internal:text") {
      const { exact, text } = detectExact(part.body);
      tokens.push([factory.generateLocator(base, "text", text, { exact })]);
      continue;
    }
    if (part.name === "internal:has-text") {
      const { exact, text } = detectExact(part.body);
      if (!exact) {
        tokens.push([factory.generateLocator(base, "has-text", text, { exact })]);
        continue;
      }
    }
    if (part.name === "internal:has-not-text") {
      const { exact, text } = detectExact(part.body);
      if (!exact) {
        tokens.push([factory.generateLocator(base, "has-not-text", text, { exact })]);
        continue;
      }
    }
    if (part.name === "internal:has") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "has", inner)));
      continue;
    }
    if (part.name === "internal:has-not") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "hasNot", inner)));
      continue;
    }
    if (part.name === "internal:and") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "and", inner)));
      continue;
    }
    if (part.name === "internal:or") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "or", inner)));
      continue;
    }
    if (part.name === "internal:chain") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "chain", inner)));
      continue;
    }
    if (part.name === "internal:label") {
      const { exact, text } = detectExact(part.body);
      tokens.push([factory.generateLocator(base, "label", text, { exact })]);
      continue;
    }
    if (part.name === "internal:role") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const options = { attrs: [] };
      for (const attr of attrSelector.attributes) {
        if (attr.name === "name") {
          options.exact = attr.caseSensitive;
          options.name = attr.value;
        } else {
          if (attr.name === "level" && typeof attr.value === "string")
            attr.value = +attr.value;
          options.attrs.push({ name: attr.name === "include-hidden" ? "includeHidden" : attr.name, value: attr.value });
        }
      }
      tokens.push([factory.generateLocator(base, "role", attrSelector.name, options)]);
      continue;
    }
    if (part.name === "internal:testid") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const { value } = attrSelector.attributes[0];
      tokens.push([factory.generateLocator(base, "test-id", value)]);
      continue;
    }
    if (part.name === "internal:attr") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const { name, value, caseSensitive } = attrSelector.attributes[0];
      const text = value;
      const exact = !!caseSensitive;
      if (name === "placeholder") {
        tokens.push([factory.generateLocator(base, "placeholder", text, { exact })]);
        continue;
      }
      if (name === "alt") {
        tokens.push([factory.generateLocator(base, "alt", text, { exact })]);
        continue;
      }
      if (name === "title") {
        tokens.push([factory.generateLocator(base, "title", text, { exact })]);
        continue;
      }
    }
    let locatorType = "default";
    const nextPart = parts[index + 1];
    if (nextPart && nextPart.name === "internal:control" && nextPart.body === "enter-frame") {
      locatorType = "frame";
      nextBase = "frame-locator";
      index++;
    }
    const selectorPart = stringifySelector({ parts: [part] });
    const locatorPart = factory.generateLocator(base, locatorType, selectorPart);
    if (locatorType === "default" && nextPart && ["internal:has-text", "internal:has-not-text"].includes(nextPart.name)) {
      const { exact, text } = detectExact(nextPart.body);
      if (!exact) {
        const nextLocatorPart = factory.generateLocator("locator", nextPart.name === "internal:has-text" ? "has-text" : "has-not-text", text, { exact });
        const options = {};
        if (nextPart.name === "internal:has-text")
          options.hasText = text;
        else
          options.hasNotText = text;
        const combinedPart = factory.generateLocator(base, "default", selectorPart, options);
        tokens.push([factory.chainLocators([locatorPart, nextLocatorPart]), combinedPart]);
        index++;
        continue;
      }
    }
    let locatorPartWithEngine;
    if (["xpath", "css"].includes(part.name)) {
      const selectorPart2 = stringifySelector(
        { parts: [part] },
        /* forceEngineName */
        true
      );
      locatorPartWithEngine = factory.generateLocator(base, locatorType, selectorPart2);
    }
    tokens.push([locatorPart, locatorPartWithEngine].filter(Boolean));
  }
  return combineTokens(factory, tokens, maxOutputSize);
}
function combineTokens(factory, tokens, maxOutputSize) {
  const currentTokens = tokens.map(() => "");
  const result = [];
  const visit = (index) => {
    if (index === tokens.length) {
      result.push(factory.chainLocators(currentTokens));
      return currentTokens.length < maxOutputSize;
    }
    for (const taken of tokens[index]) {
      currentTokens[index] = taken;
      if (!visit(index + 1))
        return false;
    }
    return true;
  };
  visit(0);
  return result;
}
function detectExact(text) {
  let exact = false;
  const match = text.match(/^\\/(.*)\\/([igm]*)$/);
  if (match)
    return { text: new RegExp(match[1], match[2]) };
  if (text.endsWith('"')) {
    text = JSON.parse(text);
    exact = true;
  } else if (text.endsWith('"s')) {
    text = JSON.parse(text.substring(0, text.length - 1));
    exact = true;
  } else if (text.endsWith('"i')) {
    text = JSON.parse(text.substring(0, text.length - 1));
    exact = false;
  }
  return { exact, text };
}
var JavaScriptLocatorFactory = class {
  constructor(preferredQuote) {
    this.preferredQuote = preferredQuote;
  }
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, { hasText: \${this.toHasText(options.hasText)} })\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, { hasNotText: \${this.toHasText(options.hasNotText)} })\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first()\`;
      case "last":
        return \`last()\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`name: \${this.regexToSourceString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`name: \${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`exact: true\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`\${name}: \${typeof value === "string" ? this.quote(value) : value}\`);
        const attrString = attrs.length ? \`, { \${attrs.join(", ")} }\` : "";
        return \`getByRole(\${this.quote(body)}\${attrString})\`;
      case "has-text":
        return \`filter({ hasText: \${this.toHasText(body)} })\`;
      case "has-not-text":
        return \`filter({ hasNotText: \${this.toHasText(body)} })\`;
      case "has":
        return \`filter({ has: \${body} })\`;
      case "hasNot":
        return \`filter({ hasNot: \${body} })\`;
      case "and":
        return \`and(\${body})\`;
      case "or":
        return \`or(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`getByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("getByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("getByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("getByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("getByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact("getByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToSourceString(re) {
    return normalizeEscapedRegexQuotes(String(re));
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToSourceString(body)})\`;
    return exact ? \`\${method}(\${this.quote(body)}, { exact: true })\` : \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToSourceString(body);
    return this.quote(body);
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToSourceString(value);
    return this.quote(value);
  }
  quote(text) {
    var _a;
    return escapeWithQuotes(text, (_a = this.preferredQuote) != null ? _a : "'");
  }
};
var PythonLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, has_text=\${this.toHasText(options.hasText)})\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, has_not_text=\${this.toHasText(options.hasNotText)})\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frame_locator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first\`;
      case "last":
        return \`last\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`name=\${this.regexToString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`name=\${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`exact=True\`);
        }
        for (const { name, value } of options.attrs) {
          let valueString = typeof value === "string" ? this.quote(value) : value;
          if (typeof value === "boolean")
            valueString = value ? "True" : "False";
          attrs.push(\`\${toSnakeCase(name)}=\${valueString}\`);
        }
        const attrString = attrs.length ? \`, \${attrs.join(", ")}\` : "";
        return \`get_by_role(\${this.quote(body)}\${attrString})\`;
      case "has-text":
        return \`filter(has_text=\${this.toHasText(body)})\`;
      case "has-not-text":
        return \`filter(has_not_text=\${this.toHasText(body)})\`;
      case "has":
        return \`filter(has=\${body})\`;
      case "hasNot":
        return \`filter(has_not=\${body})\`;
      case "and":
        return \`and_(\${body})\`;
      case "or":
        return \`or_(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`get_by_test_id(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("get_by_text", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("get_by_alt_text", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("get_by_placeholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("get_by_label", body, !!options.exact);
      case "title":
        return this.toCallWithExact("get_by_title", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", re.IGNORECASE" : "";
    return \`re.compile(r"\${normalizeEscapedRegexQuotes(body.source).replace(/\\\\\\//, "/").replace(/"/g, '\\\\"')}"\${suffix})\`;
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, exact=True)\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToString(body);
    return \`\${this.quote(body)}\`;
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var JavaLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    let clazz;
    switch (base) {
      case "page":
        clazz = "Page";
        break;
      case "frame-locator":
        clazz = "FrameLocator";
        break;
      case "locator":
        clazz = "Locator";
        break;
    }
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, new \${clazz}.LocatorOptions().setHasText(\${this.toHasText(options.hasText)}))\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, new \${clazz}.LocatorOptions().setHasNotText(\${this.toHasText(options.hasNotText)}))\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first()\`;
      case "last":
        return \`last()\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`.setName(\${this.regexToString(options.name)})\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`.setName(\${this.quote(options.name)})\`);
          if (options.exact)
            attrs.push(\`.setExact(true)\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`.set\${toTitleCase(name)}(\${typeof value === "string" ? this.quote(value) : value})\`);
        const attrString = attrs.length ? \`, new \${clazz}.GetByRoleOptions()\${attrs.join("")}\` : "";
        return \`getByRole(AriaRole.\${toSnakeCase(body).toUpperCase()}\${attrString})\`;
      case "has-text":
        return \`filter(new \${clazz}.FilterOptions().setHasText(\${this.toHasText(body)}))\`;
      case "has-not-text":
        return \`filter(new \${clazz}.FilterOptions().setHasNotText(\${this.toHasText(body)}))\`;
      case "has":
        return \`filter(new \${clazz}.FilterOptions().setHas(\${body}))\`;
      case "hasNot":
        return \`filter(new \${clazz}.FilterOptions().setHasNot(\${body}))\`;
      case "and":
        return \`and(\${body})\`;
      case "or":
        return \`or(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`getByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact(clazz, "getByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact(clazz, "getByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact(clazz, "getByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact(clazz, "getByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact(clazz, "getByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", Pattern.CASE_INSENSITIVE" : "";
    return \`Pattern.compile(\${this.quote(normalizeEscapedRegexQuotes(body.source))}\${suffix})\`;
  }
  toCallWithExact(clazz, method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, new \${clazz}.\${toTitleCase(method)}Options().setExact(true))\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToString(body);
    return this.quote(body);
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var CSharpLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`Locator(\${this.quote(body)}, new() { \${this.toHasText(options.hasText)} })\`;
        if (options.hasNotText !== void 0)
          return \`Locator(\${this.quote(body)}, new() { \${this.toHasNotText(options.hasNotText)} })\`;
        return \`Locator(\${this.quote(body)})\`;
      case "frame":
        return \`FrameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`Nth(\${body})\`;
      case "first":
        return \`First\`;
      case "last":
        return \`Last\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`NameRegex = \${this.regexToString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`Name = \${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`Exact = true\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`\${toTitleCase(name)} = \${typeof value === "string" ? this.quote(value) : value}\`);
        const attrString = attrs.length ? \`, new() { \${attrs.join(", ")} }\` : "";
        return \`GetByRole(AriaRole.\${toTitleCase(body)}\${attrString})\`;
      case "has-text":
        return \`Filter(new() { \${this.toHasText(body)} })\`;
      case "has-not-text":
        return \`Filter(new() { \${this.toHasNotText(body)} })\`;
      case "has":
        return \`Filter(new() { Has = \${body} })\`;
      case "hasNot":
        return \`Filter(new() { HasNot = \${body} })\`;
      case "and":
        return \`And(\${body})\`;
      case "or":
        return \`Or(\${body})\`;
      case "chain":
        return \`Locator(\${body})\`;
      case "test-id":
        return \`GetByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("GetByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("GetByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("GetByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("GetByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact("GetByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", RegexOptions.IgnoreCase" : "";
    return \`new Regex(\${this.quote(normalizeEscapedRegexQuotes(body.source))}\${suffix})\`;
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, new() { Exact = true })\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return \`HasTextRegex = \${this.regexToString(body)}\`;
    return \`HasText = \${this.quote(body)}\`;
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  toHasNotText(body) {
    if (isRegExp(body))
      return \`HasNotTextRegex = \${this.regexToString(body)}\`;
    return \`HasNotText = \${this.quote(body)}\`;
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var JsonlLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    return JSON.stringify({
      kind,
      body,
      options
    });
  }
  chainLocators(locators) {
    const objects = locators.map((l) => JSON.parse(l));
    for (let i = 0; i < objects.length - 1; ++i)
      objects[i].next = objects[i + 1];
    return JSON.stringify(objects[0]);
  }
};
var generators = {
  javascript: JavaScriptLocatorFactory,
  python: PythonLocatorFactory,
  java: JavaLocatorFactory,
  csharp: CSharpLocatorFactory,
  jsonl: JsonlLocatorFactory
};
function isRegExp(obj) {
  return obj instanceof RegExp;
}

// packages/playwright-core/src/server/injected/highlight.css?inline
var highlight_default = ":host{font-size:13px;font-family:system-ui,Ubuntu,Droid Sans,sans-serif;color:#333}svg{position:absolute;height:0}x-pw-tooltip{backdrop-filter:blur(5px);background-color:#fff;border-radius:6px;box-shadow:0 .5rem 1.2rem #0000004d;display:none;font-size:12.8px;font-weight:400;left:0;line-height:1.5;max-width:600px;position:absolute;top:0;padding:0;flex-direction:column;overflow:hidden}x-pw-tooltip-line{display:flex;max-width:600px;padding:6px;user-select:none;cursor:pointer}x-pw-tooltip-line.selectable:hover{background-color:#f2f2f2;overflow:hidden}x-pw-tooltip-footer{display:flex;max-width:600px;padding:6px;user-select:none;color:#777}x-pw-dialog{background-color:#fff;pointer-events:auto;border-radius:6px;box-shadow:0 .5rem 1.2rem #0000004d;display:flex;flex-direction:column;position:absolute;width:400px;height:150px;z-index:10;font-size:13px}x-pw-dialog-body{display:flex;flex-direction:column;flex:auto}x-pw-dialog-body label{margin:5px 8px;display:flex;flex-direction:row;align-items:center}x-pw-highlight{position:absolute;top:0;left:0;width:0;height:0}x-pw-action-point{position:absolute;width:20px;height:20px;background:red;border-radius:10px;margin:-10px 0 0 -10px;z-index:2}x-pw-separator{height:1px;margin:6px 9px;background:rgb(148 148 148 / 90%)}x-pw-tool-gripper{height:28px;width:24px;margin:2px 0;cursor:grab}x-pw-tool-gripper:active{cursor:grabbing}x-pw-tool-gripper>x-div{width:16px;height:16px;margin:6px 4px;clip-path:url(#icon-gripper);background-color:#555}x-pw-tools-list>label{display:flex;align-items:center;margin:0 10px;user-select:none}x-pw-tools-list{display:flex;width:100%;border-bottom:1px solid #dddddd}x-pw-tool-item{pointer-events:auto;cursor:pointer;height:28px;width:28px;border-radius:3px}x-pw-tool-item:not(.disabled):hover{background-color:#dbdbdb}x-pw-tool-item.active{background-color:#8acae480}x-pw-tool-item.active:not(.disabled):hover{background-color:#8acae4c4}x-pw-tool-item>x-div{width:16px;height:16px;margin:6px;background-color:#3a3a3a}x-pw-tool-item.disabled>x-div{background-color:#61616180;cursor:default}x-pw-tool-item.record.active{background-color:transparent}x-pw-tool-item.record.active:hover{background-color:#dbdbdb}x-pw-tool-item.record.active>x-div{background-color:#a1260d}x-pw-tool-item.accept>x-div{background-color:#388a34}x-pw-tool-item.record>x-div{clip-path:url(#icon-circle-large-filled)}x-pw-tool-item.pick-locator>x-div{clip-path:url(#icon-inspect)}x-pw-tool-item.text>x-div{clip-path:url(#icon-whole-word)}x-pw-tool-item.visibility>x-div{clip-path:url(#icon-eye)}x-pw-tool-item.value>x-div{clip-path:url(#icon-symbol-constant)}x-pw-tool-item.accept>x-div{clip-path:url(#icon-check)}x-pw-tool-item.cancel>x-div{clip-path:url(#icon-close)}x-pw-tool-item.succeeded>x-div{clip-path:url(#icon-pass);background-color:#388a34!important}x-pw-overlay{position:absolute;top:0;max-width:min-content;z-index:2147483647;background:transparent;pointer-events:auto}x-pw-overlay x-pw-tools-list{background-color:#fffd;box-shadow:#0000001a 0 5px 5px;border-radius:3px;border-bottom:none}x-pw-overlay x-pw-tool-item{margin:2px}textarea.text-editor{font-family:system-ui,Ubuntu,Droid Sans,sans-serif;flex:auto;border:none;margin:6px 10px;color:#333;outline:1px solid transparent!important;resize:none;padding:0;font-size:13px}textarea.text-editor.does-not-match{outline:1px solid red!important}x-div{display:block}x-spacer{flex:auto}*{box-sizing:border-box}*[hidden]{display:none!important}x-locator-editor{flex:none;width:100%;height:60px;padding:4px;border-bottom:1px solid #dddddd;outline:1px solid transparent}x-locator-editor.does-not-match{outline:1px solid red}.CodeMirror{width:100%!important;height:100%!important}\\n";

// packages/playwright-core/src/server/injected/highlight.ts
var Highlight = class {
  constructor(injectedScript) {
    this._highlightEntries = [];
    this._highlightOptions = {};
    this._language = "javascript";
    this._injectedScript = injectedScript;
    const document = injectedScript.document;
    this._isUnderTest = injectedScript.isUnderTest;
    this._glassPaneElement = document.createElement("x-pw-glass");
    this._glassPaneElement.style.position = "fixed";
    this._glassPaneElement.style.top = "0";
    this._glassPaneElement.style.right = "0";
    this._glassPaneElement.style.bottom = "0";
    this._glassPaneElement.style.left = "0";
    this._glassPaneElement.style.zIndex = "2147483646";
    this._glassPaneElement.style.pointerEvents = "none";
    this._glassPaneElement.style.display = "flex";
    this._glassPaneElement.style.backgroundColor = "transparent";
    for (const eventName of ["click", "auxclick", "dragstart", "input", "keydown", "keyup", "pointerdown", "pointerup", "mousedown", "mouseup", "mouseleave", "focus", "scroll"]) {
      this._glassPaneElement.addEventListener(eventName, (e) => {
        e.stopPropagation();
        e.stopImmediatePropagation();
        if (e.type === "click" && e.button === 0 && this._highlightOptions.tooltipListItemSelected)
          this._highlightOptions.tooltipListItemSelected(void 0);
      });
    }
    this._actionPointElement = document.createElement("x-pw-action-point");
    this._actionPointElement.setAttribute("hidden", "true");
    this._glassPaneShadow = this._glassPaneElement.attachShadow({ mode: this._isUnderTest ? "open" : "closed" });
    if (typeof this._glassPaneShadow.adoptedStyleSheets.push === "function") {
      const sheet = new this._injectedScript.window.CSSStyleSheet();
      sheet.replaceSync(highlight_default);
      this._glassPaneShadow.adoptedStyleSheets.push(sheet);
    } else {
      const styleElement = this._injectedScript.document.createElement("style");
      styleElement.textContent = highlight_default;
      this._glassPaneShadow.appendChild(styleElement);
    }
    this._glassPaneShadow.appendChild(this._actionPointElement);
  }
  install() {
    this._injectedScript.document.documentElement.appendChild(this._glassPaneElement);
  }
  setLanguage(language) {
    this._language = language;
  }
  runHighlightOnRaf(selector) {
    if (this._rafRequest)
      cancelAnimationFrame(this._rafRequest);
    this.updateHighlight(this._injectedScript.querySelectorAll(selector, this._injectedScript.document.documentElement), { tooltipText: asLocator(this._language, stringifySelector(selector)) });
    this._rafRequest = requestAnimationFrame(() => this.runHighlightOnRaf(selector));
  }
  uninstall() {
    if (this._rafRequest)
      cancelAnimationFrame(this._rafRequest);
    this._glassPaneElement.remove();
  }
  showActionPoint(x, y) {
    this._actionPointElement.style.top = y + "px";
    this._actionPointElement.style.left = x + "px";
    this._actionPointElement.hidden = false;
  }
  hideActionPoint() {
    this._actionPointElement.hidden = true;
  }
  clearHighlight() {
    var _a, _b;
    for (const entry of this._highlightEntries) {
      (_a = entry.highlightElement) == null ? void 0 : _a.remove();
      (_b = entry.tooltipElement) == null ? void 0 : _b.remove();
    }
    this._highlightEntries = [];
    this._highlightOptions = {};
    this._glassPaneElement.style.pointerEvents = "none";
  }
  updateHighlight(elements, options) {
    this._innerUpdateHighlight(elements, options);
  }
  maskElements(elements, color) {
    this._innerUpdateHighlight(elements, { color });
  }
  _innerUpdateHighlight(elements, options) {
    let color = options.color;
    if (!color)
      color = elements.length > 1 ? "#f6b26b7f" : "#6fa8dc7f";
    if (this._highlightIsUpToDate(elements, options))
      return;
    this.clearHighlight();
    this._highlightOptions = options;
    this._glassPaneElement.style.pointerEvents = options.tooltipListItemSelected ? "initial" : "none";
    for (let i = 0; i < elements.length; ++i) {
      const highlightElement = this._createHighlightElement();
      this._glassPaneShadow.appendChild(highlightElement);
      let tooltipElement;
      if (options.tooltipList || options.tooltipText || options.tooltipFooter) {
        tooltipElement = this._injectedScript.document.createElement("x-pw-tooltip");
        this._glassPaneShadow.appendChild(tooltipElement);
        tooltipElement.style.top = "0";
        tooltipElement.style.left = "0";
        tooltipElement.style.display = "flex";
        let lines = [];
        if (options.tooltipList) {
          lines = options.tooltipList;
        } else if (options.tooltipText) {
          const suffix = elements.length > 1 ? \` [\${i + 1} of \${elements.length}]\` : "";
          lines = [options.tooltipText + suffix];
        }
        for (let index = 0; index < lines.length; index++) {
          const element = this._injectedScript.document.createElement("x-pw-tooltip-line");
          element.textContent = lines[index];
          tooltipElement.appendChild(element);
          if (options.tooltipListItemSelected) {
            element.classList.add("selectable");
            element.addEventListener("click", () => {
              var _a;
              return (_a = options.tooltipListItemSelected) == null ? void 0 : _a.call(options, index);
            });
          }
        }
        if (options.tooltipFooter) {
          const footer = this._injectedScript.document.createElement("x-pw-tooltip-footer");
          footer.textContent = options.tooltipFooter;
          tooltipElement.appendChild(footer);
        }
      }
      this._highlightEntries.push({ targetElement: elements[i], tooltipElement, highlightElement });
    }
    for (const entry of this._highlightEntries) {
      entry.box = entry.targetElement.getBoundingClientRect();
      if (!entry.tooltipElement)
        continue;
      const { anchorLeft, anchorTop } = this.tooltipPosition(entry.box, entry.tooltipElement);
      entry.tooltipTop = anchorTop;
      entry.tooltipLeft = anchorLeft;
    }
    for (const entry of this._highlightEntries) {
      if (entry.tooltipElement) {
        entry.tooltipElement.style.top = entry.tooltipTop + "px";
        entry.tooltipElement.style.left = entry.tooltipLeft + "px";
      }
      const box = entry.box;
      entry.highlightElement.style.backgroundColor = color;
      entry.highlightElement.style.left = box.x + "px";
      entry.highlightElement.style.top = box.y + "px";
      entry.highlightElement.style.width = box.width + "px";
      entry.highlightElement.style.height = box.height + "px";
      entry.highlightElement.style.display = "block";
      if (this._isUnderTest)
        console.error("Highlight box for test: " + JSON.stringify({ x: box.x, y: box.y, width: box.width, height: box.height }));
    }
  }
  firstBox() {
    var _a;
    return (_a = this._highlightEntries[0]) == null ? void 0 : _a.box;
  }
  tooltipPosition(box, tooltipElement) {
    const tooltipWidth = tooltipElement.offsetWidth;
    const tooltipHeight = tooltipElement.offsetHeight;
    const totalWidth = this._glassPaneElement.offsetWidth;
    const totalHeight = this._glassPaneElement.offsetHeight;
    let anchorLeft = box.left;
    if (anchorLeft + tooltipWidth > totalWidth - 5)
      anchorLeft = totalWidth - tooltipWidth - 5;
    let anchorTop = box.bottom + 5;
    if (anchorTop + tooltipHeight > totalHeight - 5) {
      if (box.top > tooltipHeight + 5) {
        anchorTop = box.top - tooltipHeight - 5;
      } else {
        anchorTop = totalHeight - 5 - tooltipHeight;
      }
    }
    return { anchorLeft, anchorTop };
  }
  _highlightIsUpToDate(elements, options) {
    var _a, _b;
    if (options.tooltipText !== this._highlightOptions.tooltipText)
      return false;
    if (options.tooltipListItemSelected !== this._highlightOptions.tooltipListItemSelected)
      return false;
    if (options.tooltipFooter !== this._highlightOptions.tooltipFooter)
      return false;
    if (((_a = options.tooltipList) == null ? void 0 : _a.length) !== ((_b = this._highlightOptions.tooltipList) == null ? void 0 : _b.length))
      return false;
    if (options.tooltipList && this._highlightOptions.tooltipList) {
      for (let i = 0; i < options.tooltipList.length; i++) {
        if (options.tooltipList[i] !== this._highlightOptions.tooltipList[i])
          return false;
      }
    }
    if (elements.length !== this._highlightEntries.length)
      return false;
    for (let i = 0; i < this._highlightEntries.length; ++i) {
      if (elements[i] !== this._highlightEntries[i].targetElement)
        return false;
      const oldBox = this._highlightEntries[i].box;
      if (!oldBox)
        return false;
      const box = elements[i].getBoundingClientRect();
      if (box.top !== oldBox.top || box.right !== oldBox.right || box.bottom !== oldBox.bottom || box.left !== oldBox.left)
        return false;
    }
    return true;
  }
  _createHighlightElement() {
    return this._injectedScript.document.createElement("x-pw-highlight");
  }
  appendChild(element) {
    this._glassPaneShadow.appendChild(element);
  }
};

// packages/playwright-core/src/server/injected/injectedScript.ts
var InjectedScript = class {
  // eslint-disable-next-line no-restricted-globals
  constructor(window, isUnderTest, sdkLanguage, testIdAttributeNameForStrictErrorAndConsoleCodegen, stableRafCount, browserName, customEngines) {
    this.onGlobalListenersRemoved = /* @__PURE__ */ new Set();
    this._testIdAttributeNameForStrictErrorAndConsoleCodegen = "data-testid";
    this.utils = { isInsideScope, elementText, asLocator, normalizeWhiteSpace };
    this.window = window;
    this.document = window.document;
    this.isUnderTest = isUnderTest;
    this._sdkLanguage = sdkLanguage;
    this._testIdAttributeNameForStrictErrorAndConsoleCodegen = testIdAttributeNameForStrictErrorAndConsoleCodegen;
    this._evaluator = new SelectorEvaluatorImpl(/* @__PURE__ */ new Map());
    this._engines = /* @__PURE__ */ new Map();
    this._engines.set("xpath", XPathEngine);
    this._engines.set("xpath:light", XPathEngine);
    this._engines.set("_react", ReactEngine);
    this._engines.set("_vue", VueEngine);
    this._engines.set("role", createRoleEngine(false));
    this._engines.set("text", this._createTextEngine(true, false));
    this._engines.set("text:light", this._createTextEngine(false, false));
    this._engines.set("id", this._createAttributeEngine("id", true));
    this._engines.set("id:light", this._createAttributeEngine("id", false));
    this._engines.set("data-testid", this._createAttributeEngine("data-testid", true));
    this._engines.set("data-testid:light", this._createAttributeEngine("data-testid", false));
    this._engines.set("data-test-id", this._createAttributeEngine("data-test-id", true));
    this._engines.set("data-test-id:light", this._createAttributeEngine("data-test-id", false));
    this._engines.set("data-test", this._createAttributeEngine("data-test", true));
    this._engines.set("data-test:light", this._createAttributeEngine("data-test", false));
    this._engines.set("css", this._createCSSEngine());
    this._engines.set("nth", { queryAll: () => [] });
    this._engines.set("visible", this._createVisibleEngine());
    this._engines.set("internal:control", this._createControlEngine());
    this._engines.set("internal:has", this._createHasEngine());
    this._engines.set("internal:has-not", this._createHasNotEngine());
    this._engines.set("internal:and", { queryAll: () => [] });
    this._engines.set("internal:or", { queryAll: () => [] });
    this._engines.set("internal:chain", this._createInternalChainEngine());
    this._engines.set("internal:label", this._createInternalLabelEngine());
    this._engines.set("internal:text", this._createTextEngine(true, true));
    this._engines.set("internal:has-text", this._createInternalHasTextEngine());
    this._engines.set("internal:has-not-text", this._createInternalHasNotTextEngine());
    this._engines.set("internal:attr", this._createNamedAttributeEngine());
    this._engines.set("internal:testid", this._createNamedAttributeEngine());
    this._engines.set("internal:role", createRoleEngine(true));
    for (const { name, engine } of customEngines)
      this._engines.set(name, engine);
    this._stableRafCount = stableRafCount;
    this._browserName = browserName;
    setBrowserName(browserName);
    this._setupGlobalListenersRemovalDetection();
    this._setupHitTargetInterceptors();
    if (isUnderTest)
      this.window.__injectedScript = this;
  }
  eval(expression) {
    return this.window.eval(expression);
  }
  testIdAttributeNameForStrictErrorAndConsoleCodegen() {
    return this._testIdAttributeNameForStrictErrorAndConsoleCodegen;
  }
  parseSelector(selector) {
    const result = parseSelector(selector);
    visitAllSelectorParts(result, (part) => {
      if (!this._engines.has(part.name))
        throw this.createStacklessError(\`Unknown engine "\${part.name}" while parsing selector \${selector}\`);
    });
    return result;
  }
  generateSelector(targetElement, options) {
    return generateSelector(this, targetElement, options);
  }
  generateSelectorSimple(targetElement, options) {
    return generateSelector(this, targetElement, { ...options, testIdAttributeName: this._testIdAttributeNameForStrictErrorAndConsoleCodegen }).selector;
  }
  querySelector(selector, root, strict) {
    const result = this.querySelectorAll(selector, root);
    if (strict && result.length > 1)
      throw this.strictModeViolationError(selector, result);
    return result[0];
  }
  _queryNth(elements, part) {
    const list = [...elements];
    let nth = +part.body;
    if (nth === -1)
      nth = list.length - 1;
    return new Set(list.slice(nth, nth + 1));
  }
  _queryLayoutSelector(elements, part, originalRoot) {
    const name = part.name;
    const body = part.body;
    const result = [];
    const inner = this.querySelectorAll(body.parsed, originalRoot);
    for (const element of elements) {
      const score = layoutSelectorScore(name, element, inner, body.distance);
      if (score !== void 0)
        result.push({ element, score });
    }
    result.sort((a, b) => a.score - b.score);
    return new Set(result.map((r) => r.element));
  }
  querySelectorAll(selector, root) {
    if (selector.capture !== void 0) {
      if (selector.parts.some((part) => part.name === "nth"))
        throw this.createStacklessError(\`Can't query n-th element in a request with the capture.\`);
      const withHas = { parts: selector.parts.slice(0, selector.capture + 1) };
      if (selector.capture < selector.parts.length - 1) {
        const parsed = { parts: selector.parts.slice(selector.capture + 1) };
        const has = { name: "internal:has", body: { parsed }, source: stringifySelector(parsed) };
        withHas.parts.push(has);
      }
      return this.querySelectorAll(withHas, root);
    }
    if (!root["querySelectorAll"])
      throw this.createStacklessError("Node is not queryable.");
    if (selector.capture !== void 0) {
      throw this.createStacklessError("Internal error: there should not be a capture in the selector.");
    }
    if (root.nodeType === 11 && selector.parts.length === 1 && selector.parts[0].name === "css" && selector.parts[0].source === ":scope")
      return [root];
    this._evaluator.begin();
    try {
      let roots = /* @__PURE__ */ new Set([root]);
      for (const part of selector.parts) {
        if (part.name === "nth") {
          roots = this._queryNth(roots, part);
        } else if (part.name === "internal:and") {
          const andElements = this.querySelectorAll(part.body.parsed, root);
          roots = new Set(andElements.filter((e) => roots.has(e)));
        } else if (part.name === "internal:or") {
          const orElements = this.querySelectorAll(part.body.parsed, root);
          roots = new Set(sortInDOMOrder(/* @__PURE__ */ new Set([...roots, ...orElements])));
        } else if (kLayoutSelectorNames.includes(part.name)) {
          roots = this._queryLayoutSelector(roots, part, root);
        } else {
          const next = /* @__PURE__ */ new Set();
          for (const root2 of roots) {
            const all = this._queryEngineAll(part, root2);
            for (const one of all)
              next.add(one);
          }
          roots = next;
        }
      }
      return [...roots];
    } finally {
      this._evaluator.end();
    }
  }
  _queryEngineAll(part, root) {
    const result = this._engines.get(part.name).queryAll(root, part.body);
    for (const element of result) {
      if (!("nodeName" in element))
        throw this.createStacklessError(\`Expected a Node but got \${Object.prototype.toString.call(element)}\`);
    }
    return result;
  }
  _createAttributeEngine(attribute, shadow) {
    const toCSS = (selector) => {
      const css = \`[\${attribute}=\${JSON.stringify(selector)}]\`;
      return [{ simples: [{ selector: { css, functions: [] }, combinator: "" }] }];
    };
    return {
      queryAll: (root, selector) => {
        return this._evaluator.query({ scope: root, pierceShadow: shadow }, toCSS(selector));
      }
    };
  }
  _createCSSEngine() {
    return {
      queryAll: (root, body) => {
        return this._evaluator.query({ scope: root, pierceShadow: true }, body);
      }
    };
  }
  _createTextEngine(shadow, internal) {
    const queryAll = (root, selector) => {
      const { matcher, kind } = createTextMatcher(selector, internal);
      const result = [];
      let lastDidNotMatchSelf = null;
      const appendElement = (element) => {
        if (kind === "lax" && lastDidNotMatchSelf && lastDidNotMatchSelf.contains(element))
          return false;
        const matches = elementMatchesText(this._evaluator._cacheText, element, matcher);
        if (matches === "none")
          lastDidNotMatchSelf = element;
        if (matches === "self" || matches === "selfAndChildren" && kind === "strict" && !internal)
          result.push(element);
      };
      if (root.nodeType === Node.ELEMENT_NODE)
        appendElement(root);
      const elements = this._evaluator._queryCSS({ scope: root, pierceShadow: shadow }, "*");
      for (const element of elements)
        appendElement(element);
      return result;
    };
    return { queryAll };
  }
  _createInternalHasTextEngine() {
    return {
      queryAll: (root, selector) => {
        if (root.nodeType !== 1)
          return [];
        const element = root;
        const text = elementText(this._evaluator._cacheText, element);
        const { matcher } = createTextMatcher(selector, true);
        return matcher(text) ? [element] : [];
      }
    };
  }
  _createInternalHasNotTextEngine() {
    return {
      queryAll: (root, selector) => {
        if (root.nodeType !== 1)
          return [];
        const element = root;
        const text = elementText(this._evaluator._cacheText, element);
        const { matcher } = createTextMatcher(selector, true);
        return matcher(text) ? [] : [element];
      }
    };
  }
  _createInternalLabelEngine() {
    return {
      queryAll: (root, selector) => {
        const { matcher } = createTextMatcher(selector, true);
        const allElements = this._evaluator._queryCSS({ scope: root, pierceShadow: true }, "*");
        return allElements.filter((element) => {
          return getElementLabels(this._evaluator._cacheText, element).some((label) => matcher(label));
        });
      }
    };
  }
  _createNamedAttributeEngine() {
    const queryAll = (root, selector) => {
      const parsed = parseAttributeSelector(selector, true);
      if (parsed.name || parsed.attributes.length !== 1)
        throw new Error("Malformed attribute selector: " + selector);
      const { name, value, caseSensitive } = parsed.attributes[0];
      const lowerCaseValue = caseSensitive ? null : value.toLowerCase();
      let matcher;
      if (value instanceof RegExp)
        matcher = (s) => !!s.match(value);
      else if (caseSensitive)
        matcher = (s) => s === value;
      else
        matcher = (s) => s.toLowerCase().includes(lowerCaseValue);
      const elements = this._evaluator._queryCSS({ scope: root, pierceShadow: true }, \`[\${name}]\`);
      return elements.filter((e) => matcher(e.getAttribute(name)));
    };
    return { queryAll };
  }
  _createControlEngine() {
    return {
      queryAll(root, body) {
        if (body === "enter-frame")
          return [];
        if (body === "return-empty")
          return [];
        if (body === "component") {
          if (root.nodeType !== 1)
            return [];
          return [root.childElementCount === 1 ? root.firstElementChild : root];
        }
        throw new Error(\`Internal error, unknown internal:control selector \${body}\`);
      }
    };
  }
  _createHasEngine() {
    const queryAll = (root, body) => {
      if (root.nodeType !== 1)
        return [];
      const has = !!this.querySelector(body.parsed, root, false);
      return has ? [root] : [];
    };
    return { queryAll };
  }
  _createHasNotEngine() {
    const queryAll = (root, body) => {
      if (root.nodeType !== 1)
        return [];
      const has = !!this.querySelector(body.parsed, root, false);
      return has ? [] : [root];
    };
    return { queryAll };
  }
  _createVisibleEngine() {
    const queryAll = (root, body) => {
      if (root.nodeType !== 1)
        return [];
      return isElementVisible(root) === Boolean(body) ? [root] : [];
    };
    return { queryAll };
  }
  _createInternalChainEngine() {
    const queryAll = (root, body) => {
      return this.querySelectorAll(body.parsed, root);
    };
    return { queryAll };
  }
  extend(source, params) {
    const constrFunction = this.window.eval(\`
    (() => {
      const module = {};
      \${source}
      return module.exports.default();
    })()\`);
    return new constrFunction(this, params);
  }
  isVisible(element) {
    return isElementVisible(element);
  }
  async viewportRatio(element) {
    return await new Promise((resolve) => {
      const observer = new IntersectionObserver((entries) => {
        resolve(entries[0].intersectionRatio);
        observer.disconnect();
      });
      observer.observe(element);
      requestAnimationFrame(() => {
      });
    });
  }
  getElementBorderWidth(node) {
    if (node.nodeType !== Node.ELEMENT_NODE || !node.ownerDocument || !node.ownerDocument.defaultView)
      return { left: 0, top: 0 };
    const style = node.ownerDocument.defaultView.getComputedStyle(node);
    return { left: parseInt(style.borderLeftWidth || "", 10), top: parseInt(style.borderTopWidth || "", 10) };
  }
  describeIFrameStyle(iframe) {
    if (!iframe.ownerDocument || !iframe.ownerDocument.defaultView)
      return "error:notconnected";
    const defaultView = iframe.ownerDocument.defaultView;
    for (let e = iframe; e; e = parentElementOrShadowHost(e)) {
      if (defaultView.getComputedStyle(e).transform !== "none")
        return "transformed";
    }
    const iframeStyle = defaultView.getComputedStyle(iframe);
    return {
      left: parseInt(iframeStyle.borderLeftWidth || "", 10) + parseInt(iframeStyle.paddingLeft || "", 10),
      top: parseInt(iframeStyle.borderTopWidth || "", 10) + parseInt(iframeStyle.paddingTop || "", 10)
    };
  }
  retarget(node, behavior) {
    let element = node.nodeType === Node.ELEMENT_NODE ? node : node.parentElement;
    if (!element)
      return null;
    if (behavior === "none")
      return element;
    if (!element.matches("input, textarea, select") && !element.isContentEditable) {
      if (behavior === "button-link")
        element = element.closest("button, [role=button], a, [role=link]") || element;
      else
        element = element.closest("button, [role=button], [role=checkbox], [role=radio]") || element;
    }
    if (behavior === "follow-label") {
      if (!element.matches("input, textarea, button, select, [role=button], [role=checkbox], [role=radio]") && !element.isContentEditable) {
        element = element.closest("label") || element;
      }
      if (element.nodeName === "LABEL")
        element = element.control || element;
    }
    return element;
  }
  async checkElementStates(node, states) {
    if (states.includes("stable")) {
      const stableResult = await this._checkElementIsStable(node);
      if (stableResult === false)
        return { missingState: "stable" };
      if (stableResult === "error:notconnected")
        return stableResult;
    }
    for (const state of states) {
      if (state !== "stable") {
        const result = this.elementState(node, state);
        if (result === false)
          return { missingState: state };
        if (result === "error:notconnected")
          return result;
      }
    }
  }
  async _checkElementIsStable(node) {
    const continuePolling = Symbol("continuePolling");
    let lastRect;
    let stableRafCounter = 0;
    let lastTime = 0;
    const check = () => {
      const element = this.retarget(node, "no-follow-label");
      if (!element)
        return "error:notconnected";
      const time = performance.now();
      if (this._stableRafCount > 1 && time - lastTime < 15)
        return continuePolling;
      lastTime = time;
      const clientRect = element.getBoundingClientRect();
      const rect = { x: clientRect.top, y: clientRect.left, width: clientRect.width, height: clientRect.height };
      if (lastRect) {
        const samePosition = rect.x === lastRect.x && rect.y === lastRect.y && rect.width === lastRect.width && rect.height === lastRect.height;
        if (!samePosition)
          return false;
        if (++stableRafCounter >= this._stableRafCount)
          return true;
      }
      lastRect = rect;
      return continuePolling;
    };
    let fulfill;
    let reject;
    const result = new Promise((f, r) => {
      fulfill = f;
      reject = r;
    });
    const raf = () => {
      try {
        const success = check();
        if (success !== continuePolling)
          fulfill(success);
        else
          requestAnimationFrame(raf);
      } catch (e) {
        reject(e);
      }
    };
    requestAnimationFrame(raf);
    return result;
  }
  elementState(node, state) {
    const element = this.retarget(node, ["stable", "visible", "hidden"].includes(state) ? "none" : "follow-label");
    if (!element || !element.isConnected) {
      if (state === "hidden")
        return true;
      return "error:notconnected";
    }
    if (state === "visible")
      return this.isVisible(element);
    if (state === "hidden")
      return !this.isVisible(element);
    const disabled = getAriaDisabled(element);
    if (state === "disabled")
      return disabled;
    if (state === "enabled")
      return !disabled;
    const editable = !(["INPUT", "TEXTAREA", "SELECT"].includes(element.nodeName) && element.hasAttribute("readonly"));
    if (state === "editable")
      return !disabled && editable;
    if (state === "checked" || state === "unchecked") {
      const need = state === "checked";
      const checked = getChecked(element, false);
      if (checked === "error")
        throw this.createStacklessError("Not a checkbox or radio button");
      return need === checked;
    }
    throw this.createStacklessError(\`Unexpected element state "\${state}"\`);
  }
  selectOptions(node, optionsToSelect) {
    const element = this.retarget(node, "follow-label");
    if (!element)
      return "error:notconnected";
    if (element.nodeName.toLowerCase() !== "select")
      throw this.createStacklessError("Element is not a <select> element");
    const select = element;
    const options = [...select.options];
    const selectedOptions = [];
    let remainingOptionsToSelect = optionsToSelect.slice();
    for (let index = 0; index < options.length; index++) {
      const option = options[index];
      const filter = (optionToSelect) => {
        if (optionToSelect instanceof Node)
          return option === optionToSelect;
        let matches = true;
        if (optionToSelect.valueOrLabel !== void 0)
          matches = matches && (optionToSelect.valueOrLabel === option.value || optionToSelect.valueOrLabel === option.label);
        if (optionToSelect.value !== void 0)
          matches = matches && optionToSelect.value === option.value;
        if (optionToSelect.label !== void 0)
          matches = matches && optionToSelect.label === option.label;
        if (optionToSelect.index !== void 0)
          matches = matches && optionToSelect.index === index;
        return matches;
      };
      if (!remainingOptionsToSelect.some(filter))
        continue;
      selectedOptions.push(option);
      if (select.multiple) {
        remainingOptionsToSelect = remainingOptionsToSelect.filter((o) => !filter(o));
      } else {
        remainingOptionsToSelect = [];
        break;
      }
    }
    if (remainingOptionsToSelect.length)
      return "error:optionsnotfound";
    select.value = void 0;
    selectedOptions.forEach((option) => option.selected = true);
    select.dispatchEvent(new Event("input", { bubbles: true, composed: true }));
    select.dispatchEvent(new Event("change", { bubbles: true }));
    return selectedOptions.map((option) => option.value);
  }
  fill(node, value) {
    const element = this.retarget(node, "follow-label");
    if (!element)
      return "error:notconnected";
    if (element.nodeName.toLowerCase() === "input") {
      const input = element;
      const type = input.type.toLowerCase();
      const kInputTypesToSetValue = /* @__PURE__ */ new Set(["color", "date", "time", "datetime-local", "month", "range", "week"]);
      const kInputTypesToTypeInto = /* @__PURE__ */ new Set(["", "email", "number", "password", "search", "tel", "text", "url"]);
      if (!kInputTypesToTypeInto.has(type) && !kInputTypesToSetValue.has(type))
        throw this.createStacklessError(\`Input of type "\${type}" cannot be filled\`);
      if (type === "number") {
        value = value.trim();
        if (isNaN(Number(value)))
          throw this.createStacklessError("Cannot type text into input[type=number]");
      }
      if (kInputTypesToSetValue.has(type)) {
        value = value.trim();
        input.focus();
        input.value = value;
        if (input.value !== value)
          throw this.createStacklessError("Malformed value");
        element.dispatchEvent(new Event("input", { bubbles: true, composed: true }));
        element.dispatchEvent(new Event("change", { bubbles: true }));
        return "done";
      }
    } else if (element.nodeName.toLowerCase() === "textarea") {
    } else if (!element.isContentEditable) {
      throw this.createStacklessError("Element is not an <input>, <textarea> or [contenteditable] element");
    }
    this.selectText(element);
    return "needsinput";
  }
  selectText(node) {
    const element = this.retarget(node, "follow-label");
    if (!element)
      return "error:notconnected";
    if (element.nodeName.toLowerCase() === "input") {
      const input = element;
      input.select();
      input.focus();
      return "done";
    }
    if (element.nodeName.toLowerCase() === "textarea") {
      const textarea = element;
      textarea.selectionStart = 0;
      textarea.selectionEnd = textarea.value.length;
      textarea.focus();
      return "done";
    }
    const range = element.ownerDocument.createRange();
    range.selectNodeContents(element);
    const selection = element.ownerDocument.defaultView.getSelection();
    if (selection) {
      selection.removeAllRanges();
      selection.addRange(range);
    }
    element.focus();
    return "done";
  }
  _activelyFocused(node) {
    const activeElement = node.getRootNode().activeElement;
    const isFocused = activeElement === node && !!node.ownerDocument && node.ownerDocument.hasFocus();
    return { activeElement, isFocused };
  }
  focusNode(node, resetSelectionIfNotFocused) {
    if (!node.isConnected)
      return "error:notconnected";
    if (node.nodeType !== Node.ELEMENT_NODE)
      throw this.createStacklessError("Node is not an element");
    const { activeElement, isFocused: wasFocused } = this._activelyFocused(node);
    if (node.isContentEditable && !wasFocused && activeElement && activeElement.blur) {
      activeElement.blur();
    }
    node.focus();
    node.focus();
    if (resetSelectionIfNotFocused && !wasFocused && node.nodeName.toLowerCase() === "input") {
      try {
        const input = node;
        input.setSelectionRange(0, 0);
      } catch (e) {
      }
    }
    return "done";
  }
  blurNode(node) {
    if (!node.isConnected)
      return "error:notconnected";
    if (node.nodeType !== Node.ELEMENT_NODE)
      throw this.createStacklessError("Node is not an element");
    node.blur();
    return "done";
  }
  setInputFiles(node, payloads) {
    if (node.nodeType !== Node.ELEMENT_NODE)
      return "Node is not of type HTMLElement";
    const element = node;
    if (element.nodeName !== "INPUT")
      return "Not an <input> element";
    const input = element;
    const type = (input.getAttribute("type") || "").toLowerCase();
    if (type !== "file")
      return "Not an input[type=file] element";
    const files = payloads.map((file) => {
      const bytes = Uint8Array.from(atob(file.buffer), (c) => c.charCodeAt(0));
      return new File([bytes], file.name, { type: file.mimeType, lastModified: file.lastModifiedMs });
    });
    const dt = new DataTransfer();
    for (const file of files)
      dt.items.add(file);
    input.files = dt.files;
    input.dispatchEvent(new Event("input", { bubbles: true, composed: true }));
    input.dispatchEvent(new Event("change", { bubbles: true }));
  }
  expectHitTarget(hitPoint, targetElement) {
    const roots = [];
    let parentElement = targetElement;
    while (parentElement) {
      const root = enclosingShadowRootOrDocument(parentElement);
      if (!root)
        break;
      roots.push(root);
      if (root.nodeType === 9)
        break;
      parentElement = root.host;
    }
    let hitElement;
    for (let index = roots.length - 1; index >= 0; index--) {
      const root = roots[index];
      const elements = root.elementsFromPoint(hitPoint.x, hitPoint.y);
      const singleElement = root.elementFromPoint(hitPoint.x, hitPoint.y);
      if (singleElement && elements[0] && parentElementOrShadowHost(singleElement) === elements[0]) {
        const style = this.window.getComputedStyle(singleElement);
        if ((style == null ? void 0 : style.display) === "contents") {
          elements.unshift(singleElement);
        }
      }
      if (elements[0] && elements[0].shadowRoot === root && elements[1] === singleElement) {
        elements.shift();
      }
      const innerElement = elements[0];
      if (!innerElement)
        break;
      hitElement = innerElement;
      if (index && innerElement !== roots[index - 1].host)
        break;
    }
    const hitParents = [];
    while (hitElement && hitElement !== targetElement) {
      hitParents.push(hitElement);
      hitElement = parentElementOrShadowHost(hitElement);
    }
    if (hitElement === targetElement)
      return "done";
    const hitTargetDescription = this.previewNode(hitParents[0] || this.document.documentElement);
    let rootHitTargetDescription;
    let element = targetElement;
    while (element) {
      const index = hitParents.indexOf(element);
      if (index !== -1) {
        if (index > 1)
          rootHitTargetDescription = this.previewNode(hitParents[index - 1]);
        break;
      }
      element = parentElementOrShadowHost(element);
    }
    if (rootHitTargetDescription)
      return { hitTargetDescription: \`\${hitTargetDescription} from \${rootHitTargetDescription} subtree\` };
    return { hitTargetDescription };
  }
  // Life of a pointer action, for example click.
  //
  // 0. Retry items 1 and 2 while action fails due to navigation or element being detached.
  //   1. Resolve selector to an element.
  //   2. Retry the following steps until the element is detached or frame navigates away.
  //     2a. Wait for the element to be stable (not moving), visible and enabled.
  //     2b. Scroll element into view. Scrolling alternates between:
  //         - Built-in protocol scrolling.
  //         - Anchoring to the top/left, bottom/right and center/center.
  //         This is to scroll elements from under sticky headers/footers.
  //     2c. Click point is calculated, either based on explicitly specified position,
  //         or some visible point of the element based on protocol content quads.
  //     2d. Click point relative to page viewport is converted relative to the target iframe
  //         for the next hit-point check.
  //     2e. (injected) Hit target at the click point must be a descendant of the target element.
  //         This prevents mis-clicking in edge cases like <iframe> overlaying the target.
  //     2f. (injected) Events specific for click (or some other action type) are intercepted on
  //         the Window with capture:true. See 2i for details.
  //         Note: this step is skipped for drag&drop (see inline comments for the reason).
  //     2g. Necessary keyboard modifiers are pressed.
  //     2h. Click event is issued (mousemove + mousedown + mouseup).
  //     2i. (injected) For each event, we check that hit target at the event point
  //         is a descendant of the target element.
  //         This guarantees no race between issuing the event and handling it in the page,
  //         for example due to layout shift.
  //         When hit target check fails, we block all future events in the page.
  //     2j. Keyboard modifiers are restored.
  //     2k. (injected) Event interceptor is removed.
  //     2l. All navigations triggered between 2g-2k are awaited to be either committed or canceled.
  //     2m. If failed, wait for increasing amount of time before the next retry.
  setupHitTargetInterceptor(node, action, hitPoint, blockAllEvents) {
    const element = this.retarget(node, "button-link");
    if (!element || !element.isConnected)
      return "error:notconnected";
    if (hitPoint) {
      const preliminaryResult = this.expectHitTarget(hitPoint, element);
      if (preliminaryResult !== "done")
        return preliminaryResult.hitTargetDescription;
    }
    if (action === "drag")
      return { stop: () => "done" };
    const events = {
      "hover": kHoverHitTargetInterceptorEvents,
      "tap": kTapHitTargetInterceptorEvents,
      "mouse": kMouseHitTargetInterceptorEvents
    }[action];
    let result;
    const listener = (event) => {
      if (!events.has(event.type))
        return;
      if (!event.isTrusted)
        return;
      const point = !!this.window.TouchEvent && event instanceof this.window.TouchEvent ? event.touches[0] : event;
      if (result === void 0 && point)
        result = this.expectHitTarget({ x: point.clientX, y: point.clientY }, element);
      if (blockAllEvents || result !== "done" && result !== void 0) {
        event.preventDefault();
        event.stopPropagation();
        event.stopImmediatePropagation();
      }
    };
    const stop = () => {
      if (this._hitTargetInterceptor === listener)
        this._hitTargetInterceptor = void 0;
      return result || "done";
    };
    this._hitTargetInterceptor = listener;
    return { stop };
  }
  dispatchEvent(node, type, eventInit) {
    let event;
    eventInit = { bubbles: true, cancelable: true, composed: true, ...eventInit };
    switch (eventType.get(type)) {
      case "mouse":
        event = new MouseEvent(type, eventInit);
        break;
      case "keyboard":
        event = new KeyboardEvent(type, eventInit);
        break;
      case "touch":
        event = new TouchEvent(type, eventInit);
        break;
      case "pointer":
        event = new PointerEvent(type, eventInit);
        break;
      case "focus":
        event = new FocusEvent(type, eventInit);
        break;
      case "drag":
        event = new DragEvent(type, eventInit);
        break;
      case "wheel":
        event = new WheelEvent(type, eventInit);
        break;
      case "deviceorientation":
        try {
          event = new DeviceOrientationEvent(type, eventInit);
        } catch {
          const { bubbles, cancelable, alpha, beta, gamma, absolute } = eventInit;
          event = this.document.createEvent("DeviceOrientationEvent");
          event.initDeviceOrientationEvent(type, bubbles, cancelable, alpha, beta, gamma, absolute);
        }
        break;
      case "devicemotion":
        try {
          event = new DeviceMotionEvent(type, eventInit);
        } catch {
          const { bubbles, cancelable, acceleration, accelerationIncludingGravity, rotationRate, interval } = eventInit;
          event = this.document.createEvent("DeviceMotionEvent");
          event.initDeviceMotionEvent(type, bubbles, cancelable, acceleration, accelerationIncludingGravity, rotationRate, interval);
        }
        break;
      default:
        event = new Event(type, eventInit);
        break;
    }
    node.dispatchEvent(event);
  }
  previewNode(node) {
    if (node.nodeType === Node.TEXT_NODE)
      return oneLine(\`#text=\${node.nodeValue || ""}\`);
    if (node.nodeType !== Node.ELEMENT_NODE)
      return oneLine(\`<\${node.nodeName.toLowerCase()} />\`);
    const element = node;
    const attrs = [];
    for (let i = 0; i < element.attributes.length; i++) {
      const { name, value } = element.attributes[i];
      if (name === "style")
        continue;
      if (!value && booleanAttributes.has(name))
        attrs.push(\` \${name}\`);
      else
        attrs.push(\` \${name}="\${value}"\`);
    }
    attrs.sort((a, b) => a.length - b.length);
    const attrText = trimStringWithEllipsis(attrs.join(""), 50);
    if (autoClosingTags.has(element.nodeName))
      return oneLine(\`<\${element.nodeName.toLowerCase()}\${attrText}/>\`);
    const children = element.childNodes;
    let onlyText = false;
    if (children.length <= 5) {
      onlyText = true;
      for (let i = 0; i < children.length; i++)
        onlyText = onlyText && children[i].nodeType === Node.TEXT_NODE;
    }
    const text = onlyText ? element.textContent || "" : children.length ? "\\u2026" : "";
    return oneLine(\`<\${element.nodeName.toLowerCase()}\${attrText}>\${trimStringWithEllipsis(text, 50)}</\${element.nodeName.toLowerCase()}>\`);
  }
  strictModeViolationError(selector, matches) {
    const infos = matches.slice(0, 10).map((m) => ({
      preview: this.previewNode(m),
      selector: this.generateSelectorSimple(m)
    }));
    const lines = infos.map((info, i) => \`
    \${i + 1}) \${info.preview} aka \${asLocator(this._sdkLanguage, info.selector)}\`);
    if (infos.length < matches.length)
      lines.push("\\n    ...");
    return this.createStacklessError(\`strict mode violation: \${asLocator(this._sdkLanguage, stringifySelector(selector))} resolved to \${matches.length} elements:\${lines.join("")}
\`);
  }
  createStacklessError(message) {
    if (this._browserName === "firefox") {
      const error2 = new Error("Error: " + message);
      error2.stack = "";
      return error2;
    }
    const error = new Error(message);
    delete error.stack;
    return error;
  }
  createHighlight() {
    return new Highlight(this);
  }
  maskSelectors(selectors, color) {
    if (this._highlight)
      this.hideHighlight();
    this._highlight = new Highlight(this);
    this._highlight.install();
    const elements = [];
    for (const selector of selectors)
      elements.push(this.querySelectorAll(selector, this.document.documentElement));
    this._highlight.maskElements(elements.flat(), color);
  }
  highlight(selector) {
    if (!this._highlight) {
      this._highlight = new Highlight(this);
      this._highlight.install();
    }
    this._highlight.runHighlightOnRaf(selector);
  }
  hideHighlight() {
    if (this._highlight) {
      this._highlight.uninstall();
      delete this._highlight;
    }
  }
  markTargetElements(markedElements, callId) {
    const customEvent = new CustomEvent("__playwright_target__", {
      bubbles: true,
      cancelable: true,
      detail: callId,
      composed: true
    });
    for (const element of markedElements)
      element.dispatchEvent(customEvent);
  }
  _setupGlobalListenersRemovalDetection() {
    const customEventName = "__playwright_global_listeners_check__";
    let seenEvent = false;
    const handleCustomEvent = () => seenEvent = true;
    this.window.addEventListener(customEventName, handleCustomEvent);
    new MutationObserver((entries) => {
      const newDocumentElement = entries.some((entry) => Array.from(entry.addedNodes).includes(this.document.documentElement));
      if (!newDocumentElement)
        return;
      seenEvent = false;
      this.window.dispatchEvent(new CustomEvent(customEventName));
      if (seenEvent)
        return;
      this.window.addEventListener(customEventName, handleCustomEvent);
      for (const callback of this.onGlobalListenersRemoved)
        callback();
    }).observe(this.document, { childList: true });
  }
  _setupHitTargetInterceptors() {
    const listener = (event) => {
      var _a;
      return (_a = this._hitTargetInterceptor) == null ? void 0 : _a.call(this, event);
    };
    const addHitTargetInterceptorListeners = () => {
      for (const event of kAllHitTargetInterceptorEvents)
        this.window.addEventListener(event, listener, { capture: true, passive: false });
    };
    addHitTargetInterceptorListeners();
    this.onGlobalListenersRemoved.add(addHitTargetInterceptorListeners);
  }
  async expect(element, options, elements) {
    const isArray = options.expression === "to.have.count" || options.expression.endsWith(".array");
    if (isArray)
      return this.expectArray(elements, options);
    if (!element) {
      if (!options.isNot && options.expression === "to.be.hidden")
        return { matches: true };
      if (options.isNot && options.expression === "to.be.visible")
        return { matches: false };
      if (!options.isNot && options.expression === "to.be.detached")
        return { matches: true };
      if (options.isNot && options.expression === "to.be.attached")
        return { matches: false };
      if (options.isNot && options.expression === "to.be.in.viewport")
        return { matches: false };
      return { matches: options.isNot, missingReceived: true };
    }
    return await this.expectSingleElement(element, options);
  }
  async expectSingleElement(element, options) {
    var _a, _b;
    const expression = options.expression;
    {
      let elementState;
      if (expression === "to.have.attribute") {
        elementState = element.hasAttribute(options.expressionArg);
      } else if (expression === "to.be.checked") {
        elementState = this.elementState(element, "checked");
      } else if (expression === "to.be.unchecked") {
        elementState = this.elementState(element, "unchecked");
      } else if (expression === "to.be.disabled") {
        elementState = this.elementState(element, "disabled");
      } else if (expression === "to.be.editable") {
        elementState = this.elementState(element, "editable");
      } else if (expression === "to.be.readonly") {
        elementState = !this.elementState(element, "editable");
      } else if (expression === "to.be.empty") {
        if (element.nodeName === "INPUT" || element.nodeName === "TEXTAREA")
          elementState = !element.value;
        else
          elementState = !((_a = element.textContent) == null ? void 0 : _a.trim());
      } else if (expression === "to.be.enabled") {
        elementState = this.elementState(element, "enabled");
      } else if (expression === "to.be.focused") {
        elementState = this._activelyFocused(element).isFocused;
      } else if (expression === "to.be.hidden") {
        elementState = this.elementState(element, "hidden");
      } else if (expression === "to.be.visible") {
        elementState = this.elementState(element, "visible");
      } else if (expression === "to.be.attached") {
        elementState = true;
      } else if (expression === "to.be.detached") {
        elementState = false;
      }
      if (elementState !== void 0) {
        if (elementState === "error:notcheckbox")
          throw this.createStacklessError("Element is not a checkbox");
        if (elementState === "error:notconnected")
          throw this.createStacklessError("Element is not connected");
        return { received: elementState, matches: elementState };
      }
    }
    {
      if (expression === "to.have.property") {
        let target = element;
        const properties = options.expressionArg.split(".");
        for (let i = 0; i < properties.length - 1; i++) {
          if (typeof target !== "object" || !(properties[i] in target))
            return { received: void 0, matches: false };
          target = target[properties[i]];
        }
        const received = target[properties[properties.length - 1]];
        const matches = deepEquals(received, options.expectedValue);
        return { received, matches };
      }
    }
    {
      if (expression === "to.be.in.viewport") {
        const ratio = await this.viewportRatio(element);
        return { received: \`viewport ratio \${ratio}\`, matches: ratio > 0 && ratio > ((_b = options.expectedNumber) != null ? _b : 0) - 1e-9 };
      }
    }
    {
      if (expression === "to.have.values") {
        element = this.retarget(element, "follow-label");
        if (element.nodeName !== "SELECT" || !element.multiple)
          throw this.createStacklessError("Not a select element with a multiple attribute");
        const received = [...element.selectedOptions].map((o) => o.value);
        if (received.length !== options.expectedText.length)
          return { received, matches: false };
        return { received, matches: received.map((r, i) => new ExpectedTextMatcher(options.expectedText[i]).matches(r)).every(Boolean) };
      }
    }
    {
      let received;
      if (expression === "to.have.attribute.value") {
        const value = element.getAttribute(options.expressionArg);
        if (value === null)
          return { received: null, matches: false };
        received = value;
      } else if (expression === "to.have.class") {
        received = element.classList.toString();
      } else if (expression === "to.have.css") {
        received = this.window.getComputedStyle(element).getPropertyValue(options.expressionArg);
      } else if (expression === "to.have.id") {
        received = element.id;
      } else if (expression === "to.have.text") {
        received = options.useInnerText ? element.innerText : elementText(/* @__PURE__ */ new Map(), element).full;
      } else if (expression === "to.have.accessible.name") {
        received = getElementAccessibleName(
          element,
          false
          /* includeHidden */
        );
      } else if (expression === "to.have.accessible.description") {
        received = getElementAccessibleDescription(
          element,
          false
          /* includeHidden */
        );
      } else if (expression === "to.have.role") {
        received = getAriaRole(element) || "";
      } else if (expression === "to.have.title") {
        received = this.document.title;
      } else if (expression === "to.have.url") {
        received = this.document.location.href;
      } else if (expression === "to.have.value") {
        element = this.retarget(element, "follow-label");
        if (element.nodeName !== "INPUT" && element.nodeName !== "TEXTAREA" && element.nodeName !== "SELECT")
          throw this.createStacklessError("Not an input element");
        received = element.value;
      }
      if (received !== void 0 && options.expectedText) {
        const matcher = new ExpectedTextMatcher(options.expectedText[0]);
        return { received, matches: matcher.matches(received) };
      }
    }
    throw this.createStacklessError("Unknown expect matcher: " + expression);
  }
  expectArray(elements, options) {
    const expression = options.expression;
    if (expression === "to.have.count") {
      const received2 = elements.length;
      const matches = received2 === options.expectedNumber;
      return { received: received2, matches };
    }
    let received;
    if (expression === "to.have.text.array" || expression === "to.contain.text.array")
      received = elements.map((e) => options.useInnerText ? e.innerText : elementText(/* @__PURE__ */ new Map(), e).full);
    else if (expression === "to.have.class.array")
      received = elements.map((e) => e.classList.toString());
    if (received && options.expectedText) {
      const lengthShouldMatch = expression !== "to.contain.text.array";
      const matchesLength = received.length === options.expectedText.length || !lengthShouldMatch;
      if (!matchesLength)
        return { received, matches: false };
      const matchers = options.expectedText.map((e) => new ExpectedTextMatcher(e));
      let mIndex = 0, rIndex = 0;
      while (mIndex < matchers.length && rIndex < received.length) {
        if (matchers[mIndex].matches(received[rIndex]))
          ++mIndex;
        ++rIndex;
      }
      return { received, matches: mIndex === matchers.length };
    }
    throw this.createStacklessError("Unknown expect matcher: " + expression);
  }
  getElementAccessibleName(element, includeHidden) {
    return getElementAccessibleName(element, !!includeHidden);
  }
  getElementAccessibleDescription(element, includeHidden) {
    return getElementAccessibleDescription(element, !!includeHidden);
  }
  getAriaRole(element) {
    return getAriaRole(element);
  }
};
var autoClosingTags = /* @__PURE__ */ new Set(["AREA", "BASE", "BR", "COL", "COMMAND", "EMBED", "HR", "IMG", "INPUT", "KEYGEN", "LINK", "MENUITEM", "META", "PARAM", "SOURCE", "TRACK", "WBR"]);
var booleanAttributes = /* @__PURE__ */ new Set(["checked", "selected", "disabled", "readonly", "multiple"]);
function oneLine(s) {
  return s.replace(/\\n/g, "\\u21B5").replace(/\\t/g, "\\u21C6");
}
var eventType = /* @__PURE__ */ new Map([
  ["auxclick", "mouse"],
  ["click", "mouse"],
  ["dblclick", "mouse"],
  ["mousedown", "mouse"],
  ["mouseeenter", "mouse"],
  ["mouseleave", "mouse"],
  ["mousemove", "mouse"],
  ["mouseout", "mouse"],
  ["mouseover", "mouse"],
  ["mouseup", "mouse"],
  ["mouseleave", "mouse"],
  ["mousewheel", "mouse"],
  ["keydown", "keyboard"],
  ["keyup", "keyboard"],
  ["keypress", "keyboard"],
  ["textInput", "keyboard"],
  ["touchstart", "touch"],
  ["touchmove", "touch"],
  ["touchend", "touch"],
  ["touchcancel", "touch"],
  ["pointerover", "pointer"],
  ["pointerout", "pointer"],
  ["pointerenter", "pointer"],
  ["pointerleave", "pointer"],
  ["pointerdown", "pointer"],
  ["pointerup", "pointer"],
  ["pointermove", "pointer"],
  ["pointercancel", "pointer"],
  ["gotpointercapture", "pointer"],
  ["lostpointercapture", "pointer"],
  ["focus", "focus"],
  ["blur", "focus"],
  ["drag", "drag"],
  ["dragstart", "drag"],
  ["dragend", "drag"],
  ["dragover", "drag"],
  ["dragenter", "drag"],
  ["dragleave", "drag"],
  ["dragexit", "drag"],
  ["drop", "drag"],
  ["wheel", "wheel"],
  ["deviceorientation", "deviceorientation"],
  ["deviceorientationabsolute", "deviceorientation"],
  ["devicemotion", "devicemotion"]
]);
var kHoverHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["mousemove"]);
var kTapHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["pointerdown", "pointerup", "touchstart", "touchend", "touchcancel"]);
var kMouseHitTargetInterceptorEvents = /* @__PURE__ */ new Set(["mousedown", "mouseup", "pointerdown", "pointerup", "click", "auxclick", "dblclick", "contextmenu"]);
var kAllHitTargetInterceptorEvents = /* @__PURE__ */ new Set([...kHoverHitTargetInterceptorEvents, ...kTapHitTargetInterceptorEvents, ...kMouseHitTargetInterceptorEvents]);
function cssUnquote(s) {
  s = s.substring(1, s.length - 1);
  if (!s.includes("\\\\"))
    return s;
  const r = [];
  let i = 0;
  while (i < s.length) {
    if (s[i] === "\\\\" && i + 1 < s.length)
      i++;
    r.push(s[i++]);
  }
  return r.join("");
}
function createTextMatcher(selector, internal) {
  if (selector[0] === "/" && selector.lastIndexOf("/") > 0) {
    const lastSlash = selector.lastIndexOf("/");
    const re = new RegExp(selector.substring(1, lastSlash), selector.substring(lastSlash + 1));
    return { matcher: (elementText2) => re.test(elementText2.full), kind: "regex" };
  }
  const unquote = internal ? JSON.parse.bind(JSON) : cssUnquote;
  let strict = false;
  if (selector.length > 1 && selector[0] === '"' && selector[selector.length - 1] === '"') {
    selector = unquote(selector);
    strict = true;
  } else if (internal && selector.length > 1 && selector[0] === '"' && selector[selector.length - 2] === '"' && selector[selector.length - 1] === "i") {
    selector = unquote(selector.substring(0, selector.length - 1));
    strict = false;
  } else if (internal && selector.length > 1 && selector[0] === '"' && selector[selector.length - 2] === '"' && selector[selector.length - 1] === "s") {
    selector = unquote(selector.substring(0, selector.length - 1));
    strict = true;
  } else if (selector.length > 1 && selector[0] === "'" && selector[selector.length - 1] === "'") {
    selector = unquote(selector);
    strict = true;
  }
  selector = normalizeWhiteSpace(selector);
  if (strict) {
    if (internal)
      return { kind: "strict", matcher: (elementText2) => elementText2.normalized === selector };
    const strictTextNodeMatcher = (elementText2) => {
      if (!selector && !elementText2.immediate.length)
        return true;
      return elementText2.immediate.some((s) => normalizeWhiteSpace(s) === selector);
    };
    return { matcher: strictTextNodeMatcher, kind: "strict" };
  }
  selector = selector.toLowerCase();
  return { kind: "lax", matcher: (elementText2) => elementText2.normalized.toLowerCase().includes(selector) };
}
var ExpectedTextMatcher = class {
  constructor(expected) {
    this._normalizeWhiteSpace = expected.normalizeWhiteSpace;
    this._ignoreCase = expected.ignoreCase;
    this._string = expected.matchSubstring ? void 0 : this.normalize(expected.string);
    this._substring = expected.matchSubstring ? this.normalize(expected.string) : void 0;
    if (expected.regexSource) {
      const flags = new Set((expected.regexFlags || "").split(""));
      if (expected.ignoreCase === false)
        flags.delete("i");
      if (expected.ignoreCase === true)
        flags.add("i");
      this._regex = new RegExp(expected.regexSource, [...flags].join(""));
    }
  }
  matches(text) {
    if (!this._regex)
      text = this.normalize(text);
    if (this._string !== void 0)
      return text === this._string;
    if (this._substring !== void 0)
      return text.includes(this._substring);
    if (this._regex)
      return !!this._regex.test(text);
    return false;
  }
  normalize(s) {
    if (!s)
      return s;
    if (this._normalizeWhiteSpace)
      s = normalizeWhiteSpace(s);
    if (this._ignoreCase)
      s = s.toLocaleLowerCase();
    return s;
  }
};
function deepEquals(a, b) {
  if (a === b)
    return true;
  if (a && b && typeof a === "object" && typeof b === "object") {
    if (a.constructor !== b.constructor)
      return false;
    if (Array.isArray(a)) {
      if (a.length !== b.length)
        return false;
      for (let i = 0; i < a.length; ++i) {
        if (!deepEquals(a[i], b[i]))
          return false;
      }
      return true;
    }
    if (a instanceof RegExp)
      return a.source === b.source && a.flags === b.flags;
    if (a.valueOf !== Object.prototype.valueOf)
      return a.valueOf() === b.valueOf();
    if (a.toString !== Object.prototype.toString)
      return a.toString() === b.toString();
    const keys = Object.keys(a);
    if (keys.length !== Object.keys(b).length)
      return false;
    for (let i = 0; i < keys.length; ++i) {
      if (!b.hasOwnProperty(keys[i]))
        return false;
    }
    for (const key of keys) {
      if (!deepEquals(a[key], b[key]))
        return false;
    }
    return true;
  }
  if (typeof a === "number" && typeof b === "number")
    return isNaN(a) && isNaN(b);
  return false;
}
`});var AS=M(Nc=>{"use strict";Object.defineProperty(Nc,"__esModule",{value:!0});Nc.source=void 0;var K8=Nc.source=`
var __commonJS = obj => {
  let required = false;
  let result;
  return function __require() {
    if (!required) {
      required = true;
      let fn;
      for (const name in obj) { fn = obj[name]; break; }
      const module = { exports: {} };
      fn(module.exports, module);
      result = module.exports;
    }
    return result;
  }
};
var __export = (target, all) => {for (var name in all) target[name] = all[name];};
var __toESM = mod => ({ ...mod, 'default': mod });
var __toCommonJS = mod => ({ ...mod, __esModule: true });


// packages/playwright-core/src/server/injected/utilityScript.ts
var utilityScript_exports = {};
__export(utilityScript_exports, {
  UtilityScript: () => UtilityScript
});
module.exports = __toCommonJS(utilityScript_exports);

// packages/playwright-core/src/server/isomorphic/utilityScriptSerializers.ts
function source() {
  function isRegExp(obj) {
    try {
      return obj instanceof RegExp || Object.prototype.toString.call(obj) === "[object RegExp]";
    } catch (error) {
      return false;
    }
  }
  function isDate(obj) {
    try {
      return obj instanceof Date || Object.prototype.toString.call(obj) === "[object Date]";
    } catch (error) {
      return false;
    }
  }
  function isURL(obj) {
    try {
      return obj instanceof URL || Object.prototype.toString.call(obj) === "[object URL]";
    } catch (error) {
      return false;
    }
  }
  function isError(obj) {
    var _a;
    try {
      return obj instanceof Error || obj && ((_a = Object.getPrototypeOf(obj)) == null ? void 0 : _a.name) === "Error";
    } catch (error) {
      return false;
    }
  }
  function parseEvaluationResultValue2(value, handles = [], refs = /* @__PURE__ */ new Map()) {
    if (Object.is(value, void 0))
      return void 0;
    if (typeof value === "object" && value) {
      if ("ref" in value)
        return refs.get(value.ref);
      if ("v" in value) {
        if (value.v === "undefined")
          return void 0;
        if (value.v === "null")
          return null;
        if (value.v === "NaN")
          return NaN;
        if (value.v === "Infinity")
          return Infinity;
        if (value.v === "-Infinity")
          return -Infinity;
        if (value.v === "-0")
          return -0;
        return void 0;
      }
      if ("d" in value)
        return new Date(value.d);
      if ("u" in value)
        return new URL(value.u);
      if ("bi" in value)
        return BigInt(value.bi);
      if ("r" in value)
        return new RegExp(value.r.p, value.r.f);
      if ("a" in value) {
        const result2 = [];
        refs.set(value.id, result2);
        for (const a of value.a)
          result2.push(parseEvaluationResultValue2(a, handles, refs));
        return result2;
      }
      if ("o" in value) {
        const result2 = {};
        refs.set(value.id, result2);
        for (const { k, v } of value.o)
          result2[k] = parseEvaluationResultValue2(v, handles, refs);
        return result2;
      }
      if ("h" in value)
        return handles[value.h];
    }
    return value;
  }
  function serializeAsCallArgument2(value, handleSerializer) {
    return serialize(value, handleSerializer, { visited: /* @__PURE__ */ new Map(), lastId: 0 });
  }
  function serialize(value, handleSerializer, visitorInfo) {
    if (value && typeof value === "object") {
      if (typeof globalThis.Window === "function" && value instanceof globalThis.Window)
        return "ref: <Window>";
      if (typeof globalThis.Document === "function" && value instanceof globalThis.Document)
        return "ref: <Document>";
      if (typeof globalThis.Node === "function" && value instanceof globalThis.Node)
        return "ref: <Node>";
    }
    return innerSerialize(value, handleSerializer, visitorInfo);
  }
  function innerSerialize(value, handleSerializer, visitorInfo) {
    var _a;
    const result2 = handleSerializer(value);
    if ("fallThrough" in result2)
      value = result2.fallThrough;
    else
      return result2;
    if (typeof value === "symbol")
      return { v: "undefined" };
    if (Object.is(value, void 0))
      return { v: "undefined" };
    if (Object.is(value, null))
      return { v: "null" };
    if (Object.is(value, NaN))
      return { v: "NaN" };
    if (Object.is(value, Infinity))
      return { v: "Infinity" };
    if (Object.is(value, -Infinity))
      return { v: "-Infinity" };
    if (Object.is(value, -0))
      return { v: "-0" };
    if (typeof value === "boolean")
      return value;
    if (typeof value === "number")
      return value;
    if (typeof value === "string")
      return value;
    if (typeof value === "bigint")
      return { bi: value.toString() };
    if (isError(value)) {
      const error = value;
      if ((_a = error.stack) == null ? void 0 : _a.startsWith(error.name + ": " + error.message)) {
        return error.stack;
      }
      return \`\${error.name}: \${error.message}
\${error.stack}\`;
    }
    if (isDate(value))
      return { d: value.toJSON() };
    if (isURL(value))
      return { u: value.toJSON() };
    if (isRegExp(value))
      return { r: { p: value.source, f: value.flags } };
    const id = visitorInfo.visited.get(value);
    if (id)
      return { ref: id };
    if (Array.isArray(value)) {
      const a = [];
      const id2 = ++visitorInfo.lastId;
      visitorInfo.visited.set(value, id2);
      for (let i = 0; i < value.length; ++i)
        a.push(serialize(value[i], handleSerializer, visitorInfo));
      return { a, id: id2 };
    }
    if (typeof value === "object") {
      const o = [];
      const id2 = ++visitorInfo.lastId;
      visitorInfo.visited.set(value, id2);
      for (const name of Object.keys(value)) {
        let item;
        try {
          item = value[name];
        } catch (e) {
          continue;
        }
        if (name === "toJSON" && typeof item === "function")
          o.push({ k: name, v: { o: [], id: 0 } });
        else
          o.push({ k: name, v: serialize(item, handleSerializer, visitorInfo) });
      }
      let jsonWrapper;
      try {
        if (o.length === 0 && value.toJSON && typeof value.toJSON === "function")
          jsonWrapper = { value: value.toJSON() };
      } catch (e) {
      }
      if (jsonWrapper)
        return innerSerialize(jsonWrapper.value, handleSerializer, visitorInfo);
      return { o, id: id2 };
    }
  }
  return { parseEvaluationResultValue: parseEvaluationResultValue2, serializeAsCallArgument: serializeAsCallArgument2 };
}
var result = source();
var parseEvaluationResultValue = result.parseEvaluationResultValue;
var serializeAsCallArgument = result.serializeAsCallArgument;

// packages/playwright-core/src/server/injected/utilityScript.ts
var UtilityScript = class {
  constructor() {
    this.serializeAsCallArgument = serializeAsCallArgument;
    this.parseEvaluationResultValue = parseEvaluationResultValue;
  }
  evaluate(isFunction, returnByValue, exposeUtilityScript, expression, argCount, ...argsAndHandles) {
    const args = argsAndHandles.slice(0, argCount);
    const handles = argsAndHandles.slice(argCount);
    const parameters = [];
    for (let i = 0; i < args.length; i++)
      parameters[i] = this.parseEvaluationResultValue(args[i], handles);
    if (exposeUtilityScript)
      parameters.unshift(this);
    let result2 = globalThis.eval(expression);
    if (isFunction === true) {
      result2 = result2(...parameters);
    } else if (isFunction === false) {
      result2 = result2;
    } else {
      if (typeof result2 === "function")
        result2 = result2(...parameters);
    }
    return returnByValue ? this._promiseAwareJsonValueNoThrow(result2) : result2;
  }
  jsonValue(returnByValue, value) {
    if (Object.is(value, void 0))
      return void 0;
    return serializeAsCallArgument(value, (value2) => ({ fallThrough: value2 }));
  }
  _promiseAwareJsonValueNoThrow(value) {
    const safeJson = (value2) => {
      try {
        return this.jsonValue(true, value2);
      } catch (e) {
        return void 0;
      }
    };
    if (value && typeof value === "object" && typeof value.then === "function") {
      return (async () => {
        const promiseValue = await value;
        return safeJson(promiseValue);
      })();
    }
    return safeJson(value);
  }
};
`});var Zi=M(ri=>{"use strict";Object.defineProperty(ri,"__esModule",{value:!0});ri.serializeAsCallArgument=ri.parseEvaluationResultValue=void 0;ri.source=IS;function IS(){function r(c){try{return c instanceof RegExp||Object.prototype.toString.call(c)==="[object RegExp]"}catch{return!1}}function e(c){try{return c instanceof Date||Object.prototype.toString.call(c)==="[object Date]"}catch{return!1}}function t(c){try{return c instanceof URL||Object.prototype.toString.call(c)==="[object URL]"}catch{return!1}}function n(c){try{var u;return c instanceof Error||c&&((u=Object.getPrototypeOf(c))===null||u===void 0?void 0:u.name)==="Error"}catch{return!1}}function s(c,u=[],d=new Map){if(!Object.is(c,void 0)){if(typeof c=="object"&&c){if("ref"in c)return d.get(c.ref);if("v"in c)return c.v==="undefined"?void 0:c.v==="null"?null:c.v==="NaN"?NaN:c.v==="Infinity"?1/0:c.v==="-Infinity"?-1/0:c.v==="-0"?-0:void 0;if("d"in c)return new Date(c.d);if("u"in c)return new URL(c.u);if("bi"in c)return BigInt(c.bi);if("r"in c)return new RegExp(c.r.p,c.r.f);if("a"in c){let h=[];d.set(c.id,h);for(let p of c.a)h.push(s(p,u,d));return h}if("o"in c){let h={};d.set(c.id,h);for(let{k:p,v:f}of c.o)h[p]=s(f,u,d);return h}if("h"in c)return u[c.h]}return c}}function o(c,u){return a(c,u,{visited:new Map,lastId:0})}function a(c,u,d){if(c&&typeof c=="object"){if(typeof globalThis.Window=="function"&&c instanceof globalThis.Window)return"ref: <Window>";if(typeof globalThis.Document=="function"&&c instanceof globalThis.Document)return"ref: <Document>";if(typeof globalThis.Node=="function"&&c instanceof globalThis.Node)return"ref: <Node>"}return l(c,u,d)}function l(c,u,d){let h=u(c);if("fallThrough"in h)c=h.fallThrough;else return h;if(typeof c=="symbol")return{v:"undefined"};if(Object.is(c,void 0))return{v:"undefined"};if(Object.is(c,null))return{v:"null"};if(Object.is(c,NaN))return{v:"NaN"};if(Object.is(c,1/0))return{v:"Infinity"};if(Object.is(c,-1/0))return{v:"-Infinity"};if(Object.is(c,-0))return{v:"-0"};if(typeof c=="boolean"||typeof c=="number"||typeof c=="string")return c;if(typeof c=="bigint")return{bi:c.toString()};if(n(c)){var p;let _=c;return(p=_.stack)!==null&&p!==void 0&&p.startsWith(_.name+": "+_.message)?_.stack:`${_.name}: ${_.message}
${_.stack}`}if(e(c))return{d:c.toJSON()};if(t(c))return{u:c.toJSON()};if(r(c))return{r:{p:c.source,f:c.flags}};let f=d.visited.get(c);if(f)return{ref:f};if(Array.isArray(c)){let _=[],v=++d.lastId;d.visited.set(c,v);for(let w=0;w<c.length;++w)_.push(a(c[w],u,d));return{a:_,id:v}}if(typeof c=="object"){let _=[],v=++d.lastId;d.visited.set(c,v);for(let m of Object.keys(c)){let g;try{g=c[m]}catch{continue}m==="toJSON"&&typeof g=="function"?_.push({k:m,v:{o:[],id:0}}):_.push({k:m,v:a(g,u,d)})}let w;try{_.length===0&&c.toJSON&&typeof c.toJSON=="function"&&(w={value:c.toJSON()})}catch{}return w?l(w.value,u,d):{o:_,id:v}}}return{parseEvaluationResultValue:s,serializeAsCallArgument:o}}var RS=IS(),X8=ri.parseEvaluationResultValue=RS.parseEvaluationResultValue,Y8=ri.serializeAsCallArgument=RS.serializeAsCallArgument});var mr=M(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.JavaScriptErrorInEvaluate=jt.JSHandle=jt.ExecutionContext=void 0;jt.evaluate=vm;jt.evaluateExpression=Lc;jt.isJavaScriptErrorInEvaluate=xL;jt.normalizeEvaluationExpression=NS;jt.parseUnserializableValue=yL;jt.sparseArrayToString=SL;var _L=bL(AS()),wL=Zi(),MS=De(),vL=Qe();function FS(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(FS=function(n){return n?t:e})(r)}function bL(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=FS(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var wm=class extends MS.SdkObject{constructor(e,t,n){super(e,"execution-context"),this._delegate=void 0,this._utilityScriptPromise=void 0,this._contextDestroyedScope=new vL.LongStandingScope,this.worldNameForTest=void 0,this.worldNameForTest=n,this._delegate=t}contextDestroyed(e){this._contextDestroyedScope.close(new Error(e))}async _raceAgainstContextDestroyed(e){return this._contextDestroyedScope.race(e)}rawEvaluateJSON(e){return this._raceAgainstContextDestroyed(this._delegate.rawEvaluateJSON(e))}rawEvaluateHandle(e){return this._raceAgainstContextDestroyed(this._delegate.rawEvaluateHandle(e))}rawCallFunctionNoReply(e,...t){this._delegate.rawCallFunctionNoReply(e,...t)}evaluateWithArguments(e,t,n,s,o){return this._raceAgainstContextDestroyed(this._delegate.evaluateWithArguments(e,t,n,s,o))}getProperties(e,t){return this._raceAgainstContextDestroyed(this._delegate.getProperties(e,t))}createHandle(e){return this._delegate.createHandle(this,e)}releaseHandle(e){return this._delegate.releaseHandle(e)}adoptIfNeeded(e){return null}utilityScript(){if(!this._utilityScriptPromise){let e=`
      (() => {
        const module = {};
        ${_L.source}
        return new (module.exports.UtilityScript())();
      })();`;this._utilityScriptPromise=this._raceAgainstContextDestroyed(this._delegate.rawEvaluateHandle(e).then(t=>new Lo(this,"object","UtilityScript",t)))}return this._utilityScriptPromise}async objectCount(e){return this._delegate.objectCount(e)}async doSlowMo(){}};jt.ExecutionContext=wm;var Lo=class extends MS.SdkObject{constructor(e,t,n,s,o){super(e,"handle"),this.__jshandle=!0,this._context=void 0,this._disposed=!1,this._objectId=void 0,this._value=void 0,this._objectType=void 0,this._preview=void 0,this._previewCallback=void 0,this._context=e,this._objectId=s,this._value=o,this._objectType=t,this._preview=this._objectId?n||`JSHandle@${this._objectType}`:String(o),this._objectId&&globalThis.leakedJSHandles&&globalThis.leakedJSHandles.set(this,new Error("Leaked JSHandle"))}callFunctionNoReply(e,t){this._context.rawCallFunctionNoReply(e,this,t)}async evaluate(e,t){return vm(this._context,!0,e,this,t)}async evaluateHandle(e,t){return vm(this._context,!1,e,this,t)}async evaluateExpression(e,t,n){let s=await Lc(this._context,e,{...t,returnByValue:!0},this,n);return await this._context.doSlowMo(),s}async evaluateExpressionHandle(e,t,n){let s=await Lc(this._context,e,{...t,returnByValue:!1},this,n);return await this._context.doSlowMo(),s}async getProperty(e){let t=await this.evaluateHandle((o,a)=>{let l={__proto__:null};return l[a]=o[a],l},e),s=(await t.getProperties()).get(e);return t.dispose(),s}async getProperties(){return this._objectId?this._context.getProperties(this._context,this._objectId):new Map}rawValue(){return this._value}async jsonValue(){if(!this._objectId)return this._value;let e=await this._context.utilityScript();return this._context.evaluateWithArguments("(utilityScript, ...args) => utilityScript.jsonValue(...args)",!0,e,[!0],[this._objectId])}asElement(){return null}dispose(){this._disposed||(this._disposed=!0,this._objectId&&(this._context.releaseHandle(this._objectId).catch(e=>{}),globalThis.leakedJSHandles&&globalThis.leakedJSHandles.delete(this)))}toString(){return this._preview}_setPreviewCallback(e){this._previewCallback=e}preview(){return this._preview}worldNameForTest(){return this._context.worldNameForTest}_setPreview(e){this._preview=e,this._previewCallback&&this._previewCallback(e)}async objectCount(){if(!this._objectId)throw new Error("Can only count objects for a handle that points to the constructor prototype");return this._context.objectCount(this._objectId)}};jt.JSHandle=Lo;async function vm(r,e,t,...n){return Lc(r,String(t),{returnByValue:e,isFunction:typeof t=="function"},...n)}async function Lc(r,e,t,...n){let s=await r.utilityScript();e=NS(e,t.isFunction);let o=[],a=[],l=h=>(o.push(h),o.length-1);n=n.map(h=>(0,wL.serializeAsCallArgument)(h,p=>{if(p instanceof Lo){if(!p._objectId)return{fallThrough:p._value};if(p._disposed)throw new es("JSHandle is disposed!");let f=r.adoptIfNeeded(p);return f===null?{h:l(Promise.resolve(p))}:(a.push(f),{h:l(f)})}return{fallThrough:p}}));let c=[];for(let h of await Promise.all(o)){if(h._context!==r)throw new es("JSHandles can be evaluated only in the context they were created!");c.push(h._objectId)}let u=[t.isFunction,t.returnByValue,t.exposeUtilityScript,e,n.length,...n],d="(utilityScript, ...args) => utilityScript.evaluate(...args)";try{return await r.evaluateWithArguments(d,t.returnByValue||!1,s,u,c)}finally{a.map(h=>h.then(p=>p.dispose()))}}function yL(r){if(r==="NaN")return NaN;if(r==="Infinity")return 1/0;if(r==="-Infinity")return-1/0;if(r==="-0")return-0}function NS(r,e){if(r=r.trim(),e)try{new Function("("+r+")")}catch{r.startsWith("async ")?r="async function "+r.substring(6):r="function "+r;try{new Function("("+r+")")}catch{throw new Error("Passed function is not well-serializable!")}}return/^(async)?\s*function(\s|\()/.test(r)&&(r="("+r+")"),r}var es=class extends Error{};jt.JavaScriptErrorInEvaluate=es;function xL(r){return r instanceof es}function SL(r){let e=[];for(let{name:s,value:o}of r){let a=+s;isNaN(a)||a<0||e.push({index:a,value:o})}e.sort((s,o)=>s.index-o.index);let t=-1,n=[];for(let{index:s,value:o}of e){let a=s-t-1;a===1?n.push("empty"):a>1&&n.push(`empty x ${a}`),n.push(String(o)),t=s}return"["+n.join(", ")+"]"}});var Ut=M(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.ProgressController=void 0;var EL=Bt(),bm=ie(),kL=Qe(),ym=class{constructor(e,t){this._forceAbortPromise=new kL.ManualPromise,this._cleanups=[],this._logName="api",this._state="before",this._deadline=0,this._timeout=0,this.metadata=void 0,this.instrumentation=void 0,this.sdkObject=void 0,this.metadata=e,this.sdkObject=t,this.instrumentation=t.instrumentation,this._forceAbortPromise.catch(n=>null)}setLogName(e){this._logName=e}abort(e){this._forceAbortPromise.reject(e)}async run(e,t){var n;t&&(this._timeout=t,this._deadline=t?(0,bm.monotonicTime)()+t:0),(0,bm.assert)(this._state==="before"),this._state="running",(n=this.sdkObject.attribution.context)===null||n===void 0||n._activeProgressControllers.add(this);let s={log:c=>{this._state==="running"&&this.metadata.log.push(c),this.instrumentation.onCallLog(this.sdkObject,this.metadata,this._logName,c)},timeUntilDeadline:()=>this._deadline?this._deadline-(0,bm.monotonicTime)():2147483647,isRunning:()=>this._state==="running",cleanupWhenAborted:c=>{this._state==="running"?this._cleanups.push(c):LS(c)},throwIfAborted:()=>{if(this._state==="aborted")throw new xm},beforeInputAction:async c=>{await this.instrumentation.onBeforeInputAction(this.sdkObject,this.metadata,c)},metadata:this.metadata},o=new EL.TimeoutError(`Timeout ${this._timeout}ms exceeded.`),a=setTimeout(()=>this._forceAbortPromise.reject(o),s.timeUntilDeadline());try{let c=e(s),u=await Promise.race([c,this._forceAbortPromise]);return this._state="finished",u}catch(c){throw this._state="aborted",await Promise.all(this._cleanups.splice(0).map(LS)),c}finally{var l;(l=this.sdkObject.attribution.context)===null||l===void 0||l._activeProgressControllers.delete(this),clearTimeout(a)}}};Dc.ProgressController=ym;async function LS(r){try{await r()}catch{}}var xm=class extends Error{}});var Cm=M(km=>{"use strict";Object.defineProperty(km,"__esModule",{value:!0});km.prepareFilesForUpload=OL;var Em=BS(require("fs")),Sm=BS(require("path")),DS=ie(),CL=Be();function BS(r){return r&&r.__esModule?r:{default:r}}async function TL(r){return(await Promise.all(r.map(async t=>(await Em.default.promises.stat(t)).size))).reduce((t,n)=>t+n,0)>=DS.fileUploadSizeLimit}async function OL(r,e){var t;let{payloads:n,streams:s}=e,{localPaths:o}=e;if([n,o,s].filter(Boolean).length!==1)throw new Error("Exactly one of payloads, localPaths and streams must be provided");if(s&&(o=s.map(c=>c.path())),o)for(let c of o)(0,DS.assert)(Sm.default.isAbsolute(c)&&Sm.default.resolve(c)===c,"Paths provided to localPaths must be absolute and fully resolved.");let a=n;if(!r._page._browserContext._browser._isCollocatedWithServer&&o){if(await TL(o))throw new Error("Cannot transfer files larger than 50Mb to a browser not co-located with the server");a=await Promise.all(o.map(async c=>({name:Sm.default.basename(c),buffer:await Em.default.promises.readFile(c),lastModifiedMs:(await Em.default.promises.stat(c)).mtimeMs}))),o=void 0}let l=(t=a)===null||t===void 0?void 0:t.map(c=>({name:c.name,mimeType:c.mimeType||CL.mime.getType(c.name)||"application/octet-stream",buffer:c.buffer.toString("base64"),lastModifiedMs:c.lastModifiedMs}));return{localPaths:o,filePayloads:l}}});var Bo=M(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.NonRecoverableDOMError=zt.FrameExecutionContext=zt.ElementHandle=void 0;zt.assertDone=FL;zt.isNonRecoverableDOMError=ML;zt.kUnableToAdoptErrorMessage=void 0;zt.throwRetargetableDOMError=ut;var jS=RL(require("fs")),PL=$S(PS()),qS=Wt(),zn=$S(mr()),xt=Ut(),AL=ie(),IL=Cm();function HS(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(HS=function(n){return n?t:e})(r)}function $S(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=HS(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function RL(r){return r&&r.__esModule?r:{default:r}}var ii=class extends Error{};zt.NonRecoverableDOMError=ii;function ML(r){return r instanceof ii}var Tm=class extends zn.ExecutionContext{constructor(e,t,n){super(t,e,n||"content-script"),this.frame=void 0,this._injectedScriptPromise=void 0,this.world=void 0,this.frame=t,this.world=n}adoptIfNeeded(e){return e instanceof Do&&e._context!==this?this.frame._page._delegate.adoptElementHandle(e,this):null}async evaluate(e,t){return zn.evaluate(this,!0,e,t)}async evaluateHandle(e,t){return zn.evaluate(this,!1,e,t)}async evaluateExpression(e,t,n){return zn.evaluateExpression(this,e,{...t,returnByValue:!0},n)}async evaluateExpressionHandle(e,t,n){return zn.evaluateExpression(this,e,{...t,returnByValue:!1},n)}createHandle(e){return this.frame._page._delegate.isElementHandle(e)?new Do(this,e.objectId):super.createHandle(e)}injectedScript(){if(!this._injectedScriptPromise){let e=[],t=this.frame._page.context().selectors();for(let[o,{source:a}]of t._engines)e.push(`{ name: '${o}', engine: (${a}) }`);let n=this.frame.attribution.playwright.options.sdkLanguage,s=`
        (() => {
        const module = {};
        ${PL.source}
        return new (module.exports.InjectedScript())(
          globalThis,
          ${(0,AL.isUnderTest)()},
          "${n}",
          ${JSON.stringify(t.testIdAttributeName())},
          ${this.frame._page._delegate.rafCountForStablePosition()},
          "${this.frame._page._browserContext._browser.options.name}",
          [${e.join(`,
`)}]
        );
        })();
      `;this._injectedScriptPromise=this.rawEvaluateHandle(s).then(o=>new zn.JSHandle(this,"object","InjectedScript",o))}return this._injectedScriptPromise}};zt.FrameExecutionContext=Tm;var Do=class extends zn.JSHandle{constructor(e,t){super(e,"node",void 0,t),this.__elementhandle=!0,this._page=void 0,this._frame=void 0,this._page=e.frame._page,this._frame=e.frame,this._initializePreview().catch(n=>{})}async _initializePreview(){let e=await this._context.injectedScript();this._setPreview(await e.evaluate((t,n)=>"JSHandle@"+t.previewNode(n),this))}asElement(){return this}async evaluateInUtility(e,t){try{let n=await this._frame._utilityContext();return await n.evaluate(e,[await n.injectedScript(),this,t])}catch(n){if(zn.isJavaScriptErrorInEvaluate(n)||(0,qS.isSessionClosedError)(n))throw n;return"error:notconnected"}}async evaluateHandleInUtility(e,t){try{let n=await this._frame._utilityContext();return await n.evaluateHandle(e,[await n.injectedScript(),this,t])}catch(n){if(zn.isJavaScriptErrorInEvaluate(n)||(0,qS.isSessionClosedError)(n))throw n;return"error:notconnected"}}async ownerFrame(){let e=await this._page._delegate.getOwnerFrame(this);if(!e)return null;let t=this._page._frameManager.frame(e);if(t)return t;for(let n of this._page._browserContext.pages()){let s=n._frameManager.frame(e);if(s)return s}return null}async isIframeElement(){return this.evaluateInUtility(([e,t])=>t&&(t.nodeName==="IFRAME"||t.nodeName==="FRAME"),{})}async contentFrame(){return ut(await this.isIframeElement())?this._page._delegate.getContentFrame(this):null}async getAttribute(e,t){return this._frame.getAttribute(e,":scope",t,{},this)}async inputValue(e){return this._frame.inputValue(e,":scope",{},this)}async textContent(e){return this._frame.textContent(e,":scope",{},this)}async innerText(e){return this._frame.innerText(e,":scope",{},this)}async innerHTML(e){return this._frame.innerHTML(e,":scope",{},this)}async dispatchEvent(e,t,n={}){return this._frame.dispatchEvent(e,":scope",t,n,{},this)}async _scrollRectIntoViewIfNeeded(e){return await this._page._delegate.scrollRectIntoViewIfNeeded(this,e)}async _waitAndScrollIntoViewIfNeeded(e,t){let n=await this._retryAction(e,"scroll into view",async()=>{e.log("  waiting for element to be stable");let s=await this.evaluateInUtility(async([o,a,{waitForVisible:l}])=>await o.checkElementStates(a,l?["visible","stable"]:["stable"]),{waitForVisible:t});return s||await this._scrollRectIntoViewIfNeeded()},{});ut(n)}async scrollIntoViewIfNeeded(e,t={}){return new xt.ProgressController(e,this).run(s=>this._waitAndScrollIntoViewIfNeeded(s,!1),this._page._timeoutSettings.timeout(t))}async _clickablePoint(){let e=l=>l.map(c=>({x:Math.min(Math.max(c.x,0),s.width),y:Math.min(Math.max(c.y,0),s.height)})),t=l=>{let c=0;for(let u=0;u<l.length;++u){let d=l[u],h=l[(u+1)%l.length];c+=(d.x*h.y-h.x*d.y)/2}return Math.abs(c)},[n,s]=await Promise.all([this._page._delegate.getContentQuads(this),this._page.mainFrame()._utilityContext().then(l=>l.evaluate(()=>({width:innerWidth,height:innerHeight})))]);if(!n||!n.length)return"error:notvisible";let o=n.map(l=>e(l)).filter(l=>t(l)>.99);if(!o.length)return"error:notinviewport";let a={x:0,y:0};for(let l of o[0])a.x+=l.x/4,a.y+=l.y/4;return LL(a),a}async _offsetPoint(e){let[t,n]=await Promise.all([this.boundingBox(),this.evaluateInUtility(([s,o])=>s.getElementBorderWidth(o),{}).catch(s=>{})]);return!t||!n?"error:notvisible":n==="error:notconnected"?n:{x:t.x+n.left+e.x,y:t.y+n.top+e.y}}async _retryAction(e,t,n,s){let o=0,a=[0,20,100,100,500];for(;e.isRunning();){if(o){e.log(`retrying ${t} action${s.trial?" (trial run)":""}, attempt #${o}`);let c=a[Math.min(o-1,a.length-1)];if(c){e.log(`  waiting ${c}ms`);let u=await this.evaluateInUtility(([d,h,p])=>new Promise(f=>setTimeout(f,p)),c);if(u==="error:notconnected")return u}}else e.log(`attempting ${t} action${s.trial?" (trial run)":""}`);!s.skipLocatorHandlersCheckpoint&&!s.force&&await this._frame._page.performLocatorHandlersCheckpoint(e);let l=await n(o);if(++o,l==="error:notvisible"){if(s.force)throw new ii("Element is not visible");e.log("  element is not visible");continue}if(l==="error:notinviewport"){if(s.force)throw new ii("Element is outside of the viewport");e.log("  element is outside of the viewport");continue}if(l==="error:optionsnotfound"){e.log("  did not find some options");continue}if(typeof l=="object"&&"hitTargetDescription"in l){e.log(`  ${l.hitTargetDescription} intercepts pointer events`);continue}if(typeof l=="object"&&"missingState"in l){e.log(`  element is not ${l.missingState}`);continue}return l}return"done"}async _retryPointerAction(e,t,n,s,o){let a=t==="move and up";return await this._retryAction(e,t,async l=>{let c=[void 0,{block:"end",inline:"end"},{block:"center",inline:"center"},{block:"start",inline:"start"}],u=c[l%c.length];return await this._performPointerAction(e,t,n,s,u,o)},{...o,skipLocatorHandlersCheckpoint:a})}async _performPointerAction(e,t,n,s,o,a){let{force:l=!1,position:c}=a,u=async()=>o?await this.evaluateInUtility(([v,w,m])=>(w.nodeType===1&&w.scrollIntoView(m),"done"),o):await this._scrollRectIntoViewIfNeeded(c?{x:c.x,y:c.y,width:0,height:0}:void 0);if(this._frame.parentFrame()&&(e.throwIfAborted(),await u().catch(()=>{})),a.__testHookBeforeStable&&await a.__testHookBeforeStable(),!l){let v=n?["visible","enabled","stable"]:["visible","stable"];e.log(`  waiting for element to be ${n?"visible, enabled and stable":"visible and stable"}`);let w=await this.evaluateInUtility(async([m,g,{elementStates:x}])=>await m.checkElementStates(g,x),{elementStates:v});if(w)return w;e.log(`  element is ${n?"visible, enabled and stable":"visible and stable"}`)}a.__testHookAfterStable&&await a.__testHookAfterStable(),e.log("  scrolling into view if needed"),e.throwIfAborted();let d=await u();if(d!=="done")return d;e.log("  done scrolling");let h=c?await this._offsetPoint(c):await this._clickablePoint();if(typeof h=="string")return h;let p=NL(h);e.metadata.point=p,await e.beforeInputAction(this);let f;if(l)e.log("  forcing action");else{a.__testHookBeforeHitTarget&&await a.__testHookBeforeHitTarget();let v=await this._checkFrameIsHitTarget(p);if(v==="error:notconnected"||"hitTargetDescription"in v)return v;let w=v.framePoint,m=t==="move and up"?"drag":t==="hover"||t==="tap"?t:"mouse",g=await this.evaluateHandleInUtility(([x,b,{actionType:y,hitPoint:S,trial:E}])=>x.setupHitTargetInterceptor(b,y,S,E),{actionType:m,hitPoint:w,trial:!!a.trial});if(g==="error:notconnected")return g;if(!g._objectId){let x=g.rawValue();return x==="error:notconnected"?x:{hitTargetDescription:x}}f=g,e.cleanupWhenAborted(()=>{f.evaluate(x=>x.stop()).catch(x=>{}),f.dispose()})}let _=await this._page._frameManager.waitForSignalsCreatedBy(e,a.noWaitAfter,async()=>{a.__testHookBeforePointerAction&&await a.__testHookBeforePointerAction(),e.throwIfAborted();let v;if(a&&a.modifiers&&(v=await this._page.keyboard.ensureModifiers(a.modifiers)),e.log(`  performing ${t} action`),await s(p),v&&await this._page.keyboard.ensureModifiers(v),f){let w=f.evaluate(m=>m.stop()).catch(m=>"done").finally(()=>{var m;(m=f)===null||m===void 0||m.dispose()});if(!a.noWaitAfter){let m=await w;if(m!=="done")return m}}return e.log(`  ${a.trial?"trial ":""}${t} action done`),e.log("  waiting for scheduled navigations to finish"),a.__testHookAfterPointerAction&&await a.__testHookAfterPointerAction(),"done"},"input");return _!=="done"?_:(e.log("  navigations have finished"),"done")}async hover(e,t){return new xt.ProgressController(e,this).run(async s=>{let o=await this._hover(s,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}_hover(e,t){return this._retryPointerAction(e,"hover",!1,n=>this._page.mouse.move(n.x,n.y),t)}async click(e,t={}){return new xt.ProgressController(e,this).run(async s=>{let o=await this._click(s,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}_click(e,t){return this._retryPointerAction(e,"click",!0,n=>this._page.mouse.click(n.x,n.y,t),t)}async dblclick(e,t){return new xt.ProgressController(e,this).run(async s=>{let o=await this._dblclick(s,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}_dblclick(e,t){return this._retryPointerAction(e,"dblclick",!0,n=>this._page.mouse.dblclick(n.x,n.y,t),t)}async tap(e,t={}){return new xt.ProgressController(e,this).run(async s=>{let o=await this._tap(s,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}_tap(e,t){return this._retryPointerAction(e,"tap",!0,n=>this._page.touchscreen.tap(n.x,n.y),t)}async selectOption(e,t,n,s){return new xt.ProgressController(e,this).run(async a=>{let l=await this._selectOption(a,t,n,s);return ut(l)},this._page._timeoutSettings.timeout(s))}async _selectOption(e,t,n,s){let o=[];return await this._retryAction(e,"select option",async()=>{await e.beforeInputAction(this),s.force||e.log("  waiting for element to be visible and enabled");let a=[...t,...n],l=await this.evaluateInUtility(async([c,u,{optionsToSelect:d,force:h}])=>{if(!h){let p=await c.checkElementStates(u,["visible","enabled"]);if(p)return p}return c.selectOptions(u,d)},{optionsToSelect:a,force:s.force});return Array.isArray(l)?(e.log("  selected specified option(s)"),o=l,"done"):l},s),o}async fill(e,t,n={}){return new xt.ProgressController(e,this).run(async o=>{let a=await this._fill(o,t,n);ut(a)},this._page._timeoutSettings.timeout(n))}async _fill(e,t,n){return e.log(`  fill("${t}")`),await this._retryAction(e,"fill",async()=>(await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,async()=>{n.force||e.log("  waiting for element to be visible, enabled and editable");let s=await this.evaluateInUtility(async([o,a,{value:l,force:c}])=>{if(!c){let u=await o.checkElementStates(a,["visible","enabled","editable"]);if(u)return u}return o.fill(a,l)},{value:t,force:n.force});return e.throwIfAborted(),s==="needsinput"?(t?await this._page.keyboard.insertText(t):await this._page.keyboard.press("Delete"),"done"):s},"input")),n)}async selectText(e,t={}){return new xt.ProgressController(e,this).run(async s=>{let o=await this._retryAction(s,"selectText",async()=>(t.force||s.log("  waiting for element to be visible"),await this.evaluateInUtility(async([a,l,{force:c}])=>{if(!c){let u=await a.checkElementStates(l,["visible"]);if(u)return u}return a.selectText(l)},{force:t.force})),t);ut(o)},this._page._timeoutSettings.timeout(t))}async setInputFiles(e,t){let n=await(0,IL.prepareFilesForUpload)(this._frame,t);return new xt.ProgressController(e,this).run(async o=>{let a=await this._setInputFiles(o,n,t);return ut(a),void 0},this._page._timeoutSettings.timeout(t))}async _setInputFiles(e,t,n){let{filePayloads:s,localPaths:o}=t,a=s&&s.length>1||o&&o.length>1,l=await this.evaluateHandleInUtility(([u,d,h])=>{let p=u.retarget(d,"follow-label");if(p){if(p.tagName!=="INPUT")throw u.createStacklessError("Node is not an HTMLInputElement");if(h&&!p.multiple)throw u.createStacklessError("Non-multiple file input can only accept single file");return p}},a);if(l==="error:notconnected"||!l.asElement())return"error:notconnected";let c=l.asElement();return await e.beforeInputAction(this),await this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,async()=>{e.throwIfAborted(),o?(await Promise.all(o.map(u=>jS.default.promises.access(u,jS.default.constants.F_OK))),await this._page._delegate.setInputFilePaths(c,o)):await this._page._delegate.setInputFiles(c,s)}),"done"}async focus(e){await new xt.ProgressController(e,this).run(async n=>{let s=await this._focus(n);return ut(s),void 0},0)}async _focus(e,t){return e.throwIfAborted(),await this.evaluateInUtility(([n,s,o])=>n.focusNode(s,o),t)}async _blur(e){return e.throwIfAborted(),await this.evaluateInUtility(([t,n])=>t.blurNode(n),{})}async type(e,t,n){return new xt.ProgressController(e,this).run(async o=>{let a=await this._type(o,t,n);return ut(a),void 0},this._page._timeoutSettings.timeout(n))}async _type(e,t,n){return e.log(`elementHandle.type("${t}")`),await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,async()=>{let s=await this._focus(e,!0);return s!=="done"?s:(e.throwIfAborted(),await this._page.keyboard.type(t,n),"done")},"input")}async press(e,t,n){return new xt.ProgressController(e,this).run(async o=>{let a=await this._press(o,t,n);return ut(a),void 0},this._page._timeoutSettings.timeout(n))}async _press(e,t,n){return e.log(`elementHandle.press("${t}")`),await e.beforeInputAction(this),this._page._frameManager.waitForSignalsCreatedBy(e,n.noWaitAfter,async()=>{let s=await this._focus(e,!0);return s!=="done"?s:(e.throwIfAborted(),await this._page.keyboard.press(t,n),"done")},"input")}async check(e,t){return new xt.ProgressController(e,this).run(async s=>{let o=await this._setChecked(s,!0,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}async uncheck(e,t){return new xt.ProgressController(e,this).run(async s=>{let o=await this._setChecked(s,!1,t);return ut(o),void 0},this._page._timeoutSettings.timeout(t))}async _setChecked(e,t,n){let s=async()=>{let a=await this.evaluateInUtility(([l,c])=>l.elementState(c,"checked"),{});return ut(a)};if(await s()===t)return"done";let o=await this._click(e,n);if(o!=="done")return o;if(n.trial)return"done";if(await s()!==t)throw new ii("Clicking the checkbox did not change its state");return"done"}async boundingBox(){return this._page._delegate.getBoundingBox(this)}async screenshot(e,t={}){return new xt.ProgressController(e,this).run(s=>this._page._screenshotter.screenshotElement(s,this,t),this._page._timeoutSettings.timeout(t))}async querySelector(e,t){return this._frame.selectors.query(e,t,this)}async querySelectorAll(e){return this._frame.selectors.queryAll(e,this)}async evalOnSelector(e,t,n,s,o){return this._frame.evalOnSelector(e,t,n,s,o,this)}async evalOnSelectorAll(e,t,n,s){return this._frame.evalOnSelectorAll(e,t,n,s,this)}async isVisible(e){return this._frame.isVisible(e,":scope",{},this)}async isHidden(e){return this._frame.isHidden(e,":scope",{},this)}async isEnabled(e){return this._frame.isEnabled(e,":scope",{},this)}async isDisabled(e){return this._frame.isDisabled(e,":scope",{},this)}async isEditable(e){return this._frame.isEditable(e,":scope",{},this)}async isChecked(e){return this._frame.isChecked(e,":scope",{},this)}async waitForElementState(e,t,n={}){return new xt.ProgressController(e,this).run(async o=>{let a=`wait for ${t}`,l=await this._retryAction(o,a,async()=>await this.evaluateInUtility(async([c,u,d])=>await c.checkElementStates(u,[d])||"done",t),{});ut(l)},this._page._timeoutSettings.timeout(n))}async waitForSelector(e,t,n={}){return this._frame.waitForSelector(e,t,n,this)}async _adoptTo(e){if(this._context!==e){let t=await this._page._delegate.adoptElementHandle(this,e);return this.dispose(),t}return this}async _checkFrameIsHitTarget(e){let t=this._frame,n=[];for(;t.parentFrame();){let s=await t.frameElement(),o=await s.boundingBox(),a=await s.evaluateInUtility(([c,u])=>c.describeIFrameStyle(u),{}).catch(c=>"error:notconnected");if(!o||a==="error:notconnected")return"error:notconnected";if(a==="transformed")return{framePoint:void 0};let l={x:e.x-o.x-a.left,y:e.y-o.y-a.top};n.push({frame:t,frameElement:s,pointInFrame:l}),t=t.parentFrame()}n.push({frame:t,frameElement:null,pointInFrame:e});for(let s=n.length-1;s>0;s--){let o=n[s-1].frameElement,a=n[s].pointInFrame,l=await o.evaluateInUtility(([c,u,d])=>c.expectHitTarget(d,u),a);if(l!=="done")return l}return{framePoint:n[0].pointInFrame}}};zt.ElementHandle=Do;function ut(r){if(r==="error:notconnected")throw new Error("Element is not attached to the DOM");return r}function FL(r){}function NL(r){return{x:(r.x*100|0)/100,y:(r.y*100|0)/100}}function LL(r){let e=r.x-Math.floor(r.x);e>.49&&e<.51&&(r.x-=.02);let t=r.y-Math.floor(r.y);t>.49&&t<.51&&(r.y-=.02)}var n9=zt.kUnableToAdoptErrorMessage="Unable to adopt element handle from a different document"});var WS=M(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.kLifecycleEvents=void 0;var i9=Bc.kLifecycleEvents=new Set(["load","domcontentloaded","networkidle","commit"])});var zS=M(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.FrameSelectors=void 0;var jc=ti(),DL=Xt(),Om=class{constructor(e){this.frame=void 0,this.frame=e}_parseSelector(e,t){let n=typeof t?.strict=="boolean"?t.strict:!!this.frame._page.context()._options.strictSelectors;return this.frame._page.context().selectors().parseSelector(e,n)}async query(e,t,n){let s=await this.resolveInjectedForSelector(e,t,n);if(!s)return null;let o=await s.injected.evaluateHandle((l,{info:c,scope:u})=>l.querySelector(c.parsed,u||document,c.strict),{info:s.info,scope:s.scope}),a=o.asElement();return a?US(a,await s.frame._mainContext()):(o.dispose(),null)}async queryArrayInMainWorld(e,t){let n=await this.resolveInjectedForSelector(e,{mainWorld:!0},t);if(!n)throw new Error(`Failed to find frame for selector "${e}"`);return await n.injected.evaluateHandle((s,{info:o,scope:a})=>s.querySelectorAll(o.parsed,a||document),{info:n.info,scope:n.scope})}async queryCount(e){let t=await this.resolveInjectedForSelector(e);if(!t)throw new Error(`Failed to find frame for selector "${e}"`);return await t.injected.evaluate((n,{info:s})=>n.querySelectorAll(s.parsed,document).length,{info:t.info})}async queryAll(e,t){let n=await this.resolveInjectedForSelector(e,{},t);if(!n)return[];let s=await n.injected.evaluateHandle((c,{info:u,scope:d})=>c.querySelectorAll(u.parsed,d||document),{info:n.info,scope:n.scope}),o=await s.getProperties();s.dispose();let a=await n.frame._mainContext(),l=[];for(let c of o.values()){let u=c.asElement();u?l.push(US(u,a)):c.dispose()}return Promise.all(l)}async resolveFrameForSelector(e,t={},n){let s=this.frame,o=(0,jc.splitSelectorByFrame)(e);for(let a of o)(0,jc.visitAllSelectorParts)(a,(l,c)=>{if(c&&l.name==="internal:control"&&l.body==="enter-frame"){let u=(0,DL.asLocator)(this.frame._page.attribution.playwright.options.sdkLanguage,e);throw new jc.InvalidSelectorError(`Frame locators are not allowed inside composite locators, while querying "${u}"`)}});for(let a=0;a<o.length-1;++a){let l=this._parseSelector(o[a],t),h=(await(await(await s._context(l.world)).injectedScript()).evaluateHandle((f,{info:_,scope:v,selectorString:w})=>{let m=f.querySelector(_.parsed,v||document,_.strict);if(m&&m.nodeName!=="IFRAME"&&m.nodeName!=="FRAME")throw f.createStacklessError(`Selector "${w}" resolved to ${f.previewNode(m)}, <iframe> was expected`);return m},{info:l,scope:a===0?n:void 0,selectorString:(0,jc.stringifySelector)(l.parsed)})).asElement();if(!h)return null;let p=await s._page._delegate.getContentFrame(h);if(h.dispose(),!p)return null;s=p}return s!==this.frame&&(n=void 0),{frame:s,info:s.selectors._parseSelector(o[o.length-1],t),scope:n}}async resolveInjectedForSelector(e,t,n){let s=await this.resolveFrameForSelector(e,t,n);return s?{injected:await(await s.frame._context(t!=null&&t.mainWorld?"main":s.info.world)).injectedScript(),info:s.info,frame:s.frame,scope:s.scope}:void 0}};qc.FrameSelectors=Om;async function US(r,e){if(r._context===e)return r;let t=r._page._delegate.adoptElementHandle(r,e);return r.dispose(),t}});var si=M(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.NavigationAbortedError=wr.FrameManager=wr.Frame=void 0;var St=Hc(Bo()),gr=yt(),VS=Ze(),ts=Hc(mr()),Fm=Hc(Ct()),Pm=Et(),BL=Hc(WS()),jo=$e(),Ue=Ut(),tn=ie(),qo=Qe(),Ho=Le(),Am=De(),Im=Wt(),Rm=ti(),jL=Xt(),qL=zS(),HL=Bt(),$L=Cm();function GS(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(GS=function(n){return n?t:e})(r)}function Hc(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=GS(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var ns=class extends Error{constructor(e,t){super(t),this.documentId=void 0,this.documentId=e}};wr.NavigationAbortedError=ns;var KS="<dummy>",Nm=class{constructor(e){this._page=void 0,this._frames=new Map,this._mainFrame=void 0,this._consoleMessageTags=new Map,this._signalBarriers=new Set,this._webSockets=new Map,this._openedDialogs=new Set,this._closeAllOpeningDialogs=!1,this._page=e,this._mainFrame=void 0}createDummyMainFrameIfNeeded(){this._mainFrame||this.frameAttached(KS,null)}dispose(){for(let e of this._frames.values())e._stopNetworkIdleTimer(),e._invalidateNonStallingEvaluations("Target crashed")}mainFrame(){return this._mainFrame}frames(){let e=[];return t(this._mainFrame),e;function t(n){e.push(n);for(let s of n.childFrames())t(s)}}frame(e){return this._frames.get(e)||null}frameAttached(e,t){let n=t?this._frames.get(t):null;if(n){(0,tn.assert)(!this._frames.has(e));let s=new _r(this._page,e,n);return this._frames.set(e,s),this._page.emit(Pm.Page.Events.FrameAttached,s),s}else return this._mainFrame?(this._frames.delete(this._mainFrame._id),this._mainFrame._id=e):((0,tn.assert)(!this._frames.has(e)),this._mainFrame=new _r(this._page,e,n)),this._frames.set(e,this._mainFrame),this._mainFrame}async waitForSignalsCreatedBy(e,t,n,s){if(t)return n();let o=new Lm(e);this._signalBarriers.add(o),e&&e.cleanupWhenAborted(()=>this._signalBarriers.delete(o));let a=await n();return s==="input"&&await this._page._delegate.inputActionEpilogue(),await o.waitFor(),this._signalBarriers.delete(o),await new Promise((0,tn.makeWaitForNextTask)()),a}frameWillPotentiallyRequestNavigation(){for(let e of this._signalBarriers)e.retain()}frameDidPotentiallyRequestNavigation(){for(let e of this._signalBarriers)e.release()}frameRequestedNavigation(e,t){let n=this._frames.get(e);if(!n)return;for(let o of this._signalBarriers)o.addFrameNavigation(n);if(n.pendingDocument()&&n.pendingDocument().documentId===t)return;let s=t?Array.from(n._inflightRequests).find(o=>o._documentId===t):void 0;n.setPendingDocument({documentId:t,request:s})}frameCommittedNewDocumentNavigation(e,t,n,s,o){let a=this._frames.get(e);this.removeChildFramesRecursively(a),this.clearWebSockets(a),a._url=t,a._name=n;let l,c=a.pendingDocument();c?(c.documentId===void 0&&(c.documentId=s),c.documentId===s?a._currentDocument=c:(l=c,a._currentDocument={documentId:s,request:void 0}),a.setPendingDocument(void 0)):a._currentDocument={documentId:s,request:void 0},a._onClearLifecycle();let u={url:t,name:n,newDocument:a._currentDocument,isPublic:!0};this._fireInternalFrameNavigation(a,u),o||(Ho.debugLogger.log("api",`  navigated to "${t}"`),this._page.frameNavigatedToNewDocument(a)),a.setPendingDocument(l)}frameCommittedSameDocumentNavigation(e,t){let n=this._frames.get(e);if(!n)return;n._url=t;let s={url:t,name:n._name,isPublic:!0};this._fireInternalFrameNavigation(n,s),Ho.debugLogger.log("api",`  navigated to "${t}"`)}frameAbortedNavigation(e,t,n){let s=this._frames.get(e);if(!s||!s.pendingDocument()||n!==void 0&&s.pendingDocument().documentId!==n)return;let o={url:s._url,name:s._name,newDocument:s.pendingDocument(),error:new ns(n,t),isPublic:!(n&&s._redirectedNavigations.has(n))};s.setPendingDocument(void 0),this._fireInternalFrameNavigation(s,o)}frameDetached(e){let t=this._frames.get(e);t&&(this._removeFramesRecursively(t),this._page.mainFrame()._recalculateNetworkIdle())}frameLifecycleEvent(e,t){let n=this._frames.get(e);n&&n._onLifecycleEvent(t)}requestStarted(e,t){let n=e.frame();if(this._inflightRequestStarted(e),e._documentId&&n.setPendingDocument({documentId:e._documentId,request:e}),e._isFavicon){t&&t.continue(e,{isFallback:!0}).catch(()=>{});return}if(this._page.emitOnContext(jo.BrowserContext.Events.Request,e),t){var s,o,a,l,c,u;let d=new Fm.Route(e,t);if((s=(o=this._page)._serverRequestInterceptor)!==null&&s!==void 0&&s.call(o,d,e)||(a=(l=this._page)._clientRequestInterceptor)!==null&&a!==void 0&&a.call(l,d,e)||(c=(u=this._page._browserContext)._requestInterceptor)!==null&&c!==void 0&&c.call(u,d,e))return;d.continue({isFallback:!0}).catch(()=>{})}}requestReceivedResponse(e){e.request()._isFavicon||this._page.emitOnContext(jo.BrowserContext.Events.Response,e)}reportRequestFinished(e,t){this._inflightRequestFinished(e),!e._isFavicon&&this._page.emitOnContext(jo.BrowserContext.Events.RequestFinished,{request:e,response:t})}requestFailed(e,t){let n=e.frame();if(this._inflightRequestFinished(e),n.pendingDocument()&&n.pendingDocument().request===e){let s=e.failure().errorText;t&&(s+="; maybe frame was detached?"),this.frameAbortedNavigation(n._id,s,n.pendingDocument().documentId)}e._isFavicon||this._page.emitOnContext(jo.BrowserContext.Events.RequestFailed,e)}dialogDidOpen(e){for(let t of this._frames.values())t._invalidateNonStallingEvaluations("JavaScript dialog interrupted evaluation");this._closeAllOpeningDialogs?e.close().then(()=>{}):this._openedDialogs.add(e)}dialogWillClose(e){this._openedDialogs.delete(e)}async closeOpenDialogs(){await Promise.all([...this._openedDialogs].map(e=>e.close())).catch(()=>{}),this._openedDialogs.clear()}setCloseAllOpeningDialogs(e){this._closeAllOpeningDialogs=e}removeChildFramesRecursively(e){for(let t of e.childFrames())this._removeFramesRecursively(t)}_removeFramesRecursively(e){this.removeChildFramesRecursively(e),e._onDetached(),this._frames.delete(e._id),this._page.isClosed()||this._page.emit(Pm.Page.Events.FrameDetached,e)}_inflightRequestFinished(e){let t=e.frame();e._isFavicon||t._inflightRequests.has(e)&&(t._inflightRequests.delete(e),t._inflightRequests.size===0&&t._startNetworkIdleTimer())}_inflightRequestStarted(e){let t=e.frame();e._isFavicon||(t._inflightRequests.add(e),t._inflightRequests.size===1&&t._stopNetworkIdleTimer())}interceptConsoleMessage(e){if(e.type()!=="debug")return!1;let t=e.text(),n=this._consoleMessageTags.get(t);return n?(this._consoleMessageTags.delete(t),n(),!0):!1}clearWebSockets(e){e.parentFrame()||this._webSockets.clear()}onWebSocketCreated(e,t){let n=new Fm.WebSocket(this._page,t);this._webSockets.set(e,n)}onWebSocketRequest(e){let t=this._webSockets.get(e);t&&t.markAsNotified()&&this._page.emit(Pm.Page.Events.WebSocket,t)}onWebSocketResponse(e,t,n){let s=this._webSockets.get(e);t<400||s&&s.error(`${n}: ${t}`)}onWebSocketFrameSent(e,t,n){let s=this._webSockets.get(e);s&&s.frameSent(t,n)}webSocketFrameReceived(e,t,n){let s=this._webSockets.get(e);s&&s.frameReceived(t,n)}webSocketClosed(e){let t=this._webSockets.get(e);t&&t.closed(),this._webSockets.delete(e)}webSocketError(e,t){let n=this._webSockets.get(e);n&&n.error(t)}_fireInternalFrameNavigation(e,t){e.emit(_r.Events.InternalNavigation,t)}};wr.FrameManager=Nm;var _r=class r extends Am.SdkObject{constructor(e,t,n){super(e,"frame"),this._id=void 0,this._firedLifecycleEvents=new Set,this._firedNetworkIdleSelf=!1,this._currentDocument=void 0,this._pendingDocument=void 0,this._page=void 0,this._parentFrame=void 0,this._url="",this._contextData=new Map,this._childFrames=new Set,this._name="",this._inflightRequests=new Set,this._networkIdleTimer=void 0,this._setContentCounter=0,this._detachedScope=new tn.LongStandingScope,this._raceAgainstEvaluationStallingEventsPromises=new Set,this._redirectedNavigations=new Map,this.selectors=void 0,this.attribution.frame=this,this._id=t,this._page=e,this._parentFrame=n,this._currentDocument={documentId:void 0,request:void 0},this.selectors=new qL.FrameSelectors(this),this._contextData.set("main",{contextPromise:new qo.ManualPromise,context:null}),this._contextData.set("utility",{contextPromise:new qo.ManualPromise,context:null}),this._setContext("main",null),this._setContext("utility",null),this._parentFrame&&this._parentFrame._childFrames.add(this),this._firedLifecycleEvents.add("commit"),t!==KS&&this._startNetworkIdleTimer()}isDetached(){return this._detachedScope.isClosed()}_onLifecycleEvent(e){this._firedLifecycleEvents.has(e)||(this._firedLifecycleEvents.add(e),this.emit(r.Events.AddLifecycle,e),this===this._page.mainFrame()&&this._url!=="about:blank"&&Ho.debugLogger.log("api",`  "${e}" event fired`),this._page.mainFrame()._recalculateNetworkIdle())}_onClearLifecycle(){for(let e of this._firedLifecycleEvents)this.emit(r.Events.RemoveLifecycle,e);this._firedLifecycleEvents.clear(),this._inflightRequests=new Set(Array.from(this._inflightRequests).filter(e=>e===this._currentDocument.request)),this._stopNetworkIdleTimer(),this._inflightRequests.size===0&&this._startNetworkIdleTimer(),this._page.mainFrame()._recalculateNetworkIdle(this),this._onLifecycleEvent("commit")}setPendingDocument(e){this._pendingDocument=e,e&&this._invalidateNonStallingEvaluations("Navigation interrupted the evaluation")}pendingDocument(){return this._pendingDocument}_invalidateNonStallingEvaluations(e){if(!this._raceAgainstEvaluationStallingEventsPromises.size)return;let t=new Error(e);for(let n of this._raceAgainstEvaluationStallingEventsPromises)n.reject(t)}async raceAgainstEvaluationStallingEvents(e){if(this._pendingDocument)throw new Error("Frame is currently attempting a navigation");if(this._page._frameManager._openedDialogs.size)throw new Error("Open JavaScript dialog prevents evaluation");let t=new qo.ManualPromise;this._raceAgainstEvaluationStallingEventsPromises.add(t);try{return await Promise.race([e(),t])}finally{this._raceAgainstEvaluationStallingEventsPromises.delete(t)}}nonStallingRawEvaluateInExistingMainContext(e){return this.raceAgainstEvaluationStallingEvents(()=>{let t=this._existingMainContext();if(!t)throw new Error("Frame does not yet have a main execution context");return t.rawEvaluateJSON(e)})}nonStallingEvaluateInExistingContext(e,t,n){return this.raceAgainstEvaluationStallingEvents(()=>{var s;let o=(s=this._contextData.get(n))===null||s===void 0?void 0:s.context;if(!o)throw new Error("Frame does not yet have the execution context");return o.evaluateExpression(e,{isFunction:t})})}_recalculateNetworkIdle(e){let t=this._firedNetworkIdleSelf;for(let n of this._childFrames)n._recalculateNetworkIdle(e),n._firedLifecycleEvents.has("networkidle")||(t=!1);t&&!this._firedLifecycleEvents.has("networkidle")&&(this._firedLifecycleEvents.add("networkidle"),this.emit(r.Events.AddLifecycle,"networkidle"),this===this._page.mainFrame()&&this._url!=="about:blank"&&Ho.debugLogger.log("api",'  "networkidle" event fired')),e!==this&&this._firedLifecycleEvents.has("networkidle")&&!t&&(this._firedLifecycleEvents.delete("networkidle"),this.emit(r.Events.RemoveLifecycle,"networkidle"))}async raceNavigationAction(e,t,n){return tn.LongStandingScope.raceMultiple([this._detachedScope,this._page.openScope],n().catch(s=>{if(s instanceof ns&&s.documentId){let o=this._redirectedNavigations.get(s.documentId);if(o)return e.log(`waiting for redirected navigation to "${o.url}"`),o.gotoPromise}throw s}))}redirectNavigation(e,t,n){let s=new Ue.ProgressController((0,Am.serverSideCallMetadata)(),this),o={url:e,gotoPromise:s.run(a=>this._gotoAction(a,e,{referer:n}),0)};this._redirectedNavigations.set(t,o),o.gotoPromise.finally(()=>this._redirectedNavigations.delete(t))}async goto(e,t,n={}){let s=(0,tn.constructURLBasedOnBaseURL)(this._page._browserContext._options.baseURL,t);return new Ue.ProgressController(e,this).run(a=>this._goto(a,s,n),this._page._timeoutSettings.navigationTimeout(n))}async _goto(e,t,n){return this.raceNavigationAction(e,n,async()=>this._gotoAction(e,t,n))}async _gotoAction(e,t,n){let s=Mm("waitUntil",n.waitUntil===void 0?"load":n.waitUntil);e.log(`navigating to "${t}", waiting until "${s}"`);let a=(this._page.extraHTTPHeaders()||[]).find(f=>f.name.toLowerCase()==="referer"),l=a?a.value:void 0;if(n.referer!==void 0){if(l!==void 0&&l!==n.referer)throw new Error('"referer" is already specified as extra HTTP header');l=n.referer}t=gr.helper.completeUserURL(t);let c=gr.helper.waitForEvent(e,this,r.Events.InternalNavigation,f=>!f.newDocument),u=await this._page._delegate.navigateFrame(this,t,l),d;if(u.newDocumentId){if(c.dispose(),d=await gr.helper.waitForEvent(e,this,r.Events.InternalNavigation,f=>f.newDocument&&(f.newDocument.documentId===u.newDocumentId||!f.error)).promise,d.newDocument.documentId!==u.newDocumentId)throw new ns(u.newDocumentId,`Navigation to "${t}" is interrupted by another navigation to "${d.url}"`);if(d.error)throw d.error}else d=await c.promise;this._firedLifecycleEvents.has(s)||await gr.helper.waitForEvent(e,this,r.Events.AddLifecycle,f=>f===s).promise;let h=d.newDocument?d.newDocument.request:void 0;return h?h._finalRequest().response():null}async _waitForNavigation(e,t,n){let s=Mm("waitUntil",n.waitUntil===void 0?"load":n.waitUntil);e.log(`waiting for navigation until "${s}"`);let o=await gr.helper.waitForEvent(e,this,r.Events.InternalNavigation,l=>l.error?!0:t&&!l.newDocument?!1:(e.log(`  navigated to "${this._url}"`),!0)).promise;if(o.error)throw o.error;this._firedLifecycleEvents.has(s)||await gr.helper.waitForEvent(e,this,r.Events.AddLifecycle,l=>l===s).promise;let a=o.newDocument?o.newDocument.request:void 0;return a?a._finalRequest().response():null}async _waitForLoadState(e,t){let n=Mm("state",t);this._firedLifecycleEvents.has(n)||await gr.helper.waitForEvent(e,this,r.Events.AddLifecycle,s=>s===n).promise}async frameElement(){return this._page._delegate.getFrameElement(this)}_context(e){return this._contextData.get(e).contextPromise.then(t=>{if(t instanceof ts.ExecutionContext)return t;throw new Error(t.destroyedReason)})}_mainContext(){return this._context("main")}_existingMainContext(){var e;return((e=this._contextData.get("main"))===null||e===void 0?void 0:e.context)||null}_utilityContext(){return this._context("utility")}async evaluateExpression(e,t={},n){var s;return await(await this._context((s=t.world)!==null&&s!==void 0?s:"main")).evaluateExpression(e,t,n)}async evaluateExpressionHandle(e,t={},n){var s;return await(await this._context((s=t.world)!==null&&s!==void 0?s:"main")).evaluateExpressionHandle(e,t,n)}async querySelector(e,t){return Ho.debugLogger.log("api",`    finding element using the selector "${e}"`),this.selectors.query(e,t)}async waitForSelector(e,t,n,s){let o=new Ue.ProgressController(e,this);if(n.visibility)throw new Error("options.visibility is not supported, did you mean options.state?");if(n.waitFor&&n.waitFor!=="visible")throw new Error("options.waitFor is not supported, did you mean options.state?");let{state:a="visible"}=n;if(!["attached","detached","visible","hidden"].includes(a))throw new Error("state: expected one of (attached|detached|visible|hidden)");return o.run(async l=>(l.log(`waiting for ${this._asLocator(t)}${a==="attached"?"":" to be "+a}`),await this.waitForSelectorInternal(l,t,n,s)),this._page._timeoutSettings.timeout(n))}async waitForSelectorInternal(e,t,n,s){let{state:o="visible"}=n,a=this.retryWithProgressAndTimeouts(e,[0,20,50,100,100,500],async l=>{let c=await this.selectors.resolveInjectedForSelector(t,n,s);if(e.throwIfAborted(),!c)return o==="hidden"||o==="detached"?null:l;let u=await c.injected.evaluateHandle((v,{info:w,root:m})=>{let g=v.querySelectorAll(w.parsed,m||document),x=g[0],b=x?v.isVisible(x):!1,y="";if(g.length>1){if(w.strict)throw v.strictModeViolationError(w.parsed,g);y=`  locator resolved to ${g.length} elements. Proceeding with the first one: ${v.previewNode(g[0])}`}else x&&(y=`  locator resolved to ${b?"visible":"hidden"} ${v.previewNode(x)}`);return{log:y,element:x,visible:b,attached:!!x}},{info:c.info,root:c.frame===this?s:void 0}),{log:d,visible:h,attached:p}=await u.evaluate(v=>({log:v.log,visible:v.visible,attached:v.attached}));if(d&&e.log(d),!{attached:p,detached:!p,visible:h,hidden:!h}[o])return u.dispose(),l;if(n.omitReturnValue)return u.dispose(),null;let _=o==="attached"||o==="visible"?await u.evaluateHandle(v=>v.element):null;if(u.dispose(),!_)return null;n.__testHookBeforeAdoptNode&&await n.__testHookBeforeAdoptNode();try{return await _._adoptTo(await c.frame._mainContext())}catch{return l}});return s?s._context._raceAgainstContextDestroyed(a):a}async dispatchEvent(e,t,n,s={},o={},a){await this._callOnElementOnceMatches(e,t,(l,c,u)=>{l.dispatchEvent(c,u.type,u.eventInit)},{type:n,eventInit:s},{mainWorld:!0,...o},a)}async evalOnSelector(e,t,n,s,o,a){let l=await this.selectors.query(e,{strict:t},a);if(!l)throw new Error(`Failed to find element matching selector "${e}"`);let c=await l.evaluateExpression(n,{isFunction:s},o);return l.dispose(),c}async evalOnSelectorAll(e,t,n,s,o){let a=await this.selectors.queryArrayInMainWorld(e,o),l=await a.evaluateExpression(t,{isFunction:n},s);return a.dispose(),l}async maskSelectors(e,t){await(await(await this._utilityContext()).injectedScript()).evaluate((o,{parsed:a,color:l})=>{o.maskSelectors(a,l)},{parsed:e,color:t})}async querySelectorAll(e){return this.selectors.queryAll(e)}async queryCount(e){return await this.selectors.queryCount(e)}async content(){try{return await(await this._utilityContext()).evaluate(()=>{let t="";return document.doctype&&(t=new XMLSerializer().serializeToString(document.doctype)),document.documentElement&&(t+=document.documentElement.outerHTML),t})}catch(e){throw ts.isJavaScriptErrorInEvaluate(e)||(0,Im.isSessionClosedError)(e)?e:new Error("Unable to retrieve content because the page is navigating and changing the content.")}}async setContent(e,t,n={}){return new Ue.ProgressController(e,this).run(async o=>{await this.raceNavigationAction(o,n,async()=>{let a=n.waitUntil===void 0?"load":n.waitUntil;o.log(`setting frame content, waiting until "${a}"`);let l=`--playwright--set--content--${this._id}--${++this._setContentCounter}--`,c=await this._utilityContext(),u=new Promise((h,p)=>{this._page._frameManager._consoleMessageTags.set(l,()=>{this._onClearLifecycle(),this._waitForLoadState(o,a).then(h).catch(p)})}),d=c.evaluate(({html:h,tag:p})=>{document.open(),console.debug(p),document.write(h),document.close()},{html:t,tag:l});return await Promise.all([d,u]),null})},this._page._timeoutSettings.navigationTimeout(n))}name(){return this._name||""}url(){return this._url}origin(){var e;if(this._url.startsWith("http"))return(e=Fm.parsedURL(this._url))===null||e===void 0?void 0:e.origin}parentFrame(){return this._parentFrame}childFrames(){return Array.from(this._childFrames)}async addScriptTag(e){let{url:t=null,content:n=null,type:s=""}=e;if(!t&&!n)throw new Error("Provide an object with a `url`, `path` or `content` property");let o=await this._mainContext();return this._raceWithCSPError(async()=>{if(t!==null)return(await o.evaluateHandle(a,{url:t,type:s})).asElement();let c=(await o.evaluateHandle(l,{content:n,type:s})).asElement();return this._page._delegate.cspErrorsAsynchronousForInlineScripts&&await o.evaluate(()=>!0),c});async function a(c){let u=document.createElement("script");u.src=c.url,c.type&&(u.type=c.type);let d=new Promise((h,p)=>{u.onload=h,u.onerror=f=>p(typeof f=="string"?new Error(f):new Error(`Failed to load script at ${u.src}`))});return document.head.appendChild(u),await d,u}function l(c){let u=document.createElement("script");u.type=c.type||"text/javascript",u.text=c.content;let d=null;if(u.onerror=h=>d=h,document.head.appendChild(u),d)throw d;return u}}async addStyleTag(e){let{url:t=null,content:n=null}=e;if(!t&&!n)throw new Error("Provide an object with a `url`, `path` or `content` property");let s=await this._mainContext();return this._raceWithCSPError(async()=>t!==null?(await s.evaluateHandle(o,t)).asElement():(await s.evaluateHandle(a,n)).asElement());async function o(l){let c=document.createElement("link");c.rel="stylesheet",c.href=l;let u=new Promise((d,h)=>{c.onload=d,c.onerror=h});return document.head.appendChild(c),await u,c}async function a(l){let c=document.createElement("style");c.type="text/css",c.appendChild(document.createTextNode(l));let u=new Promise((d,h)=>{c.onload=d,c.onerror=h});return document.head.appendChild(c),await u,c}}async _raceWithCSPError(e){let t=[],n,s,o,a=e().then(c=>n=c).catch(c=>s=c),l=new Promise(c=>{t.push(VS.eventsHelper.addEventListener(this._page._browserContext,jo.BrowserContext.Events.Console,u=>{u.page()!==this._page||u.type()!=="error"||(u.text().includes("Content-Security-Policy")||u.text().includes("Content Security Policy"))&&(o=u,c())}))});if(await Promise.race([a,l]),VS.eventsHelper.removeEventListeners(t),o)throw new Error(o.text());if(s)throw s;return n}async retryWithProgressAndTimeouts(e,t,n){let s=Symbol("continuePolling");t=[0,...t];let o=0;for(;e.isRunning();){let a=t[Math.min(o++,t.length-1)];if(a){let l=new Promise(c=>setTimeout(c,a));await tn.LongStandingScope.raceMultiple([this._page.openScope,this._detachedScope],l)}e.throwIfAborted();try{let l=await n(s);if(l===s)continue;return l}catch(l){if(this._isErrorThatCannotBeRetried(l))throw l;continue}}e.throwIfAborted()}_isErrorThatCannotBeRetried(e){return!!(ts.isJavaScriptErrorInEvaluate(e)||(0,Im.isSessionClosedError)(e)||St.isNonRecoverableDOMError(e)||(0,Rm.isInvalidSelectorError)(e)||this.isDetached())}async _retryWithProgressIfNotConnected(e,t,n,s,o){return e.log(`waiting for ${this._asLocator(t)}`),this.retryWithProgressAndTimeouts(e,[0,20,50,100,100,500],async a=>{s&&await this._page.performLocatorHandlersCheckpoint(e);let l=await this.selectors.resolveInjectedForSelector(t,{strict:n});if(e.throwIfAborted(),!l)return a;let c=await l.injected.evaluateHandle((p,{info:f})=>{let _=p.querySelectorAll(f.parsed,document),v=_[0],w="";if(_.length>1){if(f.strict)throw p.strictModeViolationError(f.parsed,_);w=`  locator resolved to ${_.length} elements. Proceeding with the first one: ${p.previewNode(_[0])}`}else v&&(w=`  locator resolved to ${p.previewNode(v)}`);return{log:w,success:!!v,element:v}},{info:l.info}),{log:u,success:d}=await c.evaluate(p=>({log:p.log,success:p.success}));if(u&&e.log(u),!d)return c.dispose(),a;let h=await c.evaluateHandle(p=>p.element);c.dispose();try{let p=await o(h);return p==="error:notconnected"?(e.log("element was detached from the DOM, retrying"),a):p}finally{h?.dispose()}})}async rafrafTimeoutScreenshotElementWithProgress(e,t,n,s){return await this._retryWithProgressIfNotConnected(e,t,!0,!0,async o=>(await o._frame.rafrafTimeout(n),await this._page._screenshotter.screenshotElement(e,o,s)))}async click(e,t,n){return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._click(o,n))),this._page._timeoutSettings.timeout(n))}async dblclick(e,t,n={}){return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._dblclick(o,n))),this._page._timeoutSettings.timeout(n))}async dragAndDrop(e,t,n,s={}){await new Ue.ProgressController(e,this).run(async a=>{St.assertDone(await this._retryWithProgressIfNotConnected(a,t,s.strict,!s.force,async l=>l._retryPointerAction(a,"move and down",!1,async c=>{await this._page.mouse.move(c.x,c.y),await this._page.mouse.down()},{...s,position:s.sourcePosition,timeout:a.timeUntilDeadline()}))),St.assertDone(await this._retryWithProgressIfNotConnected(a,n,s.strict,!1,async l=>l._retryPointerAction(a,"move and up",!1,async c=>{await this._page.mouse.move(c.x,c.y),await this._page.mouse.up()},{...s,position:s.targetPosition,timeout:a.timeUntilDeadline()})))},this._page._timeoutSettings.timeout(s))}async tap(e,t,n){if(!this._page._browserContext._options.hasTouch)throw new Error("The page does not support tap. Use hasTouch context option to enable touch support.");return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._tap(o,n))),this._page._timeoutSettings.timeout(n))}async fill(e,t,n,s){return new Ue.ProgressController(e,this).run(async a=>St.assertDone(await this._retryWithProgressIfNotConnected(a,t,s.strict,!s.force,l=>l._fill(a,n,s))),this._page._timeoutSettings.timeout(s))}async focus(e,t,n={}){await new Ue.ProgressController(e,this).run(async o=>{St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!0,a=>a._focus(o)))},this._page._timeoutSettings.timeout(n))}async blur(e,t,n={}){await new Ue.ProgressController(e,this).run(async o=>{St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!0,a=>a._blur(o)))},this._page._timeoutSettings.timeout(n))}async textContent(e,t,n={},s){return this._callOnElementOnceMatches(e,t,(o,a)=>a.textContent,void 0,n,s)}async innerText(e,t,n={},s){return this._callOnElementOnceMatches(e,t,(o,a)=>{if(a.namespaceURI!=="http://www.w3.org/1999/xhtml")throw o.createStacklessError("Node is not an HTMLElement");return a.innerText},void 0,n,s)}async innerHTML(e,t,n={},s){return this._callOnElementOnceMatches(e,t,(o,a)=>a.innerHTML,void 0,n,s)}async getAttribute(e,t,n,s={},o){return this._callOnElementOnceMatches(e,t,(a,l,c)=>l.getAttribute(c.name),{name:n},s,o)}async inputValue(e,t,n={},s){return this._callOnElementOnceMatches(e,t,(o,a)=>{let l=o.retarget(a,"follow-label");if(!l||l.nodeName!=="INPUT"&&l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT")throw o.createStacklessError("Node is not an <input>, <textarea> or <select> element");return l.value},void 0,n,s)}async highlight(e){let t=await this.selectors.resolveInjectedForSelector(e);if(t)return await t.injected.evaluate((n,{info:s})=>n.highlight(s.parsed),{info:t.info})}async hideHighlight(){return this.raceAgainstEvaluationStallingEvents(async()=>await(await(await this._utilityContext()).injectedScript()).evaluate(n=>n.hideHighlight()))}async _elementState(e,t,n,s={},o){let a=await this._callOnElementOnceMatches(e,t,(l,c,u)=>l.elementState(c,u.state),{state:n},s,o);return St.throwRetargetableDOMError(a)}async isVisible(e,t,n={},s){return new Ue.ProgressController(e,this).run(async a=>(a.log(`  checking visibility of ${this._asLocator(t)}`),await this.isVisibleInternal(t,n,s)),this._page._timeoutSettings.timeout({}))}async isVisibleInternal(e,t={},n){try{let s=await this.selectors.resolveInjectedForSelector(e,t,n);return s?await s.injected.evaluate((o,{info:a,root:l})=>{let c=o.querySelector(a.parsed,l||document,a.strict),u=c?o.elementState(c,"visible"):!1;return u==="error:notconnected"?!1:u},{info:s.info,root:s.frame===this?n:void 0}):!1}catch(s){if(ts.isJavaScriptErrorInEvaluate(s)||(0,Rm.isInvalidSelectorError)(s)||(0,Im.isSessionClosedError)(s))throw s;return!1}}async isHidden(e,t,n={},s){return!await this.isVisible(e,t,n,s)}async isDisabled(e,t,n={},s){return this._elementState(e,t,"disabled",n,s)}async isEnabled(e,t,n={},s){return this._elementState(e,t,"enabled",n,s)}async isEditable(e,t,n={},s){return this._elementState(e,t,"editable",n,s)}async isChecked(e,t,n={},s){return this._elementState(e,t,"checked",n,s)}async hover(e,t,n={}){return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._hover(o,n))),this._page._timeoutSettings.timeout(n))}async selectOption(e,t,n,s,o={}){return new Ue.ProgressController(e,this).run(async l=>await this._retryWithProgressIfNotConnected(l,t,o.strict,!o.force,c=>c._selectOption(l,n,s,o)),this._page._timeoutSettings.timeout(o))}async setInputFiles(e,t,n){let s=await(0,$L.prepareFilesForUpload)(this,n);return new Ue.ProgressController(e,this).run(async a=>St.assertDone(await this._retryWithProgressIfNotConnected(a,t,n.strict,!0,l=>l._setInputFiles(a,s,n))),this._page._timeoutSettings.timeout(n))}async type(e,t,n,s={}){return new Ue.ProgressController(e,this).run(async a=>St.assertDone(await this._retryWithProgressIfNotConnected(a,t,s.strict,!0,l=>l._type(a,n,s))),this._page._timeoutSettings.timeout(s))}async press(e,t,n,s={}){return new Ue.ProgressController(e,this).run(async a=>St.assertDone(await this._retryWithProgressIfNotConnected(a,t,s.strict,!0,l=>l._press(a,n,s))),this._page._timeoutSettings.timeout(s))}async check(e,t,n={}){return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._setChecked(o,!0,n))),this._page._timeoutSettings.timeout(n))}async uncheck(e,t,n={}){return new Ue.ProgressController(e,this).run(async o=>St.assertDone(await this._retryWithProgressIfNotConnected(o,t,n.strict,!n.force,a=>a._setChecked(o,!1,n))),this._page._timeoutSettings.timeout(n))}async waitForTimeout(e,t){return new Ue.ProgressController(e,this).run(async()=>{await new Promise(s=>setTimeout(s,t))})}async expect(e,t,n){let s=await this._expectImpl(e,t,n);return s.matches===n.isNot&&(e.error={error:{name:"Expect",message:"Expect failed"}}),s}async _expectImpl(e,t,n){let s=this._page._timeoutSettings.timeout(n),o=s>0?(0,tn.monotonicTime)():0,a={isSet:!1},l=await this._expectInternal(e,t,n,!0,s,a);if(l.matches!==n.isNot)return l;if(s>0){let c=(0,tn.monotonicTime)()-o;s-=c}return s<0?{matches:n.isNot,log:e.log,timedOut:!0,received:a.received}:await this._expectInternal(e,t,n,!1,s,a)}async _expectInternal(e,t,n,s,o,a){return new Ue.ProgressController(e,this).run(async c=>(s&&(c.log(`${e.apiName}${o?` with timeout ${o}ms`:""}`),c.log(`waiting for ${this._asLocator(t)}`)),await this.retryWithProgressAndTimeouts(c,[100,250,500,1e3],async u=>{var d;await this._page.performLocatorHandlersCheckpoint(c);let h=await this.selectors.resolveFrameForSelector(t,{strict:!0});c.throwIfAborted();let{frame:p,info:f}=h||{frame:this,info:void 0},_=n.expression==="to.have.property"?"main":(d=f?.world)!==null&&d!==void 0?d:"utility",w=await(await p._context(_)).injectedScript();c.throwIfAborted();let{log:m,matches:g,received:x,missingReceived:b}=await w.evaluate(async(y,{info:S,options:E,callId:C})=>{let k=S?y.querySelectorAll(S.parsed,document):[],F=E.expression==="to.have.count"||E.expression.endsWith(".array"),O="";if(F)O=`  locator resolved to ${k.length} element${k.length===1?"":"s"}`;else{if(k.length>1)throw y.strictModeViolationError(S.parsed,k);k.length&&(O=`  locator resolved to ${y.previewNode(k[0])}`)}return C&&y.markTargetElements(new Set(k),C),{log:O,...await y.expect(k[0],E,k)}},{info:f,options:n,callId:e.id});return m&&c.log(m),g===n.isNot&&(a.received=b?"<element(s) not found>":x,a.isSet=!0,!b&&!Array.isArray(x)&&c.log(`  unexpected value "${WL(n.expression,x)}"`)),!s&&g===n.isNot?u:{matches:g,received:x}})),s?0:o).catch(c=>{if(ts.isJavaScriptErrorInEvaluate(c)||(0,Rm.isInvalidSelectorError)(c))throw c;let u={matches:n.isNot,log:e.log};return a.isSet&&(u.received=a.received),c instanceof HL.TimeoutError&&(u.timedOut=!0),u})}async _waitForFunctionExpression(e,t,n,s,o,a="main"){let l=new Ue.ProgressController(e,this);return typeof o.pollingInterval=="number"&&(0,tn.assert)(o.pollingInterval>0,"Cannot poll with non-positive interval: "+o.pollingInterval),t=ts.normalizeEvaluationExpression(t,n),l.run(async c=>this.retryWithProgressAndTimeouts(c,[100],async()=>{let h=await(await(a==="main"?await this._mainContext():await this._utilityContext()).injectedScript()).evaluateHandle((p,{expression:f,isFunction:_,polling:v,arg:w})=>{let m=()=>{let E=globalThis.eval(f);return _===!0?E=E(w):_===!1?E=E:typeof E=="function"&&(E=E(w)),E},g,x,b=!1,y=new Promise((E,C)=>{g=E,x=C}),S=()=>{if(!b)try{let E=m();if(E){g(E);return}typeof v!="number"?requestAnimationFrame(S):setTimeout(S,v)}catch(E){x(E)}};return S(),{result:y,abort:()=>b=!0}},{expression:t,isFunction:n,polling:o.pollingInterval,arg:s});return c.cleanupWhenAborted(()=>h.evaluate(p=>p.abort()).catch(()=>{})),h.evaluateHandle(p=>p.result)}),this._page._timeoutSettings.timeout(o))}async waitForFunctionValueInUtility(e,t){let n=`() => {
      const result = (${t})();
      if (!result)
        return result;
      return JSON.stringify(result);
    }`,s=await this._waitForFunctionExpression((0,Am.serverSideCallMetadata)(),n,!0,void 0,{timeout:e.timeUntilDeadline()},"utility");return JSON.parse(s.rawValue())}async title(){return(await this._utilityContext()).evaluate(()=>document.title)}async rafrafTimeout(e){if(e===0)return;let t=await this._utilityContext();await Promise.all([t.evaluate(()=>new Promise(n=>{requestAnimationFrame(()=>{requestAnimationFrame(n)})})),new Promise(n=>setTimeout(n,e))])}_onDetached(){this._stopNetworkIdleTimer(),this._detachedScope.close(new Error("Frame was detached"));for(let e of this._contextData.values())e.context&&e.context.contextDestroyed("Frame was detached"),e.contextPromise.resolve({destroyedReason:"Frame was detached"});this._parentFrame&&this._parentFrame._childFrames.delete(this),this._parentFrame=null}async _callOnElementOnceMatches(e,t,n,s,o={},a){let l=n.toString();return new Ue.ProgressController(e,this).run(async u=>{u.log(`waiting for ${this._asLocator(t)}`);let d=this.retryWithProgressAndTimeouts(u,[0,20,50,100,100,500],async h=>{let p=await this.selectors.resolveInjectedForSelector(t,o,a);if(u.throwIfAborted(),!p)return h;let{log:f,success:_,value:v}=await p.injected.evaluate((w,{info:m,callbackText:g,taskData:x,callId:b,root:y})=>{let S=w.eval(g),E=w.querySelector(m.parsed,y||document,m.strict);if(!E)return{success:!1};let C=`  locator resolved to ${w.previewNode(E)}`;return b&&w.markTargetElements(new Set([E]),b),{log:C,success:!0,value:S(w,E,x)}},{info:p.info,callbackText:l,taskData:s,callId:u.metadata.id,root:p.frame===this?a:void 0});return f&&u.log(f),_?v:h});return a?a._context._raceAgainstContextDestroyed(d):d},this._page._timeoutSettings.timeout(o))}_setContext(e,t){let n=this._contextData.get(e);n.context=t,t?n.contextPromise.resolve(t):n.contextPromise=new qo.ManualPromise}_contextCreated(e,t){let n=this._contextData.get(e);n.context&&(n.context.contextDestroyed("Execution context was destroyed, most likely because of a navigation"),this._setContext(e,null)),this._setContext(e,t)}_contextDestroyed(e){if(!this._detachedScope.isClosed()){e.contextDestroyed("Execution context was destroyed, most likely because of a navigation");for(let[t,n]of this._contextData)n.context===e&&this._setContext(t,null)}}_startNetworkIdleTimer(){(0,tn.assert)(!this._networkIdleTimer),!(this._firedLifecycleEvents.has("networkidle")||this._detachedScope.isClosed())&&(this._networkIdleTimer=setTimeout(()=>{this._firedNetworkIdleSelf=!0,this._page.mainFrame()._recalculateNetworkIdle()},500))}_stopNetworkIdleTimer(){this._networkIdleTimer&&clearTimeout(this._networkIdleTimer),this._networkIdleTimer=void 0,this._firedNetworkIdleSelf=!1}async extendInjectedScript(e,t){return(await(await this._context("main")).injectedScript()).evaluateHandle((o,{source:a,arg:l})=>o.extend(a,l),{source:e,arg:t})}async resetStorageForCurrentOriginBestEffort(e){await(await this._utilityContext()).evaluate(async({ls:n})=>{sessionStorage.clear(),localStorage.clear();for(let l of n||[])localStorage[l.name]=l.value;let s=navigator.serviceWorker?await navigator.serviceWorker.getRegistrations():[];await Promise.all(s.map(async l=>{!l.installing&&!l.waiting&&!l.active?l.unregister().catch(()=>{}):await l.unregister().catch(()=>{})}));for(let l of await((o=(a=indexedDB).databases)===null||o===void 0?void 0:o.call(a))||[]){var o,a;l.name&&indexedDB.deleteDatabase(l.name)}},{ls:e?.localStorage}).catch(()=>{})}_asLocator(e){return(0,jL.asLocator)(this._page.attribution.playwright.options.sdkLanguage,e)}};wr.Frame=_r;_r.Events={InternalNavigation:"internalnavigation",AddLifecycle:"addlifecycle",RemoveLifecycle:"removelifecycle"};var Lm=class{constructor(e){this._progress=void 0,this._protectCount=0,this._promise=new qo.ManualPromise,this._progress=e,this.retain()}waitFor(){return this.release(),this._promise}async addFrameNavigation(e){if(e.parentFrame())return;this.retain();let t=gr.helper.waitForEvent(null,e,_r.Events.InternalNavigation,n=>n.isPublic?(!n.error&&this._progress&&this._progress.log(`  navigated to "${e._url}"`),!0):!1);await tn.LongStandingScope.raceMultiple([e._page.openScope,e._detachedScope],t.promise).catch(()=>{}),t.dispose(),this.release()}retain(){++this._protectCount}release(){--this._protectCount,this._protectCount||this._promise.resolve()}};function Mm(r,e){if(e==="networkidle0"&&(e="networkidle"),!BL.kLifecycleEvents.has(e))throw new Error(`${r}: expected one of (load|domcontentloaded|networkidle|commit)`);return e}function WL(r,e){return r==="to.be.checked"?e?"checked":"unchecked":r==="to.be.unchecked"?e?"unchecked":"checked":r==="to.be.visible"?e?"visible":"hidden":r==="to.be.hidden"?e?"hidden":"visible":r==="to.be.enabled"?e?"enabled":"disabled":r==="to.be.disabled"?e?"disabled":"enabled":r==="to.be.editable"?e?"editable":"readonly":r==="to.be.readonly"?e?"readonly":"editable":r==="to.be.empty"?e?"empty":"not empty":r==="to.be.focused"?e?"focused":"not focused":e}});var JS=M(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.keypadLocation=rs.USKeyboardLayout=void 0;var l9=rs.keypadLocation=3,c9=rs.USKeyboardLayout={Escape:{keyCode:27,key:"Escape"},F1:{keyCode:112,key:"F1"},F2:{keyCode:113,key:"F2"},F3:{keyCode:114,key:"F3"},F4:{keyCode:115,key:"F4"},F5:{keyCode:116,key:"F5"},F6:{keyCode:117,key:"F6"},F7:{keyCode:118,key:"F7"},F8:{keyCode:119,key:"F8"},F9:{keyCode:120,key:"F9"},F10:{keyCode:121,key:"F10"},F11:{keyCode:122,key:"F11"},F12:{keyCode:123,key:"F12"},Backquote:{keyCode:192,shiftKey:"~",key:"`"},Digit1:{keyCode:49,shiftKey:"!",key:"1"},Digit2:{keyCode:50,shiftKey:"@",key:"2"},Digit3:{keyCode:51,shiftKey:"#",key:"3"},Digit4:{keyCode:52,shiftKey:"$",key:"4"},Digit5:{keyCode:53,shiftKey:"%",key:"5"},Digit6:{keyCode:54,shiftKey:"^",key:"6"},Digit7:{keyCode:55,shiftKey:"&",key:"7"},Digit8:{keyCode:56,shiftKey:"*",key:"8"},Digit9:{keyCode:57,shiftKey:"(",key:"9"},Digit0:{keyCode:48,shiftKey:")",key:"0"},Minus:{keyCode:189,shiftKey:"_",key:"-"},Equal:{keyCode:187,shiftKey:"+",key:"="},Backslash:{keyCode:220,shiftKey:"|",key:"\\"},Backspace:{keyCode:8,key:"Backspace"},Tab:{keyCode:9,key:"Tab"},KeyQ:{keyCode:81,shiftKey:"Q",key:"q"},KeyW:{keyCode:87,shiftKey:"W",key:"w"},KeyE:{keyCode:69,shiftKey:"E",key:"e"},KeyR:{keyCode:82,shiftKey:"R",key:"r"},KeyT:{keyCode:84,shiftKey:"T",key:"t"},KeyY:{keyCode:89,shiftKey:"Y",key:"y"},KeyU:{keyCode:85,shiftKey:"U",key:"u"},KeyI:{keyCode:73,shiftKey:"I",key:"i"},KeyO:{keyCode:79,shiftKey:"O",key:"o"},KeyP:{keyCode:80,shiftKey:"P",key:"p"},BracketLeft:{keyCode:219,shiftKey:"{",key:"["},BracketRight:{keyCode:221,shiftKey:"}",key:"]"},CapsLock:{keyCode:20,key:"CapsLock"},KeyA:{keyCode:65,shiftKey:"A",key:"a"},KeyS:{keyCode:83,shiftKey:"S",key:"s"},KeyD:{keyCode:68,shiftKey:"D",key:"d"},KeyF:{keyCode:70,shiftKey:"F",key:"f"},KeyG:{keyCode:71,shiftKey:"G",key:"g"},KeyH:{keyCode:72,shiftKey:"H",key:"h"},KeyJ:{keyCode:74,shiftKey:"J",key:"j"},KeyK:{keyCode:75,shiftKey:"K",key:"k"},KeyL:{keyCode:76,shiftKey:"L",key:"l"},Semicolon:{keyCode:186,shiftKey:":",key:";"},Quote:{keyCode:222,shiftKey:'"',key:"'"},Enter:{keyCode:13,key:"Enter",text:"\r"},ShiftLeft:{keyCode:160,keyCodeWithoutLocation:16,key:"Shift",location:1},KeyZ:{keyCode:90,shiftKey:"Z",key:"z"},KeyX:{keyCode:88,shiftKey:"X",key:"x"},KeyC:{keyCode:67,shiftKey:"C",key:"c"},KeyV:{keyCode:86,shiftKey:"V",key:"v"},KeyB:{keyCode:66,shiftKey:"B",key:"b"},KeyN:{keyCode:78,shiftKey:"N",key:"n"},KeyM:{keyCode:77,shiftKey:"M",key:"m"},Comma:{keyCode:188,shiftKey:"<",key:","},Period:{keyCode:190,shiftKey:">",key:"."},Slash:{keyCode:191,shiftKey:"?",key:"/"},ShiftRight:{keyCode:161,keyCodeWithoutLocation:16,key:"Shift",location:2},ControlLeft:{keyCode:162,keyCodeWithoutLocation:17,key:"Control",location:1},MetaLeft:{keyCode:91,key:"Meta",location:1},AltLeft:{keyCode:164,keyCodeWithoutLocation:18,key:"Alt",location:1},Space:{keyCode:32,key:" "},AltRight:{keyCode:165,keyCodeWithoutLocation:18,key:"Alt",location:2},AltGraph:{keyCode:225,key:"AltGraph"},MetaRight:{keyCode:92,key:"Meta",location:2},ContextMenu:{keyCode:93,key:"ContextMenu"},ControlRight:{keyCode:163,keyCodeWithoutLocation:17,key:"Control",location:2},PrintScreen:{keyCode:44,key:"PrintScreen"},ScrollLock:{keyCode:145,key:"ScrollLock"},Pause:{keyCode:19,key:"Pause"},PageUp:{keyCode:33,key:"PageUp"},PageDown:{keyCode:34,key:"PageDown"},Insert:{keyCode:45,key:"Insert"},Delete:{keyCode:46,key:"Delete"},Home:{keyCode:36,key:"Home"},End:{keyCode:35,key:"End"},ArrowLeft:{keyCode:37,key:"ArrowLeft"},ArrowUp:{keyCode:38,key:"ArrowUp"},ArrowRight:{keyCode:39,key:"ArrowRight"},ArrowDown:{keyCode:40,key:"ArrowDown"},NumLock:{keyCode:144,key:"NumLock"},NumpadDivide:{keyCode:111,key:"/",location:3},NumpadMultiply:{keyCode:106,key:"*",location:3},NumpadSubtract:{keyCode:109,key:"-",location:3},Numpad7:{keyCode:36,shiftKeyCode:103,key:"Home",shiftKey:"7",location:3},Numpad8:{keyCode:38,shiftKeyCode:104,key:"ArrowUp",shiftKey:"8",location:3},Numpad9:{keyCode:33,shiftKeyCode:105,key:"PageUp",shiftKey:"9",location:3},Numpad4:{keyCode:37,shiftKeyCode:100,key:"ArrowLeft",shiftKey:"4",location:3},Numpad5:{keyCode:12,shiftKeyCode:101,key:"Clear",shiftKey:"5",location:3},Numpad6:{keyCode:39,shiftKeyCode:102,key:"ArrowRight",shiftKey:"6",location:3},NumpadAdd:{keyCode:107,key:"+",location:3},Numpad1:{keyCode:35,shiftKeyCode:97,key:"End",shiftKey:"1",location:3},Numpad2:{keyCode:40,shiftKeyCode:98,key:"ArrowDown",shiftKey:"2",location:3},Numpad3:{keyCode:34,shiftKeyCode:99,key:"PageDown",shiftKey:"3",location:3},Numpad0:{keyCode:45,shiftKeyCode:96,key:"Insert",shiftKey:"0",location:3},NumpadDecimal:{keyCode:46,shiftKeyCode:110,key:"\0",shiftKey:".",location:3},NumpadEnter:{keyCode:13,key:"Enter",text:"\r",location:3}}});var Wc=M(nn=>{"use strict";Object.defineProperty(nn,"__esModule",{value:!0});nn.keypadLocation=nn.Touchscreen=nn.Mouse=nn.Keyboard=void 0;nn.resolveSmartModifier=tE;nn.resolveSmartModifierString=qm;var QS=ie(),ZS=UL(JS());function eE(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(eE=function(n){return n?t:e})(r)}function UL(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=eE(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var d9=nn.keypadLocation=ZS.keypadLocation,$c=["Alt","Control","Meta","Shift"],Dm=class{constructor(e){this._pressedModifiers=new Set,this._pressedKeys=new Set,this._raw=void 0,this._raw=e}async down(e){let t=this._keyDescriptionForString(e),n=this._pressedKeys.has(t.code);this._pressedKeys.add(t.code),$c.includes(t.key)&&this._pressedModifiers.add(t.key);let s=t.text;await this._raw.keydown(this._pressedModifiers,t.code,t.keyCode,t.keyCodeWithoutLocation,t.key,t.location,n,s)}_keyDescriptionForString(e){let t=qm(e),n=YS.get(t);return(0,QS.assert)(n,`Unknown key: "${t}"`),n=this._pressedModifiers.has("Shift")&&n.shifted?n.shifted:n,this._pressedModifiers.size>1||!this._pressedModifiers.has("Shift")&&this._pressedModifiers.size===1?{...n,text:""}:n}async up(e){let t=this._keyDescriptionForString(e);$c.includes(t.key)&&this._pressedModifiers.delete(t.key),this._pressedKeys.delete(t.code),await this._raw.keyup(this._pressedModifiers,t.code,t.keyCode,t.keyCodeWithoutLocation,t.key,t.location)}async insertText(e){await this._raw.sendText(e)}async type(e,t){let n=t&&t.delay||void 0;for(let s of e)YS.has(s)?await this.press(s,{delay:n}):(n&&await new Promise(o=>setTimeout(o,n)),await this.insertText(s))}async press(e,t={}){function n(o){let a=[],l="";for(let c of o)c==="+"&&l?(a.push(l),l=""):l+=c;return a.push(l),a}let s=n(e);e=s[s.length-1];for(let o=0;o<s.length-1;++o)await this.down(s[o]);await this.down(e),t.delay&&await new Promise(o=>setTimeout(o,t.delay)),await this.up(e);for(let o=s.length-2;o>=0;--o)await this.up(s[o])}async ensureModifiers(e){let t=e.map(tE);for(let s of t)if(!$c.includes(s))throw new Error("Unknown modifier "+s);let n=Array.from(this._pressedModifiers);for(let s of $c){let o=t.includes(s),a=this._pressedModifiers.has(s);o&&!a?await this.down(s):!o&&a&&await this.up(s)}return n}_modifiers(){return this._pressedModifiers}};nn.Keyboard=Dm;function qm(r){return r==="ControlOrMeta"?process.platform==="darwin"?"Meta":"Control":r}function tE(r){return qm(r)}var Bm=class{constructor(e,t){this._keyboard=void 0,this._x=0,this._y=0,this._lastButton="none",this._buttons=new Set,this._raw=void 0,this._page=void 0,this._raw=e,this._page=t,this._keyboard=this._page.keyboard}async move(e,t,n={},s){s&&(s.point={x:e,y:t});let{steps:o=1}=n,a=this._x,l=this._y;this._x=e,this._y=t;for(let c=1;c<=o;c++){let u=a+(e-a)*(c/o),d=l+(t-l)*(c/o);await this._raw.move(u,d,this._lastButton,this._buttons,this._keyboard._modifiers(),!!n.forClick)}}async down(e={},t){t&&(t.point={x:this._x,y:this._y});let{button:n="left",clickCount:s=1}=e;this._lastButton=n,this._buttons.add(n),await this._raw.down(this._x,this._y,this._lastButton,this._buttons,this._keyboard._modifiers(),s)}async up(e={},t){t&&(t.point={x:this._x,y:this._y});let{button:n="left",clickCount:s=1}=e;this._lastButton="none",this._buttons.delete(n),await this._raw.up(this._x,this._y,n,this._buttons,this._keyboard._modifiers(),s)}async click(e,t,n={},s){s&&(s.point={x:this._x,y:this._y});let{delay:o=null,clickCount:a=1}=n;if(o){this.move(e,t,{forClick:!0});for(let l=1;l<=a;++l)await this.down({...n,clickCount:l}),await new Promise(c=>setTimeout(c,o)),await this.up({...n,clickCount:l}),l<a&&await new Promise(c=>setTimeout(c,o))}else{let l=[];l.push(this.move(e,t,{forClick:!0}));for(let c=1;c<=a;++c)l.push(this.down({...n,clickCount:c})),l.push(this.up({...n,clickCount:c}));await Promise.all(l)}}async dblclick(e,t,n={}){await this.click(e,t,{...n,clickCount:2})}async wheel(e,t){await this._raw.wheel(this._x,this._y,this._buttons,this._keyboard._modifiers(),e,t)}};nn.Mouse=Bm;var XS=new Map([["ShiftLeft",["Shift"]],["ControlLeft",["Control"]],["AltLeft",["Alt"]],["MetaLeft",["Meta"]],["Enter",[`
`,"\r"]]]),YS=zL(ZS.USKeyboardLayout);function zL(r){let e=new Map;for(let t in r){let n=r[t],s={key:n.key||"",keyCode:n.keyCode||0,keyCodeWithoutLocation:n.keyCodeWithoutLocation||n.keyCode||0,code:t,text:n.text||"",location:n.location||0};n.key.length===1&&(s.text=s.key);let o;if(n.shiftKey&&((0,QS.assert)(n.shiftKey.length===1),o={...s},o.key=n.shiftKey,o.text=n.shiftKey,n.shiftKeyCode&&(o.keyCode=n.shiftKeyCode)),e.set(t,{...s,shifted:o}),XS.has(t))for(let a of XS.get(t))e.set(a,s);n.location||(s.key.length===1&&e.set(s.key,s),o&&e.set(o.key,{...o,shifted:void 0}))}return e}var jm=class{constructor(e,t){this._raw=void 0,this._page=void 0,this._raw=e,this._page=t}async tap(e,t,n){if(n&&(n.point={x:e,y:t}),!this._page._browserContext._options.hasTouch)throw new Error("hasTouch must be enabled on the browser context before using the touchscreen.");await this._raw.tap(e,t,this._page.keyboard._modifiers())}};nn.Touchscreen=jm});var rE=M($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.Screenshotter=void 0;$o.validateScreenshotOptions=$m;var VL=yt(),Tt=ie(),GL=wl();function KL(r,e,t,n){if(n){let l=document.createElement("style");l.textContent="body {}",document.head.appendChild(l),document.documentElement.getBoundingClientRect(),l.remove()}if(!r&&!e&&!t)return;let s=(l,c=[])=>{c.push(l);let u=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT);do{let d=u.currentNode,h=d instanceof Element?d.shadowRoot:null;h&&s(h,c)}while(u.nextNode());return c},o=s(document),a=[];if(r)for(let l of o){let c=document.createElement("style");c.textContent=r,l===document?document.documentElement.append(c):l.append(c),a.push(()=>{c.remove()})}if(e){let l=new Map;for(let c of o)c.querySelectorAll("input,textarea,[contenteditable]").forEach(u=>{l.set(u,{value:u.style.getPropertyValue("caret-color"),priority:u.style.getPropertyPriority("caret-color")}),u.style.setProperty("caret-color","transparent","important")});a.push(()=>{for(let[c,u]of l)c.style.setProperty("caret-color",u.value,u.priority)})}if(t){let l=new Set,c=u=>{for(let d of u.getAnimations()){if(!d.effect||d.playbackRate===0||l.has(d))continue;let h=d.effect.getComputedTiming().endTime;if(Number.isFinite(h))try{d.finish()}catch{}else try{d.cancel(),l.add(d)}catch{}}};for(let u of o){let d=c.bind(null,u);d(),u.addEventListener("transitionrun",d),u.addEventListener("animationstart",d),a.push(()=>{u.removeEventListener("transitionrun",d),u.removeEventListener("animationstart",d)})}a.push(()=>{for(let u of l)try{u.play()}catch{}})}window.__pwCleanupScreenshot=()=>{for(let l of a)l();delete window.__pwCleanupScreenshot}}var Hm=class{constructor(e){this._queue=new Uc,this._page=void 0,this._page=e,this._queue=new Uc}async _originalViewportSize(e){let t=this._page.viewportSize(),n=t;return n||(n=await this._page.mainFrame().waitForFunctionValueInUtility(e,()=>({width:window.innerWidth,height:window.innerHeight}))),{viewportSize:n,originalViewportSize:t}}async _fullPageSize(e){return await this._page.mainFrame().waitForFunctionValueInUtility(e,()=>!document.body||!document.documentElement?null:{width:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)})}async screenshotPage(e,t){let n=$m(t);return this._queue.postTask(async()=>{e.log("taking page screenshot");let{viewportSize:s}=await this._originalViewportSize(e);if(await this._preparePageForScreenshot(e,t.style,t.caret!=="initial",t.animations==="disabled"),e.throwIfAborted(),t.fullPage){let l=await this._fullPageSize(e),c={x:0,y:0,width:l.width,height:l.height},u=l.width<=s.width&&l.height<=s.height;t.clip&&(c=nE(t.clip,c));let d=await this._screenshot(e,n,c,void 0,u,t);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),d}let o=t.clip?nE(t.clip,s):{x:0,y:0,...s},a=await this._screenshot(e,n,void 0,o,!0,t);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),a})}async screenshotElement(e,t,n){let s=$m(n);return this._queue.postTask(async()=>{e.log("taking element screenshot");let{viewportSize:o}=await this._originalViewportSize(e);await this._preparePageForScreenshot(e,n.style,n.caret!=="initial",n.animations==="disabled"),e.throwIfAborted(),await t._waitAndScrollIntoViewIfNeeded(e,!0),e.throwIfAborted();let a=await t.boundingBox();(0,Tt.assert)(a,"Node is either not visible or not an HTMLElement"),(0,Tt.assert)(a.width!==0,"Node has 0 width."),(0,Tt.assert)(a.height!==0,"Node has 0 height.");let l=a.width<=o.width&&a.height<=o.height;e.throwIfAborted();let c=await this._page.mainFrame().waitForFunctionValueInUtility(e,()=>({x:window.scrollX,y:window.scrollY})),u={...a};u.x+=c.x,u.y+=c.y;let d=await this._screenshot(e,s,VL.helper.enclosingIntRect(u),void 0,l,n);return e.throwIfAborted(),await this._restorePageAfterScreenshot(),d})}async _preparePageForScreenshot(e,t,n,s){s&&e.log("  disabled all CSS animations");let o=this._page._delegate.shouldToggleStyleSheetToSyncAnimations();await Promise.all(this._page.frames().map(async a=>{await a.nonStallingEvaluateInExistingContext("("+KL.toString()+`)(${JSON.stringify(t)}, ${n}, ${s}, ${o})`,!1,"utility").catch(()=>{})})),process.env.PW_TEST_SCREENSHOT_NO_FONTS_READY||(e.log("waiting for fonts to load..."),await Promise.all(this._page.frames().map(async a=>{await a.nonStallingEvaluateInExistingContext("document.fonts.ready",!1,"utility").catch(()=>{})})),e.log("fonts loaded")),e.cleanupWhenAborted(()=>this._restorePageAfterScreenshot())}async _restorePageAfterScreenshot(){await Promise.all(this._page.frames().map(async e=>{e.nonStallingEvaluateInExistingContext("window.__pwCleanupScreenshot && window.__pwCleanupScreenshot()",!1,"utility").catch(()=>{})}))}async _maskElements(e,t){let n=new GL.MultiMap,s=async()=>{await Promise.all([...n.keys()].map(async o=>{await o.hideHighlight()}))};return!t.mask||!t.mask.length||(await Promise.all((t.mask||[]).map(async({frame:o,selector:a})=>{let l=await o.selectors.resolveFrameForSelector(a);l&&n.set(l.frame,l.info.parsed)})),e.throwIfAborted(),await Promise.all([...n.keys()].map(async o=>{await o.maskSelectors(n.get(o),t.maskColor||"#F0F")})),e.cleanupWhenAborted(s)),s}async _screenshot(e,t,n,s,o,a){var l;a.__testHookBeforeScreenshot&&await a.__testHookBeforeScreenshot(),e.throwIfAborted();let c=a.omitBackground&&t==="png";c&&(await this._page._delegate.setBackgroundColor({r:0,g:0,b:0,a:0}),e.cleanupWhenAborted(()=>this._page._delegate.setBackgroundColor())),e.throwIfAborted();let u=await this._maskElements(e,a);e.throwIfAborted();let d=t==="jpeg"?(l=a.quality)!==null&&l!==void 0?l:80:void 0,h=await this._page._delegate.takeScreenshot(e,t,n,s,d,o,a.scale||"device");return e.throwIfAborted(),await u(),e.throwIfAborted(),c&&await this._page._delegate.setBackgroundColor(),e.throwIfAborted(),a.__testHookAfterScreenshot&&await a.__testHookAfterScreenshot(),h}};$o.Screenshotter=Hm;var Uc=class{constructor(){this._chain=void 0,this._chain=Promise.resolve()}postTask(e){let t=this._chain.then(e);return this._chain=t.catch(()=>{}),t}};function nE(r,e){let t={x:Math.max(0,Math.min(r.x,e.width)),y:Math.max(0,Math.min(r.y,e.height))},n={x:Math.max(0,Math.min(r.x+r.width,e.width)),y:Math.max(0,Math.min(r.y+r.height,e.height))},s={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y};return(0,Tt.assert)(s.width&&s.height,"Clipped area is either empty or outside the resulting image"),s}function $m(r){let e=null;return r.type&&((0,Tt.assert)(r.type==="png"||r.type==="jpeg","Unknown options.type value: "+r.type),e=r.type),e||(e="png"),r.quality!==void 0&&((0,Tt.assert)(e==="jpeg","options.quality is unsupported for the "+e+" screenshots"),(0,Tt.assert)(typeof r.quality=="number","Expected options.quality to be a number but found "+typeof r.quality),(0,Tt.assert)(Number.isInteger(r.quality),"Expected options.quality to be an integer"),(0,Tt.assert)(r.quality>=0&&r.quality<=100,"Expected options.quality to be between 0 and 100 (inclusive), got "+r.quality)),r.clip&&((0,Tt.assert)(typeof r.clip.x=="number","Expected options.clip.x to be a number but found "+typeof r.clip.x),(0,Tt.assert)(typeof r.clip.y=="number","Expected options.clip.y to be a number but found "+typeof r.clip.y),(0,Tt.assert)(typeof r.clip.width=="number","Expected options.clip.width to be a number but found "+typeof r.clip.width),(0,Tt.assert)(typeof r.clip.height=="number","Expected options.clip.height to be a number but found "+typeof r.clip.height),(0,Tt.assert)(r.clip.width!==0,"Expected options.clip.width not to be 0."),(0,Tt.assert)(r.clip.height!==0,"Expected options.clip.height not to be 0.")),e}});var Um=M(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.ConsoleMessage=void 0;var Wm=class{constructor(e,t,n,s,o){this._type=void 0,this._text=void 0,this._args=void 0,this._location=void 0,this._page=void 0,this._page=e,this._type=t,this._text=n,this._args=s,this._location=o||{url:"",lineNumber:0,columnNumber:0}}page(){return this._page}type(){return this._type}text(){return this._text===void 0&&(this._text=this._args.map(e=>e.preview()).join(" ")),this._text}args(){return this._args}location(){return this._location}};zc.ConsoleMessage=Wm});var sE=M(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.Accessibility=void 0;var zm=class{constructor(e){this._getAXTree=void 0,this._getAXTree=e}async snapshot(e={}){let{interestingOnly:t=!0,root:n=null}=e,{tree:s,needle:o}=await this._getAXTree(n||void 0);if(!t)return n?o&&Vc(o)[0]:Vc(s)[0];let a=new Set;return iE(a,s,!1),n&&(!o||!a.has(o))?null:Vc(o||s,a)[0]}};Gc.Accessibility=zm;function iE(r,e,t){if(e.isInteresting(t)&&r.add(e),!e.isLeafNode()){t=t||e.isControl();for(let n of e.children())iE(r,n,t)}}function Vc(r,e){let t=[];for(let s of r.children())t.push(...Vc(s,e));if(e&&!e.has(r))return t;let n=r.serialize();return t.length&&(n.children=t),[n]}});var oE=M(Kc=>{"use strict";Object.defineProperty(Kc,"__esModule",{value:!0});Kc.FileChooser=void 0;var Vm=class{constructor(e,t,n){this._page=void 0,this._elementHandle=void 0,this._isMultiple=void 0,this._page=e,this._elementHandle=t,this._isMultiple=n}element(){return this._elementHandle}isMultiple(){return this._isMultiple}page(){return this._page}};Kc.FileChooser=Vm});var Et=M(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.Worker=vr.PageBinding=vr.Page=void 0;var JL=Qc(si()),Gm=Qc(Wc()),Jc=Qc(mr()),aE=rE(),XL=en(),lE=$e(),YL=Um(),QL=Qc(sE()),ZL=oE(),Wo=Ut(),zo=ie(),cE=Qe(),Uo=Le(),eD=Cp(),hE=De(),tD=ti(),uE=Zi(),nD=Bt(),dE=Xt();function pE(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(pE=function(n){return n?t:e})(r)}function Qc(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=pE(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Xc=class r extends hE.SdkObject{constructor(e,t){super(t,"page"),this._closedState="open",this._closedPromise=new cE.ManualPromise,this._initialized=!1,this._eventsToEmitAfterInitialized=[],this._crashed=!1,this.openScope=new zo.LongStandingScope,this._browserContext=void 0,this.keyboard=void 0,this.mouse=void 0,this.touchscreen=void 0,this._timeoutSettings=void 0,this._delegate=void 0,this._emulatedSize=void 0,this._extraHTTPHeaders=void 0,this._emulatedMedia={},this._interceptFileChooser=!1,this._pageBindings=new Map,this.initScripts=[],this._screenshotter=void 0,this._frameManager=void 0,this.accessibility=void 0,this._workers=new Map,this.pdf=void 0,this.coverage=void 0,this._clientRequestInterceptor=void 0,this._serverRequestInterceptor=void 0,this._ownedContext=void 0,this._pageIsError=void 0,this._video=null,this._opener=void 0,this._isServerSideOnly=!1,this._locatorHandlers=new Map,this._lastLocatorHandlerUid=0,this._locatorHandlerRunningCounter=0,this._frameThrottler=new Km(10,35,200),this._closeReason=void 0,this.attribution.page=this,this._delegate=e,this._browserContext=t,this.accessibility=new QL.Accessibility(e.getAccessibilityTree.bind(e)),this.keyboard=new Gm.Keyboard(e.rawKeyboard),this.mouse=new Gm.Mouse(e.rawMouse,this),this.touchscreen=new Gm.Touchscreen(e.rawTouchscreen,this),this._timeoutSettings=new XL.TimeoutSettings(t._timeoutSettings),this._screenshotter=new aE.Screenshotter(this),this._frameManager=new JL.FrameManager(this),e.pdf&&(this.pdf=e.pdf.bind(e)),this.coverage=e.coverage?e.coverage():null}async initOpener(e){if(!e)return;let t=await e.pageOrError();t instanceof r&&!t.isClosed()&&(this._opener=t)}reportAsNew(e=void 0,t=lE.BrowserContext.Events.Page){if(e){if(this._browserContext.isClosingOrClosed())return;this._setIsError(e)}this._initialized=!0,this.emitOnContext(t,this);for(let{event:n,args:s}of this._eventsToEmitAfterInitialized)this._browserContext.emit(n,...s);this._eventsToEmitAfterInitialized=[],this.isClosed()?this.emit(r.Events.Close):this.instrumentation.onPageOpen(this)}initializedOrUndefined(){return this._initialized?this:void 0}emitOnContext(e,...t){this._isServerSideOnly||this._browserContext.emit(e,...t)}emitOnContextOnceInitialized(e,...t){this._isServerSideOnly||(this._initialized?this._browserContext.emit(e,...t):this._eventsToEmitAfterInitialized.push({event:e,args:t}))}async resetForReuse(e){this.setDefaultNavigationTimeout(void 0),this.setDefaultTimeout(void 0),this._locatorHandlers.clear(),await this._removeExposedBindings(),await this._removeInitScripts(),await this.setClientRequestInterceptor(void 0),await this._setServerRequestInterceptor(void 0),await this.setFileChooserIntercepted(!1),await this.mainFrame().goto(e,"about:blank"),this._emulatedSize=void 0,this._emulatedMedia={},this._extraHTTPHeaders=void 0,this._interceptFileChooser=!1,await Promise.all([this._delegate.updateEmulatedViewportSize(),this._delegate.updateEmulateMedia(),this._delegate.updateFileChooserInterception()]),await this._delegate.resetForReuse()}_didClose(){this._frameManager.dispose(),this._frameThrottler.dispose(),(0,zo.assert)(this._closedState!=="closed","Page closed twice"),this._closedState="closed",this.emit(r.Events.Close),this._closedPromise.resolve(),this.instrumentation.onPageClose(this),this.openScope.close(new nD.TargetClosedError)}_didCrash(){this._frameManager.dispose(),this._frameThrottler.dispose(),this.emit(r.Events.Crash),this._crashed=!0,this.instrumentation.onPageClose(this),this.openScope.close(new Error("Page crashed"))}async _onFileChooserOpened(e){let t;try{t=await e.evaluate(s=>!!s.multiple)}catch{return}if(!this.listenerCount(r.Events.FileChooser)){e.dispose();return}let n=new ZL.FileChooser(this,e,t);this.emit(r.Events.FileChooser,n)}context(){return this._browserContext}opener(){return this._opener}mainFrame(){return this._frameManager.mainFrame()}frames(){return this._frameManager.frames()}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async exposeBinding(e,t,n){if(this._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered`);if(this._browserContext._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered in the browser context`);let s=new Vo(e,n,t);this._pageBindings.set(e,s),await this._delegate.exposeBinding(s)}async _removeExposedBindings(){for(let e of this._pageBindings.keys())e.startsWith("__pw")||this._pageBindings.delete(e);await this._delegate.removeExposedBindings()}setExtraHTTPHeaders(e){return this._extraHTTPHeaders=e,this._delegate.updateExtraHTTPHeaders()}extraHTTPHeaders(){return this._extraHTTPHeaders}async _onBindingCalled(e,t){this._closedState!=="closed"&&await Vo.dispatch(this,e,t)}_addConsoleMessage(e,t,n,s){let o=new YL.ConsoleMessage(this,e,s,t,n);if(this._frameManager.interceptConsoleMessage(o)){t.forEach(l=>l.dispose());return}this.emitOnContextOnceInitialized(lE.BrowserContext.Events.Console,o)}async reload(e,t){return new Wo.ProgressController(e,this).run(s=>this.mainFrame().raceNavigationAction(s,t,async()=>{let[o]=await Promise.all([this.mainFrame()._waitForNavigation(s,!0,t),this._delegate.reload()]);return o}),this._timeoutSettings.navigationTimeout(t))}async goBack(e,t){return new Wo.ProgressController(e,this).run(s=>this.mainFrame().raceNavigationAction(s,t,async()=>{let o,a=this.mainFrame()._waitForNavigation(s,!1,t).catch(u=>(o=u,null));if(!await this._delegate.goBack())return null;let c=await a;if(o)throw o;return c}),this._timeoutSettings.navigationTimeout(t))}async goForward(e,t){return new Wo.ProgressController(e,this).run(s=>this.mainFrame().raceNavigationAction(s,t,async()=>{let o,a=this.mainFrame()._waitForNavigation(s,!1,t).catch(u=>(o=u,null));if(!await this._delegate.goForward())return null;let c=await a;if(o)throw o;return c}),this._timeoutSettings.navigationTimeout(t))}registerLocatorHandler(e,t){let n=++this._lastLocatorHandlerUid;return this._locatorHandlers.set(n,{selector:e,noWaitAfter:t}),n}resolveLocatorHandler(e,t){let n=this._locatorHandlers.get(e);if(t&&this._locatorHandlers.delete(e),n){var s;(s=n.resolved)===null||s===void 0||s.resolve(),n.resolved=void 0}}unregisterLocatorHandler(e){this._locatorHandlers.delete(e)}async performLocatorHandlersCheckpoint(e){if(!this._locatorHandlerRunningCounter){for(let[t,n]of this._locatorHandlers)if(n.resolved||await this.mainFrame().isVisibleInternal(n.selector,{strict:!0})&&(n.resolved=new cE.ManualPromise,this.emit(r.Events.LocatorHandlerTriggered,t)),n.resolved){++this._locatorHandlerRunningCounter,e.log(`  found ${(0,dE.asLocator)(this.attribution.playwright.options.sdkLanguage,n.selector)}, intercepting action to run the handler`);let s=n.resolved.then(async()=>{e.throwIfAborted(),n.noWaitAfter?e.log("  locator handler has finished"):(e.log(`  locator handler has finished, waiting for ${(0,dE.asLocator)(this.attribution.playwright.options.sdkLanguage,n.selector)} to be hidden`),await this.mainFrame().waitForSelectorInternal(e,n.selector,{state:"hidden"}))});await this.openScope.race(s).finally(()=>--this._locatorHandlerRunningCounter),e.throwIfAborted(),e.log("  interception handler has finished, continuing")}}}async emulateMedia(e){e.media!==void 0&&(this._emulatedMedia.media=e.media),e.colorScheme!==void 0&&(this._emulatedMedia.colorScheme=e.colorScheme),e.reducedMotion!==void 0&&(this._emulatedMedia.reducedMotion=e.reducedMotion),e.forcedColors!==void 0&&(this._emulatedMedia.forcedColors=e.forcedColors),await this._delegate.updateEmulateMedia()}emulatedMedia(){var e,t,n;let s=this._browserContext._options;return{media:this._emulatedMedia.media||"no-override",colorScheme:this._emulatedMedia.colorScheme!==void 0?this._emulatedMedia.colorScheme:(e=s.colorScheme)!==null&&e!==void 0?e:"light",reducedMotion:this._emulatedMedia.reducedMotion!==void 0?this._emulatedMedia.reducedMotion:(t=s.reducedMotion)!==null&&t!==void 0?t:"no-preference",forcedColors:this._emulatedMedia.forcedColors!==void 0?this._emulatedMedia.forcedColors:(n=s.forcedColors)!==null&&n!==void 0?n:"none"}}async setViewportSize(e){this._emulatedSize={viewport:{...e},screen:{...e}},await this._delegate.updateEmulatedViewportSize()}viewportSize(){var e;return((e=this.emulatedSize())===null||e===void 0?void 0:e.viewport)||null}emulatedSize(){if(this._emulatedSize)return this._emulatedSize;let e=this._browserContext._options;return e.viewport?{viewport:e.viewport,screen:e.screen||e.viewport}:null}async bringToFront(){await this._delegate.bringToFront()}async addInitScript(e){this.initScripts.push(e),await this._delegate.addInitScript(e)}async _removeInitScripts(){this.initScripts.splice(0,this.initScripts.length),await this._delegate.removeInitScripts()}needsRequestInterception(){return!!this._clientRequestInterceptor||!!this._serverRequestInterceptor||!!this._browserContext._requestInterceptor}async setClientRequestInterceptor(e){this._clientRequestInterceptor=e,await this._delegate.updateRequestInterception()}async _setServerRequestInterceptor(e){this._serverRequestInterceptor=e,await this._delegate.updateRequestInterception()}async expectScreenshot(e,t={}){let n=t.locator,s=n?async(d,h)=>await n.frame.rafrafTimeoutScreenshotElementWithProgress(d,n.selector,h,t||{}):async(d,h)=>(await this.performLocatorHandlersCheckpoint(d),await this.mainFrame().rafrafTimeout(h),await this._screenshotter.screenshotPage(d,t||{})),o=(0,eD.getComparator)("image/png"),a=new Wo.ProgressController(e,this);if(!t.expected&&t.isNot)return{errorMessage:'"not" matcher requires expected result'};try{if((0,aE.validateScreenshotOptions)(t||{})!=="png")throw new Error("Only PNG screenshots are supported")}catch(d){return{errorMessage:d.message}}let l,c=(d,h,p)=>{let f=d&&h?o(d,h,t):void 0;return f!==void 0&&!!f==!!t.isNot?!0:(f&&(l={errorMessage:f.errorMessage,diff:f.diff,actual:d,previous:p}),!1)},u=this._timeoutSettings.timeout(t);return a.run(async d=>{let h,p,f=[0,100,250,500];d.log(`${e.apiName}${u?` with timeout ${u}ms`:""}`),t.expected?d.log("  verifying given screenshot expectation"):d.log("  generating new stable screenshot expectation");let _=!0;for(;;){var v;if(d.throwIfAborted(),this.isClosed())throw new Error("The page has closed");let w=(v=f.shift())!==null&&v!==void 0?v:1e3;if(w&&d.log(`waiting ${w}ms before taking screenshot`),p=h,h=await s(d,w).catch(g=>{d.log("failed to take screenshot - "+g.message)}),!h)continue;let m=t.expected&&_?t.expected:p;if(c(h,m,p))break;l&&d.log(l.errorMessage),_=!1}if(_||d.log("captured a stable screenshot"),!t.expected)return{actual:h};if(_)return d.log("screenshot matched expectation"),{};if(c(h,t.expected,p))return d.log("screenshot matched expectation"),{};throw new Error(l.errorMessage)},u).catch(d=>{if(Jc.isJavaScriptErrorInEvaluate(d)||(0,tD.isInvalidSelectorError)(d))throw d;return{log:d.message?[...e.log,d.message]:e.log,...l,errorMessage:d.message}})}async screenshot(e,t={}){return new Wo.ProgressController(e,this).run(s=>this._screenshotter.screenshotPage(s,t),this._timeoutSettings.timeout(t))}async close(e,t={}){if(this._closedState==="closed")return;t.reason&&(this._closeReason=t.reason);let n=!!t.runBeforeUnload;this._closedState!=="closing"&&(this._closedState="closing",await this._delegate.closePage(n).catch(s=>Uo.debugLogger.log("error",s))),n||await this._closedPromise,this._ownedContext&&await this._ownedContext.close(t)}_setIsError(e){this._pageIsError=e,this._frameManager.createDummyMainFrameIfNeeded()}isClosed(){return this._closedState==="closed"}hasCrashed(){return this._crashed}isClosedOrClosingOrCrashed(){return this._closedState!=="open"||this._crashed}_addWorker(e,t){this._workers.set(e,t),this.emit(r.Events.Worker,t)}_removeWorker(e){let t=this._workers.get(e);t&&(t.didClose(),this._workers.delete(e))}_clearWorkers(){for(let[e,t]of this._workers)t.didClose(),this._workers.delete(e)}async setFileChooserIntercepted(e){this._interceptFileChooser=e,await this._delegate.updateFileChooserInterception()}fileChooserIntercepted(){return this._interceptFileChooser}frameNavigatedToNewDocument(e){this.emit(r.Events.InternalFrameNavigatedToNewDocument,e);let t=e.origin();t&&this._browserContext.addVisitedOrigin(t)}allBindings(){return[...this._browserContext._pageBindings.values(),...this._pageBindings.values()]}getBinding(e){return this._pageBindings.get(e)||this._browserContext._pageBindings.get(e)}setScreencastOptions(e){this._delegate.setScreencastOptions(e).catch(t=>Uo.debugLogger.log("error",t)),this._frameThrottler.setThrottlingEnabled(!!e)}throttleScreencastFrameAck(e){this._frameThrottler.ack(e)}temporarilyDisableTracingScreencastThrottling(){this._frameThrottler.recharge()}async hideHighlight(){await Promise.all(this.frames().map(e=>e.hideHighlight().catch(()=>{})))}markAsServerSideOnly(){this._isServerSideOnly=!0}};vr.Page=Xc;Xc.Events={Close:"close",Crash:"crash",Download:"download",FileChooser:"filechooser",FrameAttached:"frameattached",FrameDetached:"framedetached",InternalFrameNavigatedToNewDocument:"internalframenavigatedtonewdocument",LocatorHandlerTriggered:"locatorhandlertriggered",ScreencastFrame:"screencastframe",Video:"video",WebSocket:"websocket",Worker:"worker"};var Yc=class r extends hE.SdkObject{constructor(e,t){super(e,"worker"),this._url=void 0,this._executionContextPromise=void 0,this._executionContextCallback=void 0,this._existingExecutionContext=null,this.openScope=new zo.LongStandingScope,this._url=t,this._executionContextCallback=()=>{},this._executionContextPromise=new Promise(n=>this._executionContextCallback=n)}_createExecutionContext(e){this._existingExecutionContext=new Jc.ExecutionContext(this,e,"worker"),this._executionContextCallback(this._existingExecutionContext)}url(){return this._url}didClose(){this._existingExecutionContext&&this._existingExecutionContext.contextDestroyed("Worker was closed"),this.emit(r.Events.Close,this),this.openScope.close(new Error("Worker closed"))}async evaluateExpression(e,t,n){return Jc.evaluateExpression(await this._executionContextPromise,e,{returnByValue:!0,isFunction:t},n)}async evaluateExpressionHandle(e,t,n){return Jc.evaluateExpression(await this._executionContextPromise,e,{returnByValue:!1,isFunction:t},n)}};vr.Worker=Yc;Yc.Events={Close:"close"};var Vo=class{constructor(e,t,n){this.name=void 0,this.playwrightFunction=void 0,this.source=void 0,this.needsHandle=void 0,this.name=e,this.playwrightFunction=t,this.source=`(${rD.toString()})(${JSON.stringify(e)}, ${n}, (${uE.source})())`,this.needsHandle=n}static async dispatch(e,t,n){let{name:s,seq:o,serializedArgs:a}=JSON.parse(t);try{(0,zo.assert)(n.world);let h=e.getBinding(s),p;if(h.needsHandle){let f=await n.evaluateHandle(l,{name:s,seq:o}).catch(_=>null);p=await h.playwrightFunction({frame:n.frame,page:e,context:e._browserContext},f)}else{let f=a.map(_=>(0,uE.parseEvaluationResultValue)(_));p=await h.playwrightFunction({frame:n.frame,page:e,context:e._browserContext},...f)}n.evaluate(c,{name:s,seq:o,result:p}).catch(f=>Uo.debugLogger.log("error",f))}catch(h){(0,zo.isError)(h)?n.evaluate(u,{name:s,seq:o,message:h.message,stack:h.stack}).catch(p=>Uo.debugLogger.log("error",p)):n.evaluate(d,{name:s,seq:o,error:h}).catch(p=>Uo.debugLogger.log("error",p))}function l(h){let p=globalThis[h.name].handles.get(h.seq);return globalThis[h.name].handles.delete(h.seq),p}function c(h){globalThis[h.name].callbacks.get(h.seq).resolve(h.result),globalThis[h.name].callbacks.delete(h.seq)}function u(h){let p=new Error(h.message);p.stack=h.stack,globalThis[h.name].callbacks.get(h.seq).reject(p),globalThis[h.name].callbacks.delete(h.seq)}function d(h){globalThis[h.name].callbacks.get(h.seq).reject(h.error),globalThis[h.name].callbacks.delete(h.seq)}}};vr.PageBinding=Vo;function rD(r,e,t){let n=globalThis[r];n.__installed||(globalThis[r]=(...s)=>{let o=globalThis[r];if(e&&s.slice(1).some(h=>h!==void 0))throw new Error(`exposeBindingHandle supports a single argument, ${s.length} received`);let a=o.callbacks;a||(a=new Map,o.callbacks=a);let l=(o.lastSeq||0)+1;o.lastSeq=l;let c=o.handles;c||(c=new Map,o.handles=c);let u=new Promise((h,p)=>a.set(l,{resolve:h,reject:p})),d;if(e)c.set(l,s[0]),d={name:r,seq:l};else{let h=[];for(let p=0;p<s.length;p++)h[p]=t.serializeAsCallArgument(s[p],f=>({fallThrough:f}));d={name:r,seq:l,serializedArgs:h}}return n(JSON.stringify(d)),u},globalThis[r].__installed=!0)}var Km=class{constructor(e,t,n){this._acks=[],this._defaultInterval=void 0,this._throttlingInterval=void 0,this._nonThrottledFrames=void 0,this._budget=void 0,this._throttlingEnabled=!1,this._timeoutId=void 0,this._nonThrottledFrames=e,this._budget=e,this._defaultInterval=t,this._throttlingInterval=n,this._tick()}dispose(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0)}setThrottlingEnabled(e){this._throttlingEnabled=e}recharge(){for(let e of this._acks)e();this._acks=[],this._budget=this._nonThrottledFrames,this._timeoutId&&(clearTimeout(this._timeoutId),this._tick())}ack(e){if(!this._timeoutId){e();return}this._acks.push(e)}_tick(){let e=this._acks.shift();e&&(--this._budget,e()),this._throttlingEnabled&&this._budget<=0?this._timeoutId=setTimeout(()=>this._tick(),this._throttlingInterval):this._timeoutId=setTimeout(()=>this._tick(),this._defaultInterval)}}});var Jm=M(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.slowMoActions=br.pausesBeforeInputActions=br.commandsWithTracingSnapshots=void 0;var w9=br.slowMoActions=new Set(["Page.goBack","Page.goForward","Page.reload","Page.keyboardDown","Page.keyboardUp","Page.keyboardInsertText","Page.keyboardType","Page.keyboardPress","Page.mouseMove","Page.mouseDown","Page.mouseUp","Page.mouseClick","Page.mouseWheel","Page.touchscreenTap","Frame.blur","Frame.check","Frame.click","Frame.dragAndDrop","Frame.dblclick","Frame.dispatchEvent","Frame.fill","Frame.focus","Frame.goto","Frame.hover","Frame.press","Frame.selectOption","Frame.setInputFiles","Frame.tap","Frame.type","Frame.uncheck","ElementHandle.check","ElementHandle.click","ElementHandle.dblclick","ElementHandle.dispatchEvent","ElementHandle.fill","ElementHandle.focus","ElementHandle.hover","ElementHandle.press","ElementHandle.scrollIntoViewIfNeeded","ElementHandle.selectOption","ElementHandle.selectText","ElementHandle.setInputFiles","ElementHandle.tap","ElementHandle.type","ElementHandle.uncheck"]),v9=br.commandsWithTracingSnapshots=new Set(["EventTarget.waitForEventInfo","BrowserContext.waitForEventInfo","Page.waitForEventInfo","WebSocket.waitForEventInfo","ElectronApplication.waitForEventInfo","AndroidDevice.waitForEventInfo","Page.emulateMedia","Page.goBack","Page.goForward","Page.reload","Page.expectScreenshot","Page.screenshot","Page.setViewportSize","Page.keyboardDown","Page.keyboardUp","Page.keyboardInsertText","Page.keyboardType","Page.keyboardPress","Page.mouseMove","Page.mouseDown","Page.mouseUp","Page.mouseClick","Page.mouseWheel","Page.touchscreenTap","Frame.evalOnSelector","Frame.evalOnSelectorAll","Frame.addScriptTag","Frame.addStyleTag","Frame.blur","Frame.check","Frame.click","Frame.dragAndDrop","Frame.dblclick","Frame.dispatchEvent","Frame.evaluateExpression","Frame.evaluateExpressionHandle","Frame.fill","Frame.focus","Frame.getAttribute","Frame.goto","Frame.hover","Frame.innerHTML","Frame.innerText","Frame.inputValue","Frame.isChecked","Frame.isDisabled","Frame.isEnabled","Frame.isHidden","Frame.isVisible","Frame.isEditable","Frame.press","Frame.selectOption","Frame.setContent","Frame.setInputFiles","Frame.tap","Frame.textContent","Frame.type","Frame.uncheck","Frame.waitForTimeout","Frame.waitForFunction","Frame.waitForSelector","Frame.expect","JSHandle.evaluateExpression","ElementHandle.evaluateExpression","JSHandle.evaluateExpressionHandle","ElementHandle.evaluateExpressionHandle","ElementHandle.evalOnSelector","ElementHandle.evalOnSelectorAll","ElementHandle.check","ElementHandle.click","ElementHandle.dblclick","ElementHandle.dispatchEvent","ElementHandle.fill","ElementHandle.focus","ElementHandle.hover","ElementHandle.innerHTML","ElementHandle.innerText","ElementHandle.inputValue","ElementHandle.isChecked","ElementHandle.isDisabled","ElementHandle.isEditable","ElementHandle.isEnabled","ElementHandle.isHidden","ElementHandle.isVisible","ElementHandle.press","ElementHandle.screenshot","ElementHandle.scrollIntoViewIfNeeded","ElementHandle.selectOption","ElementHandle.selectText","ElementHandle.setInputFiles","ElementHandle.tap","ElementHandle.textContent","ElementHandle.type","ElementHandle.uncheck","ElementHandle.waitForElementState","ElementHandle.waitForSelector"]),b9=br.pausesBeforeInputActions=new Set(["Frame.check","Frame.click","Frame.dragAndDrop","Frame.dblclick","Frame.fill","Frame.hover","Frame.press","Frame.selectOption","Frame.setInputFiles","Frame.tap","Frame.type","Frame.uncheck","ElementHandle.check","ElementHandle.click","ElementHandle.dblclick","ElementHandle.fill","ElementHandle.hover","ElementHandle.press","ElementHandle.selectOption","ElementHandle.setInputFiles","ElementHandle.tap","ElementHandle.type","ElementHandle.uncheck"])});var Ym=M(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.Debugger=void 0;Go.shouldSlowMo=fE;var iD=require("events"),Zc=ie(),sD=$e(),Xm=Jm(),oD=Symbol("Debugger"),eu=class r extends iD.EventEmitter{constructor(e){super(),this._pauseOnNextStatement=!1,this._pausedCallsMetadata=new Map,this._enabled=void 0,this._context=void 0,this._muted=!1,this._slowMo=void 0,this._context=e,this._context[oD]=this,this._enabled=(0,Zc.debugMode)()==="inspector",this._enabled&&this.pauseOnNextStatement(),e.instrumentation.addListener(this,e),this._context.once(sD.BrowserContext.Events.Close,()=>{this._context.instrumentation.removeListener(this)}),this._slowMo=this._context._browser.options.slowMo}async setMuted(e){this._muted=e}async onBeforeCall(e,t){this._muted||(aD(e,t)||this._pauseOnNextStatement&&lD(t))&&await this.pause(e,t)}async _doSlowMo(){await new Promise(e=>setTimeout(e,this._slowMo))}async onAfterCall(e,t){this._slowMo&&fE(t)&&await this._doSlowMo()}async onBeforeInputAction(e,t){this._muted||this._enabled&&this._pauseOnNextStatement&&await this.pause(e,t)}async pause(e,t){if(this._muted)return;this._enabled=!0,t.pauseStartTime=(0,Zc.monotonicTime)();let n=new Promise(s=>{this._pausedCallsMetadata.set(t,{resolve:s,sdkObject:e})});return this.emit(r.Events.PausedStateChanged),n}resume(e){if(!this.isPaused())return;this._pauseOnNextStatement=e;let t=(0,Zc.monotonicTime)();for(let[n,{resolve:s}]of this._pausedCallsMetadata)n.pauseEndTime=t,s();this._pausedCallsMetadata.clear(),this.emit(r.Events.PausedStateChanged)}pauseOnNextStatement(){this._pauseOnNextStatement=!0}isPaused(e){return e?this._pausedCallsMetadata.has(e):!!this._pausedCallsMetadata.size}pausedDetails(){let e=[];for(let[t,{sdkObject:n}]of this._pausedCallsMetadata)e.push({metadata:t,sdkObject:n});return e}};Go.Debugger=eu;eu.Events={PausedStateChanged:"pausedstatechanged"};function aD(r,e){var t;return r.attribution.playwright.options.isServer||!((t=r.attribution.browser)!==null&&t!==void 0&&t.options.headful)&&!(0,Zc.isUnderTest)()?!1:e.method==="pause"}function lD(r){if(!r.apiName)return!1;if(r.method==="close")return!0;if(r.method==="waitForSelector"||r.method==="waitForEventInfo")return!1;let e=r.type+"."+r.method;return Xm.commandsWithTracingSnapshots.has(e)&&!Xm.pausesBeforeInputActions.has(r.type+"."+r.method)}function fE(r){return Xm.slowMoActions.has(r.type+"."+r.method)}});var is=M(tu=>{"use strict";Object.defineProperty(tu,"__esModule",{value:!0});tu.Artifact=void 0;var mE=pD(require("fs")),cD=ie(),uD=Qe(),dD=De(),hD=Bt();function pD(r){return r&&r.__esModule?r:{default:r}}var Qm=class extends dD.SdkObject{constructor(e,t,n,s){super(e,"artifact"),this._localPath=void 0,this._unaccessibleErrorMessage=void 0,this._cancelCallback=void 0,this._finishedPromise=new uD.ManualPromise,this._saveCallbacks=[],this._finished=!1,this._deleted=!1,this._failureError=void 0,this._localPath=t,this._unaccessibleErrorMessage=n,this._cancelCallback=s}finishedPromise(){return this._finishedPromise}localPath(){return this._localPath}async localPathAfterFinished(){if(this._unaccessibleErrorMessage)throw new Error(this._unaccessibleErrorMessage);if(await this._finishedPromise,this._failureError)throw this._failureError;return this._localPath}saveAs(e){if(this._unaccessibleErrorMessage)throw new Error(this._unaccessibleErrorMessage);if(this._deleted)throw new Error("File already deleted. Save before deleting.");if(this._failureError)throw this._failureError;if(this._finished){e(this._localPath).catch(()=>{});return}this._saveCallbacks.push(e)}async failureError(){var e;return this._unaccessibleErrorMessage?this._unaccessibleErrorMessage:(await this._finishedPromise,((e=this._failureError)===null||e===void 0?void 0:e.message)||null)}async cancel(){return(0,cD.assert)(this._cancelCallback!==void 0),this._cancelCallback()}async delete(){if(this._unaccessibleErrorMessage)return;let e=await this.localPathAfterFinished();this._deleted||(this._deleted=!0,e&&await mE.default.promises.unlink(e).catch(t=>{}))}async deleteOnContextClose(){this._deleted||(this._deleted=!0,this._unaccessibleErrorMessage||await mE.default.promises.unlink(this._localPath).catch(e=>{}),await this.reportFinished(new hD.TargetClosedError))}async reportFinished(e){if(!this._finished){if(this._finished=!0,this._failureError=e,e)for(let t of this._saveCallbacks)await t("",e);else for(let t of this._saveCallbacks)await t(this._localPath);this._saveCallbacks=[],this._finishedPromise.resolve()}}};tu.Artifact=Qm});var ng=M(ru=>{"use strict";Object.defineProperty(ru,"__esModule",{value:!0});ru.HarTracer=void 0;var kn=$e(),nu=No(),Ko=yt(),fD=bD(Ct()),Jo=ie(),hn=Ze(),gE=Be(),mD=Qe(),gD=Nn(),_D=xn(),wD=si(),vD=Bp();function bE(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(bE=function(n){return n?t:e})(r)}function bD(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=bE(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var _E="HTTP/1.1",eg=class{constructor(e,t,n,s){this._context=void 0,this._barrierPromises=new Set,this._delegate=void 0,this._options=void 0,this._pageEntries=new Map,this._eventListeners=[],this._started=!1,this._entrySymbol=void 0,this._baseURL=void 0,this._page=void 0,this._context=e,this._page=t,this._delegate=n,this._options=s,s.slimMode&&(s.omitSecurityDetails=!0,s.omitCookies=!0,s.omitTiming=!0,s.omitServerIP=!0,s.omitSizes=!0,s.omitPages=!0),this._entrySymbol=Symbol("requestHarEntry"),this._baseURL=e instanceof nu.APIRequestContext?e._defaultOptions().baseURL:e._options.baseURL}start(e){if(this._started)return;this._options.omitScripts=e.omitScripts,this._started=!0;let t=this._context instanceof nu.APIRequestContext?this._context:this._context.fetchRequest;this._eventListeners=[hn.eventsHelper.addEventListener(t,nu.APIRequestContext.Events.Request,n=>this._onAPIRequest(n)),hn.eventsHelper.addEventListener(t,nu.APIRequestContext.Events.RequestFinished,n=>this._onAPIRequestFinished(n))],this._context instanceof kn.BrowserContext&&this._eventListeners.push(hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.Page,n=>this._createPageEntryIfNeeded(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.Request,n=>this._onRequest(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.RequestFinished,({request:n,response:s})=>this._onRequestFinished(n,s).catch(()=>{})),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.RequestFailed,n=>this._onRequestFailed(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.Response,n=>this._onResponse(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.RequestAborted,n=>this._onRequestAborted(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.RequestFulfilled,n=>this._onRequestFulfilled(n)),hn.eventsHelper.addEventListener(this._context,kn.BrowserContext.Events.RequestContinued,n=>this._onRequestContinued(n)))}_shouldIncludeEntryWithUrl(e){return!this._options.urlFilter||(0,_D.urlMatches)(this._baseURL,e,this._options.urlFilter)}_entryForRequest(e){return e[this._entrySymbol]}_createPageEntryIfNeeded(e){if(!e||this._options.omitPages||this._page&&e!==this._page)return;let t=this._pageEntries.get(e);if(!t){let n=new Date;t={startedDateTime:n.toISOString(),id:e.guid,title:"",pageTimings:this._options.omitTiming?{}:{onContentLoad:-1,onLoad:-1}},t[Zm]=n,e.mainFrame().on(wD.Frame.Events.AddLifecycle,s=>{s==="load"&&this._onLoad(e,t),s==="domcontentloaded"&&this._onDOMContentLoaded(e,t)}),this._pageEntries.set(e,t)}return t}_onDOMContentLoaded(e,t){let n=e.mainFrame().evaluateExpression(String(()=>({title:document.title,domContentLoaded:performance.timing.domContentLoadedEventStart})),{isFunction:!0,world:"utility"}).then(s=>{t.title=s.title,this._options.omitTiming||(t.pageTimings.onContentLoad=s.domContentLoaded)}).catch(()=>{});this._addBarrier(e,n)}_onLoad(e,t){let n=e.mainFrame().evaluateExpression(String(()=>({title:document.title,loaded:performance.timing.loadEventStart})),{isFunction:!0,world:"utility"}).then(s=>{t.title=s.title,this._options.omitTiming||(t.pageTimings.onLoad=s.loaded)}).catch(()=>{});this._addBarrier(e,n)}_addBarrier(e,t){if(!e)return null;if(!this._options.waitForContentOnStop)return;let n=e.openScope.safeRace(t);this._barrierPromises.add(n),n.then(()=>this._barrierPromises.delete(n))}_onAPIRequest(e){var t;if(!this._shouldIncludeEntryWithUrl(e.url.toString()))return;let n=wE(e.method,e.url,void 0,this._options);n._apiRequest=!0,this._options.omitCookies||(n.request.cookies=e.cookies),n.request.headers=Object.entries(e.headers).map(([s,o])=>({name:s,value:o})),n.request.postData=this._postDataForBuffer(e.postData||null,e.headers["content-type"],this._options.content),this._options.omitSizes||(n.request.bodySize=((t=e.postData)===null||t===void 0?void 0:t.length)||0),e[this._entrySymbol]=n,this._started&&this._delegate.onEntryStarted(n)}_onAPIRequestFinished(e){let t=this._entryForRequest(e.requestEvent);if(!t)return;t.response.status=e.statusCode,t.response.statusText=e.statusMessage,t.response.httpVersion=e.httpVersion,t.response.redirectURL=e.headers.location||"";for(let o=0;o<e.rawHeaders.length;o+=2)t.response.headers.push({name:e.rawHeaders[o],value:e.rawHeaders[o+1]});t.response.cookies=this._options.omitCookies?[]:e.cookies.map(o=>({...o,expires:o.expires===-1?void 0:tg(o.expires)}));let n=t.response.content,s=e.headers["content-type"];s&&(n.mimeType=s),this._storeResponseContent(e.body,n,"other"),this._started&&this._delegate.onEntryFinished(t)}_onRequest(e){var t,n;if(!this._shouldIncludeEntryWithUrl(e.url()))return;let s=(t=e.frame())===null||t===void 0?void 0:t._page;if(this._page&&s!==this._page)return;let o=fD.parsedURL(e.url());if(!o)return;let a=this._createPageEntryIfNeeded(s),l=wE(e.method(),o,(n=e.frame())===null||n===void 0?void 0:n.guid,this._options);if(a&&(l.pageref=a.id),this._recordRequestHeadersAndCookies(l,e.headers()),l.request.postData=this._postDataForRequest(e,this._options.content),this._options.omitSizes||(l.request.bodySize=e.bodySize()),e.redirectedFrom()){let c=this._entryForRequest(e.redirectedFrom());c&&(c.response.redirectURL=e.url())}e[this._entrySymbol]=l,(0,Jo.assert)(this._started),this._delegate.onEntryStarted(l)}_recordRequestHeadersAndCookies(e,t){if(!this._options.omitCookies){e.request.cookies=[];for(let n of t.filter(s=>s.name.toLowerCase()==="cookie"))e.request.cookies.push(...n.value.split(";").map(vE))}e.request.headers=t}_recordRequestOverrides(e,t){!t._hasOverrides()||!this._options.recordRequestOverrides||(e.request.method=t.method(),e.request.url=t.url(),e.request.postData=this._postDataForRequest(t,this._options.content),this._recordRequestHeadersAndCookies(e,t.headers()))}async _onRequestFinished(e,t){var n;if(!t)return;let s=this._entryForRequest(e);if(!s)return;let o=(n=e.frame())===null||n===void 0?void 0:n._page;this._options.omitServerIP||this._addBarrier(o||e.serviceWorker(),t.serverAddr().then(d=>{d!=null&&d.ipAddress&&(s.serverIPAddress=d.ipAddress),d!=null&&d.port&&(s._serverPort=d.port)})),this._options.omitSecurityDetails||this._addBarrier(o||e.serviceWorker(),t.securityDetails().then(d=>{d&&(s._securityDetails=d)}));let a=t.httpVersion();s.request.httpVersion=a,s.response.httpVersion=a;let l=this._options.omitSizes?void 0:{_encodedBodySize:-1,_decodedBodySize:-1,barrier:new mD.ManualPromise,_check:function(){this._encodedBodySize!==-1&&this._decodedBodySize!==-1&&(s.response.content.compression=Math.max(0,this._decodedBodySize-this._encodedBodySize),this.barrier.resolve())},setEncodedBodySize:function(d){this._encodedBodySize=d,this._check()},setDecodedBodySize:function(d){this._decodedBodySize=d,this._check()}};l&&this._addBarrier(o||e.serviceWorker(),l.barrier);let c=t.body().then(d=>{if(this._options.omitScripts&&e.resourceType()==="script"){l?.setDecodedBodySize(0);return}let h=s.response.content;l?.setDecodedBodySize(d.length),this._storeResponseContent(d,h,e.resourceType())}).catch(()=>{l?.setDecodedBodySize(0)}).then(()=>{this._started&&this._delegate.onEntryFinished(s)});this._addBarrier(o||e.serviceWorker(),c);let u=t.timing();s.timings.receive=t.request()._responseEndTiming!==-1?Ko.helper.millisToRoundishMillis(t.request()._responseEndTiming-u.responseStart):-1,this._computeHarEntryTotalTime(s),this._options.omitSizes||this._addBarrier(o||e.serviceWorker(),t.sizes().then(d=>{s.response.bodySize=d.responseBodySize,s.response.headersSize=d.responseHeadersSize,s.response._transferSize=d.transferSize,s.request.headersSize=d.requestHeadersSize,l?.setEncodedBodySize(d.responseBodySize)}))}async _onRequestFailed(e){let t=this._entryForRequest(e);t&&(e._failureText!==null&&(t.response._failureText=e._failureText),this._recordRequestOverrides(t,e),this._started&&this._delegate.onEntryFinished(t))}_onRequestAborted(e){let t=this._entryForRequest(e);t&&(t._wasAborted=!0)}_onRequestFulfilled(e){let t=this._entryForRequest(e);t&&(t._wasFulfilled=!0)}_onRequestContinued(e){let t=this._entryForRequest(e);t&&(t._wasContinued=!0)}_storeResponseContent(e,t,n){if(!e){t.size=0;return}if(this._options.omitSizes||(t.size=e.length),this._options.content==="embed")(0,vD.isTextualMimeType)(t.mimeType)&&n!=="font"?t.text=e.toString():(t.text=e.toString("base64"),t.encoding="base64");else if(this._options.content==="attach"){let s=(0,Jo.calculateSha1)(e)+"."+(gE.mime.getExtension(t.mimeType)||"dat");this._options.includeTraceInfo?t._sha1=s:t._file=s,this._started&&this._delegate.onContentBlob(s,e)}}_onResponse(e){var t;let n=this._entryForRequest(e.request());if(!n)return;let s=(t=e.frame())===null||t===void 0?void 0:t._page,o=this._createPageEntryIfNeeded(s),a=e.request();if(this._options.includeTraceInfo&&(n._monotonicTime=(0,Jo.monotonicTime)()),n.response={status:e.status(),statusText:e.statusText(),httpVersion:e.httpVersion(),cookies:[],headers:[],content:{size:-1,mimeType:"x-unknown"},headersSize:-1,bodySize:-1,redirectURL:"",_transferSize:this._options.omitSizes?void 0:-1},!this._options.omitTiming){let l=o?o[Zm].valueOf():0,c=e.timing();o&&l>c.startTime&&(o.startedDateTime=new Date(c.startTime).toISOString());let u=c.domainLookupEnd!==-1?Ko.helper.millisToRoundishMillis(c.domainLookupEnd-c.domainLookupStart):-1,d=c.connectEnd!==-1?Ko.helper.millisToRoundishMillis(c.connectEnd-c.connectStart):-1,h=c.connectEnd!==-1?Ko.helper.millisToRoundishMillis(c.connectEnd-c.secureConnectionStart):-1,p=c.responseStart!==-1?Ko.helper.millisToRoundishMillis(c.responseStart-c.requestStart):-1,f=-1;n.timings={dns:u,connect:d,ssl:h,send:0,wait:p,receive:f},this._computeHarEntryTotalTime(n)}this._recordRequestOverrides(n,a),this._addBarrier(s||a.serviceWorker(),a.rawRequestHeaders().then(l=>{this._recordRequestHeadersAndCookies(n,l)})),this._recordResponseHeaders(n,e.headers()),this._addBarrier(s||a.serviceWorker(),e.rawResponseHeaders().then(l=>{this._recordResponseHeaders(n,l)}))}_recordResponseHeaders(e,t){this._options.omitCookies||(e.response.cookies=t.filter(s=>s.name.toLowerCase()==="set-cookie").map(s=>vE(s.value))),e.response.headers=t;let n=t.find(s=>s.name.toLowerCase()==="content-type");n&&(e.response.content.mimeType=n.value)}_computeHarEntryTotalTime(e){e.time=[e.timings.dns,e.timings.connect,e.timings.ssl,e.timings.wait,e.timings.receive].reduce((t,n)=>(n||-1)>0?n+t:t,0)}async flush(){await Promise.all(this._barrierPromises)}stop(){this._started=!1,hn.eventsHelper.removeEventListeners(this._eventListeners),this._barrierPromises.clear();let e=this._context instanceof kn.BrowserContext?this._context:void 0,t={version:"1.2",creator:{name:"Playwright",version:(0,gD.getPlaywrightVersion)()},browser:{name:e?._browser.options.name||"",version:e?._browser.version()||""},pages:this._pageEntries.size?Array.from(this._pageEntries.values()):void 0,entries:[]};if(!this._options.omitTiming)for(let n of t.pages||[]){let s=n[Zm].valueOf();typeof n.pageTimings.onContentLoad=="number"&&n.pageTimings.onContentLoad>=0?n.pageTimings.onContentLoad-=s:n.pageTimings.onContentLoad=-1,typeof n.pageTimings.onLoad=="number"&&n.pageTimings.onLoad>=0?n.pageTimings.onLoad-=s:n.pageTimings.onLoad=-1}return this._pageEntries.clear(),t}_postDataForRequest(e,t){let n=e.postDataBuffer();if(!n)return;let s=e.headerValue("content-type");return this._postDataForBuffer(n,s,t)}_postDataForBuffer(e,t,n){var s;if(!e)return;(s=t)!==null&&s!==void 0||(t="application/octet-stream");let o={mimeType:t,text:"",params:[]};if(n==="embed"&&t!=="application/octet-stream"&&(o.text=e.toString()),n==="attach"){let a=(0,Jo.calculateSha1)(e)+"."+(gE.mime.getExtension(t)||"dat");this._options.includeTraceInfo?o._sha1=a:o._file=a,this._delegate.onContentBlob(a,e)}if(t==="application/x-www-form-urlencoded"){let a=new URLSearchParams(e.toString());for(let[l,c]of a.entries())o.params.push({name:l,value:c})}return o}};ru.HarTracer=eg;function wE(r,e,t,n){return{_frameref:n.includeTraceInfo?t:void 0,_monotonicTime:n.includeTraceInfo?(0,Jo.monotonicTime)():void 0,startedDateTime:new Date().toISOString(),time:-1,request:{method:r,url:e.toString(),httpVersion:_E,cookies:[],headers:[],queryString:[...e.searchParams].map(o=>({name:o[0],value:o[1]})),headersSize:-1,bodySize:-1},response:{status:-1,statusText:"",httpVersion:_E,cookies:[],headers:[],content:{size:-1,mimeType:"x-unknown"},headersSize:-1,bodySize:-1,redirectURL:"",_transferSize:n.omitSizes?void 0:-1},cache:{},timings:{send:-1,wait:-1,receive:-1}}}function vE(r){let e={name:"",value:""},t=!0;for(let n of r.split(/; */)){let s=n.indexOf("="),o=s!==-1?n.substr(0,s).trim():n.trim(),a=s!==-1?n.substr(s+1,n.length).trim():"";if(t){t=!1,e.name=o,e.value=a;continue}o==="Domain"&&(e.domain=a),o==="Expires"&&(e.expires=tg(a)),o==="HttpOnly"&&(e.httpOnly=!0),o==="Max-Age"&&(e.expires=tg(Date.now()+ +a*1e3)),o==="Path"&&(e.path=a),o==="SameSite"&&(e.sameSite=a),o==="Secure"&&(e.secure=!0)}return e}function tg(r){try{return new Date(r).toISOString()}catch{}}var Zm=Symbol("startedDate")});var yE=M(rg=>{"use strict";Object.defineProperty(rg,"__esModule",{value:!0});rg.frameSnapshotStreamer=yD;function yD(r,e){if(window[r])return;let t="__playwright_shadow_root_",n="__playwright_value_",s="__playwright_checked_",o="__playwright_selected_",a="__playwright_scroll_top_",l="__playwright_scroll_left_",c="__playwright_style_sheet_",u="__playwright_target__",d="__playwright_custom_elements__",h="__playwright_current_src__",p=Symbol("__playwright_snapshot_frameid_"),f=Symbol("__playwright_snapshot_cache_"),_=Symbol("__playwright_end_of_list_");function v(x){delete x[f]}function w(x){return x[f]||(x[f]={}),x[f]}function m(x){try{let b=new URL(x);return b.hash="",b.toString()}catch{return x}}class g{constructor(){this._lastSnapshotNumber=0,this._staleStyleSheets=new Set,this._readingStyleSheet=!1,this._fakeBase=void 0,this._observer=void 0;let b=S=>{S.parentStyleSheet&&this._invalidateStyleSheet(S.parentStyleSheet)};this._interceptNativeMethod(window.CSSStyleSheet.prototype,"insertRule",S=>this._invalidateStyleSheet(S)),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"deleteRule",S=>this._invalidateStyleSheet(S)),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"addRule",S=>this._invalidateStyleSheet(S)),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"removeRule",S=>this._invalidateStyleSheet(S)),this._interceptNativeGetter(window.CSSStyleSheet.prototype,"rules",S=>this._invalidateStyleSheet(S)),this._interceptNativeGetter(window.CSSStyleSheet.prototype,"cssRules",S=>this._invalidateStyleSheet(S)),this._interceptNativeMethod(window.CSSStyleSheet.prototype,"replaceSync",S=>this._invalidateStyleSheet(S)),this._interceptNativeMethod(window.CSSGroupingRule.prototype,"insertRule",b),this._interceptNativeMethod(window.CSSGroupingRule.prototype,"deleteRule",b),this._interceptNativeGetter(window.CSSGroupingRule.prototype,"cssRules",b),this._interceptNativeAsyncMethod(window.CSSStyleSheet.prototype,"replace",S=>this._invalidateStyleSheet(S)),this._fakeBase=document.createElement("base"),this._observer=new MutationObserver(S=>this._handleMutations(S));let y={attributes:!0,subtree:!0};this._observer.observe(document,y),this._refreshListenersWhenNeeded()}_refreshListenersWhenNeeded(){this._refreshListeners();let b="__playwright_snapshotter_global_listeners_check__",y=!1,S=()=>y=!0;window.addEventListener(b,S),new MutationObserver(C=>{C.some(F=>Array.from(F.addedNodes).includes(document.documentElement))&&(y=!1,window.dispatchEvent(new CustomEvent(b)),y||(window.addEventListener(b,S),this._refreshListeners()))}).observe(document,{childList:!0})}_refreshListeners(){document.addEventListener("__playwright_target__",b=>{if(!b.detail)return;let y=b.detail;b.composedPath()[0].__playwright_target__=y})}_interceptNativeMethod(b,y,S){let E=b[y];E&&(b[y]=function(...C){let k=E.call(this,...C);return S(this,k),k})}_interceptNativeAsyncMethod(b,y,S){let E=b[y];E&&(b[y]=async function(...C){let k=await E.call(this,...C);return S(this,k),k})}_interceptNativeGetter(b,y,S){let E=Object.getOwnPropertyDescriptor(b,y);Object.defineProperty(b,y,{...E,get:function(){let C=E.get.call(this);return S(this,C),C}})}_handleMutations(b){for(let y of b)w(y.target).attributesCached=void 0}_invalidateStyleSheet(b){this._readingStyleSheet||this._staleStyleSheets.add(b)}_updateStyleElementStyleSheetTextIfNeeded(b,y){let S=w(b);if(this._staleStyleSheets.has(b)||y&&S.cssText===void 0){this._staleStyleSheets.delete(b);try{S.cssText=this._getSheetText(b)}catch{S.cssText=""}}return S.cssText}_updateLinkStyleSheetTextIfNeeded(b,y){let S=w(b);if(this._staleStyleSheets.has(b)){this._staleStyleSheets.delete(b);try{return S.cssText=this._getSheetText(b),S.cssRef=y,S.cssText}catch{}}return S.cssRef===void 0?void 0:y-S.cssRef}markIframe(b,y){b[p]=y}reset(){this._staleStyleSheets.clear();let b=y=>{if(v(y),y.nodeType===Node.ELEMENT_NODE){let S=y;S.shadowRoot&&b(S.shadowRoot)}for(let S=y.firstChild;S;S=S.nextSibling)b(S)};b(document.documentElement),b(this._fakeBase)}__sanitizeMetaAttribute(b,y,S){if(b==="charset")return"utf-8";if(S.toLowerCase()!=="content-type"||b!=="content")return y;let[E,...C]=y.split(";");if(E!=="text/html"||C.length<=0)return y;let k=C.findIndex(F=>F.trim().startsWith("charset="));return k>-1&&(C[k]="charset=utf-8"),`${E}; ${C.join("; ")}`}_sanitizeUrl(b){return b.startsWith("javascript:")||b.startsWith("vbscript:")?"":b}_sanitizeSrcSet(b){return b.split(",").map(y=>{y=y.trim();let S=y.lastIndexOf(" ");return S===-1?this._sanitizeUrl(y):this._sanitizeUrl(y.substring(0,S).trim())+y.substring(S)}).join(", ")}_resolveUrl(b,y){if(y==="")return"";try{return new URL(y,b).href}catch{return y}}_getSheetBase(b){let y=b;for(;y.parentStyleSheet;)y=y.parentStyleSheet;return y.ownerNode?y.ownerNode.baseURI:document.baseURI}_getSheetText(b){this._readingStyleSheet=!0;try{let y=[];for(let S of b.cssRules)y.push(S.cssText);return y.join(`
`)}finally{this._readingStyleSheet=!1}}captureSnapshot(){let b=performance.now(),y=++this._lastSnapshotNumber,S=0,E=0,C=0;this._handleMutations(this._observer.takeRecords());let k=new Set,F=T=>{let A=T.nodeType,R=A===Node.DOCUMENT_FRAGMENT_NODE?"template":T.nodeName;if(A!==Node.ELEMENT_NODE&&A!==Node.DOCUMENT_FRAGMENT_NODE&&A!==Node.TEXT_NODE||R==="SCRIPT")return;if(R==="LINK"&&A===Node.ELEMENT_NODE){var V;let H=(V=T.getAttribute("rel"))===null||V===void 0?void 0:V.toLowerCase();if(H==="preload"||H==="prefetch")return}if(e&&R==="NOSCRIPT"||R==="META"&&T.httpEquiv.toLowerCase()==="content-security-policy"||(R==="IFRAME"||R==="FRAME")&&C)return;let J=w(T),q=[],U=!!J.cached,Y=0,Q=H=>{U=U&&J.cached[q.length]===H,q.push(H)},te=H=>(J.attributesCached=!0,U?{equals:!0,n:[[y-J.ref[0],J.ref[1]]]}:(S+=Y,J.ref=[y,S++],J.cached=q,{equals:!1,n:H}));if(A===Node.TEXT_NODE){let H=T.nodeValue||"";return Q(H),te(H)}if(R==="STYLE"){let H=T.sheet,z;return H&&(z=this._updateStyleElementStyleSheetTextIfNeeded(H)),z=z||T.textContent||"",Q(z),Y++,te([R,{},z])}let oe={},N=[R,oe],B=H=>{let z=F(H);z&&(N.push(z.n),Q(H),U=U&&z.equals)},W=H=>{let z=O(H);z&&(N.push(z.n),Q(H),U=U&&z.equals)};if(A===Node.DOCUMENT_FRAGMENT_NODE&&(oe[t]="open"),A===Node.ELEMENT_NODE){var $;let H=T;if(H.localName.includes("-")&&($=window.customElements)!==null&&$!==void 0&&$.get(H.localName)&&k.add(H.localName),R==="INPUT"||R==="TEXTAREA"){let z=H.value;Q(n),Q(z),oe[n]=z}if(R==="INPUT"&&["checkbox","radio"].includes(H.type)){let z=H.checked?"true":"false";Q(s),Q(z),oe[s]=z}if(R==="OPTION"){let z=H.selected?"true":"false";Q(o),Q(z),oe[o]=z}H.scrollTop&&(Q(a),Q(H.scrollTop),oe[a]=""+H.scrollTop),H.scrollLeft&&(Q(l),Q(H.scrollLeft),oe[l]=""+H.scrollLeft),H.shadowRoot&&(++E,B(H.shadowRoot),--E),"__playwright_target__"in H&&(Q(u),Q(H.__playwright_target__),oe[u]=H.__playwright_target__)}R==="HEAD"&&(++C,this._fakeBase.setAttribute("href",document.baseURI),B(this._fakeBase));for(let H=T.firstChild;H;H=H.nextSibling)B(H);R==="HEAD"&&--C,Q(_);let L=null;if(T.ownerDocument.documentElement===T?L=T.ownerDocument:T.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&(L=T),L){for(let H of L.adoptedStyleSheets||[])W(H);Q(_)}if(R==="IFRAME"||R==="FRAME"){let z=T[p],K="src",ae=z?`/snapshot/${z}`:"";Q(K),Q(ae),oe[K]=ae}if(R==="BODY"&&k.size){let H=[...k].join(",");Q(d),Q(H),oe[d]=H}if(R==="IMG"||R==="PICTURE"){let H=R==="PICTURE"?"":this._sanitizeUrl(T.currentSrc);Q(h),Q(H),oe[h]=H}if(U&&J.attributesCached&&!E)return te(N);if(A===Node.ELEMENT_NODE){let H=T;for(let z=0;z<H.attributes.length;z++){let K=H.attributes[z].name;if(R==="LINK"&&K==="integrity"||R==="IFRAME"&&(K==="src"||K==="srcdoc"||K==="sandbox")||R==="FRAME"&&K==="src")continue;let ae=H.attributes[z].value;R==="META"?ae=this.__sanitizeMetaAttribute(K,ae,T.httpEquiv):K==="src"&&R==="IMG"?ae=this._sanitizeUrl(ae):K==="srcset"&&R==="IMG"?ae=this._sanitizeSrcSet(ae):K==="srcset"&&R==="SOURCE"?ae=this._sanitizeSrcSet(ae):K==="href"&&R==="LINK"?ae=this._sanitizeUrl(ae):K.startsWith("on")&&(ae=""),Q(K),Q(ae),oe[K]=ae}Q(_)}return N.length===2&&!Object.keys(oe).length&&N.pop(),te(N)},O=T=>{let A=w(T),R=A.cssText,V=this._updateStyleElementStyleSheetTextIfNeeded(T,!0);return V===R?{equals:!0,n:[[y-A.ref[0],A.ref[1]]]}:(A.ref=[y,S++],{equals:!1,n:["template",{[c]:V}]})},I;if(document.documentElement){let{n:T}=F(document.documentElement);I=T}else I=["html"];let P={html:I,doctype:document.doctype?document.doctype.name:void 0,resourceOverrides:[],viewport:{width:window.innerWidth,height:window.innerHeight},url:location.href,timestamp:b,collectionTime:0};for(let T of this._staleStyleSheets){if(T.href===null)continue;let A=this._updateLinkStyleSheetTextIfNeeded(T,y);if(A===void 0)continue;let R=this._getSheetBase(T),V=m(this._resolveUrl(R,T.href));P.resourceOverrides.push({url:V,content:A,contentType:"text/css"})}return P.collectionTime=performance.now()-P.timestamp,P}}window[r]=new g}});var SE=M(iu=>{"use strict";Object.defineProperty(iu,"__esModule",{value:!0});iu.Snapshotter=void 0;var xD=$e(),SD=Et(),ig=Ze(),xE=Le(),ED=yE(),sg=ie(),kD=Be(),og=class{constructor(e,t){this._context=void 0,this._delegate=void 0,this._eventListeners=[],this._snapshotStreamer=void 0,this._initialized=!1,this._started=!1,this._context=e,this._delegate=t;let n=(0,sg.createGuid)();this._snapshotStreamer="__playwright_snapshot_streamer_"+n}started(){return this._started}async start(){this._started=!0,this._initialized||(this._initialized=!0,await this._initialize()),await this.reset()}async reset(){this._started&&await this._runInAllFrames(`window["${this._snapshotStreamer}"].reset()`)}async stop(){this._started=!1}resetForReuse(){this._initialized=!1}async _initialize(){for(let n of this._context.pages())this._onPage(n);this._eventListeners=[ig.eventsHelper.addEventListener(this._context,xD.BrowserContext.Events.Page,this._onPage.bind(this))];let{javaScriptEnabled:e}=this._context._options,t=`(${ED.frameSnapshotStreamer})("${this._snapshotStreamer}", ${e||e===void 0})`;await this._context.addInitScript(t),await this._runInAllFrames(t)}async _runInAllFrames(e){let t=[];for(let n of this._context.pages())t.push(...n.frames());await Promise.all(t.map(n=>n.nonStallingRawEvaluateInExistingMainContext(e).catch(s=>xE.debugLogger.log("error",s))))}dispose(){ig.eventsHelper.removeEventListeners(this._eventListeners)}async captureSnapshot(e,t,n,s){let o=`window["${this._snapshotStreamer}"].captureSnapshot(${JSON.stringify(n)})`;s?.callFunctionNoReply((l,c)=>{let u=new CustomEvent("__playwright_target__",{bubbles:!0,cancelable:!0,detail:c,composed:!0});l.dispatchEvent(u)},t);let a=e.frames().map(async l=>{let c=await l.nonStallingRawEvaluateInExistingMainContext(o).catch(d=>xE.debugLogger.log("error",d));if(!c||!this._started)return;let u={callId:t,snapshotName:n,pageId:e.guid,frameId:l.guid,frameUrl:c.url,doctype:c.doctype,html:c.html,viewport:c.viewport,timestamp:(0,sg.monotonicTime)(),collectionTime:c.collectionTime,resourceOverrides:[],isMainFrame:e.mainFrame()===l};for(let{url:d,content:h,contentType:p}of c.resourceOverrides)if(typeof h=="string"){let f=Buffer.from(h),_=(0,sg.calculateSha1)(f)+"."+(kD.mime.getExtension(p)||"dat");this._delegate.onSnapshotterBlob({sha1:_,buffer:f}),u.resourceOverrides.push({url:d,sha1:_})}else u.resourceOverrides.push({url:d,ref:h});this._delegate.onFrameSnapshot(u)});await Promise.all(a)}_onPage(e){for(let t of e.frames())this._annotateFrameHierarchy(t);this._eventListeners.push(ig.eventsHelper.addEventListener(e,SD.Page.Events.FrameAttached,t=>this._annotateFrameHierarchy(t)))}async _annotateFrameHierarchy(e){try{let t=await e.frameElement(),n=e.parentFrame();if(!n)return;let s=await n._mainContext();await s?.evaluate(({snapshotStreamer:o,frameElement:a,frameId:l})=>{window[o].markIframe(a,l)},{snapshotStreamer:this._snapshotStreamer,frameElement:t,frameId:e.guid}),t.dispose()}catch{}}};iu.Snapshotter=og});var ug=M(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.Tracing=void 0;Yo.shouldCaptureSnapshot=EE;var ai=cg(require("fs")),CD=cg(require("os")),pn=cg(require("path")),TD=Jm(),OD=Qe(),ss=Ze(),os=ie(),PD=ht(),AD=is(),oi=$e(),ID=De(),RD=Et(),MD=ng(),FD=SE(),ND=yo(),LD=He(),DD=Bt();function cg(r){return r&&r.__esModule?r:{default:r}}var BD=6,jD={width:800,height:600,quality:90},ag=class extends ID.SdkObject{constructor(e,t){super(e,"tracing"),this._fs=new lg,this._snapshotter=void 0,this._harTracer=void 0,this._screencastListeners=[],this._eventListeners=[],this._context=void 0,this._state=void 0,this._isStopping=!1,this._precreatedTracesDir=void 0,this._tracesTmpDir=void 0,this._allResources=new Set,this._contextCreatedEvent=void 0,this._pendingHarEntries=new Set,this._context=e,this._precreatedTracesDir=t,this._harTracer=new MD.HarTracer(e,null,this,{content:"attach",includeTraceInfo:!0,recordRequestOverrides:!1,waitForContentOnStop:!1});let n="selectors"in e?e.selectors().testIdAttributeName():void 0;this._contextCreatedEvent={version:BD,type:"context-options",browserName:"",options:{},platform:process.platform,wallTime:0,sdkLanguage:e.attribution.playwright.options.sdkLanguage,testIdAttributeName:n},e instanceof oi.BrowserContext&&(this._snapshotter=new FD.Snapshotter(e,this),(0,os.assert)(t,"tracesDir must be specified for BrowserContext"),this._contextCreatedEvent.browserName=e._browser.options.name,this._contextCreatedEvent.channel=e._browser.options.channel,this._contextCreatedEvent.options=e._options)}async resetForReuse(){var e;await this.stopChunk({mode:"discard"}).catch(()=>{}),await this.stop(),(e=this._snapshotter)===null||e===void 0||e.resetForReuse()}async start(e){if(this._isStopping)throw new Error("Cannot start tracing while stopping");if(this._state)throw new Error("Tracing has been already started");this._contextCreatedEvent.sdkLanguage=this._context.attribution.playwright.options.sdkLanguage;let t=e.name||(0,os.createGuid)(),n=this._createTracesDirIfNeeded();this._state={options:e,traceName:t,tracesDir:n,traceFile:pn.default.join(n,t+".trace"),networkFile:pn.default.join(n,t+".network"),resourcesDir:pn.default.join(n,"resources"),chunkOrdinal:0,traceSha1s:new Set,networkSha1s:new Set,recording:!1,callIds:new Set},this._fs.mkdir(this._state.resourcesDir),this._fs.writeFile(this._state.networkFile,""),e.snapshots&&this._harTracer.start({omitScripts:!e.live})}async startChunk(e={}){var t;if(this._state&&this._state.recording&&await this.stopChunk({mode:"discard"}),!this._state)throw new Error("Must start tracing before starting a new chunk");if(this._isStopping)throw new Error("Cannot start a trace chunk while stopping");this._state.recording=!0,this._state.callIds.clear(),e.name&&e.name!==this._state.traceName?this._changeTraceName(this._state,e.name):this._allocateNewTraceFile(this._state),this._fs.mkdir(pn.default.dirname(this._state.traceFile));let n={...this._contextCreatedEvent,title:e.title,wallTime:Date.now()};return this._fs.appendFile(this._state.traceFile,JSON.stringify(n)+`
`),this._context.instrumentation.addListener(this,this._context),this._eventListeners.push(ss.eventsHelper.addEventListener(this._context,oi.BrowserContext.Events.Console,this._onConsoleMessage.bind(this)),ss.eventsHelper.addEventListener(this._context,oi.BrowserContext.Events.PageError,this._onPageError.bind(this))),this._state.options.screenshots&&this._startScreencast(),this._state.options.snapshots&&await((t=this._snapshotter)===null||t===void 0?void 0:t.start()),{traceName:this._state.traceName}}_startScreencast(){if(this._context instanceof oi.BrowserContext){for(let e of this._context.pages())this._startScreencastInPage(e);this._screencastListeners.push(ss.eventsHelper.addEventListener(this._context,oi.BrowserContext.Events.Page,this._startScreencastInPage.bind(this)))}}_stopScreencast(){if(ss.eventsHelper.removeEventListeners(this._screencastListeners),this._context instanceof oi.BrowserContext)for(let e of this._context.pages())e.setScreencastOptions(null)}_allocateNewTraceFile(e){let t=e.chunkOrdinal?`-chunk${e.chunkOrdinal}`:"";e.chunkOrdinal++,e.traceFile=pn.default.join(e.tracesDir,`${e.traceName}${t}.trace`)}_changeTraceName(e,t){e.traceName=t,e.chunkOrdinal=0,this._allocateNewTraceFile(e);let n=pn.default.join(e.tracesDir,t+".network");this._fs.copyFile(e.networkFile,n),e.networkFile=n}async stop(){if(this._state){if(this._isStopping)throw new Error("Tracing is already stopping");if(this._state.recording)throw new Error("Must stop trace file before stopping tracing");this._harTracer.stop(),this.flushHarEntries(),await this._fs.syncAndGetError(),this._state=void 0}}async deleteTmpTracesDir(){this._tracesTmpDir&&await(0,PD.removeFolders)([this._tracesTmpDir])}_createTracesDirIfNeeded(){return this._precreatedTracesDir?this._precreatedTracesDir:(this._tracesTmpDir=ai.default.mkdtempSync(pn.default.join(CD.default.tmpdir(),"playwright-tracing-")),this._tracesTmpDir)}abort(){var e;(e=this._snapshotter)===null||e===void 0||e.dispose(),this._harTracer.stop()}async flush(){this.abort(),await this._fs.syncAndGetError()}async stopChunk(e){var t;if(this._isStopping)throw new Error("Tracing is already stopping");if(this._isStopping=!0,!this._state||!this._state.recording){if(this._isStopping=!1,e.mode!=="discard")throw new Error("Must start tracing before stopping");return{}}this._context.instrumentation.removeListener(this),ss.eventsHelper.removeEventListeners(this._eventListeners),this._state.options.screenshots&&this._stopScreencast(),this._state.options.snapshots&&await((t=this._snapshotter)===null||t===void 0?void 0:t.stop()),this.flushHarEntries();let n=pn.default.join(this._state.tracesDir,this._state.traceName+`-pwnetcopy-${this._state.chunkOrdinal}.network`),s=[];s.push({name:"trace.trace",value:this._state.traceFile}),s.push({name:"trace.network",value:n});for(let c of new Set([...this._state.traceSha1s,...this._state.networkSha1s]))s.push({name:pn.default.join("resources",c),value:pn.default.join(this._state.resourcesDir,c)});if(this._state.traceSha1s=new Set,e.mode==="discard")return this._isStopping=!1,this._state.recording=!1,{};this._fs.copyFile(this._state.networkFile,n);let o=this._state.traceFile+".zip";e.mode==="archive"&&this._fs.zip(s,o);let a=await this._fs.syncAndGetError();if(this._isStopping=!1,this._state&&(this._state.recording=!1),a){if(this._context instanceof oi.BrowserContext&&!this._context._browser.isConnected())return{};throw a}if(e.mode==="entries")return{entries:s};let l=new AD.Artifact(this._context,o);return l.reportFinished(),{artifact:l}}async _captureSnapshot(e,t,n,s){this._snapshotter&&t.attribution.page&&this._snapshotter.started()&&EE(n)&&await this._snapshotter.captureSnapshot(t.attribution.page,n.id,e,s).catch(()=>{})}onBeforeCall(e,t){var n,s;let o=qD(t);return o?((n=e.attribution.page)===null||n===void 0||n.temporarilyDisableTracingScreencastThrottling(),o.beforeSnapshot=`before@${t.id}`,(s=this._state)===null||s===void 0||s.callIds.add(t.id),this._appendTraceEvent(o),this._captureSnapshot(o.beforeSnapshot,e,t)):Promise.resolve()}onBeforeInputAction(e,t,n){var s,o;if(!((s=this._state)!==null&&s!==void 0&&s.callIds.has(t.id)))return Promise.resolve();let a=HD(t);return a?((o=e.attribution.page)===null||o===void 0||o.temporarilyDisableTracingScreencastThrottling(),a.inputSnapshot=`input@${t.id}`,this._appendTraceEvent(a),this._captureSnapshot(a.inputSnapshot,e,t,n)):Promise.resolve()}onCallLog(e,t,n,s){if(t.isServerSide||t.internal||n!=="api")return;let o=$D(t,s);o&&this._appendTraceEvent(o)}async onAfterCall(e,t){var n,s,o;if(!((n=this._state)!==null&&n!==void 0&&n.callIds.has(t.id)))return;(s=this._state)===null||s===void 0||s.callIds.delete(t.id);let a=WD(t);if(a)return(o=e.attribution.page)===null||o===void 0||o.temporarilyDisableTracingScreencastThrottling(),a.afterSnapshot=`after@${t.id}`,this._appendTraceEvent(a),this._captureSnapshot(a.afterSnapshot,e,t)}onEntryStarted(e){this._pendingHarEntries.add(e)}onEntryFinished(e){this._pendingHarEntries.delete(e);let n=Xo({type:"resource-snapshot",snapshot:e},this._state.networkSha1s);this._fs.appendFile(this._state.networkFile,JSON.stringify(n)+`
`,!0)}flushHarEntries(){let e=[];for(let t of this._pendingHarEntries){let s=Xo({type:"resource-snapshot",snapshot:t},this._state.networkSha1s);e.push(JSON.stringify(s))}this._pendingHarEntries.clear(),e.length&&this._fs.appendFile(this._state.networkFile,e.join(`
`)+`
`,!0)}onContentBlob(e,t){this._appendResource(e,t)}onSnapshotterBlob(e){this._appendResource(e.sha1,e.buffer)}onFrameSnapshot(e){this._appendTraceEvent({type:"frame-snapshot",snapshot:e})}_onConsoleMessage(e){var t;let n={type:"console",messageType:e.type(),text:e.text(),args:e.args().map(s=>({preview:s.toString(),value:s.rawValue()})),location:e.location(),time:(0,os.monotonicTime)(),pageId:(t=e.page())===null||t===void 0?void 0:t.guid};this._appendTraceEvent(n)}_onPageError(e,t){let n={type:"event",time:(0,os.monotonicTime)(),class:"BrowserContext",method:"pageError",params:{error:(0,DD.serializeError)(e)},pageId:t.guid};this._appendTraceEvent(n)}_startScreencastInPage(e){e.setScreencastOptions(jD);let t=e.guid;this._screencastListeners.push(ss.eventsHelper.addEventListener(e,RD.Page.Events.ScreencastFrame,n=>{let s=n.timestamp||Date.now(),o=`${t}-${s}.jpeg`,a={type:"screencast-frame",pageId:e.guid,sha1:o,width:n.width,height:n.height,timestamp:(0,os.monotonicTime)()};this._appendResource(o,n.buffer),this._appendTraceEvent(a)}))}_appendTraceEvent(e){let t=Xo(e,this._state.traceSha1s),n=this._state.options.live||e.type!=="event"&&e.type!=="console"&&e.type!=="log";this._fs.appendFile(this._state.traceFile,JSON.stringify(t)+`
`,n)}_appendResource(e,t){if(this._allResources.has(e))return;this._allResources.add(e);let n=pn.default.join(this._state.resourcesDir,e);this._fs.writeFile(n,t,!0)}};Yo.Tracing=ag;function Xo(r,e){if(Array.isArray(r))return r.map(t=>Xo(t,e));if(r instanceof LD.Dispatcher)return`<${r._type}>`;if(r instanceof Buffer)return"<Buffer>";if(r instanceof Date)return r;if(typeof r=="object"){let t={};for(let n in r){if(n==="sha1"||n==="_sha1"||n.endsWith("Sha1")){let s=r[n];s&&e.add(s)}t[n]=Xo(r[n],e)}return t}return r}function EE(r){return TD.commandsWithTracingSnapshots.has(r.type+"."+r.method)}function qD(r){return r.internal||r.method.startsWith("tracing")?null:{type:"before",callId:r.id,startTime:r.startTime,apiName:r.apiName||r.type+"."+r.method,class:r.type,method:r.method,params:r.params,wallTime:r.wallTime,pageId:r.pageId}}function HD(r){return r.internal||r.method.startsWith("tracing")?null:{type:"input",callId:r.id,point:r.point}}function $D(r,e){return r.internal||r.method.startsWith("tracing")?null:{type:"log",callId:r.id,time:(0,os.monotonicTime)(),message:e}}function WD(r){var e;return r.internal||r.method.startsWith("tracing")?null:{type:"after",callId:r.id,endTime:r.endTime,error:(e=r.error)===null||e===void 0?void 0:e.error,result:r.result,point:r.point}}var lg=class{constructor(){this._writeChain=Promise.resolve(),this._buffers=new Map,this._error=void 0}mkdir(e){this._appendOperation(()=>ai.default.promises.mkdir(e,{recursive:!0}))}writeFile(e,t,n){this._buffers.delete(e),this._appendOperation(async()=>{n?await ai.default.promises.writeFile(e,t,{flag:"wx"}).catch(()=>{}):await ai.default.promises.writeFile(e,t)})}appendFile(e,t,n){this._buffers.has(e)||this._buffers.set(e,[]),this._buffers.get(e).push(t),n&&this._flushFile(e)}_flushFile(e){let t=this._buffers.get(e);if(t===void 0)return;let n=t.join("");this._buffers.delete(e),this._appendOperation(()=>ai.default.promises.appendFile(e,n))}copyFile(e,t){this._flushFile(e),this._buffers.delete(t),this._appendOperation(()=>ai.default.promises.copyFile(e,t))}async syncAndGetError(){for(let e of this._buffers.keys())this._flushFile(e);return await this._writeChain,this._error}zip(e,t){for(let n of this._buffers.keys())this._flushFile(n);this._appendOperation(async()=>{let n=new ND.yazl.ZipFile,s=new OD.ManualPromise;n.on("error",o=>s.reject(o));for(let o of e)n.addFile(o.value,o.name);n.end(),n.outputStream.pipe(ai.default.createWriteStream(t)).on("close",()=>s.resolve()).on("error",o=>s.reject(o)),await s})}_appendOperation(e){this._writeChain=this._writeChain.then(async()=>{if(!this._error)try{await e()}catch(t){this._error=t}})}}});var OE=M(su=>{"use strict";Object.defineProperty(su,"__esModule",{value:!0});su.HarRecorder=void 0;var kE=CE(require("fs")),UD=CE(require("path")),zD=is(),VD=ng(),GD=yo(),KD=Qe(),JD=ie();function CE(r){return r&&r.__esModule?r:{default:r}}var dg=class{constructor(e,t,n){this._artifact=void 0,this._isFlushed=!1,this._tracer=void 0,this._entries=[],this._zipFile=null,this._writtenZipEntries=new Set,this._artifact=new zD.Artifact(e,UD.default.join(e._browser.options.artifactsDir,`${(0,JD.createGuid)()}.har`));let s=n.urlRegexSource!==void 0&&n.urlRegexFlags!==void 0?new RegExp(n.urlRegexSource,n.urlRegexFlags):void 0,o=n.path.endsWith(".zip"),a=n.content||(o?"attach":"embed");this._tracer=new VD.HarTracer(e,t,this,{content:a,slimMode:n.mode==="minimal",includeTraceInfo:!1,recordRequestOverrides:!0,waitForContentOnStop:!0,urlFilter:s??n.urlGlob}),this._zipFile=a==="attach"||o?new GD.yazl.ZipFile:null,this._tracer.start({omitScripts:!1})}onEntryStarted(e){this._entries.push(e)}onEntryFinished(e){}onContentBlob(e,t){!this._zipFile||this._writtenZipEntries.has(e)||(this._writtenZipEntries.add(e),this._zipFile.addBuffer(t,e))}async flush(){if(this._isFlushed)return;this._isFlushed=!0,await this._tracer.flush();let e=this._tracer.stop();e.entries=this._entries;let t=XD({log:e});if(this._zipFile){let n=new KD.ManualPromise;this._zipFile.on("error",s=>n.reject(s)),this._zipFile.addBuffer(Buffer.from(t,"utf-8"),"har.har"),this._zipFile.end(),this._zipFile.outputStream.pipe(kE.default.createWriteStream(this._artifact.localPath())).on("close",()=>{n.resolve()}),await n}else await kE.default.promises.writeFile(this._artifact.localPath(),t)}async export(){return await this.flush(),this._artifact.reportFinished(),this._artifact}};su.HarRecorder=dg;function XD(r){let e=[];return TE(r,e,"",!1,void 0),e.join("")}function TE(r,e,t,n,s){if(typeof r!="object"||r===null){e.push(JSON.stringify(r));return}let o=Array.isArray(r);if(!o&&r.constructor.name!=="Object"){e.push(JSON.stringify(r));return}let a=o?r:Object.entries(r).filter(u=>u[1]!==void 0);if(!a.length){e.push(o?"[]":"{}");return}let l=`${t}  `,c;o?c=n?{open:"[",close:"]"}:{open:`[
${l}`,close:`
${t}]`}:c=n?{open:"{ ",close:" }"}:{open:`{
${l}`,close:`
${t}}`},e.push(c.open);for(let u=0;u<a.length;++u){let d=a[u];u&&e.push(n?", ":`,
${l}`),o||e.push(`${JSON.stringify(d[0])}: `);let h=o?void 0:d[0],p=n||h==="timings"||s==="headers";TE(o?d:d[1],e,l,p,h)}e.push(c.close)}});var PE=M(ou=>{"use strict";Object.defineProperty(ou,"__esModule",{value:!0});ou.CodeGenerator=void 0;var YD=require("events"),hg=class extends YD.EventEmitter{constructor(e,t,n,s,o,a){super(),this._currentAction=null,this._lastAction=null,this._actions=[],this._enabled=void 0,this._options=void 0,n={headless:!1,...n},s={...s},this._enabled=t,this._options={browserName:e,launchOptions:n,contextOptions:s,deviceName:o,saveStorage:a},this.restart()}restart(){this._currentAction=null,this._lastAction=null,this._actions=[],this.emit("change")}setEnabled(e){this._enabled=e}addAction(e){this._enabled&&(this.willPerformAction(e),this.didPerformAction(e))}willPerformAction(e){this._enabled&&(this._currentAction=e)}performedActionFailed(e){this._enabled&&this._currentAction===e&&(this._currentAction=null)}didPerformAction(e){if(!this._enabled)return;let t=e.action,n=!1;if(this._lastAction&&this._lastAction.frame.pageAlias===e.frame.pageAlias){let s=this._lastAction.action;if(this._lastAction&&t.name==="fill"&&s.name==="fill"&&t.selector===s.selector&&(n=!0),s&&t.name==="click"&&s.name==="click"&&t.selector===s.selector&&t.clickCount>s.clickCount&&(n=!0),s&&t.name==="navigate"&&s.name==="navigate"&&t.url===s.url){this._currentAction=null;return}s&&(t.name==="check"||t.name==="uncheck")&&s.name==="click"&&t.selector===s.selector&&(n=!0)}this._lastAction=e,this._currentAction=null,n&&this._actions.pop(),this._actions.push(e),this.emit("change")}commitLastAction(){if(!this._enabled)return;let e=this._lastAction;e&&(e.committed=!0)}signal(e,t,n){if(this._enabled){if(this._currentAction){this._currentAction.action.signals.push(n);return}if(this._lastAction&&!this._lastAction.committed){let s=this._lastAction.action.signals;if(n.name==="navigation"&&s.length&&s[s.length-1].name==="download")return;n.name==="download"&&s.length&&s[s.length-1].name==="navigation"&&(s.length=s.length-1),this._lastAction.action.signals.push(n),this.emit("change");return}n.name==="navigation"&&t._page.mainFrame()===t&&this.addAction({frame:{pageAlias:e,isMainFrame:!0},committed:!0,action:{name:"navigate",url:t.url(),signals:[]}})}}generateStructure(e){let t=e.generateHeader(this._options),n=e.generateFooter(this._options.saveStorage),s=this._actions.map(a=>e.generateAction(a)).filter(Boolean),o=[t,...s,n].join(`
`);return{header:t,footer:n,actions:s,text:o}}};ou.CodeGenerator=hg});var as=M(au=>{"use strict";Object.defineProperty(au,"__esModule",{value:!0});au.toClickOptions=QD;au.toModifiers=AE;function QD(r){let e="click";r.clickCount===2&&(e="dblclick");let t=AE(r.modifiers),n={};return r.button!=="left"&&(n.button=r.button),t.length&&(n.modifiers=t),r.clickCount>2&&(n.clickCount=r.clickCount),r.position&&(n.position=r.position),{method:e,options:n}}function AE(r){let e=[];return r&1&&e.push("Alt"),r&2&&e.push("ControlOrMeta"),r&4&&e.push("ControlOrMeta"),r&8&&e.push("Shift"),e}});var Qo=M(lu=>{"use strict";Object.defineProperty(lu,"__esModule",{value:!0});lu.sanitizeDeviceOptions=ZD;lu.toSignalMap=eB;function ZD(r,e){let t={};for(let n in e)JSON.stringify(r[n])!==JSON.stringify(e[n])&&(t[n]=e[n]);return t}function eB(r){let e,t,n;for(let s of r.signals)s.name==="popup"?e=s:s.name==="download"?t=s:s.name==="dialog"&&(n=s);return{popup:e,download:t,dialog:n}}});var ls=M((R9,tB)=>{tB.exports={"Blackberry PlayBook":{userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/17.4 Safari/536.2+",viewport:{width:600,height:1024},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Blackberry PlayBook landscape":{userAgent:"Mozilla/5.0 (PlayBook; U; RIM Tablet OS 2.1.0; en-US) AppleWebKit/536.2+ (KHTML like Gecko) Version/17.4 Safari/536.2+",viewport:{width:1024,height:600},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"BlackBerry Z30":{userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/17.4 Mobile Safari/537.10+",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"BlackBerry Z30 landscape":{userAgent:"Mozilla/5.0 (BB10; Touch) AppleWebKit/537.10+ (KHTML, like Gecko) Version/17.4 Mobile Safari/537.10+",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note 3":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note 3 landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note II":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy Note II landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.1; en-us; GT-N7100 Build/JRO03C) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S III":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S III landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.0; en-us; GT-I9300 Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/17.4 Mobile Safari/534.30",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Galaxy S5":{userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S8":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:360,height:740},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S8 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; SM-G950U Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:740,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S9+":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:320,height:658},deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy S9+ landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; SM-G965U Build/R16NW) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:658,height:320},deviceScaleFactor:4.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy Tab S4":{userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:712,height:1138},deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Galaxy Tab S4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.1.0; SM-T837A) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:1138,height:712},deviceScaleFactor:2.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"iPad (gen 5)":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 5) landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 6)":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 6) landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 7)":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:810,height:1080},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad (gen 7) landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:1080,height:810},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Mini":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:768,height:1024},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Mini landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:1024,height:768},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Pro 11":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:834,height:1194},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPad Pro 11 landscape":{userAgent:"Mozilla/5.0 (iPad; CPU OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:1194,height:834},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 6 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 7 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:667},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:667,height:375},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:414,height:736},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 8 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:736,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone SE":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/17.4 Mobile/14E304 Safari/602.1",viewport:{width:320,height:568},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone SE landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/17.4 Mobile/14E304 Safari/602.1",viewport:{width:568,height:320},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone X":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:375,height:812},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone X landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/17.4 Mobile/15A372 Safari/604.1",viewport:{width:812,height:375},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone XR":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:414,height:896},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone XR landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",viewport:{width:896,height:414},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:414,height:715},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:800,height:364},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:635},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:724,height:325},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:414,height:715},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 11 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 12_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:414,height:896},viewport:{width:808,height:364},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:340},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:340},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:428,height:746},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:832,height:378},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Mini":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:629},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 12 Mini landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:712,height:325},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:342},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:342},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:428,height:746},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:832,height:380},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Mini":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:375,height:629},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 13 Mini landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:375,height:812},viewport:{width:712,height:327},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:390,height:664},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:390,height:844},viewport:{width:750,height:340},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Plus":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:428,height:746},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Plus landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:428,height:926},viewport:{width:832,height:378},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Pro":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:393,height:852},viewport:{width:393,height:660},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Pro landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:393,height:852},viewport:{width:734,height:343},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Pro Max":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:430,height:932},viewport:{width:430,height:740},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"iPhone 14 Pro Max landscape":{userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 16_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Mobile/15E148 Safari/604.1",screen:{width:430,height:932},viewport:{width:814,height:380},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Kindle Fire HDX":{userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:800,height:1280},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Kindle Fire HDX landscape":{userAgent:"Mozilla/5.0 (Linux; U; en-us; KFAPWI Build/JDQ39) AppleWebKit/535.19 (KHTML, like Gecko) Silk/3.13 Safari/535.19 Silk-Accelerated=true",viewport:{width:1280,height:800},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"LG Optimus L70":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:384,height:640},deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"LG Optimus L70 landscape":{userAgent:"Mozilla/5.0 (Linux; U; Android 4.4.2; en-us; LGMS323 Build/KOT49I.MS32310c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:640,height:384},deviceScaleFactor:1.25,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 550":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 550 landscape":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 550) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 950":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36 Edge/14.14263",viewport:{width:360,height:640},deviceScaleFactor:4,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Microsoft Lumia 950 landscape":{userAgent:"Mozilla/5.0 (Windows Phone 10.0; Android 4.2.1; Microsoft; Lumia 950) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36 Edge/14.14263",viewport:{width:640,height:360},deviceScaleFactor:4,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 10":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:800,height:1280},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 10 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 10 Build/MOB31T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:1280,height:800},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 4":{userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:384,height:640},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 4.4.2; Nexus 4 Build/KOT49H) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:640,height:384},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5":{userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5X":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 5X landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 5X Build/OPR4.170623.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6":{userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.1.1; Nexus 6 Build/N6F26U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6P":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:412,height:732},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 6P landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Nexus 6P Build/OPP3.170518.006) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:732,height:412},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 7":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:600,height:960},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nexus 7 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 6.0.1; Nexus 7 Build/MOB30X) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",viewport:{width:960,height:600},deviceScaleFactor:2,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia Lumia 520":{userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:320,height:533},deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia Lumia 520 landscape":{userAgent:"Mozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0; ARM; Touch; NOKIA; Lumia 520)",viewport:{width:533,height:320},deviceScaleFactor:1.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Nokia N9":{userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:480,height:854},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Nokia N9 landscape":{userAgent:"Mozilla/5.0 (MeeGo; NokiaN9) AppleWebKit/534.13 (KHTML, like Gecko) NokiaBrowser/8.5.0 Mobile Safari/534.13",viewport:{width:854,height:480},deviceScaleFactor:1,isMobile:!0,hasTouch:!0,defaultBrowserType:"webkit"},"Pixel 2":{userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:411,height:731},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0; Pixel 2 Build/OPD3.170816.012) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:731,height:411},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 XL":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:411,height:823},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 2 XL landscape":{userAgent:"Mozilla/5.0 (Linux; Android 8.0.0; Pixel 2 XL Build/OPD1.170816.004) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:823,height:411},deviceScaleFactor:3.5,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 3":{userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:393,height:786},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 3 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PQ1A.181105.017.A1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:786,height:393},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4":{userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:353,height:745},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 10; Pixel 4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:745,height:353},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4a (5G)":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{width:412,height:892},viewport:{width:412,height:765},deviceScaleFactor:2.63,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 4a (5G) landscape":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 4a (5G)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{height:892,width:412},viewport:{width:840,height:312},deviceScaleFactor:2.63,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 5":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{width:393,height:851},viewport:{width:393,height:727},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 5 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 11; Pixel 5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{width:851,height:393},viewport:{width:802,height:293},deviceScaleFactor:2.75,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 7":{userAgent:"Mozilla/5.0 (Linux; Android 14; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{width:412,height:915},viewport:{width:412,height:839},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Pixel 7 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 14; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",screen:{width:915,height:412},viewport:{width:863,height:360},deviceScaleFactor:2.625,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Moto G4":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:360,height:640},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Moto G4 landscape":{userAgent:"Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Mobile Safari/537.36",viewport:{width:640,height:360},deviceScaleFactor:3,isMobile:!0,hasTouch:!0,defaultBrowserType:"chromium"},"Desktop Chrome HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Edge HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36 Edg/125.0.6422.26",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Firefox HiDPI":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0.1) Gecko/20100101 Firefox/125.0.1",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"firefox"},"Desktop Safari":{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15",screen:{width:1792,height:1120},viewport:{width:1280,height:720},deviceScaleFactor:2,isMobile:!1,hasTouch:!1,defaultBrowserType:"webkit"},"Desktop Chrome":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Edge":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.26 Safari/537.36 Edg/125.0.6422.26",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"chromium"},"Desktop Firefox":{userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0.1) Gecko/20100101 Firefox/125.0.1",screen:{width:1920,height:1080},viewport:{width:1280,height:720},deviceScaleFactor:1,isMobile:!1,hasTouch:!1,defaultBrowserType:"firefox"}}});var mg=M(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.JavaScriptLanguageGenerator=ds.JavaScriptFormatter=void 0;var ME=Qo(),IE=as(),nB=Ht(),rB=Xt(),iB=ls(),pg=class{constructor(e){this.id=void 0,this.groupName="Node.js",this.name=void 0,this.highlighter="javascript",this._isTest=void 0,this.id=e?"playwright-test":"javascript",this.name=e?"Test Runner":"Library",this._isTest=e}generateAction(e){let t=e.action;if(this._isTest&&(t.name==="openPage"||t.name==="closePage"))return"";let n=e.frame.pageAlias,s=new cs(2);if(t.name==="openPage")return s.add(`const ${n} = await context.newPage();`),t.url&&t.url!=="about:blank"&&t.url!=="chrome://newtab/"&&s.add(`await ${n}.goto(${Cn(t.url)});`),s.format();let o;if(e.frame.isMainFrame)o=n;else{let l=e.frame.selectorsChain.map(c=>`.frameLocator(${Cn(c)})`);o=`${n}${l.join("")}`}let a=(0,ME.toSignalMap)(t);return a.dialog&&s.add(`  ${n}.once('dialog', dialog => {
    console.log(\`Dialog message: \${dialog.message()}\`);
    dialog.dismiss().catch(() => {});
  });`),a.popup&&s.add(`const ${a.popup.popupAlias}Promise = ${n}.waitForEvent('popup');`),a.download&&s.add(`const download${a.download.downloadAlias}Promise = ${n}.waitForEvent('download');`),s.add(this._generateActionCall(o,t)),a.popup&&s.add(`const ${a.popup.popupAlias} = await ${a.popup.popupAlias}Promise;`),a.download&&s.add(`const download${a.download.downloadAlias} = await download${a.download.downloadAlias}Promise;`),s.format()}_generateActionCall(e,t){switch(t.name){case"openPage":throw Error("Not reached");case"closePage":return`await ${e}.close();`;case"click":{let n="click";t.clickCount===2&&(n="dblclick");let s=(0,IE.toModifiers)(t.modifiers),o={};t.button!=="left"&&(o.button=t.button),s.length&&(o.modifiers=s),t.clickCount>2&&(o.clickCount=t.clickCount),t.position&&(o.position=t.position);let a=sB(o,!1);return`await ${e}.${this._asLocator(t.selector)}.${n}(${a});`}case"check":return`await ${e}.${this._asLocator(t.selector)}.check();`;case"uncheck":return`await ${e}.${this._asLocator(t.selector)}.uncheck();`;case"fill":return`await ${e}.${this._asLocator(t.selector)}.fill(${Cn(t.text)});`;case"setInputFiles":return`await ${e}.${this._asLocator(t.selector)}.setInputFiles(${us(t.files.length===1?t.files[0]:t.files)});`;case"press":{let s=[...(0,IE.toModifiers)(t.modifiers),t.key].join("+");return`await ${e}.${this._asLocator(t.selector)}.press(${Cn(s)});`}case"navigate":return`await ${e}.goto(${Cn(t.url)});`;case"select":return`await ${e}.${this._asLocator(t.selector)}.selectOption(${us(t.options.length>1?t.options:t.options[0])});`;case"assertText":return`${this._isTest?"":"// "}await expect(${e}.${this._asLocator(t.selector)}).${t.substring?"toContainText":"toHaveText"}(${Cn(t.text)});`;case"assertChecked":return`${this._isTest?"":"// "}await expect(${e}.${this._asLocator(t.selector)})${t.checked?"":".not"}.toBeChecked();`;case"assertVisible":return`${this._isTest?"":"// "}await expect(${e}.${this._asLocator(t.selector)}).toBeVisible();`;case"assertValue":{let n=t.value?`toHaveValue(${Cn(t.value)})`:"toBeEmpty()";return`${this._isTest?"":"// "}await expect(${e}.${this._asLocator(t.selector)}).${n};`}}}_asLocator(e){return(0,rB.asLocator)("javascript",e)}generateHeader(e){return this._isTest?this.generateTestHeader(e):this.generateStandaloneHeader(e)}generateFooter(e){return this._isTest?this.generateTestFooter(e):this.generateStandaloneFooter(e)}generateTestHeader(e){let t=new cs,n=RE(e.contextOptions,e.deviceName);return t.add(`
      import { test, expect${e.deviceName?", devices":""} } from '@playwright/test';
${n?`
test.use(`+n+`);
`:""}
      test('test', async ({ page }) => {`),t.format()}generateTestFooter(e){return"});"}generateStandaloneHeader(e){let t=new cs;return t.add(`
      const { ${e.browserName}${e.deviceName?", devices":""} } = require('playwright');

      (async () => {
        const browser = await ${e.browserName}.launch(${fg(e.launchOptions)});
        const context = await browser.newContext(${RE(e.contextOptions,e.deviceName)});`),t.format()}generateStandaloneFooter(e){return`
  // ---------------------${e?`
  await context.storageState({ path: ${Cn(e)} });`:""}
  await context.close();
  await browser.close();
})();`}};ds.JavaScriptLanguageGenerator=pg;function sB(r,e){return Object.keys(r).length?(e?", ":"")+us(r):""}function us(r,e="  "){if(typeof r=="string")return Cn(r);if(Array.isArray(r))return`[${r.map(t=>us(t)).join(", ")}]`;if(typeof r=="object"){let t=Object.keys(r).filter(s=>r[s]!==void 0).sort();if(!t.length)return"{}";let n=[];for(let s of t)n.push(`${s}: ${us(r[s])}`);return`{
${e}${n.join(`,
${e}`)}
}`}return String(r)}function fg(r,e="  "){let t=us(r,e);return t==="{}"?"":t}function RE(r,e){let t=e&&iB[e];if(!t)return fg(r);let n=fg((0,ME.sanitizeDeviceOptions)(t,r));n||(n=`{
}`);let s=n.split(`
`);return s.splice(1,0,`...devices[${Cn(e)}],`),s.join(`
`)}var cs=class{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(2),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split(`
`).map(t=>t.trim()).concat(this._lines)}add(e){this._lines.push(...e.trim().split(`
`).map(t=>t.trim()))}newLine(){this._lines.push("")}format(){let e="",t="";return this._lines.map(n=>{if(n==="")return n;(n.startsWith("}")||n.startsWith("]"))&&(e=e.substring(this._baseIndent.length));let s=/^(for|while|if|try).*\(.*\)$/.test(t)?this._baseIndent:"";t=n;let o=n.startsWith(".set");return n=e+s+(o?this._baseIndent:"")+n,(n.endsWith("{")||n.endsWith("["))&&(e+=this._baseIndent),this._baseOffset+n}).join(`
`)}};ds.JavaScriptFormatter=cs;function Cn(r){return(0,nB.escapeWithQuotes)(r,"'")}});var LE=M(cu=>{"use strict";Object.defineProperty(cu,"__esModule",{value:!0});cu.JavaLanguageGenerator=void 0;var oB=Qo(),FE=as(),NE=mg(),aB=Ht(),lB=Xt(),cB=ls(),gg=class{constructor(e){if(this.id=void 0,this.groupName="Java",this.name=void 0,this.highlighter="java",this._mode=void 0,e==="library")this.name="Library",this.id="java";else if(e==="junit")this.name="JUnit",this.id="java-junit";else throw new Error(`Unknown Java language mode: ${e}`);this._mode=e}generateAction(e){let t=e.action,n=e.frame.pageAlias,s=this._mode==="junit"?4:6,o=new NE.JavaScriptFormatter(s);if(this._mode!=="library"&&(t.name==="openPage"||t.name==="closePage"))return"";if(t.name==="openPage")return o.add(`Page ${n} = context.newPage();`),t.url&&t.url!=="about:blank"&&t.url!=="chrome://newtab/"&&o.add(`${n}.navigate(${nt(t.url)});`),o.format();let a,l=!1;if(e.frame.isMainFrame)a=n;else{let d=e.frame.selectorsChain.map(h=>`.frameLocator(${nt(h)})`);a=`${n}${d.join("")}`,l=!0}let c=(0,oB.toSignalMap)(t);c.dialog&&o.add(`  ${n}.onceDialog(dialog -> {
        System.out.println(String.format("Dialog message: %s", dialog.message()));
        dialog.dismiss();
      });`);let u=this._generateActionCall(a,t,l);return c.popup&&(u=`Page ${c.popup.popupAlias} = ${n}.waitForPopup(() -> {
        ${u}
      });`),c.download&&(u=`Download download${c.download.downloadAlias} = ${n}.waitForDownload(() -> {
        ${u}
      });`),o.add(u),o.format()}_generateActionCall(e,t,n){switch(t.name){case"openPage":throw Error("Not reached");case"closePage":return`${e}.close();`;case"click":{let s="click";t.clickCount===2&&(s="dblclick");let o=(0,FE.toModifiers)(t.modifiers),a={};t.button!=="left"&&(a.button=t.button),o.length&&(a.modifiers=o),t.clickCount>2&&(a.clickCount=t.clickCount),t.position&&(a.position=t.position);let l=fB(a);return`${e}.${this._asLocator(t.selector,n)}.${s}(${l});`}case"check":return`${e}.${this._asLocator(t.selector,n)}.check();`;case"uncheck":return`${e}.${this._asLocator(t.selector,n)}.uncheck();`;case"fill":return`${e}.${this._asLocator(t.selector,n)}.fill(${nt(t.text)});`;case"setInputFiles":return`${e}.${this._asLocator(t.selector,n)}.setInputFiles(${uB(t.files.length===1?t.files[0]:t.files)});`;case"press":{let o=[...(0,FE.toModifiers)(t.modifiers),t.key].join("+");return`${e}.${this._asLocator(t.selector,n)}.press(${nt(o)});`}case"navigate":return`${e}.navigate(${nt(t.url)});`;case"select":return`${e}.${this._asLocator(t.selector,n)}.selectOption(${dB(t.options.length>1?t.options:t.options[0])});`;case"assertText":return`assertThat(${e}.${this._asLocator(t.selector,n)}).${t.substring?"containsText":"hasText"}(${nt(t.text)});`;case"assertChecked":return`assertThat(${e}.${this._asLocator(t.selector,n)})${t.checked?"":".not()"}.isChecked();`;case"assertVisible":return`assertThat(${e}.${this._asLocator(t.selector,n)}).isVisible();`;case"assertValue":{let s=t.value?`hasValue(${nt(t.value)})`:"isEmpty()";return`assertThat(${e}.${this._asLocator(t.selector,n)}).${s};`}}}_asLocator(e,t){return(0,lB.asLocator)("java",e,t)}generateHeader(e){let t=new NE.JavaScriptFormatter;return this._mode==="junit"?(t.add(`
      import com.microsoft.playwright.junit.UsePlaywright;
      import com.microsoft.playwright.Page;
      import com.microsoft.playwright.options.*;

      import org.junit.jupiter.api.*;
      import static com.microsoft.playwright.assertions.PlaywrightAssertions.*;

      @UsePlaywright
      public class TestExample {
        @Test
        void test(Page page) {`),t.format()):(t.add(`
    import com.microsoft.playwright.*;
    import com.microsoft.playwright.options.*;
    import static com.microsoft.playwright.assertions.PlaywrightAssertions.assertThat;
    import java.util.*;

    public class Example {
      public static void main(String[] args) {
        try (Playwright playwright = Playwright.create()) {
          Browser browser = playwright.${e.browserName}().launch(${hB(e.launchOptions)});
          BrowserContext context = browser.newContext(${pB(e.contextOptions,e.deviceName)});`),t.format())}generateFooter(e){let t=e?`
      context.storageState(new BrowserContext.StorageStateOptions().setPath(${nt(e)}));
`:"";return this._mode==="junit"?`${t}  }
}`:`${t}    }
  }
}`}};cu.JavaLanguageGenerator=gg;function uB(r){return Array.isArray(r)?r.length===0?"new Path[0]":`new Path[] {${r.map(e=>"Paths.get("+nt(e)+")").join(", ")}}`:`Paths.get(${nt(r)})`}function dB(r){return Array.isArray(r)?r.length===0?"new String[0]":`new String[] {${r.map(e=>nt(e)).join(", ")}}`:nt(r)}function hB(r){let e=[];return Object.keys(r).filter(t=>r[t]!==void 0).length?(e.push("new BrowserType.LaunchOptions()"),r.channel&&e.push(`  .setChannel(${nt(r.channel)})`),typeof r.headless=="boolean"&&e.push("  .setHeadless(false)"),e.join(`
`)):""}function pB(r,e){var t,n,s,o,a,l,c;let u=[];if(!Object.keys(r).length&&!e)return"";let h={...e?cB[e]:{},...r};return u.push("new Browser.NewContextOptions()"),h.acceptDownloads&&u.push("  .setAcceptDownloads(true)"),h.bypassCSP&&u.push("  .setBypassCSP(true)"),h.colorScheme&&u.push(`  .setColorScheme(ColorScheme.${h.colorScheme.toUpperCase()})`),h.deviceScaleFactor&&u.push(`  .setDeviceScaleFactor(${h.deviceScaleFactor})`),h.geolocation&&u.push(`  .setGeolocation(${h.geolocation.latitude}, ${h.geolocation.longitude})`),h.hasTouch&&u.push(`  .setHasTouch(${h.hasTouch})`),h.isMobile&&u.push(`  .setIsMobile(${h.isMobile})`),h.locale&&u.push(`  .setLocale(${nt(h.locale)})`),h.proxy&&u.push(`  .setProxy(new Proxy(${nt(h.proxy.server)}))`),(t=h.recordHar)!==null&&t!==void 0&&t.content&&u.push(`  .setRecordHarContent(HarContentPolicy.${(n=h.recordHar)===null||n===void 0?void 0:n.content.toUpperCase()})`),(s=h.recordHar)!==null&&s!==void 0&&s.mode&&u.push(`  .setRecordHarMode(HarMode.${(o=h.recordHar)===null||o===void 0?void 0:o.mode.toUpperCase()})`),(a=h.recordHar)!==null&&a!==void 0&&a.omitContent&&u.push("  .setRecordHarOmitContent(true)"),(l=h.recordHar)!==null&&l!==void 0&&l.path&&u.push(`  .setRecordHarPath(Paths.get(${nt(h.recordHar.path)}))`),(c=h.recordHar)!==null&&c!==void 0&&c.urlFilter&&u.push(`  .setRecordHarUrlFilter(${nt(h.recordHar.urlFilter)})`),h.serviceWorkers&&u.push(`  .setServiceWorkers(ServiceWorkerPolicy.${h.serviceWorkers.toUpperCase()})`),h.storageState&&u.push(`  .setStorageStatePath(Paths.get(${nt(h.storageState)}))`),h.timezoneId&&u.push(`  .setTimezoneId(${nt(h.timezoneId)})`),h.userAgent&&u.push(`  .setUserAgent(${nt(h.userAgent)})`),h.viewport&&u.push(`  .setViewportSize(${h.viewport.width}, ${h.viewport.height})`),u.join(`
`)}function fB(r){let e=[];return r.button&&e.push(`  .setButton(MouseButton.${r.button.toUpperCase()})`),r.modifiers&&e.push(`  .setModifiers(Arrays.asList(${r.modifiers.map(t=>`KeyboardModifier.${t.toUpperCase()}`).join(", ")}))`),r.clickCount&&e.push(`  .setClickCount(${r.clickCount})`),r.position&&e.push(`  .setPosition(${r.position.x}, ${r.position.y})`),e.length?(e.unshift("new Locator.ClickOptions()"),e.join(`
`)):""}function nt(r){return(0,aB.escapeWithQuotes)(r,'"')}});var DE=M(uu=>{"use strict";Object.defineProperty(uu,"__esModule",{value:!0});uu.JsonlLanguageGenerator=void 0;var mB=Xt(),_g=class{constructor(){this.id="jsonl",this.groupName="",this.name="JSONL",this.highlighter="javascript"}generateAction(e){let t=e.action.selector?JSON.parse((0,mB.asLocator)("jsonl",e.action.selector)):void 0,n={...e.action,pageAlias:e.frame.pageAlias,locator:t};return JSON.stringify(n)}generateHeader(e){return JSON.stringify(e)}generateFooter(e){return""}};uu.JsonlLanguageGenerator=_g});var $E=M(hu=>{"use strict";Object.defineProperty(hu,"__esModule",{value:!0});hu.CSharpLanguageGenerator=void 0;var HE=Qo(),BE=as(),gB=Ht(),_B=Xt(),wB=ls(),vg=class{constructor(e){if(this.id=void 0,this.groupName=".NET C#",this.name=void 0,this.highlighter="csharp",this._mode=void 0,e==="library")this.name="Library",this.id="csharp";else if(e==="mstest")this.name="MSTest",this.id="csharp-mstest";else if(e==="nunit")this.name="NUnit",this.id="csharp-nunit";else throw new Error(`Unknown C# language mode: ${e}`);this._mode=e}generateAction(e){let t=this._generateActionInner(e);return t||""}_generateActionInner(e){let t=e.action;if(this._mode!=="library"&&(t.name==="openPage"||t.name==="closePage"))return"";let n=e.frame.pageAlias;this._mode!=="library"&&(n=n.replace("page","Page"));let s=new Zo(this._mode==="library"?0:8);if(t.name==="openPage")return s.add(`var ${n} = await context.NewPageAsync();`),t.url&&t.url!=="about:blank"&&t.url!=="chrome://newtab/"&&s.add(`await ${n}.GotoAsync(${fn(t.url)});`),s.format();let o;if(e.frame.isMainFrame)o=n;else{let c=e.frame.selectorsChain.map(u=>`.FrameLocator(${fn(u)})`);o=`${n}${c.join("")}`}let a=(0,HE.toSignalMap)(t);a.dialog&&s.add(`    void ${n}_Dialog${a.dialog.dialogAlias}_EventHandler(object sender, IDialog dialog)
      {
          Console.WriteLine($"Dialog message: {dialog.Message}");
          dialog.DismissAsync();
          ${n}.Dialog -= ${n}_Dialog${a.dialog.dialogAlias}_EventHandler;
      }
      ${n}.Dialog += ${n}_Dialog${a.dialog.dialogAlias}_EventHandler;`);let l=[];l.push(this._generateActionCall(o,t)),a.download&&(l.unshift(`var download${a.download.downloadAlias} = await ${n}.RunAndWaitForDownloadAsync(async () =>
{`),l.push("});")),a.popup&&(l.unshift(`var ${a.popup.popupAlias} = await ${n}.RunAndWaitForPopupAsync(async () =>
{`),l.push("});"));for(let c of l)s.add(c);return s.format()}_generateActionCall(e,t){switch(t.name){case"openPage":throw Error("Not reached");case"closePage":return`await ${e}.CloseAsync();`;case"click":{let n="Click";t.clickCount===2&&(n="DblClick");let s=(0,BE.toModifiers)(t.modifiers),o={};if(t.button!=="left"&&(o.button=t.button),s.length&&(o.modifiers=s),t.clickCount>2&&(o.clickCount=t.clickCount),t.position&&(o.position=t.position),!Object.entries(o).length)return`await ${e}.${this._asLocator(t.selector)}.${n}Async();`;let a=yr(o,"    ","Locator"+n+"Options");return`await ${e}.${this._asLocator(t.selector)}.${n}Async(${a});`}case"check":return`await ${e}.${this._asLocator(t.selector)}.CheckAsync();`;case"uncheck":return`await ${e}.${this._asLocator(t.selector)}.UncheckAsync();`;case"fill":return`await ${e}.${this._asLocator(t.selector)}.FillAsync(${fn(t.text)});`;case"setInputFiles":return`await ${e}.${this._asLocator(t.selector)}.SetInputFilesAsync(${yr(t.files)});`;case"press":{let s=[...(0,BE.toModifiers)(t.modifiers),t.key].join("+");return`await ${e}.${this._asLocator(t.selector)}.PressAsync(${fn(s)});`}case"navigate":return`await ${e}.GotoAsync(${fn(t.url)});`;case"select":return`await ${e}.${this._asLocator(t.selector)}.SelectOptionAsync(${yr(t.options)});`;case"assertText":return`await Expect(${e}.${this._asLocator(t.selector)}).${t.substring?"ToContainTextAsync":"ToHaveTextAsync"}(${fn(t.text)});`;case"assertChecked":return`await Expect(${e}.${this._asLocator(t.selector)})${t.checked?"":".Not"}.ToBeCheckedAsync();`;case"assertVisible":return`await Expect(${e}.${this._asLocator(t.selector)}).ToBeVisibleAsync();`;case"assertValue":{let n=t.value?`ToHaveValueAsync(${fn(t.value)})`:"ToBeEmptyAsync()";return`await Expect(${e}.${this._asLocator(t.selector)}).${n};`}}}_asLocator(e){return(0,_B.asLocator)("csharp",e)}generateHeader(e){return this._mode==="library"?this.generateStandaloneHeader(e):this.generateTestRunnerHeader(e)}generateStandaloneHeader(e){let t=new Zo(0);return t.add(`
      using Microsoft.Playwright;
      using System;
      using System.Threading.Tasks;

      using var playwright = await Playwright.CreateAsync();
      await using var browser = await playwright.${du(e.browserName)}.LaunchAsync(${yr(e.launchOptions,"    ","BrowserTypeLaunchOptions")});
      var context = await browser.NewContextAsync(${qE(e.contextOptions,e.deviceName)});`),t.newLine(),t.format()}generateTestRunnerHeader(e){let t=new Zo(0);t.add(`
      using Microsoft.Playwright.${this._mode==="nunit"?"NUnit":"MSTest"};
      using Microsoft.Playwright;

      ${this._mode==="nunit"?`[Parallelizable(ParallelScope.Self)]
      [TestFixture]`:"[TestClass]"}
      public class Tests : PageTest
      {`);let n=qE(e.contextOptions,e.deviceName);return n&&(t.add(`public override BrowserNewContextOptions ContextOptions()
      {
          return ${n};
      }`),t.newLine()),t.add(`    [${this._mode==="nunit"?"Test":"TestMethod"}]
    public async Task MyTest()
    {`),t.format()}generateFooter(e){let t=this._mode==="library"?"":"        ",n=e?`
${t}await context.StorageStateAsync(new BrowserContextStorageStateOptions
${t}{
${t}    Path = ${fn(e)}
${t}});
`:"";return this._mode!=="library"&&(n+=`    }
}
`),n}};hu.CSharpLanguageGenerator=vg;function yr(r,e="    ",t=""){if(typeof r=="string")return["permissions","colorScheme","modifiers","button","recordHarContent","recordHarMode","serviceWorkers"].includes(t)?`${wg(t)}.${du(r)}`:fn(r);if(Array.isArray(r))return`new[] { ${r.map(n=>yr(n,e,t)).join(", ")} }`;if(typeof r=="object"){let n=Object.keys(r).filter(o=>r[o]!==void 0).sort();if(!n.length)return t?`new ${wg(t)}`:"";let s=[];for(let o of n){let a=vB(o);s.push(`${a} = ${yr(r[o],e,o)},`)}return t?`new ${wg(t)}
{
${e}${s.join(`
${e}`)}
${e}}`:`{
${e}${s.join(`
${e}`)}
${e}}`}return t==="latitude"||t==="longitude"?String(r)+"m":String(r)}function wg(r){switch(r){case"viewport":return"ViewportSize";case"proxy":return"ProxySettings";case"permissions":return"ContextPermission";case"modifiers":return"KeyboardModifier";case"button":return"MouseButton";case"recordHarMode":return"HarMode";case"recordHarContent":return"HarContentPolicy";case"serviceWorkers":return"ServiceWorkerPolicy";default:return du(r)}}function vB(r){switch(r){case"storageState":return"StorageStatePath";case"viewport":return"ViewportSize";default:return du(r)}}function du(r){return r[0].toUpperCase()+r.slice(1)}function jE(r){let e={...r};return r.recordHar&&(e.recordHarPath=r.recordHar.path,e.recordHarContent=r.recordHar.content,e.recordHarMode=r.recordHar.mode,e.recordHarOmitContent=r.recordHar.omitContent,e.recordHarUrlFilter=r.recordHar.urlFilter,delete e.recordHar),e}function qE(r,e){let t=e&&wB[e];return t?(r=(0,HE.sanitizeDeviceOptions)(t,r),Object.entries(r).length?yr(jE(r),"    ",`BrowserNewContextOptions(playwright.Devices[${fn(e)}])`):`playwright.Devices[${fn(e)}]`):Object.entries(r).length?yr(jE(r),"    ","BrowserNewContextOptions"):""}var Zo=class{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(4),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split(`
`).map(t=>t.trim()).concat(this._lines)}add(e){this._lines.push(...e.trim().split(`
`).map(t=>t.trim()))}newLine(){this._lines.push("")}format(){let e="",t="";return this._lines.map(n=>{if(n==="")return n;(n.startsWith("}")||n.startsWith("]")||n.includes("});")||n===");")&&(e=e.substring(this._baseIndent.length));let s=/^(for|while|if).*\(.*\)$/.test(t)?this._baseIndent:"";return t=n,n=e+s+n,(n.endsWith("{")||n.endsWith("[")||n.endsWith("("))&&(e+=this._baseIndent),n.endsWith("));")&&(e=e.substring(this._baseIndent.length)),this._baseOffset+n}).join(`
`)}};function fn(r){return(0,gB.escapeWithQuotes)(r,'"')}});var VE=M(fu=>{"use strict";Object.defineProperty(fu,"__esModule",{value:!0});fu.PythonLanguageGenerator=void 0;var zE=Qo(),WE=as(),yg=Ht(),bB=Xt(),yB=ls(),xg=class{constructor(e,t){this.id=void 0,this.groupName="Python",this.name=void 0,this.highlighter="python",this._awaitPrefix=void 0,this._asyncPrefix=void 0,this._isAsync=void 0,this._isPyTest=void 0,this.id=t?"python-pytest":e?"python-async":"python",this.name=t?"Pytest":e?"Library Async":"Library",this._isAsync=e,this._isPyTest=t,this._awaitPrefix=e?"await ":"",this._asyncPrefix=e?"async ":""}generateAction(e){let t=e.action;if(this._isPyTest&&(t.name==="openPage"||t.name==="closePage"))return"";let n=e.frame.pageAlias,s=new pu(4);if(t.name==="openPage")return s.add(`${n} = ${this._awaitPrefix}context.new_page()`),t.url&&t.url!=="about:blank"&&t.url!=="chrome://newtab/"&&s.add(`${this._awaitPrefix}${n}.goto(${mn(t.url)})`),s.format();let o;if(e.frame.isMainFrame)o=n;else{let c=e.frame.selectorsChain.map(u=>`.frame_locator(${mn(u)})`);o=`${n}${c.join("")}`}let a=(0,zE.toSignalMap)(t);a.dialog&&s.add(`  ${n}.once("dialog", lambda dialog: dialog.dismiss())`);let l=`${this._awaitPrefix}${this._generateActionCall(o,t)}`;return a.popup&&(l=`${this._asyncPrefix}with ${n}.expect_popup() as ${a.popup.popupAlias}_info {
        ${l}
      }
      ${a.popup.popupAlias} = ${this._awaitPrefix}${a.popup.popupAlias}_info.value`),a.download&&(l=`${this._asyncPrefix}with ${n}.expect_download() as download${a.download.downloadAlias}_info {
        ${l}
      }
      download${a.download.downloadAlias} = ${this._awaitPrefix}download${a.download.downloadAlias}_info.value`),s.add(l),s.format()}_generateActionCall(e,t){switch(t.name){case"openPage":throw Error("Not reached");case"closePage":return`${e}.close()`;case"click":{let n="click";t.clickCount===2&&(n="dblclick");let s=(0,WE.toModifiers)(t.modifiers),o={};t.button!=="left"&&(o.button=t.button),s.length&&(o.modifiers=s),t.clickCount>2&&(o.clickCount=t.clickCount),t.position&&(o.position=t.position);let a=ea(o,!1);return`${e}.${this._asLocator(t.selector)}.${n}(${a})`}case"check":return`${e}.${this._asLocator(t.selector)}.check()`;case"uncheck":return`${e}.${this._asLocator(t.selector)}.uncheck()`;case"fill":return`${e}.${this._asLocator(t.selector)}.fill(${mn(t.text)})`;case"setInputFiles":return`${e}.${this._asLocator(t.selector)}.set_input_files(${ta(t.files.length===1?t.files[0]:t.files)})`;case"press":{let s=[...(0,WE.toModifiers)(t.modifiers),t.key].join("+");return`${e}.${this._asLocator(t.selector)}.press(${mn(s)})`}case"navigate":return`${e}.goto(${mn(t.url)})`;case"select":return`${e}.${this._asLocator(t.selector)}.select_option(${ta(t.options.length===1?t.options[0]:t.options)})`;case"assertText":return`expect(${e}.${this._asLocator(t.selector)}).${t.substring?"to_contain_text":"to_have_text"}(${mn(t.text)})`;case"assertChecked":return`expect(${e}.${this._asLocator(t.selector)}).${t.checked?"to_be_checked()":"not_to_be_checked()"}`;case"assertVisible":return`expect(${e}.${this._asLocator(t.selector)}).to_be_visible()`;case"assertValue":{let n=t.value?`to_have_value(${mn(t.value)})`:"to_be_empty()";return`expect(${e}.${this._asLocator(t.selector)}).${n};`}}}_asLocator(e){return(0,bB.asLocator)("python",e)}generateHeader(e){let t=new pu;if(this._isPyTest){let n=bg(e.contextOptions,e.deviceName,!0),s=n?`

@pytest.fixture(scope="session")
def browser_context_args(browser_context_args, playwright) {
    return {${n}}
}
`:"";t.add(`${e.deviceName?`import pytest
`:""}import re
from playwright.sync_api import Page, expect
${s}

def test_example(page: Page) -> None {`)}else this._isAsync?t.add(`
import asyncio
import re
from playwright.async_api import Playwright, async_playwright, expect


async def run(playwright: Playwright) -> None {
    browser = await playwright.${e.browserName}.launch(${ea(e.launchOptions,!1)})
    context = await browser.new_context(${bg(e.contextOptions,e.deviceName)})`):t.add(`
import re
from playwright.sync_api import Playwright, sync_playwright, expect


def run(playwright: Playwright) -> None {
    browser = playwright.${e.browserName}.launch(${ea(e.launchOptions,!1)})
    context = browser.new_context(${bg(e.contextOptions,e.deviceName)})`);return t.format()}generateFooter(e){return this._isPyTest?"":this._isAsync?`
    # ---------------------${e?`
    await context.storage_state(path=${mn(e)})`:""}
    await context.close()
    await browser.close()


async def main() -> None:
    async with async_playwright() as playwright:
        await run(playwright)


asyncio.run(main())
`:`
    # ---------------------${e?`
    context.storage_state(path=${mn(e)})`:""}
    context.close()
    browser.close()


with sync_playwright() as playwright:
    run(playwright)
`}};fu.PythonLanguageGenerator=xg;function ta(r){return r===!1?"False":r===!0?"True":r===void 0?"None":Array.isArray(r)?`[${r.map(ta).join(", ")}]`:typeof r=="string"?mn(r):typeof r=="object"?JSON.stringify(r):String(r)}function ea(r,e,t){let n=Object.keys(r).filter(s=>r[s]!==void 0).sort();return n.length?(e?", ":"")+n.map(s=>t?`"${(0,yg.toSnakeCase)(s)}": ${ta(r[s])}`:`${(0,yg.toSnakeCase)(s)}=${ta(r[s])}`).join(", "):""}function UE(r){let e={...r};return r.recordHar&&(e.record_har_path=r.recordHar.path,e.record_har_content=r.recordHar.content,e.record_har_mode=r.recordHar.mode,e.record_har_omit_content=r.recordHar.omitContent,e.record_har_url_filter=r.recordHar.urlFilter,delete e.recordHar),e}function bg(r,e,t){let n=e&&yB[e];return n?`**playwright.devices[${mn(e)}]`+ea(UE((0,zE.sanitizeDeviceOptions)(n,r)),!0,t):ea(UE(r),!1,t)}var pu=class{constructor(e=0){this._baseIndent=void 0,this._baseOffset=void 0,this._lines=[],this._baseIndent=" ".repeat(4),this._baseOffset=" ".repeat(e)}prepend(e){this._lines=e.trim().split(`
`).map(t=>t.trim()).concat(this._lines)}add(e){this._lines.push(...e.trim().split(`
`).map(t=>t.trim()))}newLine(){this._lines.push("")}format(){let e="",t=[];return this._lines.forEach(n=>{if(n==="")return t.push(n);if(n==="}"){e=e.substring(this._baseIndent.length);return}return n=e+n,n.endsWith("{")&&(e+=this._baseIndent,n=n.substring(0,n.length-1).trimEnd()+":"),t.push(this._baseOffset+n)}),t.join(`
`)}};function mn(r){return(0,yg.escapeWithQuotes)(r,'"')}});var GE=M(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.source=void 0;var B9=mu.source=`
var __commonJS = obj => {
  let required = false;
  let result;
  return function __require() {
    if (!required) {
      required = true;
      let fn;
      for (const name in obj) { fn = obj[name]; break; }
      const module = { exports: {} };
      fn(module.exports, module);
      result = module.exports;
    }
    return result;
  }
};
var __export = (target, all) => {for (var name in all) target[name] = all[name];};
var __toESM = mod => ({ ...mod, 'default': mod });
var __toCommonJS = mod => ({ ...mod, __esModule: true });


// packages/playwright-core/src/server/injected/recorder/recorder.ts
var recorder_exports = {};
__export(recorder_exports, {
  PollingRecorder: () => PollingRecorder,
  Recorder: () => Recorder,
  default: () => recorder_default
});
module.exports = __toCommonJS(recorder_exports);

// packages/playwright-core/src/server/injected/recorder/clipPaths.ts
var svgJson = { "tagName": "svg", "children": [{ "tagName": "defs", "children": [{ "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-gripper" }, "children": [{ "tagName": "path", "attrs": { "d": "M5 3h2v2H5zm0 4h2v2H5zm0 4h2v2H5zm4-8h2v2H9zm0 4h2v2H9zm0 4h2v2H9z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-circle-large-filled" }, "children": [{ "tagName": "path", "attrs": { "d": "M8 1a6.8 6.8 0 0 1 1.86.253 6.899 6.899 0 0 1 3.083 1.805 6.903 6.903 0 0 1 1.804 3.083C14.916 6.738 15 7.357 15 8s-.084 1.262-.253 1.86a6.9 6.9 0 0 1-.704 1.674 7.157 7.157 0 0 1-2.516 2.509 6.966 6.966 0 0 1-1.668.71A6.984 6.984 0 0 1 8 15a6.984 6.984 0 0 1-1.86-.246 7.098 7.098 0 0 1-1.674-.711 7.3 7.3 0 0 1-1.415-1.094 7.295 7.295 0 0 1-1.094-1.415 7.098 7.098 0 0 1-.71-1.675A6.985 6.985 0 0 1 1 8c0-.643.082-1.262.246-1.86a6.968 6.968 0 0 1 .711-1.667 7.156 7.156 0 0 1 2.509-2.516 6.895 6.895 0 0 1 1.675-.704A6.808 6.808 0 0 1 8 1z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-inspect" }, "children": [{ "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M1 3l1-1h12l1 1v6h-1V3H2v8h5v1H2l-1-1V3zm14.707 9.707L9 6v9.414l2.707-2.707h4zM10 13V8.414l3.293 3.293h-2L10 13z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-whole-word" }, "children": [{ "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M0 11H1V13H15V11H16V14H15H1H0V11Z" } }, { "tagName": "path", "attrs": { "d": "M6.84048 11H5.95963V10.1406H5.93814C5.555 10.7995 4.99104 11.1289 4.24625 11.1289C3.69839 11.1289 3.26871 10.9839 2.95718 10.6938C2.64924 10.4038 2.49527 10.0189 2.49527 9.53906C2.49527 8.51139 3.10041 7.91341 4.3107 7.74512L5.95963 7.51416C5.95963 6.57959 5.58186 6.1123 4.82632 6.1123C4.16389 6.1123 3.56591 6.33789 3.03238 6.78906V5.88672C3.57307 5.54297 4.19612 5.37109 4.90152 5.37109C6.19416 5.37109 6.84048 6.05501 6.84048 7.42285V11ZM5.95963 8.21777L4.63297 8.40039C4.22476 8.45768 3.91682 8.55973 3.70914 8.70654C3.50145 8.84977 3.39761 9.10579 3.39761 9.47461C3.39761 9.74316 3.4925 9.96338 3.68228 10.1353C3.87564 10.3035 4.13166 10.3877 4.45035 10.3877C4.8872 10.3877 5.24706 10.2355 5.52994 9.93115C5.8164 9.62321 5.95963 9.2347 5.95963 8.76562V8.21777Z" } }, { "tagName": "path", "attrs": { "d": "M9.3475 10.2051H9.32601V11H8.44515V2.85742H9.32601V6.4668H9.3475C9.78076 5.73633 10.4146 5.37109 11.2489 5.37109C11.9543 5.37109 12.5057 5.61816 12.9032 6.1123C13.3042 6.60286 13.5047 7.26172 13.5047 8.08887C13.5047 9.00911 13.2809 9.74674 12.8333 10.3018C12.3857 10.8532 11.7734 11.1289 10.9964 11.1289C10.2695 11.1289 9.71989 10.821 9.3475 10.2051ZM9.32601 7.98682V8.75488C9.32601 9.20964 9.47282 9.59635 9.76644 9.91504C10.0636 10.2301 10.4396 10.3877 10.8944 10.3877C11.4279 10.3877 11.8451 10.1836 12.1458 9.77539C12.4502 9.36719 12.6024 8.79964 12.6024 8.07275C12.6024 7.46045 12.4609 6.98063 12.1781 6.6333C11.8952 6.28597 11.512 6.1123 11.0286 6.1123C10.5166 6.1123 10.1048 6.29134 9.7933 6.64941C9.48177 7.00391 9.32601 7.44971 9.32601 7.98682Z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-eye" }, "children": [{ "tagName": "path", "attrs": { "d": "M7.99993 6.00316C9.47266 6.00316 10.6666 7.19708 10.6666 8.66981C10.6666 10.1426 9.47266 11.3365 7.99993 11.3365C6.52715 11.3365 5.33324 10.1426 5.33324 8.66981C5.33324 7.19708 6.52715 6.00316 7.99993 6.00316ZM7.99993 7.00315C7.07946 7.00315 6.33324 7.74935 6.33324 8.66981C6.33324 9.59028 7.07946 10.3365 7.99993 10.3365C8.9204 10.3365 9.6666 9.59028 9.6666 8.66981C9.6666 7.74935 8.9204 7.00315 7.99993 7.00315ZM7.99993 3.66675C11.0756 3.66675 13.7307 5.76675 14.4673 8.70968C14.5344 8.97755 14.3716 9.24908 14.1037 9.31615C13.8358 9.38315 13.5643 9.22041 13.4973 8.95248C12.8713 6.45205 10.6141 4.66675 7.99993 4.66675C5.38454 4.66675 3.12664 6.45359 2.50182 8.95555C2.43491 9.22341 2.16348 9.38635 1.89557 9.31948C1.62766 9.25255 1.46471 8.98115 1.53162 8.71321C2.26701 5.76856 4.9229 3.66675 7.99993 3.66675Z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-symbol-constant" }, "children": [{ "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M4 6h8v1H4V6zm8 3H4v1h8V9z" } }, { "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M1 4l1-1h12l1 1v8l-1 1H2l-1-1V4zm1 0v8h12V4H2z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-check" }, "children": [{ "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M14.431 3.323l-8.47 10-.79-.036-3.35-4.77.818-.574 2.978 4.24 8.051-9.506.764.646z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-close" }, "children": [{ "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M8 8.707l3.646 3.647.708-.707L8.707 8l3.647-3.646-.707-.708L8 7.293 4.354 3.646l-.707.708L7.293 8l-3.646 3.646.707.708L8 8.707z" } }] }, { "tagName": "clipPath", "attrs": { "width": "16", "height": "16", "viewBox": "0 0 16 16", "fill": "currentColor", "id": "icon-pass" }, "children": [{ "tagName": "path", "attrs": { "d": "M6.27 10.87h.71l4.56-4.56-.71-.71-4.2 4.21-1.92-1.92L4 8.6l2.27 2.27z" } }, { "tagName": "path", "attrs": { "fill-rule": "evenodd", "clip-rule": "evenodd", "d": "M8.6 1c1.6.1 3.1.9 4.2 2 1.3 1.4 2 3.1 2 5.1 0 1.6-.6 3.1-1.6 4.4-1 1.2-2.4 2.1-4 2.4-1.6.3-3.2.1-4.6-.7-1.4-.8-2.5-2-3.1-3.5C.9 9.2.8 7.5 1.3 6c.5-1.6 1.4-2.9 2.8-3.8C5.4 1.3 7 .9 8.6 1zm.5 12.9c1.3-.3 2.5-1 3.4-2.1.8-1.1 1.3-2.4 1.2-3.8 0-1.6-.6-3.2-1.7-4.3-1-1-2.2-1.6-3.6-1.7-1.3-.1-2.7.2-3.8 1-1.1.8-1.9 1.9-2.3 3.3-.4 1.3-.4 2.7.2 4 .6 1.3 1.5 2.3 2.7 3 1.2.7 2.6.9 3.9.6z" } }] }] }] };
var clipPaths_default = svgJson;

// packages/playwright-core/src/server/injected/recorder/recorder.ts
var NoneTool = class {
  cursor() {
    return "default";
  }
};
var InspectTool = class {
  constructor(recorder, assertVisibility) {
    this._hoveredModel = null;
    this._hoveredElement = null;
    this._hoveredSelectors = null;
    this._recorder = recorder;
    this._assertVisibility = assertVisibility;
  }
  cursor() {
    return "pointer";
  }
  cleanup() {
    this._hoveredModel = null;
    this._hoveredElement = null;
    this._hoveredSelectors = null;
  }
  onClick(event) {
    var _a;
    consumeEvent(event);
    if (event.button !== 0)
      return;
    if ((_a = this._hoveredModel) == null ? void 0 : _a.selector)
      this._commit(this._hoveredModel.selector);
  }
  onContextMenu(event) {
    if (this._hoveredModel && !this._hoveredModel.tooltipListItemSelected && this._hoveredSelectors && this._hoveredSelectors.length > 1) {
      consumeEvent(event);
      const selectors = this._hoveredSelectors;
      this._hoveredModel.tooltipFooter = void 0;
      this._hoveredModel.tooltipList = selectors.map((selector) => this._recorder.injectedScript.utils.asLocator(this._recorder.state.language, selector));
      this._hoveredModel.tooltipListItemSelected = (index) => {
        if (index === void 0)
          this._reset(true);
        else
          this._commit(selectors[index]);
      };
      this._recorder.updateHighlight(this._hoveredModel, true);
    }
  }
  onPointerDown(event) {
    consumeEvent(event);
  }
  onPointerUp(event) {
    consumeEvent(event);
  }
  onMouseDown(event) {
    consumeEvent(event);
  }
  onMouseUp(event) {
    consumeEvent(event);
  }
  onMouseMove(event) {
    var _a;
    consumeEvent(event);
    let target = this._recorder.deepEventTarget(event);
    if (!target.isConnected)
      target = null;
    if (this._hoveredElement === target)
      return;
    this._hoveredElement = target;
    let model = null;
    let selectors = [];
    if (this._hoveredElement) {
      const generated = this._recorder.injectedScript.generateSelector(this._hoveredElement, { testIdAttributeName: this._recorder.state.testIdAttributeName, multiple: false });
      selectors = generated.selectors;
      model = {
        selector: generated.selector,
        elements: generated.elements,
        tooltipText: this._recorder.injectedScript.utils.asLocator(this._recorder.state.language, generated.selector),
        tooltipFooter: selectors.length > 1 ? \`Click to select, right-click for more options\` : void 0,
        color: this._assertVisibility ? "#8acae480" : void 0
      };
    }
    if (((_a = this._hoveredModel) == null ? void 0 : _a.selector) === (model == null ? void 0 : model.selector))
      return;
    this._hoveredModel = model;
    this._hoveredSelectors = selectors;
    this._recorder.updateHighlight(model, true);
  }
  onMouseEnter(event) {
    consumeEvent(event);
  }
  onMouseLeave(event) {
    consumeEvent(event);
    const window = this._recorder.injectedScript.window;
    if (window.top !== window && this._recorder.deepEventTarget(event).nodeType === Node.DOCUMENT_NODE)
      this._reset(true);
  }
  onKeyDown(event) {
    var _a, _b, _c;
    consumeEvent(event);
    if (event.key === "Escape") {
      if ((_a = this._hoveredModel) == null ? void 0 : _a.tooltipListItemSelected)
        this._reset(true);
      else if (this._assertVisibility)
        (_c = (_b = this._recorder.delegate).setMode) == null ? void 0 : _c.call(_b, "recording");
    }
  }
  onKeyUp(event) {
    consumeEvent(event);
  }
  onScroll(event) {
    this._reset(false);
  }
  _commit(selector) {
    var _a, _b, _c, _d, _e, _f, _g;
    if (this._assertVisibility) {
      (_b = (_a = this._recorder.delegate).recordAction) == null ? void 0 : _b.call(_a, {
        name: "assertVisible",
        selector,
        signals: []
      });
      (_d = (_c = this._recorder.delegate).setMode) == null ? void 0 : _d.call(_c, "recording");
      (_e = this._recorder.overlay) == null ? void 0 : _e.flashToolSucceeded("assertingVisibility");
    } else {
      (_g = (_f = this._recorder.delegate).setSelector) == null ? void 0 : _g.call(_f, selector);
    }
  }
  _reset(userGesture) {
    this._hoveredElement = null;
    this._hoveredModel = null;
    this._hoveredSelectors = null;
    this._recorder.updateHighlight(null, userGesture);
  }
};
var RecordActionTool = class {
  constructor(recorder) {
    this._performingAction = false;
    this._hoveredModel = null;
    this._hoveredElement = null;
    this._activeModel = null;
    this._expectProgrammaticKeyUp = false;
    this._recorder = recorder;
  }
  cursor() {
    return "pointer";
  }
  cleanup() {
    this._hoveredModel = null;
    this._hoveredElement = null;
    this._activeModel = null;
    this._expectProgrammaticKeyUp = false;
  }
  onClick(event) {
    if (isRangeInput(this._hoveredElement))
      return;
    if (this._shouldIgnoreMouseEvent(event))
      return;
    if (this._actionInProgress(event))
      return;
    if (this._consumedDueToNoModel(event, this._hoveredModel))
      return;
    const checkbox = asCheckbox(this._recorder.deepEventTarget(event));
    if (checkbox) {
      this._performAction({
        name: checkbox.checked ? "check" : "uncheck",
        selector: this._hoveredModel.selector,
        signals: []
      });
      return;
    }
    this._performAction({
      name: "click",
      selector: this._hoveredModel.selector,
      position: positionForEvent(event),
      signals: [],
      button: buttonForEvent(event),
      modifiers: modifiersForEvent(event),
      clickCount: event.detail
    });
  }
  onPointerDown(event) {
    if (this._shouldIgnoreMouseEvent(event))
      return;
    if (!this._performingAction)
      consumeEvent(event);
  }
  onPointerUp(event) {
    if (this._shouldIgnoreMouseEvent(event))
      return;
    if (!this._performingAction)
      consumeEvent(event);
  }
  onMouseDown(event) {
    if (this._shouldIgnoreMouseEvent(event))
      return;
    if (!this._performingAction)
      consumeEvent(event);
    this._activeModel = this._hoveredModel;
  }
  onMouseUp(event) {
    if (this._shouldIgnoreMouseEvent(event))
      return;
    if (!this._performingAction)
      consumeEvent(event);
  }
  onMouseMove(event) {
    const target = this._recorder.deepEventTarget(event);
    if (this._hoveredElement === target)
      return;
    this._hoveredElement = target;
    this._updateModelForHoveredElement();
  }
  onMouseLeave(event) {
    const window = this._recorder.injectedScript.window;
    if (window.top !== window && this._recorder.deepEventTarget(event).nodeType === Node.DOCUMENT_NODE) {
      this._hoveredElement = null;
      this._updateModelForHoveredElement();
    }
  }
  onFocus(event) {
    this._onFocus(true);
  }
  onInput(event) {
    var _a, _b, _c, _d, _e, _f;
    const target = this._recorder.deepEventTarget(event);
    if (target.nodeName === "INPUT" && target.type.toLowerCase() === "file") {
      (_b = (_a = this._recorder.delegate).recordAction) == null ? void 0 : _b.call(_a, {
        name: "setInputFiles",
        selector: this._activeModel.selector,
        signals: [],
        files: [...target.files || []].map((file) => file.name)
      });
      return;
    }
    if (isRangeInput(target)) {
      (_d = (_c = this._recorder.delegate).recordAction) == null ? void 0 : _d.call(_c, {
        name: "fill",
        // must use hoveredModel instead of activeModel for it to work in webkit
        selector: this._hoveredModel.selector,
        signals: [],
        text: target.value
      });
      return;
    }
    if (["INPUT", "TEXTAREA"].includes(target.nodeName) || target.isContentEditable) {
      if (target.nodeName === "INPUT" && ["checkbox", "radio"].includes(target.type.toLowerCase())) {
        return;
      }
      if (this._consumedDueWrongTarget(event))
        return;
      (_f = (_e = this._recorder.delegate).recordAction) == null ? void 0 : _f.call(_e, {
        name: "fill",
        selector: this._activeModel.selector,
        signals: [],
        text: target.isContentEditable ? target.innerText : target.value
      });
    }
    if (target.nodeName === "SELECT") {
      const selectElement = target;
      if (this._actionInProgress(event))
        return;
      this._performAction({
        name: "select",
        selector: this._hoveredModel.selector,
        options: [...selectElement.selectedOptions].map((option) => option.value),
        signals: []
      });
    }
  }
  onKeyDown(event) {
    if (!this._shouldGenerateKeyPressFor(event))
      return;
    if (this._actionInProgress(event)) {
      this._expectProgrammaticKeyUp = true;
      return;
    }
    if (this._consumedDueWrongTarget(event))
      return;
    if (event.key === " ") {
      const checkbox = asCheckbox(this._recorder.deepEventTarget(event));
      if (checkbox) {
        this._performAction({
          name: checkbox.checked ? "uncheck" : "check",
          selector: this._activeModel.selector,
          signals: []
        });
        return;
      }
    }
    this._performAction({
      name: "press",
      selector: this._activeModel.selector,
      signals: [],
      key: event.key,
      modifiers: modifiersForEvent(event)
    });
  }
  onKeyUp(event) {
    if (!this._shouldGenerateKeyPressFor(event))
      return;
    if (!this._expectProgrammaticKeyUp) {
      consumeEvent(event);
      return;
    }
    this._expectProgrammaticKeyUp = false;
  }
  onScroll(event) {
    this._hoveredModel = null;
    this._hoveredElement = null;
    this._recorder.updateHighlight(null, false);
  }
  _onFocus(userGesture) {
    const activeElement = deepActiveElement(this._recorder.document);
    if (userGesture && activeElement === this._recorder.document.body)
      return;
    const result = activeElement ? this._recorder.injectedScript.generateSelector(activeElement, { testIdAttributeName: this._recorder.state.testIdAttributeName }) : null;
    this._activeModel = result && result.selector ? result : null;
    if (userGesture)
      this._hoveredElement = activeElement;
    this._updateModelForHoveredElement();
  }
  _shouldIgnoreMouseEvent(event) {
    const target = this._recorder.deepEventTarget(event);
    const nodeName = target.nodeName;
    if (nodeName === "SELECT" || nodeName === "OPTION")
      return true;
    if (nodeName === "INPUT" && ["date", "range"].includes(target.type))
      return true;
    return false;
  }
  _actionInProgress(event) {
    if (this._performingAction)
      return true;
    consumeEvent(event);
    return false;
  }
  _consumedDueToNoModel(event, model) {
    if (model)
      return false;
    consumeEvent(event);
    return true;
  }
  _consumedDueWrongTarget(event) {
    if (this._activeModel && this._activeModel.elements[0] === this._recorder.deepEventTarget(event))
      return false;
    consumeEvent(event);
    return true;
  }
  async _performAction(action) {
    var _a, _b;
    this._hoveredElement = null;
    this._hoveredModel = null;
    this._activeModel = null;
    this._recorder.updateHighlight(null, false);
    this._performingAction = true;
    await ((_b = (_a = this._recorder.delegate).performAction) == null ? void 0 : _b.call(_a, action).catch(() => {
    }));
    this._performingAction = false;
    this._onFocus(false);
    if (this._recorder.injectedScript.isUnderTest) {
      console.error("Action performed for test: " + JSON.stringify({
        // eslint-disable-line no-console
        hovered: this._hoveredModel ? this._hoveredModel.selector : null,
        active: this._activeModel ? this._activeModel.selector : null
      }));
    }
  }
  _shouldGenerateKeyPressFor(event) {
    if (event.key === "Enter" && (this._recorder.deepEventTarget(event).nodeName === "TEXTAREA" || this._recorder.deepEventTarget(event).isContentEditable))
      return false;
    if (["Backspace", "Delete", "AltGraph"].includes(event.key))
      return false;
    if (event.key === "@" && event.code === "KeyL")
      return false;
    if (navigator.platform.includes("Mac")) {
      if (event.key === "v" && event.metaKey)
        return false;
    } else {
      if (event.key === "v" && event.ctrlKey)
        return false;
      if (event.key === "Insert" && event.shiftKey)
        return false;
    }
    if (["Shift", "Control", "Meta", "Alt", "Process"].includes(event.key))
      return false;
    const hasModifier = event.ctrlKey || event.altKey || event.metaKey;
    if (event.key.length === 1 && !hasModifier)
      return !!asCheckbox(this._recorder.deepEventTarget(event));
    return true;
  }
  _updateModelForHoveredElement() {
    if (!this._hoveredElement || !this._hoveredElement.isConnected) {
      this._hoveredModel = null;
      this._hoveredElement = null;
      this._recorder.updateHighlight(null, true);
      return;
    }
    const { selector, elements } = this._recorder.injectedScript.generateSelector(this._hoveredElement, { testIdAttributeName: this._recorder.state.testIdAttributeName });
    if (this._hoveredModel && this._hoveredModel.selector === selector)
      return;
    this._hoveredModel = selector ? { selector, elements, color: "#dc6f6f7f" } : null;
    this._recorder.updateHighlight(this._hoveredModel, true);
  }
};
var TextAssertionTool = class {
  constructor(recorder, kind) {
    this._hoverHighlight = null;
    this._action = null;
    this._dialogElement = null;
    this._textCache = /* @__PURE__ */ new Map();
    this._recorder = recorder;
    this._kind = kind;
    this._acceptButton = this._recorder.document.createElement("x-pw-tool-item");
    this._acceptButton.title = "Accept";
    this._acceptButton.classList.add("accept");
    this._acceptButton.appendChild(this._recorder.document.createElement("x-div"));
    this._acceptButton.addEventListener("click", () => this._commit());
    this._cancelButton = this._recorder.document.createElement("x-pw-tool-item");
    this._cancelButton.title = "Close";
    this._cancelButton.classList.add("cancel");
    this._cancelButton.appendChild(this._recorder.document.createElement("x-div"));
    this._cancelButton.addEventListener("click", () => this._closeDialog());
  }
  cursor() {
    return "pointer";
  }
  cleanup() {
    this._closeDialog();
    this._hoverHighlight = null;
  }
  onClick(event) {
    consumeEvent(event);
    if (this._kind === "value") {
      this._commitAssertValue();
    } else {
      if (!this._dialogElement)
        this._showDialog();
    }
  }
  onMouseDown(event) {
    const target = this._recorder.deepEventTarget(event);
    if (this._elementHasValue(target))
      event.preventDefault();
  }
  onPointerUp(event) {
    var _a;
    const target = (_a = this._hoverHighlight) == null ? void 0 : _a.elements[0];
    if (this._kind === "value" && target && target.nodeName === "INPUT" && target.disabled) {
      this._commitAssertValue();
    }
  }
  onMouseMove(event) {
    var _a;
    if (this._dialogElement)
      return;
    const target = this._recorder.deepEventTarget(event);
    if (((_a = this._hoverHighlight) == null ? void 0 : _a.elements[0]) === target)
      return;
    if (this._kind === "text")
      this._hoverHighlight = this._recorder.injectedScript.utils.elementText(this._textCache, target).full ? { elements: [target], selector: "" } : null;
    else
      this._hoverHighlight = this._elementHasValue(target) ? this._recorder.injectedScript.generateSelector(target, { testIdAttributeName: this._recorder.state.testIdAttributeName }) : null;
    if (this._hoverHighlight)
      this._hoverHighlight.color = "#8acae480";
    this._recorder.updateHighlight(this._hoverHighlight, true);
  }
  onKeyDown(event) {
    var _a, _b;
    if (event.key === "Escape")
      (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, "recording");
    consumeEvent(event);
  }
  onScroll(event) {
    this._recorder.updateHighlight(this._hoverHighlight, false);
  }
  _elementHasValue(element) {
    return element.nodeName === "TEXTAREA" || element.nodeName === "SELECT" || element.nodeName === "INPUT" && !["button", "image", "reset", "submit"].includes(element.type);
  }
  _generateAction() {
    var _a;
    this._textCache.clear();
    const target = (_a = this._hoverHighlight) == null ? void 0 : _a.elements[0];
    if (!target)
      return null;
    if (this._kind === "value") {
      if (!this._elementHasValue(target))
        return null;
      const { selector } = this._recorder.injectedScript.generateSelector(target, { testIdAttributeName: this._recorder.state.testIdAttributeName });
      if (target.nodeName === "INPUT" && ["checkbox", "radio"].includes(target.type.toLowerCase())) {
        return {
          name: "assertChecked",
          selector,
          signals: [],
          // Interestingly, inputElement.checked is reversed inside this event handler.
          checked: !target.checked
        };
      } else {
        return {
          name: "assertValue",
          selector,
          signals: [],
          value: target.value
        };
      }
    } else {
      this._hoverHighlight = this._recorder.injectedScript.generateSelector(target, { testIdAttributeName: this._recorder.state.testIdAttributeName, forTextExpect: true });
      this._hoverHighlight.color = "#8acae480";
      this._recorder.updateHighlight(this._hoverHighlight, true);
      return {
        name: "assertText",
        selector: this._hoverHighlight.selector,
        signals: [],
        text: this._recorder.injectedScript.utils.elementText(this._textCache, target).normalized,
        substring: true
      };
    }
  }
  _renderValue(action) {
    if ((action == null ? void 0 : action.name) === "assertText")
      return this._recorder.injectedScript.utils.normalizeWhiteSpace(action.text);
    if ((action == null ? void 0 : action.name) === "assertChecked")
      return String(action.checked);
    if ((action == null ? void 0 : action.name) === "assertValue")
      return action.value;
    return "";
  }
  _commit() {
    var _a, _b, _c, _d;
    if (!this._action || !this._dialogElement)
      return;
    this._closeDialog();
    (_b = (_a = this._recorder.delegate).recordAction) == null ? void 0 : _b.call(_a, this._action);
    (_d = (_c = this._recorder.delegate).setMode) == null ? void 0 : _d.call(_c, "recording");
  }
  _showDialog() {
    var _a;
    if (!((_a = this._hoverHighlight) == null ? void 0 : _a.elements[0]))
      return;
    this._action = this._generateAction();
    if (!this._action || this._action.name !== "assertText")
      return;
    this._dialogElement = this._recorder.document.createElement("x-pw-dialog");
    this._keyboardListener = (event) => {
      if (event.key === "Escape") {
        this._closeDialog();
        return;
      }
      if (event.key === "Enter" && (event.ctrlKey || event.metaKey)) {
        if (this._dialogElement)
          this._commit();
        return;
      }
    };
    this._recorder.document.addEventListener("keydown", this._keyboardListener, true);
    const toolbarElement = this._recorder.document.createElement("x-pw-tools-list");
    const labelElement = this._recorder.document.createElement("label");
    labelElement.textContent = "Assert that element contains text";
    toolbarElement.appendChild(labelElement);
    toolbarElement.appendChild(this._recorder.document.createElement("x-spacer"));
    toolbarElement.appendChild(this._acceptButton);
    toolbarElement.appendChild(this._cancelButton);
    this._dialogElement.appendChild(toolbarElement);
    const bodyElement = this._recorder.document.createElement("x-pw-dialog-body");
    const action = this._action;
    const textElement = this._recorder.document.createElement("textarea");
    textElement.setAttribute("spellcheck", "false");
    textElement.value = this._renderValue(this._action);
    textElement.classList.add("text-editor");
    const updateAndValidate = () => {
      var _a2;
      const newValue = this._recorder.injectedScript.utils.normalizeWhiteSpace(textElement.value);
      const target = (_a2 = this._hoverHighlight) == null ? void 0 : _a2.elements[0];
      if (!target)
        return;
      action.text = newValue;
      const targetText = this._recorder.injectedScript.utils.elementText(this._textCache, target).normalized;
      const matches = newValue && targetText.includes(newValue);
      textElement.classList.toggle("does-not-match", !matches);
    };
    textElement.addEventListener("input", updateAndValidate);
    bodyElement.appendChild(textElement);
    this._dialogElement.appendChild(bodyElement);
    this._recorder.highlight.appendChild(this._dialogElement);
    const position = this._recorder.highlight.tooltipPosition(this._recorder.highlight.firstBox(), this._dialogElement);
    this._dialogElement.style.top = position.anchorTop + "px";
    this._dialogElement.style.left = position.anchorLeft + "px";
    textElement.focus();
  }
  _closeDialog() {
    if (!this._dialogElement)
      return;
    this._dialogElement.remove();
    this._recorder.document.removeEventListener("keydown", this._keyboardListener);
    this._dialogElement = null;
  }
  _commitAssertValue() {
    var _a, _b, _c, _d, _e;
    if (this._kind !== "value")
      return;
    const action = this._generateAction();
    if (!action)
      return;
    (_b = (_a = this._recorder.delegate).recordAction) == null ? void 0 : _b.call(_a, action);
    (_d = (_c = this._recorder.delegate).setMode) == null ? void 0 : _d.call(_c, "recording");
    (_e = this._recorder.overlay) == null ? void 0 : _e.flashToolSucceeded("assertingValue");
  }
};
var Overlay = class {
  constructor(recorder) {
    this._listeners = [];
    this._offsetX = 0;
    this._measure = { width: 0, height: 0 };
    this._recorder = recorder;
    const document = this._recorder.document;
    this._overlayElement = document.createElement("x-pw-overlay");
    this._overlayElement.appendChild(createSvgElement(this._recorder.document, clipPaths_default));
    const toolsListElement = document.createElement("x-pw-tools-list");
    this._overlayElement.appendChild(toolsListElement);
    this._dragHandle = document.createElement("x-pw-tool-gripper");
    this._dragHandle.appendChild(document.createElement("x-div"));
    toolsListElement.appendChild(this._dragHandle);
    this._recordToggle = this._recorder.document.createElement("x-pw-tool-item");
    this._recordToggle.title = "Record";
    this._recordToggle.classList.add("record");
    this._recordToggle.appendChild(this._recorder.document.createElement("x-div"));
    toolsListElement.appendChild(this._recordToggle);
    this._pickLocatorToggle = this._recorder.document.createElement("x-pw-tool-item");
    this._pickLocatorToggle.title = "Pick locator";
    this._pickLocatorToggle.classList.add("pick-locator");
    this._pickLocatorToggle.appendChild(this._recorder.document.createElement("x-div"));
    toolsListElement.appendChild(this._pickLocatorToggle);
    this._assertVisibilityToggle = this._recorder.document.createElement("x-pw-tool-item");
    this._assertVisibilityToggle.title = "Assert visibility";
    this._assertVisibilityToggle.classList.add("visibility");
    this._assertVisibilityToggle.appendChild(this._recorder.document.createElement("x-div"));
    toolsListElement.appendChild(this._assertVisibilityToggle);
    this._assertTextToggle = this._recorder.document.createElement("x-pw-tool-item");
    this._assertTextToggle.title = "Assert text";
    this._assertTextToggle.classList.add("text");
    this._assertTextToggle.appendChild(this._recorder.document.createElement("x-div"));
    toolsListElement.appendChild(this._assertTextToggle);
    this._assertValuesToggle = this._recorder.document.createElement("x-pw-tool-item");
    this._assertValuesToggle.title = "Assert value";
    this._assertValuesToggle.classList.add("value");
    this._assertValuesToggle.appendChild(this._recorder.document.createElement("x-div"));
    toolsListElement.appendChild(this._assertValuesToggle);
    this._updateVisualPosition();
    this._refreshListeners();
  }
  _refreshListeners() {
    removeEventListeners(this._listeners);
    this._listeners = [
      addEventListener(this._dragHandle, "mousedown", (event) => {
        this._dragState = { offsetX: this._offsetX, dragStart: { x: event.clientX, y: 0 } };
      }),
      addEventListener(this._recordToggle, "click", () => {
        var _a, _b;
        (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, this._recorder.state.mode === "none" || this._recorder.state.mode === "standby" || this._recorder.state.mode === "inspecting" ? "recording" : "standby");
      }),
      addEventListener(this._pickLocatorToggle, "click", () => {
        var _a, _b;
        const newMode = {
          "inspecting": "standby",
          "none": "inspecting",
          "standby": "inspecting",
          "recording": "recording-inspecting",
          "recording-inspecting": "recording",
          "assertingText": "recording-inspecting",
          "assertingVisibility": "recording-inspecting",
          "assertingValue": "recording-inspecting"
        };
        (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, newMode[this._recorder.state.mode]);
      }),
      addEventListener(this._assertVisibilityToggle, "click", () => {
        var _a, _b;
        if (!this._assertVisibilityToggle.classList.contains("disabled"))
          (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, this._recorder.state.mode === "assertingVisibility" ? "recording" : "assertingVisibility");
      }),
      addEventListener(this._assertTextToggle, "click", () => {
        var _a, _b;
        if (!this._assertTextToggle.classList.contains("disabled"))
          (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, this._recorder.state.mode === "assertingText" ? "recording" : "assertingText");
      }),
      addEventListener(this._assertValuesToggle, "click", () => {
        var _a, _b;
        if (!this._assertValuesToggle.classList.contains("disabled"))
          (_b = (_a = this._recorder.delegate).setMode) == null ? void 0 : _b.call(_a, this._recorder.state.mode === "assertingValue" ? "recording" : "assertingValue");
      })
    ];
  }
  install() {
    this._recorder.highlight.appendChild(this._overlayElement);
    this._refreshListeners();
    this._updateVisualPosition();
  }
  contains(element) {
    return this._recorder.injectedScript.utils.isInsideScope(this._overlayElement, element);
  }
  setUIState(state) {
    this._recordToggle.classList.toggle("active", state.mode === "recording" || state.mode === "assertingText" || state.mode === "assertingVisibility" || state.mode === "assertingValue" || state.mode === "recording-inspecting");
    this._pickLocatorToggle.classList.toggle("active", state.mode === "inspecting" || state.mode === "recording-inspecting");
    this._assertVisibilityToggle.classList.toggle("active", state.mode === "assertingVisibility");
    this._assertVisibilityToggle.classList.toggle("disabled", state.mode === "none" || state.mode === "standby" || state.mode === "inspecting");
    this._assertTextToggle.classList.toggle("active", state.mode === "assertingText");
    this._assertTextToggle.classList.toggle("disabled", state.mode === "none" || state.mode === "standby" || state.mode === "inspecting");
    this._assertValuesToggle.classList.toggle("active", state.mode === "assertingValue");
    this._assertValuesToggle.classList.toggle("disabled", state.mode === "none" || state.mode === "standby" || state.mode === "inspecting");
    if (this._offsetX !== state.overlay.offsetX) {
      this._offsetX = state.overlay.offsetX;
      this._updateVisualPosition();
    }
    if (state.mode === "none")
      this._hideOverlay();
    else
      this._showOverlay();
  }
  flashToolSucceeded(tool) {
    const element = tool === "assertingVisibility" ? this._assertVisibilityToggle : this._assertValuesToggle;
    element.classList.add("succeeded");
    setTimeout(() => element.classList.remove("succeeded"), 2e3);
  }
  _hideOverlay() {
    this._overlayElement.setAttribute("hidden", "true");
  }
  _showOverlay() {
    if (!this._overlayElement.hasAttribute("hidden"))
      return;
    this._overlayElement.removeAttribute("hidden");
    this._updateVisualPosition();
  }
  _updateVisualPosition() {
    this._measure = this._overlayElement.getBoundingClientRect();
    this._overlayElement.style.left = (this._recorder.injectedScript.window.innerWidth - this._measure.width) / 2 + this._offsetX + "px";
  }
  onMouseMove(event) {
    var _a, _b;
    if (!event.buttons) {
      this._dragState = void 0;
      return false;
    }
    if (this._dragState) {
      this._offsetX = this._dragState.offsetX + event.clientX - this._dragState.dragStart.x;
      const halfGapSize = (this._recorder.injectedScript.window.innerWidth - this._measure.width) / 2 - 10;
      this._offsetX = Math.max(-halfGapSize, Math.min(halfGapSize, this._offsetX));
      this._updateVisualPosition();
      (_b = (_a = this._recorder.delegate).setOverlayState) == null ? void 0 : _b.call(_a, { offsetX: this._offsetX });
      consumeEvent(event);
      return true;
    }
    return false;
  }
  onMouseUp(event) {
    if (this._dragState) {
      consumeEvent(event);
      return true;
    }
    return false;
  }
  onClick(event) {
    if (this._dragState) {
      this._dragState = void 0;
      consumeEvent(event);
      return true;
    }
    return false;
  }
};
var Recorder = class {
  constructor(injectedScript) {
    this._listeners = [];
    this._actionSelectorModel = null;
    this.state = { mode: "none", testIdAttributeName: "data-testid", language: "javascript", overlay: { offsetX: 0 } };
    this.delegate = {};
    this.document = injectedScript.document;
    this.injectedScript = injectedScript;
    this.highlight = injectedScript.createHighlight();
    this._tools = {
      "none": new NoneTool(),
      "standby": new NoneTool(),
      "inspecting": new InspectTool(this, false),
      "recording": new RecordActionTool(this),
      "recording-inspecting": new InspectTool(this, false),
      "assertingText": new TextAssertionTool(this, "text"),
      "assertingVisibility": new InspectTool(this, true),
      "assertingValue": new TextAssertionTool(this, "value")
    };
    this._currentTool = this._tools.none;
    if (injectedScript.window.top === injectedScript.window) {
      this.overlay = new Overlay(this);
      this.overlay.setUIState(this.state);
    }
    this._stylesheet = new injectedScript.window.CSSStyleSheet();
    this._stylesheet.replaceSync(\`
      body[data-pw-cursor=pointer] *, body[data-pw-cursor=pointer] *::after { cursor: pointer !important; }
      body[data-pw-cursor=text] *, body[data-pw-cursor=text] *::after { cursor: text !important; }
    \`);
    this.installListeners();
    if (injectedScript.isUnderTest)
      console.error("Recorder script ready for test");
  }
  installListeners() {
    var _a;
    removeEventListeners(this._listeners);
    this._listeners = [
      addEventListener(this.document, "click", (event) => this._onClick(event), true),
      addEventListener(this.document, "auxclick", (event) => this._onClick(event), true),
      addEventListener(this.document, "contextmenu", (event) => this._onContextMenu(event), true),
      addEventListener(this.document, "dragstart", (event) => this._onDragStart(event), true),
      addEventListener(this.document, "input", (event) => this._onInput(event), true),
      addEventListener(this.document, "keydown", (event) => this._onKeyDown(event), true),
      addEventListener(this.document, "keyup", (event) => this._onKeyUp(event), true),
      addEventListener(this.document, "pointerdown", (event) => this._onPointerDown(event), true),
      addEventListener(this.document, "pointerup", (event) => this._onPointerUp(event), true),
      addEventListener(this.document, "mousedown", (event) => this._onMouseDown(event), true),
      addEventListener(this.document, "mouseup", (event) => this._onMouseUp(event), true),
      addEventListener(this.document, "mousemove", (event) => this._onMouseMove(event), true),
      addEventListener(this.document, "mouseleave", (event) => this._onMouseLeave(event), true),
      addEventListener(this.document, "mouseenter", (event) => this._onMouseEnter(event), true),
      addEventListener(this.document, "focus", (event) => this._onFocus(event), true),
      addEventListener(this.document, "scroll", (event) => this._onScroll(event), true)
    ];
    this.highlight.install();
    (_a = this.overlay) == null ? void 0 : _a.install();
    this.document.adoptedStyleSheets.push(this._stylesheet);
  }
  _switchCurrentTool() {
    var _a, _b, _c;
    const newTool = this._tools[this.state.mode];
    if (newTool === this._currentTool)
      return;
    (_b = (_a = this._currentTool).cleanup) == null ? void 0 : _b.call(_a);
    this.clearHighlight();
    this._currentTool = newTool;
    (_c = this.injectedScript.document.body) == null ? void 0 : _c.setAttribute("data-pw-cursor", newTool.cursor());
  }
  setUIState(state, delegate) {
    var _a, _b, _c, _d;
    this.delegate = delegate;
    if (state.actionPoint && this.state.actionPoint && state.actionPoint.x === this.state.actionPoint.x && state.actionPoint.y === this.state.actionPoint.y) {
    } else if (!state.actionPoint && !this.state.actionPoint) {
    } else {
      if (state.actionPoint)
        this.highlight.showActionPoint(state.actionPoint.x, state.actionPoint.y);
      else
        this.highlight.hideActionPoint();
    }
    this.state = state;
    this.highlight.setLanguage(state.language);
    this._switchCurrentTool();
    (_a = this.overlay) == null ? void 0 : _a.setUIState(state);
    if (((_b = this._actionSelectorModel) == null ? void 0 : _b.selector) && !((_c = this._actionSelectorModel) == null ? void 0 : _c.elements.length))
      this._actionSelectorModel = null;
    if (state.actionSelector !== ((_d = this._actionSelectorModel) == null ? void 0 : _d.selector))
      this._actionSelectorModel = state.actionSelector ? querySelector(this.injectedScript, state.actionSelector, this.document) : null;
    if (this.state.mode === "none" || this.state.mode === "standby")
      this.updateHighlight(this._actionSelectorModel, false);
  }
  clearHighlight() {
    var _a, _b;
    (_b = (_a = this._currentTool).cleanup) == null ? void 0 : _b.call(_a);
    this.updateHighlight(null, false);
  }
  _onClick(event) {
    var _a, _b, _c;
    if (!event.isTrusted)
      return;
    if ((_a = this.overlay) == null ? void 0 : _a.onClick(event))
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_c = (_b = this._currentTool).onClick) == null ? void 0 : _c.call(_b, event);
  }
  _onContextMenu(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onContextMenu) == null ? void 0 : _b.call(_a, event);
  }
  _onDragStart(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onDragStart) == null ? void 0 : _b.call(_a, event);
  }
  _onPointerDown(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onPointerDown) == null ? void 0 : _b.call(_a, event);
  }
  _onPointerUp(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onPointerUp) == null ? void 0 : _b.call(_a, event);
  }
  _onMouseDown(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onMouseDown) == null ? void 0 : _b.call(_a, event);
  }
  _onMouseUp(event) {
    var _a, _b, _c;
    if (!event.isTrusted)
      return;
    if ((_a = this.overlay) == null ? void 0 : _a.onMouseUp(event))
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_c = (_b = this._currentTool).onMouseUp) == null ? void 0 : _c.call(_b, event);
  }
  _onMouseMove(event) {
    var _a, _b, _c;
    if (!event.isTrusted)
      return;
    if ((_a = this.overlay) == null ? void 0 : _a.onMouseMove(event))
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_c = (_b = this._currentTool).onMouseMove) == null ? void 0 : _c.call(_b, event);
  }
  _onMouseEnter(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onMouseEnter) == null ? void 0 : _b.call(_a, event);
  }
  _onMouseLeave(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onMouseLeave) == null ? void 0 : _b.call(_a, event);
  }
  _onFocus(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onFocus) == null ? void 0 : _b.call(_a, event);
  }
  _onScroll(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    this.highlight.hideActionPoint();
    (_b = (_a = this._currentTool).onScroll) == null ? void 0 : _b.call(_a, event);
  }
  _onInput(event) {
    var _a, _b;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onInput) == null ? void 0 : _b.call(_a, event);
  }
  _onKeyDown(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onKeyDown) == null ? void 0 : _b.call(_a, event);
  }
  _onKeyUp(event) {
    var _a, _b;
    if (!event.isTrusted)
      return;
    if (this._ignoreOverlayEvent(event))
      return;
    (_b = (_a = this._currentTool).onKeyUp) == null ? void 0 : _b.call(_a, event);
  }
  updateHighlight(model, userGesture) {
    var _a, _b;
    let tooltipText = model == null ? void 0 : model.tooltipText;
    if (tooltipText === void 0 && !(model == null ? void 0 : model.tooltipList) && (model == null ? void 0 : model.selector))
      tooltipText = this.injectedScript.utils.asLocator(this.state.language, model.selector);
    this.highlight.updateHighlight((model == null ? void 0 : model.elements) || [], { ...model, tooltipText });
    if (userGesture)
      (_b = (_a = this.delegate).highlightUpdated) == null ? void 0 : _b.call(_a);
  }
  _ignoreOverlayEvent(event) {
    return event.composedPath().some((e) => {
      const nodeName = e.nodeName || "";
      return nodeName.toLowerCase() === "x-pw-glass";
    });
  }
  deepEventTarget(event) {
    var _a;
    for (const element of event.composedPath()) {
      if (!((_a = this.overlay) == null ? void 0 : _a.contains(element)))
        return element;
    }
    return event.composedPath()[0];
  }
};
function deepActiveElement(document) {
  let activeElement = document.activeElement;
  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)
    activeElement = activeElement.shadowRoot.activeElement;
  return activeElement;
}
function modifiersForEvent(event) {
  return (event.altKey ? 1 : 0) | (event.ctrlKey ? 2 : 0) | (event.metaKey ? 4 : 0) | (event.shiftKey ? 8 : 0);
}
function buttonForEvent(event) {
  switch (event.which) {
    case 1:
      return "left";
    case 2:
      return "middle";
    case 3:
      return "right";
  }
  return "left";
}
function positionForEvent(event) {
  const targetElement = event.target;
  if (targetElement.nodeName !== "CANVAS")
    return;
  return {
    x: event.offsetX,
    y: event.offsetY
  };
}
function consumeEvent(e) {
  e.preventDefault();
  e.stopPropagation();
  e.stopImmediatePropagation();
}
function asCheckbox(node) {
  if (!node || node.nodeName !== "INPUT")
    return null;
  const inputElement = node;
  return ["checkbox", "radio"].includes(inputElement.type) ? inputElement : null;
}
function isRangeInput(node) {
  if (!node || node.nodeName !== "INPUT")
    return false;
  const inputElement = node;
  return inputElement.type.toLowerCase() === "range";
}
function addEventListener(target, eventName, listener, useCapture) {
  target.addEventListener(eventName, listener, useCapture);
  const remove = () => {
    target.removeEventListener(eventName, listener, useCapture);
  };
  return remove;
}
function removeEventListeners(listeners) {
  for (const listener of listeners)
    listener();
  listeners.splice(0, listeners.length);
}
function querySelector(injectedScript, selector, ownerDocument) {
  try {
    const parsedSelector = injectedScript.parseSelector(selector);
    return {
      selector,
      elements: injectedScript.querySelectorAll(parsedSelector, ownerDocument)
    };
  } catch (e) {
    return {
      selector,
      elements: []
    };
  }
}
function createSvgElement(doc, { tagName, attrs, children }) {
  const elem = doc.createElementNS("http://www.w3.org/2000/svg", tagName);
  if (attrs) {
    for (const [k, v] of Object.entries(attrs))
      elem.setAttribute(k, v);
  }
  if (children) {
    for (const c of children)
      elem.appendChild(createSvgElement(doc, c));
  }
  return elem;
}
var PollingRecorder = class {
  constructor(injectedScript) {
    this._recorder = new Recorder(injectedScript);
    this._embedder = injectedScript.window;
    injectedScript.onGlobalListenersRemoved.add(() => this._recorder.installListeners());
    const refreshOverlay = () => {
      this._pollRecorderMode().catch((e) => console.log(e));
    };
    this._embedder.__pw_refreshOverlay = refreshOverlay;
    refreshOverlay();
  }
  async _pollRecorderMode() {
    const pollPeriod = 1e3;
    if (this._pollRecorderModeTimer)
      clearTimeout(this._pollRecorderModeTimer);
    const state = await this._embedder.__pw_recorderState().catch(() => {
    });
    if (!state) {
      this._pollRecorderModeTimer = setTimeout(() => this._pollRecorderMode(), pollPeriod);
      return;
    }
    const win = this._recorder.document.defaultView;
    if (win.top !== win) {
      state.actionPoint = void 0;
    }
    this._recorder.setUIState(state, this);
    this._pollRecorderModeTimer = setTimeout(() => this._pollRecorderMode(), pollPeriod);
  }
  async performAction(action) {
    await this._embedder.__pw_recorderPerformAction(action);
  }
  async recordAction(action) {
    await this._embedder.__pw_recorderRecordAction(action);
  }
  async setSelector(selector) {
    await this._embedder.__pw_recorderSetSelector(selector);
  }
  async setMode(mode) {
    await this._embedder.__pw_recorderSetMode(mode);
  }
  async setOverlayState(state) {
    await this._embedder.__pw_recorderSetOverlayState(state);
  }
};
var recorder_default = PollingRecorder;
`});var Sg=M(gu=>{"use strict";Object.defineProperty(gu,"__esModule",{value:!0});gu.source=void 0;var q9=gu.source=`
var __commonJS = obj => {
  let required = false;
  let result;
  return function __require() {
    if (!required) {
      required = true;
      let fn;
      for (const name in obj) { fn = obj[name]; break; }
      const module = { exports: {} };
      fn(module.exports, module);
      result = module.exports;
    }
    return result;
  }
};
var __export = (target, all) => {for (var name in all) target[name] = all[name];};
var __toESM = mod => ({ ...mod, 'default': mod });
var __toCommonJS = mod => ({ ...mod, __esModule: true });


// packages/playwright-core/src/server/injected/consoleApi.ts
var consoleApi_exports = {};
__export(consoleApi_exports, {
  default: () => consoleApi_default
});
module.exports = __toCommonJS(consoleApi_exports);

// packages/playwright-core/src/utils/isomorphic/stringUtils.ts
function escapeWithQuotes(text, char = "'") {
  const stringified = JSON.stringify(text);
  const escapedText = stringified.substring(1, stringified.length - 1).replace(/\\\\"/g, '"');
  if (char === "'")
    return char + escapedText.replace(/[']/g, "\\\\'") + char;
  if (char === '"')
    return char + escapedText.replace(/["]/g, '\\\\"') + char;
  if (char === "\`")
    return char + escapedText.replace(/[\`]/g, "\`") + char;
  throw new Error("Invalid escape char");
}
function toTitleCase(name) {
  return name.charAt(0).toUpperCase() + name.substring(1);
}
function toSnakeCase(name) {
  return name.replace(/([a-z0-9])([A-Z])/g, "$1_$2").replace(/([A-Z])([A-Z][a-z])/g, "$1_$2").toLowerCase();
}
function normalizeEscapedRegexQuotes(source) {
  return source.replace(/(^|[^\\\\])(\\\\\\\\)*\\\\(['"\`])/g, "$1$2$3");
}
function escapeRegexForSelector(re) {
  if (re.unicode || re.unicodeSets)
    return String(re);
  return String(re).replace(/(^|[^\\\\])(\\\\\\\\)*(["'\`])/g, "$1$2\\\\$3").replace(/>>/g, "\\\\>\\\\>");
}
function escapeForTextSelector(text, exact) {
  if (typeof text !== "string")
    return escapeRegexForSelector(text);
  return \`\${JSON.stringify(text)}\${exact ? "s" : "i"}\`;
}
function escapeForAttributeSelector(value, exact) {
  if (typeof value !== "string")
    return escapeRegexForSelector(value);
  return \`"\${value.replace(/\\\\/g, "\\\\\\\\").replace(/["]/g, '\\\\"')}"\${exact ? "s" : "i"}\`;
}

// packages/playwright-core/src/utils/isomorphic/locatorUtils.ts
function getByAttributeTextSelector(attrName, text, options) {
  return \`internal:attr=[\${attrName}=\${escapeForAttributeSelector(text, (options == null ? void 0 : options.exact) || false)}]\`;
}
function getByTestIdSelector(testIdAttributeName, testId) {
  return \`internal:testid=[\${testIdAttributeName}=\${escapeForAttributeSelector(testId, true)}]\`;
}
function getByLabelSelector(text, options) {
  return "internal:label=" + escapeForTextSelector(text, !!(options == null ? void 0 : options.exact));
}
function getByAltTextSelector(text, options) {
  return getByAttributeTextSelector("alt", text, options);
}
function getByTitleSelector(text, options) {
  return getByAttributeTextSelector("title", text, options);
}
function getByPlaceholderSelector(text, options) {
  return getByAttributeTextSelector("placeholder", text, options);
}
function getByTextSelector(text, options) {
  return "internal:text=" + escapeForTextSelector(text, !!(options == null ? void 0 : options.exact));
}
function getByRoleSelector(role, options = {}) {
  const props = [];
  if (options.checked !== void 0)
    props.push(["checked", String(options.checked)]);
  if (options.disabled !== void 0)
    props.push(["disabled", String(options.disabled)]);
  if (options.selected !== void 0)
    props.push(["selected", String(options.selected)]);
  if (options.expanded !== void 0)
    props.push(["expanded", String(options.expanded)]);
  if (options.includeHidden !== void 0)
    props.push(["include-hidden", String(options.includeHidden)]);
  if (options.level !== void 0)
    props.push(["level", String(options.level)]);
  if (options.name !== void 0)
    props.push(["name", escapeForAttributeSelector(options.name, !!options.exact)]);
  if (options.pressed !== void 0)
    props.push(["pressed", String(options.pressed)]);
  return \`internal:role=\${role}\${props.map(([n, v]) => \`[\${n}=\${v}]\`).join("")}\`;
}

// packages/playwright-core/src/utils/isomorphic/cssTokenizer.ts
var between = function(num, first, last) {
  return num >= first && num <= last;
};
function digit(code) {
  return between(code, 48, 57);
}
function hexdigit(code) {
  return digit(code) || between(code, 65, 70) || between(code, 97, 102);
}
function uppercaseletter(code) {
  return between(code, 65, 90);
}
function lowercaseletter(code) {
  return between(code, 97, 122);
}
function letter(code) {
  return uppercaseletter(code) || lowercaseletter(code);
}
function nonascii(code) {
  return code >= 128;
}
function namestartchar(code) {
  return letter(code) || nonascii(code) || code === 95;
}
function namechar(code) {
  return namestartchar(code) || digit(code) || code === 45;
}
function nonprintable(code) {
  return between(code, 0, 8) || code === 11 || between(code, 14, 31) || code === 127;
}
function newline(code) {
  return code === 10;
}
function whitespace(code) {
  return newline(code) || code === 9 || code === 32;
}
var maximumallowedcodepoint = 1114111;
var InvalidCharacterError = class extends Error {
  constructor(message) {
    super(message);
    this.name = "InvalidCharacterError";
  }
};
function preprocess(str) {
  const codepoints = [];
  for (let i = 0; i < str.length; i++) {
    let code = str.charCodeAt(i);
    if (code === 13 && str.charCodeAt(i + 1) === 10) {
      code = 10;
      i++;
    }
    if (code === 13 || code === 12)
      code = 10;
    if (code === 0)
      code = 65533;
    if (between(code, 55296, 56319) && between(str.charCodeAt(i + 1), 56320, 57343)) {
      const lead = code - 55296;
      const trail = str.charCodeAt(i + 1) - 56320;
      code = Math.pow(2, 16) + lead * Math.pow(2, 10) + trail;
      i++;
    }
    codepoints.push(code);
  }
  return codepoints;
}
function stringFromCode(code) {
  if (code <= 65535)
    return String.fromCharCode(code);
  code -= Math.pow(2, 16);
  const lead = Math.floor(code / Math.pow(2, 10)) + 55296;
  const trail = code % Math.pow(2, 10) + 56320;
  return String.fromCharCode(lead) + String.fromCharCode(trail);
}
function tokenize(str1) {
  const str = preprocess(str1);
  let i = -1;
  const tokens = [];
  let code;
  let line = 0;
  let column = 0;
  let lastLineLength = 0;
  const incrLineno = function() {
    line += 1;
    lastLineLength = column;
    column = 0;
  };
  const locStart = { line, column };
  const codepoint = function(i2) {
    if (i2 >= str.length)
      return -1;
    return str[i2];
  };
  const next = function(num) {
    if (num === void 0)
      num = 1;
    if (num > 3)
      throw "Spec Error: no more than three codepoints of lookahead.";
    return codepoint(i + num);
  };
  const consume = function(num) {
    if (num === void 0)
      num = 1;
    i += num;
    code = codepoint(i);
    if (newline(code))
      incrLineno();
    else
      column += num;
    return true;
  };
  const reconsume = function() {
    i -= 1;
    if (newline(code)) {
      line -= 1;
      column = lastLineLength;
    } else {
      column -= 1;
    }
    locStart.line = line;
    locStart.column = column;
    return true;
  };
  const eof = function(codepoint2) {
    if (codepoint2 === void 0)
      codepoint2 = code;
    return codepoint2 === -1;
  };
  const donothing = function() {
  };
  const parseerror = function() {
  };
  const consumeAToken = function() {
    consumeComments();
    consume();
    if (whitespace(code)) {
      while (whitespace(next()))
        consume();
      return new WhitespaceToken();
    } else if (code === 34) {
      return consumeAStringToken();
    } else if (code === 35) {
      if (namechar(next()) || areAValidEscape(next(1), next(2))) {
        const token = new HashToken("");
        if (wouldStartAnIdentifier(next(1), next(2), next(3)))
          token.type = "id";
        token.value = consumeAName();
        return token;
      } else {
        return new DelimToken(code);
      }
    } else if (code === 36) {
      if (next() === 61) {
        consume();
        return new SuffixMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 39) {
      return consumeAStringToken();
    } else if (code === 40) {
      return new OpenParenToken();
    } else if (code === 41) {
      return new CloseParenToken();
    } else if (code === 42) {
      if (next() === 61) {
        consume();
        return new SubstringMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 43) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 44) {
      return new CommaToken();
    } else if (code === 45) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else if (next(1) === 45 && next(2) === 62) {
        consume(2);
        return new CDCToken();
      } else if (startsWithAnIdentifier()) {
        reconsume();
        return consumeAnIdentlikeToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 46) {
      if (startsWithANumber()) {
        reconsume();
        return consumeANumericToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 58) {
      return new ColonToken();
    } else if (code === 59) {
      return new SemicolonToken();
    } else if (code === 60) {
      if (next(1) === 33 && next(2) === 45 && next(3) === 45) {
        consume(3);
        return new CDOToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 64) {
      if (wouldStartAnIdentifier(next(1), next(2), next(3)))
        return new AtKeywordToken(consumeAName());
      else
        return new DelimToken(code);
    } else if (code === 91) {
      return new OpenSquareToken();
    } else if (code === 92) {
      if (startsWithAValidEscape()) {
        reconsume();
        return consumeAnIdentlikeToken();
      } else {
        parseerror();
        return new DelimToken(code);
      }
    } else if (code === 93) {
      return new CloseSquareToken();
    } else if (code === 94) {
      if (next() === 61) {
        consume();
        return new PrefixMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 123) {
      return new OpenCurlyToken();
    } else if (code === 124) {
      if (next() === 61) {
        consume();
        return new DashMatchToken();
      } else if (next() === 124) {
        consume();
        return new ColumnToken();
      } else {
        return new DelimToken(code);
      }
    } else if (code === 125) {
      return new CloseCurlyToken();
    } else if (code === 126) {
      if (next() === 61) {
        consume();
        return new IncludeMatchToken();
      } else {
        return new DelimToken(code);
      }
    } else if (digit(code)) {
      reconsume();
      return consumeANumericToken();
    } else if (namestartchar(code)) {
      reconsume();
      return consumeAnIdentlikeToken();
    } else if (eof()) {
      return new EOFToken();
    } else {
      return new DelimToken(code);
    }
  };
  const consumeComments = function() {
    while (next(1) === 47 && next(2) === 42) {
      consume(2);
      while (true) {
        consume();
        if (code === 42 && next() === 47) {
          consume();
          break;
        } else if (eof()) {
          parseerror();
          return;
        }
      }
    }
  };
  const consumeANumericToken = function() {
    const num = consumeANumber();
    if (wouldStartAnIdentifier(next(1), next(2), next(3))) {
      const token = new DimensionToken();
      token.value = num.value;
      token.repr = num.repr;
      token.type = num.type;
      token.unit = consumeAName();
      return token;
    } else if (next() === 37) {
      consume();
      const token = new PercentageToken();
      token.value = num.value;
      token.repr = num.repr;
      return token;
    } else {
      const token = new NumberToken();
      token.value = num.value;
      token.repr = num.repr;
      token.type = num.type;
      return token;
    }
  };
  const consumeAnIdentlikeToken = function() {
    const str2 = consumeAName();
    if (str2.toLowerCase() === "url" && next() === 40) {
      consume();
      while (whitespace(next(1)) && whitespace(next(2)))
        consume();
      if (next() === 34 || next() === 39)
        return new FunctionToken(str2);
      else if (whitespace(next()) && (next(2) === 34 || next(2) === 39))
        return new FunctionToken(str2);
      else
        return consumeAURLToken();
    } else if (next() === 40) {
      consume();
      return new FunctionToken(str2);
    } else {
      return new IdentToken(str2);
    }
  };
  const consumeAStringToken = function(endingCodePoint) {
    if (endingCodePoint === void 0)
      endingCodePoint = code;
    let string = "";
    while (consume()) {
      if (code === endingCodePoint || eof()) {
        return new StringToken(string);
      } else if (newline(code)) {
        parseerror();
        reconsume();
        return new BadStringToken();
      } else if (code === 92) {
        if (eof(next()))
          donothing();
        else if (newline(next()))
          consume();
        else
          string += stringFromCode(consumeEscape());
      } else {
        string += stringFromCode(code);
      }
    }
    throw new Error("Internal error");
  };
  const consumeAURLToken = function() {
    const token = new URLToken("");
    while (whitespace(next()))
      consume();
    if (eof(next()))
      return token;
    while (consume()) {
      if (code === 41 || eof()) {
        return token;
      } else if (whitespace(code)) {
        while (whitespace(next()))
          consume();
        if (next() === 41 || eof(next())) {
          consume();
          return token;
        } else {
          consumeTheRemnantsOfABadURL();
          return new BadURLToken();
        }
      } else if (code === 34 || code === 39 || code === 40 || nonprintable(code)) {
        parseerror();
        consumeTheRemnantsOfABadURL();
        return new BadURLToken();
      } else if (code === 92) {
        if (startsWithAValidEscape()) {
          token.value += stringFromCode(consumeEscape());
        } else {
          parseerror();
          consumeTheRemnantsOfABadURL();
          return new BadURLToken();
        }
      } else {
        token.value += stringFromCode(code);
      }
    }
    throw new Error("Internal error");
  };
  const consumeEscape = function() {
    consume();
    if (hexdigit(code)) {
      const digits = [code];
      for (let total = 0; total < 5; total++) {
        if (hexdigit(next())) {
          consume();
          digits.push(code);
        } else {
          break;
        }
      }
      if (whitespace(next()))
        consume();
      let value = parseInt(digits.map(function(x) {
        return String.fromCharCode(x);
      }).join(""), 16);
      if (value > maximumallowedcodepoint)
        value = 65533;
      return value;
    } else if (eof()) {
      return 65533;
    } else {
      return code;
    }
  };
  const areAValidEscape = function(c1, c2) {
    if (c1 !== 92)
      return false;
    if (newline(c2))
      return false;
    return true;
  };
  const startsWithAValidEscape = function() {
    return areAValidEscape(code, next());
  };
  const wouldStartAnIdentifier = function(c1, c2, c3) {
    if (c1 === 45)
      return namestartchar(c2) || c2 === 45 || areAValidEscape(c2, c3);
    else if (namestartchar(c1))
      return true;
    else if (c1 === 92)
      return areAValidEscape(c1, c2);
    else
      return false;
  };
  const startsWithAnIdentifier = function() {
    return wouldStartAnIdentifier(code, next(1), next(2));
  };
  const wouldStartANumber = function(c1, c2, c3) {
    if (c1 === 43 || c1 === 45) {
      if (digit(c2))
        return true;
      if (c2 === 46 && digit(c3))
        return true;
      return false;
    } else if (c1 === 46) {
      if (digit(c2))
        return true;
      return false;
    } else if (digit(c1)) {
      return true;
    } else {
      return false;
    }
  };
  const startsWithANumber = function() {
    return wouldStartANumber(code, next(1), next(2));
  };
  const consumeAName = function() {
    let result = "";
    while (consume()) {
      if (namechar(code)) {
        result += stringFromCode(code);
      } else if (startsWithAValidEscape()) {
        result += stringFromCode(consumeEscape());
      } else {
        reconsume();
        return result;
      }
    }
    throw new Error("Internal parse error");
  };
  const consumeANumber = function() {
    let repr = "";
    let type = "integer";
    if (next() === 43 || next() === 45) {
      consume();
      repr += stringFromCode(code);
    }
    while (digit(next())) {
      consume();
      repr += stringFromCode(code);
    }
    if (next(1) === 46 && digit(next(2))) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    }
    const c1 = next(1), c2 = next(2), c3 = next(3);
    if ((c1 === 69 || c1 === 101) && digit(c2)) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    } else if ((c1 === 69 || c1 === 101) && (c2 === 43 || c2 === 45) && digit(c3)) {
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      consume();
      repr += stringFromCode(code);
      type = "number";
      while (digit(next())) {
        consume();
        repr += stringFromCode(code);
      }
    }
    const value = convertAStringToANumber(repr);
    return { type, value, repr };
  };
  const convertAStringToANumber = function(string) {
    return +string;
  };
  const consumeTheRemnantsOfABadURL = function() {
    while (consume()) {
      if (code === 41 || eof()) {
        return;
      } else if (startsWithAValidEscape()) {
        consumeEscape();
        donothing();
      } else {
        donothing();
      }
    }
  };
  let iterationCount = 0;
  while (!eof(next())) {
    tokens.push(consumeAToken());
    iterationCount++;
    if (iterationCount > str.length * 2)
      throw new Error("I'm infinite-looping!");
  }
  return tokens;
}
var CSSParserToken = class {
  constructor() {
    this.tokenType = "";
  }
  toJSON() {
    return { token: this.tokenType };
  }
  toString() {
    return this.tokenType;
  }
  toSource() {
    return "" + this;
  }
};
var BadStringToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "BADSTRING";
  }
};
var BadURLToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "BADURL";
  }
};
var WhitespaceToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "WHITESPACE";
  }
  toString() {
    return "WS";
  }
  toSource() {
    return " ";
  }
};
var CDOToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "CDO";
  }
  toSource() {
    return "<!--";
  }
};
var CDCToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "CDC";
  }
  toSource() {
    return "-->";
  }
};
var ColonToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ":";
  }
};
var SemicolonToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ";";
  }
};
var CommaToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = ",";
  }
};
var GroupingToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.value = "";
    this.mirror = "";
  }
};
var OpenCurlyToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "{";
    this.value = "{";
    this.mirror = "}";
  }
};
var CloseCurlyToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "}";
    this.value = "}";
    this.mirror = "{";
  }
};
var OpenSquareToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "[";
    this.value = "[";
    this.mirror = "]";
  }
};
var CloseSquareToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "]";
    this.value = "]";
    this.mirror = "[";
  }
};
var OpenParenToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = "(";
    this.value = "(";
    this.mirror = ")";
  }
};
var CloseParenToken = class extends GroupingToken {
  constructor() {
    super();
    this.tokenType = ")";
    this.value = ")";
    this.mirror = "(";
  }
};
var IncludeMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "~=";
  }
};
var DashMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "|=";
  }
};
var PrefixMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "^=";
  }
};
var SuffixMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "$=";
  }
};
var SubstringMatchToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "*=";
  }
};
var ColumnToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "||";
  }
};
var EOFToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.tokenType = "EOF";
  }
  toSource() {
    return "";
  }
};
var DelimToken = class extends CSSParserToken {
  constructor(code) {
    super();
    this.tokenType = "DELIM";
    this.value = "";
    this.value = stringFromCode(code);
  }
  toString() {
    return "DELIM(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    return json;
  }
  toSource() {
    if (this.value === "\\\\")
      return "\\\\\\n";
    else
      return this.value;
  }
};
var StringValuedToken = class extends CSSParserToken {
  constructor() {
    super(...arguments);
    this.value = "";
  }
  ASCIIMatch(str) {
    return this.value.toLowerCase() === str.toLowerCase();
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    return json;
  }
};
var IdentToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "IDENT";
    this.value = val;
  }
  toString() {
    return "IDENT(" + this.value + ")";
  }
  toSource() {
    return escapeIdent(this.value);
  }
};
var FunctionToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "FUNCTION";
    this.value = val;
    this.mirror = ")";
  }
  toString() {
    return "FUNCTION(" + this.value + ")";
  }
  toSource() {
    return escapeIdent(this.value) + "(";
  }
};
var AtKeywordToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "AT-KEYWORD";
    this.value = val;
  }
  toString() {
    return "AT(" + this.value + ")";
  }
  toSource() {
    return "@" + escapeIdent(this.value);
  }
};
var HashToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "HASH";
    this.value = val;
    this.type = "unrestricted";
  }
  toString() {
    return "HASH(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.type = this.type;
    return json;
  }
  toSource() {
    if (this.type === "id")
      return "#" + escapeIdent(this.value);
    else
      return "#" + escapeHash(this.value);
  }
};
var StringToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "STRING";
    this.value = val;
  }
  toString() {
    return '"' + escapeString(this.value) + '"';
  }
};
var URLToken = class extends StringValuedToken {
  constructor(val) {
    super();
    this.tokenType = "URL";
    this.value = val;
  }
  toString() {
    return "URL(" + this.value + ")";
  }
  toSource() {
    return 'url("' + escapeString(this.value) + '")';
  }
};
var NumberToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "NUMBER";
    this.type = "integer";
    this.repr = "";
  }
  toString() {
    if (this.type === "integer")
      return "INT(" + this.value + ")";
    return "NUMBER(" + this.value + ")";
  }
  toJSON() {
    const json = super.toJSON();
    json.value = this.value;
    json.type = this.type;
    json.repr = this.repr;
    return json;
  }
  toSource() {
    return this.repr;
  }
};
var PercentageToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "PERCENTAGE";
    this.repr = "";
  }
  toString() {
    return "PERCENTAGE(" + this.value + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.repr = this.repr;
    return json;
  }
  toSource() {
    return this.repr + "%";
  }
};
var DimensionToken = class extends CSSParserToken {
  constructor() {
    super();
    this.tokenType = "DIMENSION";
    this.type = "integer";
    this.repr = "";
    this.unit = "";
  }
  toString() {
    return "DIM(" + this.value + "," + this.unit + ")";
  }
  toJSON() {
    const json = this.constructor.prototype.constructor.prototype.toJSON.call(this);
    json.value = this.value;
    json.type = this.type;
    json.repr = this.repr;
    json.unit = this.unit;
    return json;
  }
  toSource() {
    const source = this.repr;
    let unit = escapeIdent(this.unit);
    if (unit[0].toLowerCase() === "e" && (unit[1] === "-" || between(unit.charCodeAt(1), 48, 57))) {
      unit = "\\\\65 " + unit.slice(1, unit.length);
    }
    return source + unit;
  }
};
function escapeIdent(string) {
  string = "" + string;
  let result = "";
  const firstcode = string.charCodeAt(0);
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (between(code, 1, 31) || code === 127 || i === 0 && between(code, 48, 57) || i === 1 && between(code, 48, 57) && firstcode === 45)
      result += "\\\\" + code.toString(16) + " ";
    else if (code >= 128 || code === 45 || code === 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122))
      result += string[i];
    else
      result += "\\\\" + string[i];
  }
  return result;
}
function escapeHash(string) {
  string = "" + string;
  let result = "";
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (code >= 128 || code === 45 || code === 95 || between(code, 48, 57) || between(code, 65, 90) || between(code, 97, 122))
      result += string[i];
    else
      result += "\\\\" + code.toString(16) + " ";
  }
  return result;
}
function escapeString(string) {
  string = "" + string;
  let result = "";
  for (let i = 0; i < string.length; i++) {
    const code = string.charCodeAt(i);
    if (code === 0)
      throw new InvalidCharacterError("Invalid character: the input contains U+0000.");
    if (between(code, 1, 31) || code === 127)
      result += "\\\\" + code.toString(16) + " ";
    else if (code === 34 || code === 92)
      result += "\\\\" + string[i];
    else
      result += string[i];
  }
  return result;
}

// packages/playwright-core/src/utils/isomorphic/cssParser.ts
var InvalidSelectorError = class extends Error {
};
function parseCSS(selector, customNames) {
  let tokens;
  try {
    tokens = tokenize(selector);
    if (!(tokens[tokens.length - 1] instanceof EOFToken))
      tokens.push(new EOFToken());
  } catch (e) {
    const newMessage = e.message + \` while parsing selector "\${selector}"\`;
    const index = (e.stack || "").indexOf(e.message);
    if (index !== -1)
      e.stack = e.stack.substring(0, index) + newMessage + e.stack.substring(index + e.message.length);
    e.message = newMessage;
    throw e;
  }
  const unsupportedToken = tokens.find((token) => {
    return token instanceof AtKeywordToken || token instanceof BadStringToken || token instanceof BadURLToken || token instanceof ColumnToken || token instanceof CDOToken || token instanceof CDCToken || token instanceof SemicolonToken || // TODO: Consider using these for something, e.g. to escape complex strings.
    // For example :xpath{ (//div/bar[@attr="foo"])[2]/baz }
    // Or this way :xpath( {complex-xpath-goes-here("hello")} )
    token instanceof OpenCurlyToken || token instanceof CloseCurlyToken || // TODO: Consider treating these as strings?
    token instanceof URLToken || token instanceof PercentageToken;
  });
  if (unsupportedToken)
    throw new InvalidSelectorError(\`Unsupported token "\${unsupportedToken.toSource()}" while parsing selector "\${selector}"\`);
  let pos = 0;
  const names = /* @__PURE__ */ new Set();
  function unexpected() {
    return new InvalidSelectorError(\`Unexpected token "\${tokens[pos].toSource()}" while parsing selector "\${selector}"\`);
  }
  function skipWhitespace() {
    while (tokens[pos] instanceof WhitespaceToken)
      pos++;
  }
  function isIdent(p = pos) {
    return tokens[p] instanceof IdentToken;
  }
  function isString(p = pos) {
    return tokens[p] instanceof StringToken;
  }
  function isNumber(p = pos) {
    return tokens[p] instanceof NumberToken;
  }
  function isComma(p = pos) {
    return tokens[p] instanceof CommaToken;
  }
  function isOpenParen(p = pos) {
    return tokens[p] instanceof OpenParenToken;
  }
  function isCloseParen(p = pos) {
    return tokens[p] instanceof CloseParenToken;
  }
  function isFunction(p = pos) {
    return tokens[p] instanceof FunctionToken;
  }
  function isStar(p = pos) {
    return tokens[p] instanceof DelimToken && tokens[p].value === "*";
  }
  function isEOF(p = pos) {
    return tokens[p] instanceof EOFToken;
  }
  function isClauseCombinator(p = pos) {
    return tokens[p] instanceof DelimToken && [">", "+", "~"].includes(tokens[p].value);
  }
  function isSelectorClauseEnd(p = pos) {
    return isComma(p) || isCloseParen(p) || isEOF(p) || isClauseCombinator(p) || tokens[p] instanceof WhitespaceToken;
  }
  function consumeFunctionArguments() {
    const result2 = [consumeArgument()];
    while (true) {
      skipWhitespace();
      if (!isComma())
        break;
      pos++;
      result2.push(consumeArgument());
    }
    return result2;
  }
  function consumeArgument() {
    skipWhitespace();
    if (isNumber())
      return tokens[pos++].value;
    if (isString())
      return tokens[pos++].value;
    return consumeComplexSelector();
  }
  function consumeComplexSelector() {
    const result2 = { simples: [] };
    skipWhitespace();
    if (isClauseCombinator()) {
      result2.simples.push({ selector: { functions: [{ name: "scope", args: [] }] }, combinator: "" });
    } else {
      result2.simples.push({ selector: consumeSimpleSelector(), combinator: "" });
    }
    while (true) {
      skipWhitespace();
      if (isClauseCombinator()) {
        result2.simples[result2.simples.length - 1].combinator = tokens[pos++].value;
        skipWhitespace();
      } else if (isSelectorClauseEnd()) {
        break;
      }
      result2.simples.push({ combinator: "", selector: consumeSimpleSelector() });
    }
    return result2;
  }
  function consumeSimpleSelector() {
    let rawCSSString = "";
    const functions = [];
    while (!isSelectorClauseEnd()) {
      if (isIdent() || isStar()) {
        rawCSSString += tokens[pos++].toSource();
      } else if (tokens[pos] instanceof HashToken) {
        rawCSSString += tokens[pos++].toSource();
      } else if (tokens[pos] instanceof DelimToken && tokens[pos].value === ".") {
        pos++;
        if (isIdent())
          rawCSSString += "." + tokens[pos++].toSource();
        else
          throw unexpected();
      } else if (tokens[pos] instanceof ColonToken) {
        pos++;
        if (isIdent()) {
          if (!customNames.has(tokens[pos].value.toLowerCase())) {
            rawCSSString += ":" + tokens[pos++].toSource();
          } else {
            const name = tokens[pos++].value.toLowerCase();
            functions.push({ name, args: [] });
            names.add(name);
          }
        } else if (isFunction()) {
          const name = tokens[pos++].value.toLowerCase();
          if (!customNames.has(name)) {
            rawCSSString += \`:\${name}(\${consumeBuiltinFunctionArguments()})\`;
          } else {
            functions.push({ name, args: consumeFunctionArguments() });
            names.add(name);
          }
          skipWhitespace();
          if (!isCloseParen())
            throw unexpected();
          pos++;
        } else {
          throw unexpected();
        }
      } else if (tokens[pos] instanceof OpenSquareToken) {
        rawCSSString += "[";
        pos++;
        while (!(tokens[pos] instanceof CloseSquareToken) && !isEOF())
          rawCSSString += tokens[pos++].toSource();
        if (!(tokens[pos] instanceof CloseSquareToken))
          throw unexpected();
        rawCSSString += "]";
        pos++;
      } else {
        throw unexpected();
      }
    }
    if (!rawCSSString && !functions.length)
      throw unexpected();
    return { css: rawCSSString || void 0, functions };
  }
  function consumeBuiltinFunctionArguments() {
    let s = "";
    let balance = 1;
    while (!isEOF()) {
      if (isOpenParen() || isFunction())
        balance++;
      if (isCloseParen())
        balance--;
      if (!balance)
        break;
      s += tokens[pos++].toSource();
    }
    return s;
  }
  const result = consumeFunctionArguments();
  if (!isEOF())
    throw unexpected();
  if (result.some((arg) => typeof arg !== "object" || !("simples" in arg)))
    throw new InvalidSelectorError(\`Error while parsing selector "\${selector}"\`);
  return { selector: result, names: Array.from(names) };
}

// packages/playwright-core/src/utils/isomorphic/selectorParser.ts
var kNestedSelectorNames = /* @__PURE__ */ new Set(["internal:has", "internal:has-not", "internal:and", "internal:or", "internal:chain", "left-of", "right-of", "above", "below", "near"]);
var kNestedSelectorNamesWithDistance = /* @__PURE__ */ new Set(["left-of", "right-of", "above", "below", "near"]);
var customCSSNames = /* @__PURE__ */ new Set(["not", "is", "where", "has", "scope", "light", "visible", "text", "text-matches", "text-is", "has-text", "above", "below", "right-of", "left-of", "near", "nth-match"]);
function parseSelector(selector) {
  const parsedStrings = parseSelectorString(selector);
  const parts = [];
  for (const part of parsedStrings.parts) {
    if (part.name === "css" || part.name === "css:light") {
      if (part.name === "css:light")
        part.body = ":light(" + part.body + ")";
      const parsedCSS = parseCSS(part.body, customCSSNames);
      parts.push({
        name: "css",
        body: parsedCSS.selector,
        source: part.body
      });
      continue;
    }
    if (kNestedSelectorNames.has(part.name)) {
      let innerSelector;
      let distance;
      try {
        const unescaped = JSON.parse("[" + part.body + "]");
        if (!Array.isArray(unescaped) || unescaped.length < 1 || unescaped.length > 2 || typeof unescaped[0] !== "string")
          throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
        innerSelector = unescaped[0];
        if (unescaped.length === 2) {
          if (typeof unescaped[1] !== "number" || !kNestedSelectorNamesWithDistance.has(part.name))
            throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
          distance = unescaped[1];
        }
      } catch (e) {
        throw new InvalidSelectorError(\`Malformed selector: \${part.name}=\` + part.body);
      }
      const nested = { name: part.name, source: part.body, body: { parsed: parseSelector(innerSelector), distance } };
      const lastFrame = [...nested.body.parsed.parts].reverse().find((part2) => part2.name === "internal:control" && part2.body === "enter-frame");
      const lastFrameIndex = lastFrame ? nested.body.parsed.parts.indexOf(lastFrame) : -1;
      if (lastFrameIndex !== -1 && selectorPartsEqual(nested.body.parsed.parts.slice(0, lastFrameIndex + 1), parts.slice(0, lastFrameIndex + 1)))
        nested.body.parsed.parts.splice(0, lastFrameIndex + 1);
      parts.push(nested);
      continue;
    }
    parts.push({ ...part, source: part.body });
  }
  if (kNestedSelectorNames.has(parts[0].name))
    throw new InvalidSelectorError(\`"\${parts[0].name}" selector cannot be first\`);
  return {
    capture: parsedStrings.capture,
    parts
  };
}
function selectorPartsEqual(list1, list2) {
  return stringifySelector({ parts: list1 }) === stringifySelector({ parts: list2 });
}
function stringifySelector(selector, forceEngineName) {
  if (typeof selector === "string")
    return selector;
  return selector.parts.map((p, i) => {
    let includeEngine = true;
    if (!forceEngineName && i !== selector.capture) {
      if (p.name === "css")
        includeEngine = false;
      else if (p.name === "xpath" && p.source.startsWith("//") || p.source.startsWith(".."))
        includeEngine = false;
    }
    const prefix = includeEngine ? p.name + "=" : "";
    return \`\${i === selector.capture ? "*" : ""}\${prefix}\${p.source}\`;
  }).join(" >> ");
}
function parseSelectorString(selector) {
  let index = 0;
  let quote;
  let start = 0;
  const result = { parts: [] };
  const append = () => {
    const part = selector.substring(start, index).trim();
    const eqIndex = part.indexOf("=");
    let name;
    let body;
    if (eqIndex !== -1 && part.substring(0, eqIndex).trim().match(/^[a-zA-Z_0-9-+:*]+$/)) {
      name = part.substring(0, eqIndex).trim();
      body = part.substring(eqIndex + 1);
    } else if (part.length > 1 && part[0] === '"' && part[part.length - 1] === '"') {
      name = "text";
      body = part;
    } else if (part.length > 1 && part[0] === "'" && part[part.length - 1] === "'") {
      name = "text";
      body = part;
    } else if (/^\\(*\\/\\//.test(part) || part.startsWith("..")) {
      name = "xpath";
      body = part;
    } else {
      name = "css";
      body = part;
    }
    let capture = false;
    if (name[0] === "*") {
      capture = true;
      name = name.substring(1);
    }
    result.parts.push({ name, body });
    if (capture) {
      if (result.capture !== void 0)
        throw new InvalidSelectorError(\`Only one of the selectors can capture using * modifier\`);
      result.capture = result.parts.length - 1;
    }
  };
  if (!selector.includes(">>")) {
    index = selector.length;
    append();
    return result;
  }
  const shouldIgnoreTextSelectorQuote = () => {
    const prefix = selector.substring(start, index);
    const match = prefix.match(/^\\s*text\\s*=(.*)$/);
    return !!match && !!match[1];
  };
  while (index < selector.length) {
    const c = selector[index];
    if (c === "\\\\" && index + 1 < selector.length) {
      index += 2;
    } else if (c === quote) {
      quote = void 0;
      index++;
    } else if (!quote && (c === '"' || c === "'" || c === "\`") && !shouldIgnoreTextSelectorQuote()) {
      quote = c;
      index++;
    } else if (!quote && c === ">" && selector[index + 1] === ">") {
      append();
      index += 2;
      start = index;
    } else {
      index++;
    }
  }
  append();
  return result;
}
function parseAttributeSelector(selector, allowUnquotedStrings) {
  let wp = 0;
  let EOL = selector.length === 0;
  const next = () => selector[wp] || "";
  const eat1 = () => {
    const result2 = next();
    ++wp;
    EOL = wp >= selector.length;
    return result2;
  };
  const syntaxError = (stage) => {
    if (EOL)
      throw new InvalidSelectorError(\`Unexpected end of selector while parsing selector \\\`\${selector}\\\`\`);
    throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - unexpected symbol "\${next()}" at position \${wp}\` + (stage ? " during " + stage : ""));
  };
  function skipSpaces() {
    while (!EOL && /\\s/.test(next()))
      eat1();
  }
  function isCSSNameChar(char) {
    return char >= "\\x80" || char >= "0" && char <= "9" || char >= "A" && char <= "Z" || char >= "a" && char <= "z" || char >= "0" && char <= "9" || char === "_" || char === "-";
  }
  function readIdentifier() {
    let result2 = "";
    skipSpaces();
    while (!EOL && isCSSNameChar(next()))
      result2 += eat1();
    return result2;
  }
  function readQuotedString(quote) {
    let result2 = eat1();
    if (result2 !== quote)
      syntaxError("parsing quoted string");
    while (!EOL && next() !== quote) {
      if (next() === "\\\\")
        eat1();
      result2 += eat1();
    }
    if (next() !== quote)
      syntaxError("parsing quoted string");
    result2 += eat1();
    return result2;
  }
  function readRegularExpression() {
    if (eat1() !== "/")
      syntaxError("parsing regular expression");
    let source = "";
    let inClass = false;
    while (!EOL) {
      if (next() === "\\\\") {
        source += eat1();
        if (EOL)
          syntaxError("parsing regular expression");
      } else if (inClass && next() === "]") {
        inClass = false;
      } else if (!inClass && next() === "[") {
        inClass = true;
      } else if (!inClass && next() === "/") {
        break;
      }
      source += eat1();
    }
    if (eat1() !== "/")
      syntaxError("parsing regular expression");
    let flags = "";
    while (!EOL && next().match(/[dgimsuy]/))
      flags += eat1();
    try {
      return new RegExp(source, flags);
    } catch (e) {
      throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\`: \${e.message}\`);
    }
  }
  function readAttributeToken() {
    let token = "";
    skipSpaces();
    if (next() === \`'\` || next() === \`"\`)
      token = readQuotedString(next()).slice(1, -1);
    else
      token = readIdentifier();
    if (!token)
      syntaxError("parsing property path");
    return token;
  }
  function readOperator() {
    skipSpaces();
    let op = "";
    if (!EOL)
      op += eat1();
    if (!EOL && op !== "=")
      op += eat1();
    if (!["=", "*=", "^=", "$=", "|=", "~="].includes(op))
      syntaxError("parsing operator");
    return op;
  }
  function readAttribute() {
    eat1();
    const jsonPath = [];
    jsonPath.push(readAttributeToken());
    skipSpaces();
    while (next() === ".") {
      eat1();
      jsonPath.push(readAttributeToken());
      skipSpaces();
    }
    if (next() === "]") {
      eat1();
      return { name: jsonPath.join("."), jsonPath, op: "<truthy>", value: null, caseSensitive: false };
    }
    const operator = readOperator();
    let value = void 0;
    let caseSensitive = true;
    skipSpaces();
    if (next() === "/") {
      if (operator !== "=")
        throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - cannot use \${operator} in attribute with regular expression\`);
      value = readRegularExpression();
    } else if (next() === \`'\` || next() === \`"\`) {
      value = readQuotedString(next()).slice(1, -1);
      skipSpaces();
      if (next() === "i" || next() === "I") {
        caseSensitive = false;
        eat1();
      } else if (next() === "s" || next() === "S") {
        caseSensitive = true;
        eat1();
      }
    } else {
      value = "";
      while (!EOL && (isCSSNameChar(next()) || next() === "+" || next() === "."))
        value += eat1();
      if (value === "true") {
        value = true;
      } else if (value === "false") {
        value = false;
      } else {
        if (!allowUnquotedStrings) {
          value = +value;
          if (Number.isNaN(value))
            syntaxError("parsing attribute value");
        }
      }
    }
    skipSpaces();
    if (next() !== "]")
      syntaxError("parsing attribute value");
    eat1();
    if (operator !== "=" && typeof value !== "string")
      throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - cannot use \${operator} in attribute with non-string matching value - \${value}\`);
    return { name: jsonPath.join("."), jsonPath, op: operator, value, caseSensitive };
  }
  const result = {
    name: "",
    attributes: []
  };
  result.name = readIdentifier();
  skipSpaces();
  while (next() === "[") {
    result.attributes.push(readAttribute());
    skipSpaces();
  }
  if (!EOL)
    syntaxError(void 0);
  if (!result.name && !result.attributes.length)
    throw new InvalidSelectorError(\`Error while parsing selector \\\`\${selector}\\\` - selector cannot be empty\`);
  return result;
}

// packages/playwright-core/src/utils/isomorphic/locatorGenerators.ts
function asLocator(lang, selector, isFrameLocator = false) {
  return asLocators(lang, selector, isFrameLocator)[0];
}
function asLocators(lang, selector, isFrameLocator = false, maxOutputSize = 20, preferredQuote) {
  try {
    return innerAsLocators(new generators[lang](preferredQuote), parseSelector(selector), isFrameLocator, maxOutputSize);
  } catch (e) {
    return [selector];
  }
}
function innerAsLocators(factory, parsed, isFrameLocator = false, maxOutputSize = 20) {
  const parts = [...parsed.parts];
  for (let index = 0; index < parts.length - 1; index++) {
    if (parts[index].name === "nth" && parts[index + 1].name === "internal:control" && parts[index + 1].body === "enter-frame") {
      const [nth] = parts.splice(index, 1);
      parts.splice(index + 1, 0, nth);
    }
  }
  const tokens = [];
  let nextBase = isFrameLocator ? "frame-locator" : "page";
  for (let index = 0; index < parts.length; index++) {
    const part = parts[index];
    const base = nextBase;
    nextBase = "locator";
    if (part.name === "nth") {
      if (part.body === "0")
        tokens.push([factory.generateLocator(base, "first", ""), factory.generateLocator(base, "nth", "0")]);
      else if (part.body === "-1")
        tokens.push([factory.generateLocator(base, "last", ""), factory.generateLocator(base, "nth", "-1")]);
      else
        tokens.push([factory.generateLocator(base, "nth", part.body)]);
      continue;
    }
    if (part.name === "internal:text") {
      const { exact, text } = detectExact(part.body);
      tokens.push([factory.generateLocator(base, "text", text, { exact })]);
      continue;
    }
    if (part.name === "internal:has-text") {
      const { exact, text } = detectExact(part.body);
      if (!exact) {
        tokens.push([factory.generateLocator(base, "has-text", text, { exact })]);
        continue;
      }
    }
    if (part.name === "internal:has-not-text") {
      const { exact, text } = detectExact(part.body);
      if (!exact) {
        tokens.push([factory.generateLocator(base, "has-not-text", text, { exact })]);
        continue;
      }
    }
    if (part.name === "internal:has") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "has", inner)));
      continue;
    }
    if (part.name === "internal:has-not") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "hasNot", inner)));
      continue;
    }
    if (part.name === "internal:and") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "and", inner)));
      continue;
    }
    if (part.name === "internal:or") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "or", inner)));
      continue;
    }
    if (part.name === "internal:chain") {
      const inners = innerAsLocators(factory, part.body.parsed, false, maxOutputSize);
      tokens.push(inners.map((inner) => factory.generateLocator(base, "chain", inner)));
      continue;
    }
    if (part.name === "internal:label") {
      const { exact, text } = detectExact(part.body);
      tokens.push([factory.generateLocator(base, "label", text, { exact })]);
      continue;
    }
    if (part.name === "internal:role") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const options = { attrs: [] };
      for (const attr of attrSelector.attributes) {
        if (attr.name === "name") {
          options.exact = attr.caseSensitive;
          options.name = attr.value;
        } else {
          if (attr.name === "level" && typeof attr.value === "string")
            attr.value = +attr.value;
          options.attrs.push({ name: attr.name === "include-hidden" ? "includeHidden" : attr.name, value: attr.value });
        }
      }
      tokens.push([factory.generateLocator(base, "role", attrSelector.name, options)]);
      continue;
    }
    if (part.name === "internal:testid") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const { value } = attrSelector.attributes[0];
      tokens.push([factory.generateLocator(base, "test-id", value)]);
      continue;
    }
    if (part.name === "internal:attr") {
      const attrSelector = parseAttributeSelector(part.body, true);
      const { name, value, caseSensitive } = attrSelector.attributes[0];
      const text = value;
      const exact = !!caseSensitive;
      if (name === "placeholder") {
        tokens.push([factory.generateLocator(base, "placeholder", text, { exact })]);
        continue;
      }
      if (name === "alt") {
        tokens.push([factory.generateLocator(base, "alt", text, { exact })]);
        continue;
      }
      if (name === "title") {
        tokens.push([factory.generateLocator(base, "title", text, { exact })]);
        continue;
      }
    }
    let locatorType = "default";
    const nextPart = parts[index + 1];
    if (nextPart && nextPart.name === "internal:control" && nextPart.body === "enter-frame") {
      locatorType = "frame";
      nextBase = "frame-locator";
      index++;
    }
    const selectorPart = stringifySelector({ parts: [part] });
    const locatorPart = factory.generateLocator(base, locatorType, selectorPart);
    if (locatorType === "default" && nextPart && ["internal:has-text", "internal:has-not-text"].includes(nextPart.name)) {
      const { exact, text } = detectExact(nextPart.body);
      if (!exact) {
        const nextLocatorPart = factory.generateLocator("locator", nextPart.name === "internal:has-text" ? "has-text" : "has-not-text", text, { exact });
        const options = {};
        if (nextPart.name === "internal:has-text")
          options.hasText = text;
        else
          options.hasNotText = text;
        const combinedPart = factory.generateLocator(base, "default", selectorPart, options);
        tokens.push([factory.chainLocators([locatorPart, nextLocatorPart]), combinedPart]);
        index++;
        continue;
      }
    }
    let locatorPartWithEngine;
    if (["xpath", "css"].includes(part.name)) {
      const selectorPart2 = stringifySelector(
        { parts: [part] },
        /* forceEngineName */
        true
      );
      locatorPartWithEngine = factory.generateLocator(base, locatorType, selectorPart2);
    }
    tokens.push([locatorPart, locatorPartWithEngine].filter(Boolean));
  }
  return combineTokens(factory, tokens, maxOutputSize);
}
function combineTokens(factory, tokens, maxOutputSize) {
  const currentTokens = tokens.map(() => "");
  const result = [];
  const visit = (index) => {
    if (index === tokens.length) {
      result.push(factory.chainLocators(currentTokens));
      return currentTokens.length < maxOutputSize;
    }
    for (const taken of tokens[index]) {
      currentTokens[index] = taken;
      if (!visit(index + 1))
        return false;
    }
    return true;
  };
  visit(0);
  return result;
}
function detectExact(text) {
  let exact = false;
  const match = text.match(/^\\/(.*)\\/([igm]*)$/);
  if (match)
    return { text: new RegExp(match[1], match[2]) };
  if (text.endsWith('"')) {
    text = JSON.parse(text);
    exact = true;
  } else if (text.endsWith('"s')) {
    text = JSON.parse(text.substring(0, text.length - 1));
    exact = true;
  } else if (text.endsWith('"i')) {
    text = JSON.parse(text.substring(0, text.length - 1));
    exact = false;
  }
  return { exact, text };
}
var JavaScriptLocatorFactory = class {
  constructor(preferredQuote) {
    this.preferredQuote = preferredQuote;
  }
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, { hasText: \${this.toHasText(options.hasText)} })\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, { hasNotText: \${this.toHasText(options.hasNotText)} })\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first()\`;
      case "last":
        return \`last()\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`name: \${this.regexToSourceString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`name: \${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`exact: true\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`\${name}: \${typeof value === "string" ? this.quote(value) : value}\`);
        const attrString = attrs.length ? \`, { \${attrs.join(", ")} }\` : "";
        return \`getByRole(\${this.quote(body)}\${attrString})\`;
      case "has-text":
        return \`filter({ hasText: \${this.toHasText(body)} })\`;
      case "has-not-text":
        return \`filter({ hasNotText: \${this.toHasText(body)} })\`;
      case "has":
        return \`filter({ has: \${body} })\`;
      case "hasNot":
        return \`filter({ hasNot: \${body} })\`;
      case "and":
        return \`and(\${body})\`;
      case "or":
        return \`or(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`getByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("getByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("getByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("getByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("getByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact("getByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToSourceString(re) {
    return normalizeEscapedRegexQuotes(String(re));
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToSourceString(body)})\`;
    return exact ? \`\${method}(\${this.quote(body)}, { exact: true })\` : \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToSourceString(body);
    return this.quote(body);
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToSourceString(value);
    return this.quote(value);
  }
  quote(text) {
    var _a;
    return escapeWithQuotes(text, (_a = this.preferredQuote) != null ? _a : "'");
  }
};
var PythonLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, has_text=\${this.toHasText(options.hasText)})\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, has_not_text=\${this.toHasText(options.hasNotText)})\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frame_locator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first\`;
      case "last":
        return \`last\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`name=\${this.regexToString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`name=\${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`exact=True\`);
        }
        for (const { name, value } of options.attrs) {
          let valueString = typeof value === "string" ? this.quote(value) : value;
          if (typeof value === "boolean")
            valueString = value ? "True" : "False";
          attrs.push(\`\${toSnakeCase(name)}=\${valueString}\`);
        }
        const attrString = attrs.length ? \`, \${attrs.join(", ")}\` : "";
        return \`get_by_role(\${this.quote(body)}\${attrString})\`;
      case "has-text":
        return \`filter(has_text=\${this.toHasText(body)})\`;
      case "has-not-text":
        return \`filter(has_not_text=\${this.toHasText(body)})\`;
      case "has":
        return \`filter(has=\${body})\`;
      case "hasNot":
        return \`filter(has_not=\${body})\`;
      case "and":
        return \`and_(\${body})\`;
      case "or":
        return \`or_(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`get_by_test_id(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("get_by_text", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("get_by_alt_text", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("get_by_placeholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("get_by_label", body, !!options.exact);
      case "title":
        return this.toCallWithExact("get_by_title", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", re.IGNORECASE" : "";
    return \`re.compile(r"\${normalizeEscapedRegexQuotes(body.source).replace(/\\\\\\//, "/").replace(/"/g, '\\\\"')}"\${suffix})\`;
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, exact=True)\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToString(body);
    return \`\${this.quote(body)}\`;
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var JavaLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    let clazz;
    switch (base) {
      case "page":
        clazz = "Page";
        break;
      case "frame-locator":
        clazz = "FrameLocator";
        break;
      case "locator":
        clazz = "Locator";
        break;
    }
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`locator(\${this.quote(body)}, new \${clazz}.LocatorOptions().setHasText(\${this.toHasText(options.hasText)}))\`;
        if (options.hasNotText !== void 0)
          return \`locator(\${this.quote(body)}, new \${clazz}.LocatorOptions().setHasNotText(\${this.toHasText(options.hasNotText)}))\`;
        return \`locator(\${this.quote(body)})\`;
      case "frame":
        return \`frameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`nth(\${body})\`;
      case "first":
        return \`first()\`;
      case "last":
        return \`last()\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`.setName(\${this.regexToString(options.name)})\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`.setName(\${this.quote(options.name)})\`);
          if (options.exact)
            attrs.push(\`.setExact(true)\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`.set\${toTitleCase(name)}(\${typeof value === "string" ? this.quote(value) : value})\`);
        const attrString = attrs.length ? \`, new \${clazz}.GetByRoleOptions()\${attrs.join("")}\` : "";
        return \`getByRole(AriaRole.\${toSnakeCase(body).toUpperCase()}\${attrString})\`;
      case "has-text":
        return \`filter(new \${clazz}.FilterOptions().setHasText(\${this.toHasText(body)}))\`;
      case "has-not-text":
        return \`filter(new \${clazz}.FilterOptions().setHasNotText(\${this.toHasText(body)}))\`;
      case "has":
        return \`filter(new \${clazz}.FilterOptions().setHas(\${body}))\`;
      case "hasNot":
        return \`filter(new \${clazz}.FilterOptions().setHasNot(\${body}))\`;
      case "and":
        return \`and(\${body})\`;
      case "or":
        return \`or(\${body})\`;
      case "chain":
        return \`locator(\${body})\`;
      case "test-id":
        return \`getByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact(clazz, "getByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact(clazz, "getByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact(clazz, "getByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact(clazz, "getByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact(clazz, "getByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", Pattern.CASE_INSENSITIVE" : "";
    return \`Pattern.compile(\${this.quote(normalizeEscapedRegexQuotes(body.source))}\${suffix})\`;
  }
  toCallWithExact(clazz, method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, new \${clazz}.\${toTitleCase(method)}Options().setExact(true))\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return this.regexToString(body);
    return this.quote(body);
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var CSharpLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    switch (kind) {
      case "default":
        if (options.hasText !== void 0)
          return \`Locator(\${this.quote(body)}, new() { \${this.toHasText(options.hasText)} })\`;
        if (options.hasNotText !== void 0)
          return \`Locator(\${this.quote(body)}, new() { \${this.toHasNotText(options.hasNotText)} })\`;
        return \`Locator(\${this.quote(body)})\`;
      case "frame":
        return \`FrameLocator(\${this.quote(body)})\`;
      case "nth":
        return \`Nth(\${body})\`;
      case "first":
        return \`First\`;
      case "last":
        return \`Last\`;
      case "role":
        const attrs = [];
        if (isRegExp(options.name)) {
          attrs.push(\`NameRegex = \${this.regexToString(options.name)}\`);
        } else if (typeof options.name === "string") {
          attrs.push(\`Name = \${this.quote(options.name)}\`);
          if (options.exact)
            attrs.push(\`Exact = true\`);
        }
        for (const { name, value } of options.attrs)
          attrs.push(\`\${toTitleCase(name)} = \${typeof value === "string" ? this.quote(value) : value}\`);
        const attrString = attrs.length ? \`, new() { \${attrs.join(", ")} }\` : "";
        return \`GetByRole(AriaRole.\${toTitleCase(body)}\${attrString})\`;
      case "has-text":
        return \`Filter(new() { \${this.toHasText(body)} })\`;
      case "has-not-text":
        return \`Filter(new() { \${this.toHasNotText(body)} })\`;
      case "has":
        return \`Filter(new() { Has = \${body} })\`;
      case "hasNot":
        return \`Filter(new() { HasNot = \${body} })\`;
      case "and":
        return \`And(\${body})\`;
      case "or":
        return \`Or(\${body})\`;
      case "chain":
        return \`Locator(\${body})\`;
      case "test-id":
        return \`GetByTestId(\${this.toTestIdValue(body)})\`;
      case "text":
        return this.toCallWithExact("GetByText", body, !!options.exact);
      case "alt":
        return this.toCallWithExact("GetByAltText", body, !!options.exact);
      case "placeholder":
        return this.toCallWithExact("GetByPlaceholder", body, !!options.exact);
      case "label":
        return this.toCallWithExact("GetByLabel", body, !!options.exact);
      case "title":
        return this.toCallWithExact("GetByTitle", body, !!options.exact);
      default:
        throw new Error("Unknown selector kind " + kind);
    }
  }
  chainLocators(locators) {
    return locators.join(".");
  }
  regexToString(body) {
    const suffix = body.flags.includes("i") ? ", RegexOptions.IgnoreCase" : "";
    return \`new Regex(\${this.quote(normalizeEscapedRegexQuotes(body.source))}\${suffix})\`;
  }
  toCallWithExact(method, body, exact) {
    if (isRegExp(body))
      return \`\${method}(\${this.regexToString(body)})\`;
    if (exact)
      return \`\${method}(\${this.quote(body)}, new() { Exact = true })\`;
    return \`\${method}(\${this.quote(body)})\`;
  }
  toHasText(body) {
    if (isRegExp(body))
      return \`HasTextRegex = \${this.regexToString(body)}\`;
    return \`HasText = \${this.quote(body)}\`;
  }
  toTestIdValue(value) {
    if (isRegExp(value))
      return this.regexToString(value);
    return this.quote(value);
  }
  toHasNotText(body) {
    if (isRegExp(body))
      return \`HasNotTextRegex = \${this.regexToString(body)}\`;
    return \`HasNotText = \${this.quote(body)}\`;
  }
  quote(text) {
    return escapeWithQuotes(text, '"');
  }
};
var JsonlLocatorFactory = class {
  generateLocator(base, kind, body, options = {}) {
    return JSON.stringify({
      kind,
      body,
      options
    });
  }
  chainLocators(locators) {
    const objects = locators.map((l) => JSON.parse(l));
    for (let i = 0; i < objects.length - 1; ++i)
      objects[i].next = objects[i + 1];
    return JSON.stringify(objects[0]);
  }
};
var generators = {
  javascript: JavaScriptLocatorFactory,
  python: PythonLocatorFactory,
  java: JavaLocatorFactory,
  csharp: CSharpLocatorFactory,
  jsonl: JsonlLocatorFactory
};
function isRegExp(obj) {
  return obj instanceof RegExp;
}

// packages/playwright-core/src/server/injected/consoleApi.ts
var selectorSymbol = Symbol("selector");
var _Locator = class _Locator {
  constructor(injectedScript, selector, options) {
    if (options == null ? void 0 : options.hasText)
      selector += \` >> internal:has-text=\${escapeForTextSelector(options.hasText, false)}\`;
    if (options == null ? void 0 : options.hasNotText)
      selector += \` >> internal:has-not-text=\${escapeForTextSelector(options.hasNotText, false)}\`;
    if (options == null ? void 0 : options.has)
      selector += \` >> internal:has=\` + JSON.stringify(options.has[selectorSymbol]);
    if (options == null ? void 0 : options.hasNot)
      selector += \` >> internal:has-not=\` + JSON.stringify(options.hasNot[selectorSymbol]);
    this[selectorSymbol] = selector;
    if (selector) {
      const parsed = injectedScript.parseSelector(selector);
      this.element = injectedScript.querySelector(parsed, injectedScript.document, false);
      this.elements = injectedScript.querySelectorAll(parsed, injectedScript.document);
    }
    const selectorBase = selector;
    const self = this;
    self.locator = (selector2, options2) => {
      return new _Locator(injectedScript, selectorBase ? selectorBase + " >> " + selector2 : selector2, options2);
    };
    self.getByTestId = (testId) => self.locator(getByTestIdSelector(injectedScript.testIdAttributeNameForStrictErrorAndConsoleCodegen(), testId));
    self.getByAltText = (text, options2) => self.locator(getByAltTextSelector(text, options2));
    self.getByLabel = (text, options2) => self.locator(getByLabelSelector(text, options2));
    self.getByPlaceholder = (text, options2) => self.locator(getByPlaceholderSelector(text, options2));
    self.getByText = (text, options2) => self.locator(getByTextSelector(text, options2));
    self.getByTitle = (text, options2) => self.locator(getByTitleSelector(text, options2));
    self.getByRole = (role, options2 = {}) => self.locator(getByRoleSelector(role, options2));
    self.filter = (options2) => new _Locator(injectedScript, selector, options2);
    self.first = () => self.locator("nth=0");
    self.last = () => self.locator("nth=-1");
    self.nth = (index) => self.locator(\`nth=\${index}\`);
    self.and = (locator) => new _Locator(injectedScript, selectorBase + \` >> internal:and=\` + JSON.stringify(locator[selectorSymbol]));
    self.or = (locator) => new _Locator(injectedScript, selectorBase + \` >> internal:or=\` + JSON.stringify(locator[selectorSymbol]));
  }
};
selectorSymbol;
var Locator = _Locator;
var ConsoleAPI = class {
  constructor(injectedScript) {
    this._injectedScript = injectedScript;
    if (this._injectedScript.window.playwright)
      return;
    this._injectedScript.window.playwright = {
      $: (selector, strict) => this._querySelector(selector, !!strict),
      $$: (selector) => this._querySelectorAll(selector),
      inspect: (selector) => this._inspect(selector),
      selector: (element) => this._selector(element),
      generateLocator: (element, language) => this._generateLocator(element, language),
      resume: () => this._resume(),
      ...new Locator(injectedScript, "")
    };
    delete this._injectedScript.window.playwright.filter;
    delete this._injectedScript.window.playwright.first;
    delete this._injectedScript.window.playwright.last;
    delete this._injectedScript.window.playwright.nth;
    delete this._injectedScript.window.playwright.and;
    delete this._injectedScript.window.playwright.or;
  }
  _querySelector(selector, strict) {
    if (typeof selector !== "string")
      throw new Error(\`Usage: playwright.query('Playwright >> selector').\`);
    const parsed = this._injectedScript.parseSelector(selector);
    return this._injectedScript.querySelector(parsed, this._injectedScript.document, strict);
  }
  _querySelectorAll(selector) {
    if (typeof selector !== "string")
      throw new Error(\`Usage: playwright.$$('Playwright >> selector').\`);
    const parsed = this._injectedScript.parseSelector(selector);
    return this._injectedScript.querySelectorAll(parsed, this._injectedScript.document);
  }
  _inspect(selector) {
    if (typeof selector !== "string")
      throw new Error(\`Usage: playwright.inspect('Playwright >> selector').\`);
    this._injectedScript.window.inspect(this._querySelector(selector, false));
  }
  _selector(element) {
    if (!(element instanceof Element))
      throw new Error(\`Usage: playwright.selector(element).\`);
    return this._injectedScript.generateSelectorSimple(element);
  }
  _generateLocator(element, language) {
    if (!(element instanceof Element))
      throw new Error(\`Usage: playwright.locator(element).\`);
    const selector = this._injectedScript.generateSelectorSimple(element);
    return asLocator(language || "javascript", selector);
  }
  _resume() {
    this._injectedScript.window.__pw_resume().catch(() => {
    });
  }
};
var consoleApi_default = ConsoleAPI;
`});var Eg=M(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.launchApp=xB;wu.syncLocalStorageWithSettings=EB;var _u=QE(require("fs")),KE=QE(require("path")),XE=qn(),YE=ie(),JE=De();function QE(r){return r&&r.__esModule?r:{default:r}}async function xB(r,e){var t,n;let s=[...(t=(n=e.persistentContextOptions)===null||n===void 0?void 0:n.args)!==null&&t!==void 0?t:[]];r.name()==="chromium"&&s.push("--app=data:text/html,",`--window-size=${e.windowSize.width},${e.windowSize.height}`,...e.windowPosition?[`--window-position=${e.windowPosition.x},${e.windowPosition.y}`]:[],"--test-type=");let o=await r.launchPersistentContext((0,JE.serverSideCallMetadata)(),"",{channel:(0,XE.findChromiumChannel)(e.sdkLanguage),noDefaultViewport:!0,ignoreDefaultArgs:["--enable-automation"],colorScheme:"no-override",acceptDownloads:(0,YE.isUnderTest)()?"accept":"internal-browser-default",...e?.persistentContextOptions,args:s}),[a]=o.pages();return r.name()==="chromium"&&process.platform==="darwin"&&o.on("page",async l=>{l.mainFrame().url()==="chrome://new-tab-page/"&&(await a.bringToFront(),await l.close((0,JE.serverSideCallMetadata)()))}),r.name()==="chromium"&&await SB(a),{context:o,page:a}}async function SB(r){let e=await _u.default.promises.readFile(require.resolve("./chromium/appIcon.png"));await r._delegate._mainFrameSession._client.send("Browser.setDockTile",{image:e.toString("base64")})}async function EB(r,e){if((0,YE.isUnderTest)())return;let t=KE.default.join(XE.registryDirectory,".settings",`${e}.json`);await r.exposeBinding("_saveSerializedSettings",!1,(s,o)=>{_u.default.mkdirSync(KE.default.dirname(t),{recursive:!0}),_u.default.writeFileSync(t,o)});let n=await _u.default.promises.readFile(t,"utf-8").catch(()=>"{}");await r.addInitScript(`(${String(s=>{location&&location.protocol==="data:"||(Object.entries(s).map(([o,a])=>localStorage[o]=a),window.saveSettings=()=>{window._saveSerializedSettings(JSON.stringify({...localStorage}))})})})(${n});
  `)}});var ek=M(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});vu.Download=void 0;var kB=OB(require("path")),ZE=Et(),CB=ie(),TB=is();function OB(r){return r&&r.__esModule?r:{default:r}}var kg=class{constructor(e,t,n,s,o){this.artifact=void 0,this.url=void 0,this._page=void 0,this._suggestedFilename=void 0;let a=e._browserContext._options.acceptDownloads==="deny"?"Pass { acceptDownloads: true } when you are creating your browser context.":void 0;this.artifact=new TB.Artifact(e,kB.default.join(t,n),a,()=>this._page._browserContext.cancelDownload(n)),this._page=e,this.url=s,this._suggestedFilename=o,e._browserContext._downloads.add(this),o!==void 0&&this._page.emit(ZE.Page.Events.Download,this)}_filenameSuggested(e){(0,CB.assert)(this._suggestedFilename===void 0),this._suggestedFilename=e,this._page.emit(ZE.Page.Events.Download,this)}suggestedFilename(){return this._suggestedFilename}};vu.Download=kg});var li=M(yu=>{"use strict";Object.defineProperty(yu,"__esModule",{value:!0});yu.Browser=void 0;var Cg=$e(),tk=Et(),PB=ek(),AB=De(),IB=is(),bu=class r extends AB.SdkObject{constructor(e,t){super(e,"browser"),this.options=void 0,this._downloads=new Map,this._defaultContext=null,this._startedClosing=!1,this._idToVideo=new Map,this._contextForReuse=void 0,this._closeReason=void 0,this._isCollocatedWithServer=!0,this.attribution.browser=this,this.options=t,this.instrumentation.onBrowserOpen(this)}async newContext(e,t){(0,Cg.validateBrowserContextOptions)(t,this.options);let n=await this.doCreateNewContext(t);return t.storageState&&await n.setStorageState(e,t.storageState),n}async newContextForReuse(e,t){let n=Cg.BrowserContext.reusableContextHash(e);return!this._contextForReuse||n!==this._contextForReuse.hash||!this._contextForReuse.context.canResetForReuse()?(this._contextForReuse&&await this._contextForReuse.context.close({reason:"Context reused"}),this._contextForReuse={context:await this.newContext(t,e),hash:n},{context:this._contextForReuse.context,needsReset:!1}):(await this._contextForReuse.context.stopPendingOperations("Context recreated"),{context:this._contextForReuse.context,needsReset:!0})}async stopPendingOperations(e){var t;await((t=this._contextForReuse)===null||t===void 0||(t=t.context)===null||t===void 0?void 0:t.stopPendingOperations(e))}_downloadCreated(e,t,n,s){let o=new PB.Download(e,this.options.downloadsPath||"",t,n,s);this._downloads.set(t,o)}_downloadFilenameSuggested(e,t){let n=this._downloads.get(e);n&&n._filenameSuggested(t)}_downloadFinished(e,t){let n=this._downloads.get(e);n&&(n.artifact.reportFinished(t?new Error(t):void 0),this._downloads.delete(e))}_videoStarted(e,t,n,s){let o=new IB.Artifact(e,n);this._idToVideo.set(t,{context:e,artifact:o}),s.then(a=>{a instanceof tk.Page&&(a._video=o,a.emitOnContext(Cg.BrowserContext.Events.VideoStarted,o),a.emit(tk.Page.Events.Video,o))})}_takeVideo(e){let t=this._idToVideo.get(e);return this._idToVideo.delete(e),t?.artifact}_didClose(){for(let e of this.contexts())e._browserClosed();this._defaultContext&&this._defaultContext._browserClosed(),this.emit(r.Events.Disconnected),this.instrumentation.onBrowserClose(this)}async close(e){this._startedClosing||(e.reason&&(this._closeReason=e.reason),this._startedClosing=!0,await this.options.browserProcess.close()),this.isConnected()&&await new Promise(t=>this.once(r.Events.Disconnected,t))}async killForTests(){await this.options.browserProcess.kill()}};yu.Browser=bu;bu.Events={Disconnected:"disconnected"}});var ra=M(rn=>{"use strict";Object.defineProperty(rn,"__esModule",{value:!0});rn.kBrowserCloseMessageId=rn.ConnectionEvents=rn.CRSession=rn.CRConnection=rn.CDPSession=void 0;var Tg=ie(),Pg=require("events"),RB=Le(),MB=yt(),nk=Wt(),FB=rn.ConnectionEvents={Disconnected:Symbol("ConnectionEvents.Disconnected")},NB=rn.kBrowserCloseMessageId=-9999,Og=class extends Pg.EventEmitter{constructor(e,t,n){super(),this._lastId=0,this._transport=void 0,this._sessions=new Map,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this._browserDisconnectedLogs=void 0,this.rootSession=void 0,this._closed=!1,this.setMaxListeners(0),this._transport=e,this._protocolLogger=t,this._browserLogsCollector=n,this.rootSession=new xu(this,null,""),this._sessions.set("",this.rootSession),this._transport.onmessage=this._onMessage.bind(this),this._transport.onclose=this._onClose.bind(this)}_rawSend(e,t,n){let s=++this._lastId,o={id:s,method:t,params:n};return e&&(o.sessionId=e),this._protocolLogger("send",o),this._transport.send(o),s}async _onMessage(e){if(this._protocolLogger("receive",e),e.id===NB)return;let t=this._sessions.get(e.sessionId||"");t&&t._onMessage(e)}_onClose(e){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0,this._browserDisconnectedLogs=MB.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs(),e),this.rootSession.dispose(),Promise.resolve().then(()=>this.emit(FB.Disconnected))}close(){this._closed||this._transport.close()}async createBrowserSession(){let{sessionId:e}=await this.rootSession.send("Target.attachToBrowserTarget");return new na(this.rootSession,e)}};rn.CRConnection=Og;var xu=class r extends Pg.EventEmitter{constructor(e,t,n,s){super(),this._connection=void 0,this._eventListener=void 0,this._callbacks=new Map,this._sessionId=void 0,this._parentSession=void 0,this._crashed=!1,this._closed=!1,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this._connection=e,this._parentSession=t,this._sessionId=n,this._eventListener=s,this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}_markAsCrashed(){this._crashed=!0}createChildSession(e,t){let n=new r(this._connection,this,e,t);return this._connection._sessions.set(e,n),n}async send(e,t){if(this._crashed||this._closed||this._connection._closed||this._connection._browserDisconnectedLogs)throw new nk.ProtocolError(this._crashed?"crashed":"closed",void 0,this._connection._browserDisconnectedLogs);let n=this._connection._rawSend(this._sessionId,e,t);return new Promise((s,o)=>{this._callbacks.set(n,{resolve:s,reject:o,error:new nk.ProtocolError("error",e)})})}_sendMayFail(e,t){return this.send(e,t).catch(n=>RB.debugLogger.log("error",n))}_onMessage(e){var t;if(e.id&&this._callbacks.has(e.id)){let s=this._callbacks.get(e.id);this._callbacks.delete(e.id),e.error?(s.error.setMessage(e.error.message),s.reject(s.error)):s.resolve(e.result)}else if(!(e.id&&((t=e.error)===null||t===void 0?void 0:t.code)===-32001)){var n;(0,Tg.assert)(!e.id,(e==null||(n=e.error)===null||n===void 0?void 0:n.message)||void 0),Promise.resolve().then(()=>{this._eventListener&&this._eventListener(e.method,e.params),this.emit(e.method,e.params)})}}async detach(){if(this._closed)throw new Error("Session already detached. Most likely the page has been closed.");if(!this._parentSession)throw new Error("Root session cannot be closed");await this._sendMayFail("Runtime.runIfWaitingForDebugger"),await this._parentSession.send("Target.detachFromTarget",{sessionId:this._sessionId}),this.dispose()}dispose(){this._closed=!0,this._connection._sessions.delete(this._sessionId);for(let e of this._callbacks.values())e.error.setMessage("Internal server error, session closed."),e.error.type=this._crashed?"crashed":"closed",e.error.logs=this._connection._browserDisconnectedLogs,e.reject(e.error);this._callbacks.clear()}};rn.CRSession=xu;var na=class r extends Pg.EventEmitter{constructor(e,t){super(),this.guid=void 0,this._session=void 0,this._listeners=[],this.guid=`cdp-session@${t}`,this._session=e.createChildSession(t,(n,s)=>this.emit(r.Events.Event,{method:n,params:s})),this._listeners=[Tg.eventsHelper.addEventListener(e,"Target.detachedFromTarget",n=>{n.sessionId===t&&this._onClose()})]}async send(e,t){return await this._session.send(e,t)}async detach(){return await this._session.detach()}async attachToTarget(e){let{sessionId:t}=await this.send("Target.attachToTarget",{targetId:e,flatten:!0});return new r(this._session,t)}_onClose(){Tg.eventsHelper.removeEventListeners(this._listeners),this._session.dispose(),this.emit(r.Events.Closed)}};rn.CDPSession=na;na.Events={Event:"event",Closed:"close"}});var Eu=M(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});Su.Dialog=void 0;var rk=ie(),LB=De(),Ag=class extends LB.SdkObject{constructor(e,t,n,s,o){super(e,"dialog"),this._page=void 0,this._type=void 0,this._message=void 0,this._onHandle=void 0,this._handled=!1,this._defaultValue=void 0,this._page=e,this._type=t,this._message=n,this._onHandle=s,this._defaultValue=o||"",this._page._frameManager.dialogDidOpen(this)}page(){return this._page}type(){return this._type}message(){return this._message}defaultValue(){return this._defaultValue}async accept(e){(0,rk.assert)(!this._handled,"Cannot accept dialog which is already handled!"),this._handled=!0,this._page._frameManager.dialogWillClose(this),await this._onHandle(!0,e)}async dismiss(){(0,rk.assert)(!this._handled,"Cannot dismiss dialog which is already handled!"),this._handled=!0,this._page._frameManager.dialogWillClose(this),await this._onHandle(!1)}async close(){this._type==="beforeunload"?await this.accept():await this.dismiss()}};Su.Dialog=Ag});var ik=M(Rg=>{"use strict";Object.defineProperty(Rg,"__esModule",{value:!0});Rg.getAccessibilityTree=DB;async function DB(r,e){let{nodes:t}=await r.send("Accessibility.getFullAXTree"),n=Ig.createTree(r,t);return{tree:n,needle:e?await n._findElement(e):null}}var Ig=class r{constructor(e,t){this._payload=void 0,this._children=[],this._richlyEditable=!1,this._editable=!1,this._focusable=!1,this._expanded=!1,this._hidden=!1,this._name=void 0,this._role=void 0,this._cachedHasFocusableChild=void 0,this._client=void 0,this._client=e,this._payload=t,this._name=this._payload.name?this._payload.name.value:"",this._role=this._payload.role?this._payload.role.value:"Unknown";for(let n of this._payload.properties||[])n.name==="editable"&&(this._richlyEditable=n.value.value==="richtext",this._editable=!0),n.name==="focusable"&&(this._focusable=n.value.value),n.name==="expanded"&&(this._expanded=n.value.value),n.name==="hidden"&&(this._hidden=n.value.value)}_isPlainTextField(){return this._richlyEditable?!1:this._editable?!0:this._role==="textbox"||this._role==="ComboBox"||this._role==="searchbox"}_isTextOnlyObject(){let e=this._role;return e==="LineBreak"||e==="text"||e==="InlineTextBox"||e==="StaticText"}_hasFocusableChild(){if(this._cachedHasFocusableChild===void 0){this._cachedHasFocusableChild=!1;for(let e of this._children)if(e._focusable||e._hasFocusableChild()){this._cachedHasFocusableChild=!0;break}}return this._cachedHasFocusableChild}children(){return this._children}async _findElement(e){let t=e._objectId,{node:{backendNodeId:n}}=await this._client.send("DOM.describeNode",{objectId:t});return this.find(o=>o._payload.backendDOMNodeId===n)||null}find(e){if(e(this))return this;for(let t of this._children){let n=t.find(e);if(n)return n}return null}isLeafNode(){if(!this._children.length||this._isPlainTextField()||this._isTextOnlyObject())return!0;switch(this._role){case"doc-cover":case"graphics-symbol":case"img":case"Meter":case"scrollbar":case"slider":case"separator":case"progressbar":return!0;default:break}return this._hasFocusableChild()?!1:!!(this._focusable&&this._role!=="WebArea"&&this._role!=="RootWebArea"&&this._name||this._role==="heading"&&this._name)}isControl(){switch(this._role){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"tree":return!0;default:return!1}}isInteresting(e){return this._role==="Ignored"||this._hidden?!1:this._focusable||this._richlyEditable||this.isControl()?!0:e?!1:this.isLeafNode()&&!!this._name}normalizedRole(){switch(this._role){case"RootWebArea":return"WebArea";case"StaticText":return"text";default:return this._role}}serialize(){let e=new Map;for(let c of this._payload.properties||[])e.set(c.name.toLowerCase(),c.value.value);this._payload.description&&e.set("description",this._payload.description.value);let t={role:this.normalizedRole(),name:this._payload.name&&this._payload.name.value||""},n=["description","keyshortcuts","roledescription","valuetext"];for(let c of n)e.has(c)&&(t[c]=e.get(c));let s=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"];for(let c of s){if(c==="focused"&&(this._role==="WebArea"||this._role==="RootWebArea"))continue;let u=e.get(c);u&&(t[c]=u)}let o=["level","valuemax","valuemin"];for(let c of o)e.has(c)&&(t[c]=e.get(c));let a=["autocomplete","haspopup","invalid","orientation"];for(let c of a){let u=e.get(c);!u||u==="false"||(t[c]=u)}let l=t;return this._payload.value&&(typeof this._payload.value.value=="string"&&(l.valueString=this._payload.value.value),typeof this._payload.value.value=="number"&&(l.valueNumber=this._payload.value.value)),e.has("checked")&&(l.checked=e.get("checked")==="true"?"checked":e.get("checked")==="false"?"unchecked":"mixed"),e.has("pressed")&&(l.pressed=e.get("pressed")==="true"?"pressed":e.get("pressed")==="false"?"released":"mixed"),l}static createTree(e,t){let n=new Map;for(let s of t)n.set(s.nodeId,new r(e,s));for(let s of n.values())for(let o of s._payload.childIds||[])s._children.push(n.get(o));return n.values().next().value}}});var sk=M(Cu=>{"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});Cu.CRCoverage=void 0;var ci=Ze(),ku=ie(),Mg=class{constructor(e){this._jsCoverage=void 0,this._cssCoverage=void 0,this._jsCoverage=new Fg(e),this._cssCoverage=new Ng(e)}async startJSCoverage(e){return await this._jsCoverage.start(e)}async stopJSCoverage(){return await this._jsCoverage.stop()}async startCSSCoverage(e){return await this._cssCoverage.start(e)}async stopCSSCoverage(){return await this._cssCoverage.stop()}};Cu.CRCoverage=Mg;var Fg=class{constructor(e){this._client=void 0,this._enabled=void 0,this._scriptIds=void 0,this._scriptSources=void 0,this._eventListeners=void 0,this._resetOnNavigation=void 0,this._reportAnonymousScripts=!1,this._client=e,this._enabled=!1,this._scriptIds=new Set,this._scriptSources=new Map,this._eventListeners=[],this._resetOnNavigation=!1}async start(e){(0,ku.assert)(!this._enabled,"JSCoverage is already enabled");let{resetOnNavigation:t=!0,reportAnonymousScripts:n=!1}=e;this._resetOnNavigation=t,this._reportAnonymousScripts=n,this._enabled=!0,this._scriptIds.clear(),this._scriptSources.clear(),this._eventListeners=[ci.eventsHelper.addEventListener(this._client,"Debugger.scriptParsed",this._onScriptParsed.bind(this)),ci.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",this._onExecutionContextsCleared.bind(this)),ci.eventsHelper.addEventListener(this._client,"Debugger.paused",this._onDebuggerPaused.bind(this))],await Promise.all([this._client.send("Profiler.enable"),this._client.send("Profiler.startPreciseCoverage",{callCount:!0,detailed:!0}),this._client.send("Debugger.enable"),this._client.send("Debugger.setSkipAllPauses",{skip:!0})])}_onDebuggerPaused(){this._client.send("Debugger.resume")}_onExecutionContextsCleared(){this._resetOnNavigation&&(this._scriptIds.clear(),this._scriptSources.clear())}async _onScriptParsed(e){if(this._scriptIds.add(e.scriptId),!e.url&&!this._reportAnonymousScripts)return;let t=await this._client._sendMayFail("Debugger.getScriptSource",{scriptId:e.scriptId});t&&this._scriptSources.set(e.scriptId,t.scriptSource)}async stop(){(0,ku.assert)(this._enabled,"JSCoverage is not enabled"),this._enabled=!1;let[e]=await Promise.all([this._client.send("Profiler.takePreciseCoverage"),this._client.send("Profiler.stopPreciseCoverage"),this._client.send("Profiler.disable"),this._client.send("Debugger.disable")]);ci.eventsHelper.removeEventListeners(this._eventListeners);let t={entries:[]};for(let n of e.result){if(!this._scriptIds.has(n.scriptId)||!n.url&&!this._reportAnonymousScripts)continue;let s=this._scriptSources.get(n.scriptId);s?t.entries.push({...n,source:s}):t.entries.push(n)}return t}},Ng=class{constructor(e){this._client=void 0,this._enabled=void 0,this._stylesheetURLs=void 0,this._stylesheetSources=void 0,this._eventListeners=void 0,this._resetOnNavigation=void 0,this._client=e,this._enabled=!1,this._stylesheetURLs=new Map,this._stylesheetSources=new Map,this._eventListeners=[],this._resetOnNavigation=!1}async start(e){(0,ku.assert)(!this._enabled,"CSSCoverage is already enabled");let{resetOnNavigation:t=!0}=e;this._resetOnNavigation=t,this._enabled=!0,this._stylesheetURLs.clear(),this._stylesheetSources.clear(),this._eventListeners=[ci.eventsHelper.addEventListener(this._client,"CSS.styleSheetAdded",this._onStyleSheet.bind(this)),ci.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",this._onExecutionContextsCleared.bind(this))],await Promise.all([this._client.send("DOM.enable"),this._client.send("CSS.enable"),this._client.send("CSS.startRuleUsageTracking")])}_onExecutionContextsCleared(){this._resetOnNavigation&&(this._stylesheetURLs.clear(),this._stylesheetSources.clear())}async _onStyleSheet(e){let t=e.header;if(!t.sourceURL)return;let n=await this._client._sendMayFail("CSS.getStyleSheetText",{styleSheetId:t.styleSheetId});n&&(this._stylesheetURLs.set(t.styleSheetId,t.sourceURL),this._stylesheetSources.set(t.styleSheetId,n.text))}async stop(){(0,ku.assert)(this._enabled,"CSSCoverage is not enabled"),this._enabled=!1;let e=await this._client.send("CSS.stopRuleUsageTracking");await Promise.all([this._client.send("CSS.disable"),this._client.send("DOM.disable")]),ci.eventsHelper.removeEventListeners(this._eventListeners);let t=new Map;for(let s of e.ruleUsage){let o=t.get(s.styleSheetId);o||(o=[],t.set(s.styleSheetId,o)),o.push({startOffset:s.startOffset,endOffset:s.endOffset,count:s.used?1:0})}let n={entries:[]};for(let s of this._stylesheetURLs.keys()){let o=this._stylesheetURLs.get(s),a=this._stylesheetSources.get(s),l=BB(t.get(s)||[]);n.entries.push({url:o,ranges:l,text:a})}return n}};function BB(r){let e=[];for(let o of r)e.push({offset:o.startOffset,type:0,range:o}),e.push({offset:o.endOffset,type:1,range:o});e.sort((o,a)=>{if(o.offset!==a.offset)return o.offset-a.offset;if(o.type!==a.type)return a.type-o.type;let l=o.range.endOffset-o.range.startOffset,c=a.range.endOffset-a.range.startOffset;return o.type===0?c-l:l-c});let t=[],n=[],s=0;for(let o of e){if(t.length&&s<o.offset&&t[t.length-1]>0){let a=n.length?n[n.length-1]:null;a&&a.end===s?a.end=o.offset:n.push({start:s,end:o.offset})}s=o.offset,o.type===0?t.push(o.range.count):t.pop()}return n.filter(o=>o.end-o.start>1)}});var xr=M(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.exceptionToError=GB;Tn.getExceptionMessage=ok;Tn.readProtocolStream=zB;Tn.releaseObject=WB;Tn.saveProtocolStream=UB;Tn.toButtonsMask=JB;Tn.toConsoleMessageLocation=VB;Tn.toModifiersMask=KB;var jB=$B(require("fs")),qB=ht(),HB=Lt();function $B(r){return r&&r.__esModule?r:{default:r}}function ok(r){if(r.exception)return r.exception.description||String(r.exception.value);let e=r.text;if(r.stackTrace)for(let t of r.stackTrace.callFrames){let n=t.url+":"+t.lineNumber+":"+t.columnNumber,s=t.functionName||"<anonymous>";e+=`
    at ${s} (${n})`}return e}async function WB(r,e){await r.send("Runtime.releaseObject",{objectId:e}).catch(t=>{})}async function UB(r,e,t){let n=!1;await(0,qB.mkdirIfNeeded)(t);let s=await jB.default.promises.open(t,"w");for(;!n;){let o=await r.send("IO.read",{handle:e});n=o.eof;let a=Buffer.from(o.data,o.base64Encoded?"base64":void 0);await s.write(a)}await s.close(),await r.send("IO.close",{handle:e})}async function zB(r,e){let t=!1,n=[];for(;!t;){let s=await r.send("IO.read",{handle:e});t=s.eof;let o=Buffer.from(s.data,s.base64Encoded?"base64":void 0);n.push(o)}return await r.send("IO.close",{handle:e}),Buffer.concat(n)}function VB(r){return r&&r.callFrames.length?{url:r.callFrames[0].url,lineNumber:r.callFrames[0].lineNumber,columnNumber:r.callFrames[0].columnNumber}:{url:"",lineNumber:0,columnNumber:0}}function GB(r){let e=ok(r),t=e.split(`
`),n=t.findIndex(u=>u.startsWith("    at")),s="",o="";n===-1?s=e:(s=t.slice(0,n).join(`
`),o=e);let{name:a,message:l}=(0,HB.splitErrorMessage)(s),c=new Error(l);return c.stack=o,c.name=a,c}function KB(r){let e=0;return r.has("Alt")&&(e|=1),r.has("Control")&&(e|=2),r.has("Meta")&&(e|=4),r.has("Shift")&&(e|=8),e}function JB(r){let e=0;return r.has("left")&&(e|=1),r.has("right")&&(e|=2),r.has("middle")&&(e|=4),e}});var ak=M(Tu=>{"use strict";Object.defineProperty(Tu,"__esModule",{value:!0});Tu.DragManager=void 0;var XB=ie(),Lg=xr(),Dg=class{constructor(e){this._crPage=void 0,this._dragState=null,this._lastPosition={x:0,y:0},this._crPage=e}async cancelDrag(){return this._dragState?(await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragCancel",x:this._lastPosition.x,y:this._lastPosition.y,data:{items:[],dragOperationsMask:65535}}),this._dragState=null,!0):!1}async interceptDragCausedByMove(e,t,n,s,o,a){if(this._lastPosition={x:e,y:t},this._dragState){await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragOver",x:e,y:t,data:this._dragState,modifiers:(0,Lg.toModifiersMask)(o)});return}if(n!=="left")return a();let l=this._crPage._mainFrameSession._client,c,u=new Promise(h=>c=h);await Promise.all(this._crPage._page.frames().map(async h=>{await h.nonStallingEvaluateInExistingContext(function(){let p=Promise.resolve(!1),f=null,_=w=>f=w,v=()=>{p=new Promise(w=>{window.addEventListener("dragstart",_,{once:!0,capture:!0}),setTimeout(()=>w(f?!f.defaultPrevented:!1),0)})};window.addEventListener("mousemove",v,{once:!0,capture:!0}),window.__cleanupDrag=async()=>{let w=await p;return window.removeEventListener("mousemove",v,{capture:!0}),window.removeEventListener("dragstart",_,{capture:!0}),delete window.__cleanupDrag,w}}.toString(),!0,"utility").catch(()=>{})})),l.on("Input.dragIntercepted",c);try{await l.send("Input.setInterceptDrags",{enabled:!0})}catch{return l.off("Input.dragIntercepted",c),a()}await a();let d=(await Promise.all(this._crPage._page.frames().map(async h=>h.nonStallingEvaluateInExistingContext("window.__cleanupDrag && window.__cleanupDrag()",!1,"utility").catch(()=>!1)))).some(h=>h);this._dragState=d?(await u).data:null,l.off("Input.dragIntercepted",c),await l.send("Input.setInterceptDrags",{enabled:!1}),this._dragState&&await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"dragEnter",x:e,y:t,data:this._dragState,modifiers:(0,Lg.toModifiersMask)(o)})}isDragging(){return!!this._dragState}async drop(e,t,n){(0,XB.assert)(this._dragState,"missing drag state"),await this._crPage._mainFrameSession._client.send("Input.dispatchDragEvent",{type:"drop",x:e,y:t,data:this._dragState,modifiers:(0,Lg.toModifiersMask)(n)}),this._dragState=null}};Tu.DragManager=Dg});var Au=M(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.CRExecutionContext=void 0;var Ou=xr(),Sr=ej(mr()),YB=Lt(),QB=Zi(),ZB=Wt();function lk(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(lk=function(n){return n?t:e})(r)}function ej(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=lk(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var jg=class{constructor(e,t){this._client=void 0,this._contextId=void 0,this._client=e,this._contextId=t.id}async rawEvaluateJSON(e){let{exceptionDetails:t,result:n}=await this._client.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!0}).catch(Bg);if(t)throw new Sr.JavaScriptErrorInEvaluate((0,Ou.getExceptionMessage)(t));return n.value}async rawEvaluateHandle(e){let{exceptionDetails:t,result:n}=await this._client.send("Runtime.evaluate",{expression:e,contextId:this._contextId}).catch(Bg);if(t)throw new Sr.JavaScriptErrorInEvaluate((0,Ou.getExceptionMessage)(t));return n.objectId}rawCallFunctionNoReply(e,...t){this._client.send("Runtime.callFunctionOn",{functionDeclaration:e.toString(),arguments:t.map(n=>n instanceof Sr.JSHandle?{objectId:n._objectId}:{value:n}),returnByValue:!0,executionContextId:this._contextId,userGesture:!0}).catch(()=>{})}async evaluateWithArguments(e,t,n,s,o){let{exceptionDetails:a,result:l}=await this._client.send("Runtime.callFunctionOn",{functionDeclaration:e,objectId:n._objectId,arguments:[{objectId:n._objectId},...s.map(c=>({value:c})),...o.map(c=>({objectId:c}))],returnByValue:t,awaitPromise:!0,userGesture:!0}).catch(Bg);if(a)throw new Sr.JavaScriptErrorInEvaluate((0,Ou.getExceptionMessage)(a));return t?(0,QB.parseEvaluationResultValue)(l.value):n._context.createHandle(l)}async getProperties(e,t){let n=await this._client.send("Runtime.getProperties",{objectId:t,ownProperties:!0}),s=new Map;for(let o of n.result)!o.enumerable||!o.value||s.set(o.name,e.createHandle(o.value));return s}createHandle(e,t){return new Sr.JSHandle(e,t.subtype||t.type,nj(t),t.objectId,tj(t))}async releaseHandle(e){await(0,Ou.releaseObject)(this._client,e)}async objectCount(e){return+(await this._client.send("Runtime.queryObjects",{prototypeObjectId:e})).objects.description.match(/Array\((\d+)\)/)[1]}};Pu.CRExecutionContext=jg;function Bg(r){if(r.message.includes("Object reference chain is too long"))return{result:{type:"undefined"}};if(r.message.includes("Object couldn't be returned by value"))return{result:{type:"undefined"}};throw r instanceof TypeError&&r.message.startsWith("Converting circular structure to JSON")&&(0,YB.rewriteErrorMessage)(r,r.message+" Are you passing a nested JSHandle?"),!Sr.isJavaScriptErrorInEvaluate(r)&&!(0,ZB.isSessionClosedError)(r)?new Error("Execution context was destroyed, most likely because of a navigation."):r}function tj(r){let e=r.value,t=r.unserializableValue;return t?Sr.parseUnserializableValue(t):e}function nj(r){if(r.type==="undefined")return"undefined";if("value"in r)return String(r.value);if(r.unserializableValue)return String(r.unserializableValue);if(r.description==="Object"&&r.preview){let e=[];for(let{name:t,value:n}of r.preview.properties)e.push(`${t}: ${n}`);return`{${e.join(", ")}}`}return r.subtype==="array"&&r.preview?Sr.sparseArrayToString(r.preview.properties):r.description}});var qg=M(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:!0});Iu.macEditingCommands=void 0;var Q9=Iu.macEditingCommands={Backspace:"deleteBackward:",Enter:"insertNewline:",NumpadEnter:"insertNewline:",Escape:"cancelOperation:",ArrowUp:"moveUp:",ArrowDown:"moveDown:",ArrowLeft:"moveLeft:",ArrowRight:"moveRight:",F5:"complete:",Delete:"deleteForward:",Home:"scrollToBeginningOfDocument:",End:"scrollToEndOfDocument:",PageUp:"scrollPageUp:",PageDown:"scrollPageDown:","Shift+Backspace":"deleteBackward:","Shift+Enter":"insertNewline:","Shift+NumpadEnter":"insertNewline:","Shift+Escape":"cancelOperation:","Shift+ArrowUp":"moveUpAndModifySelection:","Shift+ArrowDown":"moveDownAndModifySelection:","Shift+ArrowLeft":"moveLeftAndModifySelection:","Shift+ArrowRight":"moveRightAndModifySelection:","Shift+F5":"complete:","Shift+Delete":"deleteForward:","Shift+Home":"moveToBeginningOfDocumentAndModifySelection:","Shift+End":"moveToEndOfDocumentAndModifySelection:","Shift+PageUp":"pageUpAndModifySelection:","Shift+PageDown":"pageDownAndModifySelection:","Shift+Numpad5":"delete:","Control+Tab":"selectNextKeyView:","Control+Enter":"insertLineBreak:","Control+NumpadEnter":"insertLineBreak:","Control+Quote":"insertSingleQuoteIgnoringSubstitution:","Control+KeyA":"moveToBeginningOfParagraph:","Control+KeyB":"moveBackward:","Control+KeyD":"deleteForward:","Control+KeyE":"moveToEndOfParagraph:","Control+KeyF":"moveForward:","Control+KeyH":"deleteBackward:","Control+KeyK":"deleteToEndOfParagraph:","Control+KeyL":"centerSelectionInVisibleArea:","Control+KeyN":"moveDown:","Control+KeyO":["insertNewlineIgnoringFieldEditor:","moveBackward:"],"Control+KeyP":"moveUp:","Control+KeyT":"transpose:","Control+KeyV":"pageDown:","Control+KeyY":"yank:","Control+Backspace":"deleteBackwardByDecomposingPreviousCharacter:","Control+ArrowUp":"scrollPageUp:","Control+ArrowDown":"scrollPageDown:","Control+ArrowLeft":"moveToLeftEndOfLine:","Control+ArrowRight":"moveToRightEndOfLine:","Shift+Control+Enter":"insertLineBreak:","Shift+Control+NumpadEnter":"insertLineBreak:","Shift+Control+Tab":"selectPreviousKeyView:","Shift+Control+Quote":"insertDoubleQuoteIgnoringSubstitution:","Shift+Control+KeyA":"moveToBeginningOfParagraphAndModifySelection:","Shift+Control+KeyB":"moveBackwardAndModifySelection:","Shift+Control+KeyE":"moveToEndOfParagraphAndModifySelection:","Shift+Control+KeyF":"moveForwardAndModifySelection:","Shift+Control+KeyN":"moveDownAndModifySelection:","Shift+Control+KeyP":"moveUpAndModifySelection:","Shift+Control+KeyV":"pageDownAndModifySelection:","Shift+Control+Backspace":"deleteBackwardByDecomposingPreviousCharacter:","Shift+Control+ArrowUp":"scrollPageUp:","Shift+Control+ArrowDown":"scrollPageDown:","Shift+Control+ArrowLeft":"moveToLeftEndOfLineAndModifySelection:","Shift+Control+ArrowRight":"moveToRightEndOfLineAndModifySelection:","Alt+Backspace":"deleteWordBackward:","Alt+Enter":"insertNewlineIgnoringFieldEditor:","Alt+NumpadEnter":"insertNewlineIgnoringFieldEditor:","Alt+Escape":"complete:","Alt+ArrowUp":["moveBackward:","moveToBeginningOfParagraph:"],"Alt+ArrowDown":["moveForward:","moveToEndOfParagraph:"],"Alt+ArrowLeft":"moveWordLeft:","Alt+ArrowRight":"moveWordRight:","Alt+Delete":"deleteWordForward:","Alt+PageUp":"pageUp:","Alt+PageDown":"pageDown:","Shift+Alt+Backspace":"deleteWordBackward:","Shift+Alt+Enter":"insertNewlineIgnoringFieldEditor:","Shift+Alt+NumpadEnter":"insertNewlineIgnoringFieldEditor:","Shift+Alt+Escape":"complete:","Shift+Alt+ArrowUp":"moveParagraphBackwardAndModifySelection:","Shift+Alt+ArrowDown":"moveParagraphForwardAndModifySelection:","Shift+Alt+ArrowLeft":"moveWordLeftAndModifySelection:","Shift+Alt+ArrowRight":"moveWordRightAndModifySelection:","Shift+Alt+Delete":"deleteWordForward:","Shift+Alt+PageUp":"pageUp:","Shift+Alt+PageDown":"pageDown:","Control+Alt+KeyB":"moveWordBackward:","Control+Alt+KeyF":"moveWordForward:","Control+Alt+Backspace":"deleteWordBackward:","Shift+Control+Alt+KeyB":"moveWordBackwardAndModifySelection:","Shift+Control+Alt+KeyF":"moveWordForwardAndModifySelection:","Shift+Control+Alt+Backspace":"deleteWordBackward:","Meta+NumpadSubtract":"cancel:","Meta+Backspace":"deleteToBeginningOfLine:","Meta+ArrowUp":"moveToBeginningOfDocument:","Meta+ArrowDown":"moveToEndOfDocument:","Meta+ArrowLeft":"moveToLeftEndOfLine:","Meta+ArrowRight":"moveToRightEndOfLine:","Shift+Meta+NumpadSubtract":"cancel:","Shift+Meta+Backspace":"deleteToBeginningOfLine:","Shift+Meta+ArrowUp":"moveToBeginningOfDocumentAndModifySelection:","Shift+Meta+ArrowDown":"moveToEndOfDocumentAndModifySelection:","Shift+Meta+ArrowLeft":"moveToLeftEndOfLineAndModifySelection:","Shift+Meta+ArrowRight":"moveToRightEndOfLineAndModifySelection:","Meta+KeyA":"selectAll:","Meta+KeyC":"copy:","Meta+KeyX":"cut:","Meta+KeyV":"paste:","Meta+KeyZ":"undo:","Shift+Meta+KeyZ":"redo:"}});var uk=M(Er=>{"use strict";Object.defineProperty(Er,"__esModule",{value:!0});Er.RawTouchscreenImpl=Er.RawMouseImpl=Er.RawKeyboardImpl=void 0;var rj=oj(Wc()),ij=qg(),sj=ie(),gn=xr();function ck(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(ck=function(n){return n?t:e})(r)}function oj(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=ck(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Hg=class{constructor(e,t,n){this._client=e,this._isMac=t,this._dragManger=n}_commandsForCode(e,t){if(!this._isMac)return[];let n=[];for(let a of["Shift","Control","Alt","Meta"])t.has(a)&&n.push(a);n.push(e);let s=n.join("+"),o=ij.macEditingCommands[s]||[];return(0,sj.isString)(o)&&(o=[o]),o=o.filter(a=>!a.startsWith("insert")),o.map(a=>a.substring(0,a.length-1))}async keydown(e,t,n,s,o,a,l,c){if(t==="Escape"&&await this._dragManger.cancelDrag())return;let u=this._commandsForCode(t,e);await this._client.send("Input.dispatchKeyEvent",{type:c?"keyDown":"rawKeyDown",modifiers:(0,gn.toModifiersMask)(e),windowsVirtualKeyCode:s,code:t,commands:u,key:o,text:c,unmodifiedText:c,autoRepeat:l,location:a,isKeypad:a===rj.keypadLocation})}async keyup(e,t,n,s,o,a){await this._client.send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:(0,gn.toModifiersMask)(e),key:o,windowsVirtualKeyCode:s,code:t,location:a})}async sendText(e){await this._client.send("Input.insertText",{text:e})}};Er.RawKeyboardImpl=Hg;var $g=class{constructor(e,t,n){this._client=void 0,this._page=void 0,this._dragManager=void 0,this._page=e,this._client=t,this._dragManager=n}async move(e,t,n,s,o,a){let l=async()=>{await this._client.send("Input.dispatchMouseEvent",{type:"mouseMoved",button:n,buttons:(0,gn.toButtonsMask)(s),x:e,y:t,modifiers:(0,gn.toModifiersMask)(o)})};if(a)return l();await this._dragManager.interceptDragCausedByMove(e,t,n,s,o,l)}async down(e,t,n,s,o,a){this._dragManager.isDragging()||await this._client.send("Input.dispatchMouseEvent",{type:"mousePressed",button:n,buttons:(0,gn.toButtonsMask)(s),x:e,y:t,modifiers:(0,gn.toModifiersMask)(o),clickCount:a})}async up(e,t,n,s,o,a){if(this._dragManager.isDragging()){await this._dragManager.drop(e,t,o);return}await this._client.send("Input.dispatchMouseEvent",{type:"mouseReleased",button:n,buttons:(0,gn.toButtonsMask)(s),x:e,y:t,modifiers:(0,gn.toModifiersMask)(o),clickCount:a})}async wheel(e,t,n,s,o,a){await this._client.send("Input.dispatchMouseEvent",{type:"mouseWheel",x:e,y:t,modifiers:(0,gn.toModifiersMask)(s),deltaX:o,deltaY:a})}};Er.RawMouseImpl=$g;var Wg=class{constructor(e){this._client=void 0,this._client=e}async tap(e,t,n){await Promise.all([this._client.send("Input.dispatchTouchEvent",{type:"touchStart",modifiers:(0,gn.toModifiersMask)(n),touchPoints:[{x:e,y:t}]}),this._client.send("Input.dispatchTouchEvent",{type:"touchEnd",modifiers:(0,gn.toModifiersMask)(n),touchPoints:[]})])}};Er.RawTouchscreenImpl=Wg});var Jg=M(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:!0});Mu.CRNetworkManager=void 0;var dk=yt(),gt=Ze(),Ru=aj(Ct()),ui=ie(),hk=Wt();function pk(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(pk=function(n){return n?t:e})(r)}function aj(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=pk(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var zg=class{constructor(e,t){this._page=void 0,this._serviceWorker=void 0,this._requestIdToRequest=new Map,this._requestIdToRequestWillBeSentEvent=new Map,this._credentials=null,this._attemptedAuthentications=new Set,this._userRequestInterceptionEnabled=!1,this._protocolRequestInterceptionEnabled=!1,this._offline=!1,this._extraHTTPHeaders=[],this._requestIdToRequestPausedEvent=new Map,this._responseExtraInfoTracker=new Kg,this._sessions=new Map,this._page=e,this._serviceWorker=t}async addSession(e,t,n){let s={session:e,isMain:n,workerFrame:t,eventListeners:[]};s.eventListeners=[gt.eventsHelper.addEventListener(e,"Fetch.requestPaused",this._onRequestPaused.bind(this,s)),gt.eventsHelper.addEventListener(e,"Fetch.authRequired",this._onAuthRequired.bind(this,s)),gt.eventsHelper.addEventListener(e,"Network.requestWillBeSent",this._onRequestWillBeSent.bind(this,s)),gt.eventsHelper.addEventListener(e,"Network.requestWillBeSentExtraInfo",this._onRequestWillBeSentExtraInfo.bind(this)),gt.eventsHelper.addEventListener(e,"Network.requestServedFromCache",this._onRequestServedFromCache.bind(this)),gt.eventsHelper.addEventListener(e,"Network.responseReceived",this._onResponseReceived.bind(this,s)),gt.eventsHelper.addEventListener(e,"Network.responseReceivedExtraInfo",this._onResponseReceivedExtraInfo.bind(this)),gt.eventsHelper.addEventListener(e,"Network.loadingFinished",this._onLoadingFinished.bind(this,s)),gt.eventsHelper.addEventListener(e,"Network.loadingFailed",this._onLoadingFailed.bind(this,s))],this._page&&s.eventListeners.push(gt.eventsHelper.addEventListener(e,"Network.webSocketCreated",o=>this._page._frameManager.onWebSocketCreated(o.requestId,o.url)),gt.eventsHelper.addEventListener(e,"Network.webSocketWillSendHandshakeRequest",o=>this._page._frameManager.onWebSocketRequest(o.requestId)),gt.eventsHelper.addEventListener(e,"Network.webSocketHandshakeResponseReceived",o=>this._page._frameManager.onWebSocketResponse(o.requestId,o.response.status,o.response.statusText)),gt.eventsHelper.addEventListener(e,"Network.webSocketFrameSent",o=>o.response.payloadData&&this._page._frameManager.onWebSocketFrameSent(o.requestId,o.response.opcode,o.response.payloadData)),gt.eventsHelper.addEventListener(e,"Network.webSocketFrameReceived",o=>o.response.payloadData&&this._page._frameManager.webSocketFrameReceived(o.requestId,o.response.opcode,o.response.payloadData)),gt.eventsHelper.addEventListener(e,"Network.webSocketClosed",o=>this._page._frameManager.webSocketClosed(o.requestId)),gt.eventsHelper.addEventListener(e,"Network.webSocketFrameError",o=>this._page._frameManager.webSocketError(o.requestId,o.errorMessage))),this._sessions.set(e,s),await Promise.all([e.send("Network.enable"),this._updateProtocolRequestInterceptionForSession(s,!0),this._setOfflineForSession(s,!0),this._setExtraHTTPHeadersForSession(s,!0)])}removeSession(e){let t=this._sessions.get(e);t&&gt.eventsHelper.removeEventListeners(t.eventListeners),this._sessions.delete(e)}async _forEachSession(e){await Promise.all([...this._sessions.values()].map(t=>t.isMain?e(t):e(t).catch(n=>{if(!(0,hk.isSessionClosedError)(n))throw n})))}async authenticate(e){this._credentials=e,await this._updateProtocolRequestInterception()}async setOffline(e){e!==this._offline&&(this._offline=e,await this._forEachSession(t=>this._setOfflineForSession(t)))}async _setOfflineForSession(e,t){t&&!this._offline||e.workerFrame||await e.session.send("Network.emulateNetworkConditions",{offline:this._offline,latency:0,downloadThroughput:-1,uploadThroughput:-1})}async setRequestInterception(e){this._userRequestInterceptionEnabled=e,await this._updateProtocolRequestInterception()}async _updateProtocolRequestInterception(){let e=this._userRequestInterceptionEnabled||!!this._credentials;e!==this._protocolRequestInterceptionEnabled&&(this._protocolRequestInterceptionEnabled=e,await this._forEachSession(t=>this._updateProtocolRequestInterceptionForSession(t)))}async _updateProtocolRequestInterceptionForSession(e,t){let n=this._protocolRequestInterceptionEnabled;if(t&&!n)return;let s=e.session.send("Network.setCacheDisabled",{cacheDisabled:n}),o=Promise.resolve(void 0);e.workerFrame||(n?o=e.session.send("Fetch.enable",{handleAuthRequests:!0,patterns:[{urlPattern:"*",requestStage:"Request"}]}):o=e.session.send("Fetch.disable")),await Promise.all([s,o])}async setExtraHTTPHeaders(e){!this._extraHTTPHeaders.length&&!e.length||(this._extraHTTPHeaders=e,await this._forEachSession(t=>this._setExtraHTTPHeadersForSession(t)))}async _setExtraHTTPHeadersForSession(e,t){t&&!this._extraHTTPHeaders.length||await e.session.send("Network.setExtraHTTPHeaders",{headers:(0,ui.headersArrayToObject)(this._extraHTTPHeaders,!1)})}async clearCache(){await this._forEachSession(async e=>{await e.session.send("Network.setCacheDisabled",{cacheDisabled:!0}),this._protocolRequestInterceptionEnabled||await e.session.send("Network.setCacheDisabled",{cacheDisabled:!1}),e.workerFrame||await e.session.send("Network.clearBrowserCache")})}_onRequestWillBeSent(e,t){if(this._protocolRequestInterceptionEnabled&&!t.request.url.startsWith("data:")){let n=t.requestId,s=this._requestIdToRequestPausedEvent.get(n);s?(this._onRequest(e,t,s.sessionInfo,s.event),this._requestIdToRequestPausedEvent.delete(n)):this._requestIdToRequestWillBeSentEvent.set(t.requestId,{sessionInfo:e,event:t})}else this._onRequest(e,t,void 0,void 0)}_onRequestServedFromCache(e){this._responseExtraInfoTracker.requestServedFromCache(e)}_onRequestWillBeSentExtraInfo(e){this._responseExtraInfoTracker.requestWillBeSentExtraInfo(e)}_onAuthRequired(e,t){let n="Default",s=this._shouldProvideCredentials(t.request.url);this._attemptedAuthentications.has(t.requestId)?n="CancelAuth":s&&(n="ProvideCredentials",this._attemptedAuthentications.add(t.requestId));let{username:o,password:a}=s&&this._credentials?this._credentials:{username:void 0,password:void 0};e.session._sendMayFail("Fetch.continueWithAuth",{requestId:t.requestId,authChallengeResponse:{response:n,username:o,password:a}})}_shouldProvideCredentials(e){return this._credentials?!this._credentials.origin||new URL(e).origin.toLowerCase()===this._credentials.origin.toLowerCase():!1}_onRequestPaused(e,t){if(!t.networkId){e.session._sendMayFail("Fetch.continueRequest",{requestId:t.requestId});return}if(t.request.url.startsWith("data:"))return;let n=t.networkId,s=this._requestIdToRequestWillBeSentEvent.get(n);if(s)this._onRequest(s.sessionInfo,s.event,e,t),this._requestIdToRequestWillBeSentEvent.delete(n);else{var o;let a=this._requestIdToRequest.get(n),l=a==null||(o=a._route)===null||o===void 0?void 0:o._alreadyContinuedParams;if(l&&!t.redirectedRequestId){e.session._sendMayFail("Fetch.continueRequest",{...l,requestId:t.requestId});return}this._requestIdToRequestPausedEvent.set(n,{sessionInfo:e,event:t})}}_onRequest(e,t,n,s){var o,a,l;if(t.request.url.startsWith("data:"))return;let c=null;if(t.redirectResponse){let w=this._requestIdToRequest.get(t.requestId);w&&(this._handleRequestRedirect(w,t.redirectResponse,t.timestamp,t.redirectHasExtraInfo),c=w)}let u=t.frameId?(o=this._page)===null||o===void 0?void 0:o._frameManager.frame(t.frameId):e.workerFrame;if(!u&&this._page&&s&&s.frameId&&(u=this._page._frameManager.frame(s.frameId)),!u&&this._page&&t.frameId===((a=this._page)===null||a===void 0?void 0:a._delegate)._targetId&&(u=this._page._frameManager.frameAttached(t.frameId,null)),!!s&&s.request.method==="OPTIONS"&&t.initiator.type==="preflight"&&(this._page||this._serviceWorker).needsRequestInterception()){let w=s.request.headers,m=[{name:"Access-Control-Allow-Origin",value:w.Origin||"*"},{name:"Access-Control-Allow-Methods",value:w["Access-Control-Request-Method"]||"GET, POST, OPTIONS, DELETE"},{name:"Access-Control-Allow-Credentials",value:"true"}];w["Access-Control-Request-Headers"]&&m.push({name:"Access-Control-Allow-Headers",value:w["Access-Control-Request-Headers"]}),n.session._sendMayFail("Fetch.fulfillRequest",{requestId:s.requestId,responseCode:204,responsePhrase:Ru.STATUS_TEXTS[204],responseHeaders:m,body:""});return}if(!u&&!this._serviceWorker){s&&n.session._sendMayFail("Fetch.continueRequest",{requestId:s.requestId});return}let h=null;if(s)if(c||!this._userRequestInterceptionEnabled&&this._protocolRequestInterceptionEnabled){var p;let w=(p=c)===null||p===void 0||(p=p._originalRequestRoute)===null||p===void 0||(p=p._alreadyContinuedParams)===null||p===void 0?void 0:p.headers;n.session._sendMayFail("Fetch.continueRequest",{requestId:s.requestId,headers:w})}else h=new Gg(n.session,s.requestId);let _=t.requestId===t.loaderId&&t.type==="Document"?t.loaderId:void 0,v=new Vg({session:e.session,context:(this._page||this._serviceWorker)._browserContext,frame:u||null,serviceWorker:this._serviceWorker||null,documentId:_,route:h,requestWillBeSentEvent:t,requestPausedEvent:s,redirectedFrom:c});this._requestIdToRequest.set(t.requestId,v),s&&v.request.setRawRequestHeaders((0,ui.headersObjectToArray)(s.request.headers,`
`)),(((l=this._page)===null||l===void 0?void 0:l._frameManager)||this._serviceWorker).requestStarted(v.request,h||void 0)}_createResponse(e,t,n){var s,o,a,l,c;let u=async()=>{let f=Object.entries(t.headers).find(x=>x[0].toLowerCase()==="content-length"),_=f?+f[1]:void 0,v=e.session,w=await v.send("Network.getResponseBody",{requestId:e._requestId});if(w.body||!_)return Buffer.from(w.body,w.base64Encoded?"base64":"utf8");let m=await v.send("Network.loadNetworkResource",{url:e.request.url(),frameId:this._serviceWorker?void 0:e.request.frame()._id,options:{disableCache:!1,includeCredentials:!0}}),g=[];for(;m.resource.stream;){let x=await v.send("IO.read",{handle:m.resource.stream});if(g.push(Buffer.from(x.data,x.base64Encoded?"base64":"utf-8")),x.eof){await v.send("IO.close",{handle:m.resource.stream});break}}return Buffer.concat(g)},d=t.timing,h;d&&!this._responseExtraInfoTracker.servedFromCache(e._requestId)?h={startTime:(d.requestTime-e._timestamp+e._wallTime)*1e3,domainLookupStart:d.dnsStart,domainLookupEnd:d.dnsEnd,connectStart:d.connectStart,secureConnectionStart:d.sslStart,connectEnd:d.connectEnd,requestStart:d.sendStart,responseStart:d.receiveHeadersEnd}:h={startTime:e._wallTime*1e3,domainLookupStart:-1,domainLookupEnd:-1,connectStart:-1,secureConnectionStart:-1,connectEnd:-1,requestStart:-1,responseStart:-1};let p=new Ru.Response(e.request,t.status,t.statusText,(0,ui.headersObjectToArray)(t.headers),h,u,!!t.fromServiceWorker,t.protocol);return t!=null&&t.remoteIPAddress&&typeof t?.remotePort=="number"?p._serverAddrFinished({ipAddress:t.remoteIPAddress,port:t.remotePort}):p._serverAddrFinished(),p._securityDetailsFinished({protocol:t==null||(s=t.securityDetails)===null||s===void 0?void 0:s.protocol,subjectName:t==null||(o=t.securityDetails)===null||o===void 0?void 0:o.subjectName,issuer:t==null||(a=t.securityDetails)===null||a===void 0?void 0:a.issuer,validFrom:t==null||(l=t.securityDetails)===null||l===void 0?void 0:l.validFrom,validTo:t==null||(c=t.securityDetails)===null||c===void 0?void 0:c.validTo}),this._responseExtraInfoTracker.processResponse(e._requestId,p,n),p}_deleteRequest(e){this._requestIdToRequest.delete(e._requestId),e._interceptionId&&this._attemptedAuthentications.delete(e._interceptionId)}_handleRequestRedirect(e,t,n,s){var o,a;let l=this._createResponse(e,t,s);l.setTransferSize(null),l.setEncodedBodySize(null),l._requestFinished((n-e._timestamp)*1e3),this._deleteRequest(e),(((o=this._page)===null||o===void 0?void 0:o._frameManager)||this._serviceWorker).requestReceivedResponse(l),(((a=this._page)===null||a===void 0?void 0:a._frameManager)||this._serviceWorker).reportRequestFinished(e.request,l)}_onResponseReceivedExtraInfo(e){this._responseExtraInfoTracker.responseReceivedExtraInfo(e)}_onResponseReceived(e,t){var n;let s=this._requestIdToRequest.get(t.requestId);if(!s&&t.response.fromServiceWorker){let a=this._requestIdToRequestWillBeSentEvent.get(t.requestId);a&&(this._requestIdToRequestWillBeSentEvent.delete(t.requestId),this._onRequest(e,a.event,void 0,void 0),s=this._requestIdToRequest.get(t.requestId))}if(!s)return;let o=this._createResponse(s,t.response,t.hasExtraInfo);(((n=this._page)===null||n===void 0?void 0:n._frameManager)||this._serviceWorker).requestReceivedResponse(o)}_onLoadingFinished(e,t){var n;this._responseExtraInfoTracker.loadingFinished(t);let s=this._requestIdToRequest.get(t.requestId);if(!s)return;this._maybeUpdateOOPIFMainRequest(e,s);let o=s.request._existingResponse();o&&(o.setTransferSize(t.encodedDataLength),o.responseHeadersSize().then(a=>o.setEncodedBodySize(t.encodedDataLength-a)),o._requestFinished(dk.helper.secondsToRoundishMillis(t.timestamp-s._timestamp))),this._deleteRequest(s),(((n=this._page)===null||n===void 0?void 0:n._frameManager)||this._serviceWorker).reportRequestFinished(s.request,o)}_onLoadingFailed(e,t){var n;this._responseExtraInfoTracker.loadingFailed(t);let s=this._requestIdToRequest.get(t.requestId);if(!s){let a=this._requestIdToRequestWillBeSentEvent.get(t.requestId);a&&(this._requestIdToRequestWillBeSentEvent.delete(t.requestId),this._onRequest(e,a.event,void 0,void 0),s=this._requestIdToRequest.get(t.requestId))}if(!s)return;this._maybeUpdateOOPIFMainRequest(e,s);let o=s.request._existingResponse();o?(o.setTransferSize(null),o.setEncodedBodySize(null),o._requestFinished(dk.helper.secondsToRoundishMillis(t.timestamp-s._timestamp))):s.request.setRawRequestHeaders(null),this._deleteRequest(s),s.request._setFailureText(t.errorText||t.blockedReason||""),(((n=this._page)===null||n===void 0?void 0:n._frameManager)||this._serviceWorker).requestFailed(s.request,!!t.canceled)}_maybeUpdateOOPIFMainRequest(e,t){t.session!==e.session&&!e.isMain&&t._documentId===t._requestId&&(t.session=e.session)}};Mu.CRNetworkManager=zg;var Vg=class{constructor(e){this.request=void 0,this._requestId=void 0,this._interceptionId=void 0,this._documentId=void 0,this._timestamp=void 0,this._wallTime=void 0,this._route=void 0,this._originalRequestRoute=void 0,this.session=void 0;let{session:t,context:n,frame:s,documentId:o,route:a,requestWillBeSentEvent:l,requestPausedEvent:c,redirectedFrom:u,serviceWorker:d}=e;this.session=t,this._timestamp=l.timestamp,this._wallTime=l.wallTime,this._requestId=l.requestId,this._interceptionId=c&&c.requestId,this._documentId=o,this._route=a,this._originalRequestRoute=a??u?._originalRequestRoute;let{headers:h,method:p,url:f,postDataEntries:_=null}=c?c.request:l.request,v=(l.type||"").toLowerCase(),w=null;_&&_.length&&_[0].bytes&&(w=Buffer.from(_[0].bytes,"base64")),this.request=new Ru.Request(n,s,d,u?.request||null,o,f,v,p,w,(0,ui.headersObjectToArray)(h))}},Gg=class{constructor(e,t){this._session=void 0,this._interceptionId=void 0,this._alreadyContinuedParams=void 0,this._session=e,this._interceptionId=t}async continue(e,t){this._alreadyContinuedParams={requestId:this._interceptionId,url:t.url,headers:t.headers,method:t.method,postData:t.postData?t.postData.toString("base64"):void 0},await Ug(async()=>{await this._session.send("Fetch.continueRequest",this._alreadyContinuedParams)})}async fulfill(e){let t=e.isBase64?e.body:Buffer.from(e.body).toString("base64"),n=lj(e.headers);await Ug(async()=>{await this._session.send("Fetch.fulfillRequest",{requestId:this._interceptionId,responseCode:e.status,responsePhrase:Ru.STATUS_TEXTS[String(e.status)],responseHeaders:n,body:t})})}async abort(e="failed"){let t=cj[e];(0,ui.assert)(t,"Unknown error code: "+e),await Ug(async()=>{await this._session.send("Fetch.failRequest",{requestId:this._interceptionId,errorReason:t})})}};async function Ug(r){try{return await r()}catch(e){if((0,hk.isProtocolError)(e)&&e.message.includes("Invalid http status code or phrase"))throw e}}function lj(r){let e=r.findIndex(({name:o})=>o.toLowerCase()==="set-cookie");if(e===-1)return r;let t=r[e],n=t.value.split(`
`);if(n.length===1)return r;let s=r.slice();return s.splice(e,1,...n.map(o=>({name:t.name,value:o}))),s}var cj={aborted:"Aborted",accessdenied:"AccessDenied",addressunreachable:"AddressUnreachable",blockedbyclient:"BlockedByClient",blockedbyresponse:"BlockedByResponse",connectionaborted:"ConnectionAborted",connectionclosed:"ConnectionClosed",connectionfailed:"ConnectionFailed",connectionrefused:"ConnectionRefused",connectionreset:"ConnectionReset",internetdisconnected:"InternetDisconnected",namenotresolved:"NameNotResolved",timedout:"TimedOut",failed:"Failed"},Kg=class{constructor(){this._requests=new Map}requestWillBeSentExtraInfo(e){let t=this._getOrCreateEntry(e.requestId);t.requestWillBeSentExtraInfo.push(e),this._patchHeaders(t,t.requestWillBeSentExtraInfo.length-1),this._checkFinished(t)}requestServedFromCache(e){let t=this._getOrCreateEntry(e.requestId);t.servedFromCache=!0}servedFromCache(e){let t=this._requests.get(e);return!!(t!=null&&t.servedFromCache)}responseReceivedExtraInfo(e){let t=this._getOrCreateEntry(e.requestId);t.responseReceivedExtraInfo.push(e),this._patchHeaders(t,t.responseReceivedExtraInfo.length-1),this._checkFinished(t)}processResponse(e,t,n){var s;let o=this._requests.get(e);if(!n||(s=o)!==null&&s!==void 0&&s.servedFromCache){t.request().setRawRequestHeaders(null),t.setResponseHeadersSize(null),t.setRawResponseHeaders(null);return}o=this._getOrCreateEntry(e),o.responses.push(t),this._patchHeaders(o,o.responses.length-1)}loadingFinished(e){let t=this._requests.get(e.requestId);t&&(t.loadingFinished=e,this._checkFinished(t))}loadingFailed(e){let t=this._requests.get(e.requestId);t&&(t.loadingFailed=e,this._checkFinished(t))}_getOrCreateEntry(e){let t=this._requests.get(e);return t||(t={requestId:e,requestWillBeSentExtraInfo:[],responseReceivedExtraInfo:[],responses:[]},this._requests.set(e,t)),t}_patchHeaders(e,t){let n=e.responses[t],s=e.requestWillBeSentExtraInfo[t];n&&s&&(n.request().setRawRequestHeaders((0,ui.headersObjectToArray)(s.headers,`
`)),e.requestWillBeSentExtraInfo[t]=void 0);let o=e.responseReceivedExtraInfo[t];if(n&&o){var a;n.setResponseHeadersSize(((a=o.headersText)===null||a===void 0?void 0:a.length)||0),n.setRawResponseHeaders((0,ui.headersObjectToArray)(o.headers,`
`)),e.responseReceivedExtraInfo[t]=void 0}}_checkFinished(e){if(!(!e.loadingFinished&&!e.loadingFailed)&&e.responses.length<=e.responseReceivedExtraInfo.length){this._stopTracking(e.requestId);return}}_stopTracking(e){this._requests.delete(e)}}});var gk=M(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:!0});Fu.CRPDF=void 0;var mk=ie(),uj=xr(),dj={letter:{width:8.5,height:11},legal:{width:8.5,height:14},tabloid:{width:11,height:17},ledger:{width:17,height:11},a0:{width:33.1,height:46.8},a1:{width:23.4,height:33.1},a2:{width:16.54,height:23.4},a3:{width:11.7,height:16.54},a4:{width:8.27,height:11.7},a5:{width:5.83,height:8.27},a6:{width:4.13,height:5.83}},fk={px:1,in:96,cm:37.8,mm:3.78};function hs(r){if(r===void 0)return;let e=r.substring(r.length-2).toLowerCase(),t="";fk.hasOwnProperty(e)?t=r.substring(0,r.length-2):(e="px",t=r);let n=Number(t);return(0,mk.assert)(!isNaN(n),"Failed to parse parameter value: "+r),n*fk[e]/96}var Xg=class{constructor(e){this._client=void 0,this._client=e}async generate(e){let{scale:t=1,displayHeaderFooter:n=!1,headerTemplate:s="",footerTemplate:o="",printBackground:a=!1,landscape:l=!1,pageRanges:c="",preferCSSPageSize:u=!1,margin:d={},tagged:h=!1,outline:p=!1}=e,f=8.5,_=11;if(e.format){let S=dj[e.format.toLowerCase()];(0,mk.assert)(S,"Unknown paper format: "+e.format),f=S.width,_=S.height}else f=hs(e.width)||f,_=hs(e.height)||_;let v=hs(d.top)||0,w=hs(d.left)||0,m=hs(d.bottom)||0,g=hs(d.right)||0,x=p,b=h,y=await this._client.send("Page.printToPDF",{transferMode:"ReturnAsStream",landscape:l,displayHeaderFooter:n,headerTemplate:s,footerTemplate:o,printBackground:a,scale:t,paperWidth:f,paperHeight:_,marginTop:v,marginBottom:m,marginLeft:w,marginRight:g,pageRanges:c,preferCSSPageSize:u,generateTaggedPDF:b,generateDocumentOutline:x});return await(0,uj.readProtocolStream)(this._client,y.stream)}};Fu.CRPDF=Xg});var _k=M(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.platformToFontFamilies=void 0;var r7=Nu.platformToFontFamilies={linux:{fontFamilies:{standard:"Times New Roman",fixed:"Monospace",serif:"Times New Roman",sansSerif:"Arial",cursive:"Comic Sans MS",fantasy:"Impact"}},mac:{fontFamilies:{standard:"Times",fixed:"Courier",serif:"Times",sansSerif:"Helvetica",cursive:"Apple Chancery",fantasy:"Papyrus"},forScripts:[{script:"jpan",fontFamilies:{standard:"Hiragino Kaku Gothic ProN",fixed:"Osaka-Mono",serif:"Hiragino Mincho ProN",sansSerif:"Hiragino Kaku Gothic ProN"}},{script:"hang",fontFamilies:{standard:"Apple SD Gothic Neo",serif:"AppleMyungjo",sansSerif:"Apple SD Gothic Neo"}},{script:"hans",fontFamilies:{standard:",PingFang SC,STHeiti",serif:"Songti SC",sansSerif:",PingFang SC,STHeiti",cursive:"Kaiti SC"}},{script:"hant",fontFamilies:{standard:",PingFang TC,Heiti TC",serif:"Songti TC",sansSerif:",PingFang TC,Heiti TC",cursive:"Kaiti TC"}}]},win:{fontFamilies:{standard:"Times New Roman",fixed:"Consolas",serif:"Times New Roman",sansSerif:"Arial",cursive:"Comic Sans MS",fantasy:"Impact"},forScripts:[{script:"cyrl",fontFamilies:{standard:"Times New Roman",fixed:"Courier New",serif:"Times New Roman",sansSerif:"Arial"}},{script:"arab",fontFamilies:{fixed:"Courier New",sansSerif:"Segoe UI"}},{script:"grek",fontFamilies:{standard:"Times New Roman",fixed:"Courier New",serif:"Times New Roman",sansSerif:"Arial"}},{script:"jpan",fontFamilies:{standard:",Meiryo,Yu Gothic",fixed:"MS Gothic",serif:",Yu Mincho,MS PMincho",sansSerif:",Meiryo,Yu Gothic"}},{script:"hang",fontFamilies:{standard:"Malgun Gothic",fixed:"Gulimche",serif:"Batang",sansSerif:"Malgun Gothic",cursive:"Gungsuh"}},{script:"hans",fontFamilies:{standard:"Microsoft YaHei",fixed:"NSimsun",serif:"Simsun",sansSerif:"Microsoft YaHei",cursive:"KaiTi"}},{script:"hant",fontFamilies:{standard:"Microsoft JhengHei",fixed:"MingLiU",serif:"PMingLiU",sansSerif:"Microsoft JhengHei",cursive:"DFKai-SB"}}]}}});var vk=M(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});Lu.VideoRecorder=void 0;var Yg=ie(),hj=Et(),pj=sr(),fj=Ut(),mj=De(),wk=25,Qg=class r{static async launch(e,t,n){if(!n.outputFile.endsWith(".webm"))throw new Error("File must have .webm extension");let s=new fj.ProgressController((0,mj.serverSideCallMetadata)(),e);return s.setLogName("browser"),await s.run(async o=>{let a=new r(e,t,o);return await a._launch(n),a})}constructor(e,t,n){this._process=null,this._gracefullyClose=null,this._lastWritePromise=Promise.resolve(),this._lastFrameTimestamp=0,this._lastFrameBuffer=null,this._lastWriteTimestamp=0,this._progress=void 0,this._frameQueue=[],this._isStopped=!1,this._ffmpegPath=void 0,this._progress=n,this._ffmpegPath=t,e.on(hj.Page.Events.ScreencastFrame,s=>this.writeFrame(s.buffer,s.timestamp))}async _launch(e){let t=e.width,n=e.height,s=`-loglevel error -f image2pipe -avioflags direct -fpsprobesize 0 -probesize 32 -analyzeduration 0 -c:v mjpeg -i - -y -an -r ${wk} -c:v vp8 -qmin 0 -qmax 50 -crf 8 -deadline realtime -speed 8 -b:v 1M -threads 1 -vf pad=${t}:${n}:0:0:gray,crop=${t}:${n}:0:0`.split(" ");s.push(e.outputFile);let o=this._progress,{launchedProcess:a,gracefullyClose:l}=await(0,pj.launchProcess)({command:this._ffmpegPath,args:s,stdio:"stdin",log:c=>o.log(c),tempDirectories:[],attemptToGracefullyClose:async()=>{o.log("Closing stdin..."),a.stdin.end()},onExit:(c,u)=>{o.log(`ffmpeg onkill exitCode=${c} signal=${u}`)}});a.stdin.on("finish",()=>{o.log("ffmpeg finished input.")}),a.stdin.on("error",()=>{o.log("ffmpeg error.")}),this._process=a,this._gracefullyClose=l}writeFrame(e,t){if((0,Yg.assert)(this._process),!this._isStopped){if(this._lastFrameBuffer){let n=t-this._lastFrameTimestamp,s=Math.max(1,Math.round(wk*n));for(let o=0;o<s;++o)this._frameQueue.push(this._lastFrameBuffer);this._lastWritePromise=this._lastWritePromise.then(()=>this._sendFrames())}this._lastFrameBuffer=e,this._lastFrameTimestamp=t,this._lastWriteTimestamp=(0,Yg.monotonicTime)()}}async _sendFrames(){for(;this._frameQueue.length;)await this._sendFrame(this._frameQueue.shift())}async _sendFrame(e){return new Promise(t=>this._process.stdin.write(e,t)).then(t=>{t&&this._progress.log(`ffmpeg failed to write: ${String(t)}`)})}async stop(){this._isStopped||(this.writeFrame(Buffer.from([]),this._lastFrameTimestamp+((0,Yg.monotonicTime)()-this._lastWriteTimestamp)/1e3),this._isStopped=!0,await this._lastWritePromise,await this._gracefullyClose())}};Lu.VideoRecorder=Qg});var kk=M($u=>{"use strict";Object.defineProperty($u,"__esModule",{value:!0});$u.CRPage=void 0;var gj=Rj(require("path")),Je=Ze(),_j=qn(),wj=Lt(),Du=ie(),vj=Hu(Eu()),bk=Hu(Bo()),bj=Hu(si()),yk=yt(),yj=Hu(Ct()),ju=Et(),xj=ik(),Sj=ps(),Ej=sk(),kj=ak(),xk=Au(),Zg=uk(),Cj=Jg(),Tj=gk(),ia=xr(),Oj=_k(),Pj=vk(),qu=$e(),Aj=Bt(),Ij=Wt();function Ek(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Ek=function(n){return n?t:e})(r)}function Hu(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Ek(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function Rj(r){return r&&r.__esModule?r:{default:r}}var Bu="__playwright_utility_world__",e_=class{static mainFrameSession(e){return e._delegate._mainFrameSession}constructor(e,t,n,s,o){this._mainFrameSession=void 0,this._sessions=new Map,this._page=void 0,this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._targetId=void 0,this._opener=void 0,this._networkManager=void 0,this._pdf=void 0,this._coverage=void 0,this._browserContext=void 0,this._pagePromise=void 0,this._initializedPage=null,this._isBackgroundPage=void 0,this._nextWindowOpenPopupFeatures=[],this._targetId=t,this._opener=s,this._isBackgroundPage=o.isBackgroundPage;let a=new kj.DragManager(this);if(this.rawKeyboard=new Zg.RawKeyboardImpl(e,n._browser._platform()==="mac",a),this.rawMouse=new Zg.RawMouseImpl(this,e,a),this.rawTouchscreen=new Zg.RawTouchscreenImpl(e),this._pdf=new Tj.CRPDF(e),this._coverage=new Ej.CRCoverage(e),this._browserContext=n,this._page=new ju.Page(this,n),this._networkManager=new Cj.CRNetworkManager(this._page,null),this.updateOffline(),this.updateExtraHTTPHeaders(),this.updateHttpCredentials(),this.updateRequestInterception(),this._mainFrameSession=new t_(this,e,t,null),this._sessions.set(t,this._mainFrameSession),s&&!n._options.noDefaultViewport){let l=s._nextWindowOpenPopupFeatures.shift()||[],c=yk.helper.getViewportSizeFromWindowFeatures(l);c&&(this._page._emulatedSize={viewport:c,screen:c})}this._pagePromise=this._mainFrameSession._initialize(o.hasUIWindow).then(async l=>(await this._page.initOpener(this._opener),l)).catch(async l=>{throw await this._page.initOpener(this._opener),l}).then(()=>(this._initializedPage=this._page,this._reportAsNew(),this._page)).catch(l=>(this._reportAsNew(l),l))}potentiallyUninitializedPage(){return this._page}_reportAsNew(e){this._page.reportAsNew(e,this._isBackgroundPage?Sj.CRBrowserContext.CREvents.BackgroundPage:qu.BrowserContext.Events.Page)}async _forAllFrameSessions(e){let t=Array.from(this._sessions.values());await Promise.all(t.map(n=>n._isMainFrame()?e(n):e(n).catch(s=>{if(!(0,Ij.isSessionClosedError)(s))throw s})))}_sessionForFrame(e){for(;!this._sessions.has(e._id);){let t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");e=t}return this._sessions.get(e._id)}_sessionForHandle(e){let t=e._context.frame;return this._sessionForFrame(t)}willBeginDownload(){this._mainFrameSession._willBeginDownload()}async pageOrError(){return this._pagePromise}didClose(){for(let e of this._sessions.values())e.dispose();this._page._didClose()}async navigateFrame(e,t,n){return this._sessionForFrame(e)._navigate(e,t,n)}async exposeBinding(e){await this._forAllFrameSessions(t=>t._initBinding(e)),await Promise.all(this._page.frames().map(t=>t.evaluateExpression(e.source).catch(n=>{})))}async removeExposedBindings(){await this._forAllFrameSessions(e=>e._removeExposedBindings())}async updateExtraHTTPHeaders(){let e=yj.mergeHeaders([this._browserContext._options.extraHTTPHeaders,this._page.extraHTTPHeaders()]);await this._networkManager.setExtraHTTPHeaders(e)}async updateGeolocation(){await this._forAllFrameSessions(e=>e._updateGeolocation(!1))}async updateOffline(){await this._networkManager.setOffline(!!this._browserContext._options.offline)}async updateHttpCredentials(){await this._networkManager.authenticate(this._browserContext._options.httpCredentials||null)}async updateEmulatedViewportSize(e){await this._mainFrameSession._updateViewport(e)}async bringToFront(){await this._mainFrameSession._client.send("Page.bringToFront")}async updateEmulateMedia(){await this._forAllFrameSessions(e=>e._updateEmulateMedia())}async updateUserAgent(){await this._forAllFrameSessions(e=>e._updateUserAgent())}async updateRequestInterception(){await this._networkManager.setRequestInterception(this._page.needsRequestInterception())}async updateFileChooserInterception(){await this._forAllFrameSessions(e=>e._updateFileChooserInterception(!1))}async reload(){await this._mainFrameSession._client.send("Page.reload")}async _go(e){let t=await this._mainFrameSession._client.send("Page.getNavigationHistory"),n=t.entries[t.currentIndex+e];return n?(await this._mainFrameSession._client.send("Page.navigateToHistoryEntry",{entryId:n.id}),!0):!1}goBack(){return this._go(-1)}goForward(){return this._go(1)}async addInitScript(e,t="main"){await this._forAllFrameSessions(n=>n._evaluateOnNewDocument(e,t))}async removeInitScripts(){await this._forAllFrameSessions(e=>e._removeEvaluatesOnNewDocument())}async closePage(e){e?await this._mainFrameSession._client.send("Page.close"):await this._browserContext._browser._closePage(this)}async setBackgroundColor(e){await this._mainFrameSession._client.send("Emulation.setDefaultBackgroundColorOverride",{color:e})}async takeScreenshot(e,t,n,s,o,a,l){let{visualViewport:c}=await this._mainFrameSession._client.send("Page.getLayoutMetrics");n||(n={x:c.pageX+s.x,y:c.pageY+s.y,...yk.helper.enclosingIntSize({width:s.width/c.scale,height:s.height/c.scale})});let u={...n,scale:s?c.scale:1};if(l==="css"){let h=this._browserContext._options.deviceScaleFactor||1;u.scale/=h}e.throwIfAborted();let d=await this._mainFrameSession._client.send("Page.captureScreenshot",{format:t,quality:o,clip:u,captureBeyondViewport:!a});return Buffer.from(d.data,"base64")}async getContentFrame(e){return this._sessionForHandle(e)._getContentFrame(e)}async getOwnerFrame(e){return this._sessionForHandle(e)._getOwnerFrame(e)}isElementHandle(e){return e.subtype==="node"}async getBoundingBox(e){return this._sessionForHandle(e)._getBoundingBox(e)}async scrollRectIntoViewIfNeeded(e,t){return this._sessionForHandle(e)._scrollRectIntoViewIfNeeded(e,t)}async setScreencastOptions(e){e?await this._mainFrameSession._startScreencast(this,{format:"jpeg",quality:e.quality,maxWidth:e.width,maxHeight:e.height}):await this._mainFrameSession._stopScreencast(this)}rafCountForStablePosition(){return 1}async getContentQuads(e){return this._sessionForHandle(e)._getContentQuads(e)}async setInputFiles(e,t){await e.evaluateInUtility(([n,s,o])=>n.setInputFiles(s,o),t)}async setInputFilePaths(e,t){let n=await e.ownerFrame();if(!n)throw new Error("Cannot set input files to detached input element");await this._sessionForFrame(n)._client.send("DOM.setFileInputFiles",{objectId:e._objectId,files:t})}async adoptElementHandle(e,t){return this._sessionForHandle(e)._adoptElementHandle(e,t)}async getAccessibilityTree(e){return(0,xj.getAccessibilityTree)(this._mainFrameSession._client,e)}async inputActionEpilogue(){await this._mainFrameSession._client.send("Page.enable").catch(e=>{})}async resetForReuse(){}async pdf(e){return this._pdf.generate(e)}coverage(){return this._coverage}async getFrameElement(e){let t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");let n=this._sessionForFrame(t),{backendNodeId:s}=await n._client.send("DOM.getFrameOwner",{frameId:e._id}).catch(o=>{throw o instanceof Error&&o.message.includes("Frame with the given id was not found.")&&(0,wj.rewriteErrorMessage)(o,"Frame has been detached."),o});if(t=e.parentFrame(),!t)throw new Error("Frame has been detached.");return n._adoptBackendNodeId(s,await t._mainContext())}shouldToggleStyleSheetToSyncAnimations(){return!1}};$u.CRPage=e_;var t_=class r{constructor(e,t,n,s){this._client=void 0,this._crPage=void 0,this._page=void 0,this._parentSession=void 0,this._childSessions=new Set,this._contextIdToContext=new Map,this._eventListeners=[],this._targetId=void 0,this._firstNonInitialNavigationCommittedPromise=void 0,this._firstNonInitialNavigationCommittedFulfill=()=>{},this._firstNonInitialNavigationCommittedReject=o=>{},this._windowId=void 0,this._swappedIn=!1,this._videoRecorder=null,this._screencastId=null,this._screencastClients=new Set,this._evaluateOnNewDocumentIdentifiers=[],this._exposedBindingNames=[],this._metricsOverride=void 0,this._workerSessions=new Map,this._client=t,this._crPage=e,this._page=e._page,this._targetId=n,this._parentSession=s,s&&s._childSessions.add(this),this._firstNonInitialNavigationCommittedPromise=new Promise((o,a)=>{this._firstNonInitialNavigationCommittedFulfill=o,this._firstNonInitialNavigationCommittedReject=a})}_isMainFrame(){return this._targetId===this._crPage._targetId}_addRendererListeners(){this._eventListeners.push(Je.eventsHelper.addEventListener(this._client,"Log.entryAdded",e=>this._onLogEntryAdded(e)),Je.eventsHelper.addEventListener(this._client,"Page.fileChooserOpened",e=>this._onFileChooserOpened(e)),Je.eventsHelper.addEventListener(this._client,"Page.frameAttached",e=>this._onFrameAttached(e.frameId,e.parentFrameId)),Je.eventsHelper.addEventListener(this._client,"Page.frameDetached",e=>this._onFrameDetached(e.frameId,e.reason)),Je.eventsHelper.addEventListener(this._client,"Page.frameNavigated",e=>this._onFrameNavigated(e.frame,!1)),Je.eventsHelper.addEventListener(this._client,"Page.frameRequestedNavigation",e=>this._onFrameRequestedNavigation(e)),Je.eventsHelper.addEventListener(this._client,"Page.javascriptDialogOpening",e=>this._onDialog(e)),Je.eventsHelper.addEventListener(this._client,"Page.navigatedWithinDocument",e=>this._onFrameNavigatedWithinDocument(e.frameId,e.url)),Je.eventsHelper.addEventListener(this._client,"Runtime.bindingCalled",e=>this._onBindingCalled(e)),Je.eventsHelper.addEventListener(this._client,"Runtime.consoleAPICalled",e=>this._onConsoleAPI(e)),Je.eventsHelper.addEventListener(this._client,"Runtime.exceptionThrown",e=>this._handleException(e.exceptionDetails)),Je.eventsHelper.addEventListener(this._client,"Runtime.executionContextCreated",e=>this._onExecutionContextCreated(e.context)),Je.eventsHelper.addEventListener(this._client,"Runtime.executionContextDestroyed",e=>this._onExecutionContextDestroyed(e.executionContextId)),Je.eventsHelper.addEventListener(this._client,"Runtime.executionContextsCleared",e=>this._onExecutionContextsCleared()),Je.eventsHelper.addEventListener(this._client,"Target.attachedToTarget",e=>this._onAttachedToTarget(e)),Je.eventsHelper.addEventListener(this._client,"Target.detachedFromTarget",e=>this._onDetachedFromTarget(e)))}_addBrowserListeners(){this._eventListeners.push(Je.eventsHelper.addEventListener(this._client,"Inspector.targetCrashed",e=>this._onTargetCrashed()),Je.eventsHelper.addEventListener(this._client,"Page.screencastFrame",e=>this._onScreencastFrame(e)),Je.eventsHelper.addEventListener(this._client,"Page.windowOpen",e=>this._onWindowOpen(e)))}async _initialize(e){let t=this._page._browserContext.isSettingStorageState();if(!t&&e&&!this._crPage._browserContext._browser.isClank()&&!this._crPage._browserContext._options.noDefaultViewport){let{windowId:a}=await this._client.send("Browser.getWindowForTarget");this._windowId=a}let n;if(!t&&this._isMainFrame()&&this._crPage._browserContext._options.recordVideo&&e){let a=(0,Du.createGuid)(),l=gj.default.join(this._crPage._browserContext._options.recordVideo.dir,a+".webm");n={...this._crPage._browserContext._options.recordVideo.size,outputFile:l},await this._crPage._browserContext._ensureVideosPath(),await this._createVideoRecorder(a,n),this._crPage.pageOrError().then(c=>{c instanceof Error&&this._stopVideoRecording().catch(()=>{})})}let s;this._isMainFrame()||this._addRendererListeners(),this._addBrowserListeners();let o=[this._client.send("Page.enable"),this._client.send("Page.getFrameTree").then(({frameTree:a})=>{this._isMainFrame()&&(this._handleFrameTree(a),this._addRendererListeners());let l=this._isMainFrame()?this._page.frames():[this._page._frameManager.frame(this._targetId)];for(let u of l){this._client._sendMayFail("Page.createIsolatedWorld",{frameId:u._id,grantUniveralAccess:!0,worldName:Bu});for(let d of this._crPage._browserContext._pageBindings.values())u.evaluateExpression(d.source).catch(h=>{});for(let d of this._crPage._browserContext.initScripts)u.evaluateExpression(d).catch(h=>{})}this._isMainFrame()&&this._page.mainFrame().url()===":"?s.catch(u=>{}).then(()=>{this._eventListeners.push(Je.eventsHelper.addEventListener(this._client,"Page.lifecycleEvent",u=>this._onLifecycleEvent(u)))}):(this._firstNonInitialNavigationCommittedFulfill(),this._eventListeners.push(Je.eventsHelper.addEventListener(this._client,"Page.lifecycleEvent",u=>this._onLifecycleEvent(u))))}),this._client.send("Log.enable",{}),s=this._client.send("Page.setLifecycleEventsEnabled",{enabled:!0}),this._client.send("Runtime.enable",{}),this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:"",worldName:Bu}),this._crPage._networkManager.addSession(this._client,void 0,this._isMainFrame()),this._client.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0})];if(!t){this._isMainFrame()&&o.push(this._client.send("Emulation.setFocusEmulationEnabled",{enabled:!0}));let a=this._crPage._browserContext._options;a.bypassCSP&&o.push(this._client.send("Page.setBypassCSP",{enabled:!0})),a.ignoreHTTPSErrors&&o.push(this._client.send("Security.setIgnoreCertificateErrors",{ignore:!0})),this._isMainFrame()&&o.push(this._updateViewport()),a.hasTouch&&o.push(this._client.send("Emulation.setTouchEmulationEnabled",{enabled:!0})),a.javaScriptEnabled===!1&&o.push(this._client.send("Emulation.setScriptExecutionDisabled",{value:!0})),(a.userAgent||a.locale)&&o.push(this._updateUserAgent()),a.locale&&o.push(Mj(this._client,a.locale)),a.timezoneId&&o.push(Fj(this._client,a.timezoneId)),this._crPage._browserContext._browser.options.headful||o.push(this._setDefaultFontFamilies(this._client)),o.push(this._updateGeolocation(!0)),o.push(this._updateEmulateMedia()),o.push(this._updateFileChooserInterception(!0));for(let l of this._crPage._page.allBindings())o.push(this._initBinding(l));for(let l of this._crPage._browserContext.initScripts)o.push(this._evaluateOnNewDocument(l,"main"));for(let l of this._crPage._page.initScripts)o.push(this._evaluateOnNewDocument(l,"main"));n&&o.push(this._startVideoRecording(n))}o.push(this._client.send("Runtime.runIfWaitingForDebugger")),o.push(this._firstNonInitialNavigationCommittedPromise),await Promise.all(o)}dispose(){this._firstNonInitialNavigationCommittedReject(new Aj.TargetClosedError);for(let e of this._childSessions)e.dispose();this._parentSession&&this._parentSession._childSessions.delete(this),Je.eventsHelper.removeEventListeners(this._eventListeners),this._crPage._networkManager.removeSession(this._client),this._crPage._sessions.delete(this._targetId),this._client.dispose()}async _navigate(e,t,n){let s=await this._client.send("Page.navigate",{url:t,referrer:n,frameId:e._id,referrerPolicy:"unsafeUrl"});if(s.errorText)throw new bj.NavigationAbortedError(s.loaderId,`${s.errorText} at ${t}`);return{newDocumentId:s.loaderId}}_onLifecycleEvent(e){this._eventBelongsToStaleFrame(e.frameId)||(e.name==="load"?this._page._frameManager.frameLifecycleEvent(e.frameId,"load"):e.name==="DOMContentLoaded"&&this._page._frameManager.frameLifecycleEvent(e.frameId,"domcontentloaded"))}_handleFrameTree(e){if(this._onFrameAttached(e.frame.id,e.frame.parentId||null),this._onFrameNavigated(e.frame,!0),!!e.childFrames)for(let t of e.childFrames)this._handleFrameTree(t)}_eventBelongsToStaleFrame(e){let t=this._page._frameManager.frame(e);if(!t)return!0;let n=this._crPage._sessionForFrame(t);return n&&n!==this&&!n._swappedIn}_onFrameAttached(e,t){let n=this._crPage._sessions.get(e);if(n&&e!==this._targetId){n._swappedIn=!0;let s=this._page._frameManager.frame(e);s&&this._page._frameManager.removeChildFramesRecursively(s);return}t&&!this._page._frameManager.frame(t)||this._page._frameManager.frameAttached(e,t)}_onFrameNavigated(e,t){this._eventBelongsToStaleFrame(e.id)||(this._page._frameManager.frameCommittedNewDocumentNavigation(e.id,e.url+(e.urlFragment||""),e.name||"",e.loaderId,t),t||this._firstNonInitialNavigationCommittedFulfill())}_onFrameRequestedNavigation(e){this._eventBelongsToStaleFrame(e.frameId)||e.disposition==="currentTab"&&this._page._frameManager.frameRequestedNavigation(e.frameId)}_onFrameNavigatedWithinDocument(e,t){this._eventBelongsToStaleFrame(e)||this._page._frameManager.frameCommittedSameDocumentNavigation(e,t)}_onFrameDetached(e,t){if(!this._crPage._sessions.has(e)){if(t==="swap"){let n=this._page._frameManager.frame(e);n&&this._page._frameManager.removeChildFramesRecursively(n);return}this._page._frameManager.frameDetached(e)}}_onExecutionContextCreated(e){let t=e.auxData?this._page._frameManager.frame(e.auxData.frameId):null;if(!t||this._eventBelongsToStaleFrame(t._id))return;let n=new xk.CRExecutionContext(this._client,e),s=null;e.auxData&&e.auxData.isDefault?s="main":e.name===Bu&&(s="utility");let o=new bk.FrameExecutionContext(n,t,s);o[Sk]=n,s&&t._contextCreated(s,o),this._contextIdToContext.set(e.id,o)}_onExecutionContextDestroyed(e){let t=this._contextIdToContext.get(e);t&&(this._contextIdToContext.delete(e),t.frame._contextDestroyed(t))}_onExecutionContextsCleared(){for(let e of Array.from(this._contextIdToContext.keys()))this._onExecutionContextDestroyed(e)}_onAttachedToTarget(e){var t;let n=this._client.createChildSession(e.sessionId);if(e.targetInfo.type==="iframe"){let a=e.targetInfo.targetId,l=this._page._frameManager.frame(a);if(!l)return;this._page._frameManager.removeChildFramesRecursively(l);let c=new r(this._crPage,n,a,this);this._crPage._sessions.set(a,c),c._initialize(!1).catch(u=>u);return}if(e.targetInfo.type!=="worker"){n.detach().catch(()=>{});return}let s=e.targetInfo.url,o=new ju.Worker(this._page,s);this._page._addWorker(e.sessionId,o),this._workerSessions.set(e.sessionId,n),n.once("Runtime.executionContextCreated",async a=>{o._createExecutionContext(new xk.CRExecutionContext(n,a.context))}),n._sendMayFail("Runtime.enable"),this._crPage._networkManager.addSession(n,(t=this._page._frameManager.frame(this._targetId))!==null&&t!==void 0?t:void 0).catch(()=>{}),n._sendMayFail("Runtime.runIfWaitingForDebugger"),n._sendMayFail("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),n.on("Target.attachedToTarget",a=>this._onAttachedToTarget(a)),n.on("Target.detachedFromTarget",a=>this._onDetachedFromTarget(a)),n.on("Runtime.consoleAPICalled",a=>{let l=a.args.map(c=>o._existingExecutionContext.createHandle(c));this._page._addConsoleMessage(a.type,l,(0,ia.toConsoleMessageLocation)(a.stackTrace))}),n.on("Runtime.exceptionThrown",a=>this._page.emitOnContextOnceInitialized(qu.BrowserContext.Events.PageError,(0,ia.exceptionToError)(a.exceptionDetails),this._page))}_onDetachedFromTarget(e){let t=this._workerSessions.get(e.sessionId);if(t){t.dispose(),this._page._removeWorker(e.sessionId);return}let n=this._crPage._sessions.get(e.targetId);if(n){if(n._swappedIn){n.dispose();return}this._client.send("Page.enable").catch(s=>null).then(()=>{n._swappedIn||this._page._frameManager.frameDetached(e.targetId),n.dispose()})}}_onWindowOpen(e){this._crPage._nextWindowOpenPopupFeatures.push(e.windowFeatures)}async _onConsoleAPI(e){if(e.executionContextId===0)return;let t=this._contextIdToContext.get(e.executionContextId);if(!t)return;let n=e.args.map(s=>t.createHandle(s));this._page._addConsoleMessage(e.type,n,(0,ia.toConsoleMessageLocation)(e.stackTrace))}async _initBinding(e){let[,t]=await Promise.all([this._client.send("Runtime.addBinding",{name:e.name}),this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:e.source})]);this._exposedBindingNames.push(e.name),e.name.startsWith("__pw")||this._evaluateOnNewDocumentIdentifiers.push(t.identifier)}async _removeExposedBindings(){let e=[],t=[];for(let n of this._exposedBindingNames)(n.startsWith("__pw_")?e:t).push(n);this._exposedBindingNames=e,await Promise.all(t.map(n=>this._client.send("Runtime.removeBinding",{name:n})))}async _onBindingCalled(e){if(!(await this._crPage.pageOrError()instanceof Error)){let n=this._contextIdToContext.get(e.executionContextId);n&&await this._page._onBindingCalled(e.payload,n)}}_onDialog(e){this._page._frameManager.frame(this._targetId)&&this._page.emitOnContext(qu.BrowserContext.Events.Dialog,new vj.Dialog(this._page,e.type,e.message,async(t,n)=>{await this._client.send("Page.handleJavaScriptDialog",{accept:t,promptText:n})},e.defaultPrompt))}_handleException(e){this._page.emitOnContextOnceInitialized(qu.BrowserContext.Events.PageError,(0,ia.exceptionToError)(e),this._page)}async _onTargetCrashed(){this._client._markAsCrashed(),this._page._didCrash()}_onLogEntryAdded(e){let{level:t,text:n,args:s,source:o,url:a,lineNumber:l}=e.entry;if(s&&s.map(c=>(0,ia.releaseObject)(this._client,c.objectId)),o!=="worker"){let c={url:a||"",lineNumber:l||0,columnNumber:0};this._page._addConsoleMessage(t,[],c,n)}}async _onFileChooserOpened(e){if(!e.backendNodeId)return;let t=this._page._frameManager.frame(e.frameId);if(!t)return;let n;try{let s=await t._utilityContext();n=await this._adoptBackendNodeId(e.backendNodeId,s)}catch{return}await this._page._onFileChooserOpened(n)}_willBeginDownload(){this._crPage._initializedPage||this._firstNonInitialNavigationCommittedReject(new Error("Starting new page download"))}_onScreencastFrame(e){this._page.throttleScreencastFrameAck(()=>{this._client.send("Page.screencastFrameAck",{sessionId:e.sessionId}).catch(()=>{})});let t=Buffer.from(e.data,"base64");this._page.emit(ju.Page.Events.ScreencastFrame,{buffer:t,timestamp:e.metadata.timestamp,width:e.metadata.deviceWidth,height:e.metadata.deviceHeight})}async _createVideoRecorder(e,t){(0,Du.assert)(!this._screencastId);let n=_j.registry.findExecutable("ffmpeg").executablePathOrDie(this._page.attribution.playwright.options.sdkLanguage);this._videoRecorder=await Pj.VideoRecorder.launch(this._crPage._page,n,t),this._screencastId=e}async _startVideoRecording(e){let t=this._screencastId;(0,Du.assert)(t),this._page.once(ju.Page.Events.Close,()=>this._stopVideoRecording().catch(()=>{}));let n=new Promise(s=>this._client.once("Page.screencastFrame",s));await this._startScreencast(this._videoRecorder,{format:"jpeg",quality:90,maxWidth:e.width,maxHeight:e.height}),n.then(()=>{this._crPage._browserContext._browser._videoStarted(this._crPage._browserContext,t,e.outputFile,this._crPage.pageOrError())})}async _stopVideoRecording(){if(!this._screencastId)return;let e=this._screencastId;this._screencastId=null;let t=this._videoRecorder;this._videoRecorder=null,await this._stopScreencast(t),await t.stop().catch(()=>{});let n=this._crPage._browserContext._browser._takeVideo(e);n?.reportFinished()}async _startScreencast(e,t={}){this._screencastClients.add(e),this._screencastClients.size===1&&await this._client.send("Page.startScreencast",t)}async _stopScreencast(e){this._screencastClients.delete(e),this._screencastClients.size||await this._client._sendMayFail("Page.stopScreencast")}async _updateGeolocation(e){let t=this._crPage._browserContext._options.geolocation;(!e||t)&&await this._client.send("Emulation.setGeolocationOverride",t||{})}async _updateViewport(e){if(this._crPage._browserContext._browser.isClank())return;(0,Du.assert)(this._isMainFrame());let t=this._crPage._browserContext._options,n=this._page.emulatedSize();if(n===null)return;let s=n.viewport,o=n.screen,a=o.width>o.height,l={mobile:!!t.isMobile,width:s.width,height:s.height,screenWidth:o.width,screenHeight:o.height,deviceScaleFactor:t.deviceScaleFactor||1,screenOrientation:t.isMobile?a?{angle:90,type:"landscapePrimary"}:{angle:0,type:"portraitPrimary"}:{angle:0,type:"landscapePrimary"},dontSetVisibleSize:e};if(JSON.stringify(this._metricsOverride)===JSON.stringify(l))return;let c=[this._client.send("Emulation.setDeviceMetricsOverride",l)];if(!e&&this._windowId){let u={width:0,height:0};this._crPage._browserContext._browser.options.headful&&(u={width:24,height:88},process.platform==="win32"?u={width:16,height:88}:process.platform==="linux"?u={width:8,height:85}:process.platform==="darwin"&&(u={width:2,height:80}),this._crPage._browserContext.isPersistentContext()&&(u.height+=46)),c.push(this.setWindowBounds({width:s.width+u.width,height:s.height+u.height}))}await Promise.all(c),this._metricsOverride=l}async windowBounds(){let{bounds:e}=await this._client.send("Browser.getWindowBounds",{windowId:this._windowId});return e}async setWindowBounds(e){return await this._client.send("Browser.setWindowBounds",{windowId:this._windowId,bounds:e})}async _updateEmulateMedia(){let e=this._page.emulatedMedia(),t=e.media==="no-override"?"":e.media,n=e.colorScheme==="no-override"?"":e.colorScheme,s=e.reducedMotion==="no-override"?"":e.reducedMotion,o=e.forcedColors==="no-override"?"":e.forcedColors,a=[{name:"prefers-color-scheme",value:n},{name:"prefers-reduced-motion",value:s},{name:"forced-colors",value:o}];await this._client.send("Emulation.setEmulatedMedia",{media:t,features:a})}async _updateUserAgent(){let e=this._crPage._browserContext._options;await this._client.send("Emulation.setUserAgentOverride",{userAgent:e.userAgent||"",acceptLanguage:e.locale,userAgentMetadata:Nj(e)})}async _setDefaultFontFamilies(e){let t=Oj.platformToFontFamilies[this._crPage._browserContext._browser._platform()];await e.send("Page.setFontFamilies",t)}async _updateFileChooserInterception(e){let t=this._page.fileChooserIntercepted();e&&!t||await this._client.send("Page.setInterceptFileChooserDialog",{enabled:t}).catch(()=>{})}async _evaluateOnNewDocument(e,t){let n=t==="utility"?Bu:void 0,{identifier:s}=await this._client.send("Page.addScriptToEvaluateOnNewDocument",{source:e,worldName:n});this._evaluateOnNewDocumentIdentifiers.push(s)}async _removeEvaluatesOnNewDocument(){let e=this._evaluateOnNewDocumentIdentifiers;this._evaluateOnNewDocumentIdentifiers=[],await Promise.all(e.map(t=>this._client.send("Page.removeScriptToEvaluateOnNewDocument",{identifier:t})))}async _getContentFrame(e){let t=await this._client.send("DOM.describeNode",{objectId:e._objectId});return!t||typeof t.node.frameId!="string"?null:this._page._frameManager.frame(t.node.frameId)}async _getOwnerFrame(e){let t=await e.evaluateHandle(o=>{let a=o;return a.documentElement&&a.documentElement.ownerDocument===a?a.documentElement:o.ownerDocument?o.ownerDocument.documentElement:null});if(!t||!t._objectId)return null;let n=await this._client.send("DOM.describeNode",{objectId:t._objectId}),s=n&&typeof n.node.frameId=="string"?n.node.frameId:null;return t.dispose(),s}async _getBoundingBox(e){let t=await this._client._sendMayFail("DOM.getBoxModel",{objectId:e._objectId});if(!t)return null;let n=t.model.border,s=Math.min(n[0],n[2],n[4],n[6]),o=Math.min(n[1],n[3],n[5],n[7]),a=Math.max(n[0],n[2],n[4],n[6])-s,l=Math.max(n[1],n[3],n[5],n[7])-o,c=await this._framePosition();return c?{x:s+c.x,y:o+c.y,width:a,height:l}:null}async _framePosition(){let e=this._page._frameManager.frame(this._targetId);return e?e===this._page.mainFrame()?{x:0,y:0}:await(await e.frameElement()).boundingBox():null}async _scrollRectIntoViewIfNeeded(e,t){return await this._client.send("DOM.scrollIntoViewIfNeeded",{objectId:e._objectId,rect:t}).then(()=>"done").catch(n=>{if(n instanceof Error&&n.message.includes("Node does not have a layout object"))return"error:notvisible";if(n instanceof Error&&n.message.includes("Node is detached from document"))return"error:notconnected";throw n})}async _getContentQuads(e){let t=await this._client._sendMayFail("DOM.getContentQuads",{objectId:e._objectId});if(!t)return null;let n=await this._framePosition();return n?t.quads.map(s=>[{x:s[0]+n.x,y:s[1]+n.y},{x:s[2]+n.x,y:s[3]+n.y},{x:s[4]+n.x,y:s[5]+n.y},{x:s[6]+n.x,y:s[7]+n.y}]):null}async _adoptElementHandle(e,t){let n=await this._client.send("DOM.describeNode",{objectId:e._objectId});return this._adoptBackendNodeId(n.node.backendNodeId,t)}async _adoptBackendNodeId(e,t){let n=await this._client._sendMayFail("DOM.resolveNode",{backendNodeId:e,executionContextId:t[Sk]._contextId});if(!n||n.object.subtype==="null")throw new Error(bk.kUnableToAdoptErrorMessage);return t.createHandle(n.object).asElement()}};async function Mj(r,e){try{await r.send("Emulation.setLocaleOverride",{locale:e})}catch(t){if(t.message.includes("Another locale override is already in effect"))return;throw t}}async function Fj(r,e){try{await r.send("Emulation.setTimezoneOverride",{timezoneId:e})}catch(t){if(t.message.includes("Timezone override is already in effect"))return;throw t.message.includes("Invalid timezone")?new Error(`Invalid timezone ID: ${e}`):t}}var Sk=Symbol("delegate");function Nj(r){let e=r.userAgent;if(!e)return;let t={mobile:!!r.isMobile,model:"",architecture:"x64",platform:"Windows",platformVersion:""},n=e.match(/Android (\d+(\.\d+)?(\.\d+)?)/),s=e.match(/iPhone OS (\d+(_\d+)?)/),o=e.match(/iPad; CPU OS (\d+(_\d+)?)/),a=e.match(/Mac OS X (\d+(_\d+)?(_\d+)?)/),l=e.match(/Windows\D+(\d+(\.\d+)?(\.\d+)?)/);return n?(t.platform="Android",t.platformVersion=n[1],t.architecture="arm"):s?(t.platform="iOS",t.platformVersion=s[1],t.architecture="arm"):o?(t.platform="iOS",t.platformVersion=o[1],t.architecture="arm"):a?(t.platform="macOS",t.platformVersion=a[1],e.includes("Intel")||(t.architecture="arm")):l?(t.platform="Windows",t.platformVersion=l[1]):e.toLowerCase().includes("linux")&&(t.platform="Linux"),e.includes("ARM")&&(t.architecture="arm"),t}});var Tk=M(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:!0});Uu.CRServiceWorker=void 0;var Lj=Et(),Dj=Au(),Bj=Jg(),jj=qj(Ct()),Wu=$e();function Ck(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Ck=function(n){return n?t:e})(r)}function qj(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Ck(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var n_=class extends Lj.Worker{constructor(e,t,n){super(e,n),this._browserContext=void 0,this._networkManager=void 0,this._session=void 0,this._session=t,this._browserContext=e,process.env.PW_EXPERIMENTAL_SERVICE_WORKER_NETWORK_EVENTS&&(this._networkManager=new Bj.CRNetworkManager(null,this)),t.once("Runtime.executionContextCreated",s=>{this._createExecutionContext(new Dj.CRExecutionContext(t,s.context))}),this._networkManager&&this._isNetworkInspectionEnabled()&&(this.updateRequestInterception(),this.updateExtraHTTPHeaders(),this.updateHttpCredentials(),this.updateOffline(),this._networkManager.addSession(t,void 0,!0).catch(()=>{})),t.send("Runtime.enable",{}).catch(s=>{}),t.send("Runtime.runIfWaitingForDebugger").catch(s=>{}),t.on("Inspector.targetReloadedAfterCrash",()=>{t._sendMayFail("Runtime.runIfWaitingForDebugger",{})})}didClose(){var e;(e=this._networkManager)===null||e===void 0||e.removeSession(this._session),this._session.dispose(),super.didClose()}async updateOffline(){var e;this._isNetworkInspectionEnabled()&&await((e=this._networkManager)===null||e===void 0?void 0:e.setOffline(!!this._browserContext._options.offline).catch(()=>{}))}async updateHttpCredentials(){var e;this._isNetworkInspectionEnabled()&&await((e=this._networkManager)===null||e===void 0?void 0:e.authenticate(this._browserContext._options.httpCredentials||null).catch(()=>{}))}async updateExtraHTTPHeaders(){var e;this._isNetworkInspectionEnabled()&&await((e=this._networkManager)===null||e===void 0?void 0:e.setExtraHTTPHeaders(this._browserContext._options.extraHTTPHeaders||[]).catch(()=>{}))}async updateRequestInterception(){var e;this._isNetworkInspectionEnabled()&&await((e=this._networkManager)===null||e===void 0?void 0:e.setRequestInterception(this.needsRequestInterception()).catch(()=>{}))}needsRequestInterception(){return this._isNetworkInspectionEnabled()&&!!this._browserContext._requestInterceptor}reportRequestFinished(e,t){this._browserContext.emit(Wu.BrowserContext.Events.RequestFinished,{request:e,response:t})}requestFailed(e,t){this._browserContext.emit(Wu.BrowserContext.Events.RequestFailed,e)}requestReceivedResponse(e){this._browserContext.emit(Wu.BrowserContext.Events.Response,e)}requestStarted(e,t){if(this._browserContext.emit(Wu.BrowserContext.Events.Request,e),t){var n,s;let o=new jj.Route(e,t);if((n=(s=this._browserContext)._requestInterceptor)!==null&&n!==void 0&&n.call(s,o,e))return;o.continue({isFallback:!0}).catch(()=>{})}}_isNetworkInspectionEnabled(){return this._browserContext._options.serviceWorkers!=="block"}};Uu.CRServiceWorker=n_});var ps=M(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.CRBrowserContext=fs.CRBrowser=void 0;var Hj=Jj(require("path")),$j=li(),r_=$e(),Vn=ie(),Ok=Kj(Ct()),Wj=Et(),Uj=si(),Pk=ra(),Ak=kk(),zj=xr(),Vj=Tk(),Gj=is();function Ik(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Ik=function(n){return n?t:e})(r)}function Kj(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Ik(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function Jj(r){return r&&r.__esModule?r:{default:r}}var i_=class r extends $j.Browser{static async connect(e,t,n,s){n={...n};let o=new Pk.CRConnection(t,n.protocolLogger,n.browserLogsCollector),a=new r(e,o,n);a._devtools=s,a.isClank()&&(a._isCollocatedWithServer=!1);let l=o.rootSession;n.__testHookOnConnectToBrowser&&await n.__testHookOnConnectToBrowser();let c=await l.send("Browser.getVersion");return a._version=c.product.substring(c.product.indexOf("/")+1),a._userAgent=c.userAgent,a.options.headful=!c.userAgent.includes("Headless"),n.persistent?(a._defaultContext=new di(a,void 0,n.persistent),await Promise.all([l.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}).then(async()=>{await l.send("Target.getTargetInfo")}),a._defaultContext._initialize()]),await a._waitForAllPagesToBeInitialized(),a):(await l.send("Target.setAutoAttach",{autoAttach:!0,waitForDebuggerOnStart:!0,flatten:!0}),a)}constructor(e,t,n){super(e,n),this._connection=void 0,this._session=void 0,this._clientRootSessionPromise=null,this._contexts=new Map,this._crPages=new Map,this._backgroundPages=new Map,this._serviceWorkers=new Map,this._devtools=void 0,this._version="",this._tracingRecording=!1,this._tracingClient=void 0,this._userAgent="",this._connection=t,this._session=this._connection.rootSession,this._connection.on(Pk.ConnectionEvents.Disconnected,()=>this._didDisconnect()),this._session.on("Target.attachedToTarget",this._onAttachedToTarget.bind(this)),this._session.on("Target.detachedFromTarget",this._onDetachedFromTarget.bind(this)),this._session.on("Browser.downloadWillBegin",this._onDownloadWillBegin.bind(this)),this._session.on("Browser.downloadProgress",this._onDownloadProgress.bind(this))}async doCreateNewContext(e){let t;e.proxy&&(process.env.PLAYWRIGHT_DISABLE_FORCED_CHROMIUM_PROXIED_LOOPBACK?t=e.proxy.bypass:t="<-loopback>"+(e.proxy.bypass?`,${e.proxy.bypass}`:""));let{browserContextId:n}=await this._session.send("Target.createBrowserContext",{disposeOnDetach:!0,proxyServer:e.proxy?e.proxy.server:void 0,proxyBypassList:t}),s=new di(this,n,e);return await s._initialize(),this._contexts.set(n,s),s}contexts(){return Array.from(this._contexts.values())}version(){return this._version}userAgent(){return this._userAgent}_platform(){return this._userAgent.includes("Windows")?"win":this._userAgent.includes("Macintosh")?"mac":"linux"}isClank(){return this.options.name==="clank"}async _waitForAllPagesToBeInitialized(){await Promise.all([...this._crPages.values()].map(e=>e.pageOrError()))}_onAttachedToTarget({targetInfo:e,sessionId:t,waitingForDebugger:n}){if(e.type==="browser")return;let s=this._session.createChildSession(t);(0,Vn.assert)(e.browserContextId,"targetInfo: "+JSON.stringify(e,null,2));let o=this._contexts.get(e.browserContextId)||null;if(o||(o=this._defaultContext),e.type==="other"&&e.url.startsWith("devtools://devtools")&&this._devtools){this._devtools.install(s);return}let a=e.type==="other"&&process.env.PW_CHROMIUM_ATTACH_TO_OTHER;if(!o||e.type==="other"&&!a){s.detach().catch(()=>{});return}if((0,Vn.assert)(!this._crPages.has(e.targetId),"Duplicate target "+e.targetId),(0,Vn.assert)(!this._backgroundPages.has(e.targetId),"Duplicate target "+e.targetId),(0,Vn.assert)(!this._serviceWorkers.has(e.targetId),"Duplicate target "+e.targetId),e.type==="background_page"){let l=new Ak.CRPage(s,e.targetId,o,null,{hasUIWindow:!1,isBackgroundPage:!0});this._backgroundPages.set(e.targetId,l);return}if(e.type==="page"||a){let l=e.openerId&&this._crPages.get(e.openerId)||null,c=new Ak.CRPage(s,e.targetId,o,l,{hasUIWindow:e.type==="page",isBackgroundPage:!1});this._crPages.set(e.targetId,c);return}if(e.type==="service_worker"){let l=new Vj.CRServiceWorker(o,s,e.url);this._serviceWorkers.set(e.targetId,l),o.emit(di.CREvents.ServiceWorker,l);return}s.detach().catch(()=>{})}_onDetachedFromTarget(e){let t=e.targetId,n=this._crPages.get(t);if(n){this._crPages.delete(t),n.didClose();return}let s=this._backgroundPages.get(t);if(s){this._backgroundPages.delete(t),s.didClose();return}let o=this._serviceWorkers.get(t);if(o){this._serviceWorkers.delete(t),o.didClose();return}}_didDisconnect(){for(let e of this._crPages.values())e.didClose();this._crPages.clear();for(let e of this._backgroundPages.values())e.didClose();this._backgroundPages.clear();for(let e of this._serviceWorkers.values())e.didClose();this._serviceWorkers.clear(),this._didClose()}_findOwningPage(e){for(let t of this._crPages.values())if(t._page._frameManager.frame(e))return t;return null}_onDownloadWillBegin(e){let t=this._findOwningPage(e.frameId);if(!t)return;t.willBeginDownload();let n=t._initializedPage;!n&&t._opener&&(n=t._opener._initializedPage),n&&this._downloadCreated(n,e.guid,e.url,e.suggestedFilename)}_onDownloadProgress(e){e.state==="completed"&&this._downloadFinished(e.guid,""),e.state==="canceled"&&this._downloadFinished(e.guid,this._closeReason||"canceled")}async _closePage(e){await this._session.send("Target.closeTarget",{targetId:e._targetId})}async newBrowserCDPSession(){return await this._connection.createBrowserSession()}async startTracing(e,t={}){(0,Vn.assert)(!this._tracingRecording,"Cannot start recording trace while already recording trace."),this._tracingClient=e?e._delegate._mainFrameSession._client:this._session;let n=["-*","devtools.timeline","v8.execute","disabled-by-default-devtools.timeline","disabled-by-default-devtools.timeline.frame","toplevel","blink.console","blink.user_timing","latencyInfo","disabled-by-default-devtools.timeline.stack","disabled-by-default-v8.cpu_profiler","disabled-by-default-v8.cpu_profiler.hires"],{screenshots:s=!1,categories:o=n}=t;s&&o.push("disabled-by-default-devtools.screenshot"),this._tracingRecording=!0,await this._tracingClient.send("Tracing.start",{transferMode:"ReturnAsStream",categories:o.join(",")})}async stopTracing(){(0,Vn.assert)(this._tracingClient,"Tracing was not started.");let[e]=await Promise.all([new Promise(s=>this._tracingClient.once("Tracing.tracingComplete",s)),this._tracingClient.send("Tracing.end")]),t=Hj.default.join(this.options.artifactsDir,(0,Vn.createGuid)()+".crtrace");await(0,zj.saveProtocolStream)(this._tracingClient,e.stream,t),this._tracingRecording=!1;let n=new Gj.Artifact(this,t);return n.reportFinished(),n}isConnected(){return!this._connection._closed}async _clientRootSession(){return this._clientRootSessionPromise||(this._clientRootSessionPromise=this._connection.createBrowserSession()),this._clientRootSessionPromise}};fs.CRBrowser=i_;var di=class extends r_.BrowserContext{constructor(e,t,n){super(e,n,t),this._authenticateProxyViaCredentials()}async _initialize(){(0,Vn.assert)(!Array.from(this._browser._crPages.values()).some(t=>t._browserContext===this));let e=[super._initialize()];this._browser.options.name!=="electron"&&this._browser.options.name!=="clank"&&this._options.acceptDownloads!=="internal-browser-default"&&e.push(this._browser._session.send("Browser.setDownloadBehavior",{behavior:this._options.acceptDownloads==="accept"?"allowAndName":"deny",browserContextId:this._browserContextId,downloadPath:this._browser.options.downloadsPath,eventsEnabled:!0})),await Promise.all(e)}_crPages(){return[...this._browser._crPages.values()].filter(e=>e._browserContext===this)}pages(){return this._crPages().map(e=>e._initializedPage).filter(Boolean)}async newPageDelegate(){(0,r_.assertBrowserContextIsNotOwned)(this);let e=this._browser.isClank()?new Set(this._browser._crPages.keys()):void 0,{targetId:t}=await this._browser._session.send("Target.createTarget",{url:"about:blank",browserContextId:this._browserContextId});if(e){let n=new Set(this._browser._crPages.keys());for(let s of e)n.delete(s);for(let s of n)this._browser._crPages.get(s)._opener&&n.delete(s);(0,Vn.assert)(n.size===1),[t]=[...n]}return this._browser._crPages.get(t)}async doGetCookies(e){let{cookies:t}=await this._browser._session.send("Storage.getCookies",{browserContextId:this._browserContextId});return Ok.filterCookies(t.map(n=>{let s={sameSite:"Lax",...n};return delete s.size,delete s.priority,delete s.session,delete s.sameParty,delete s.sourceScheme,delete s.sourcePort,s}),e)}async addCookies(e){await this._browser._session.send("Storage.setCookies",{cookies:Ok.rewriteCookies(e),browserContextId:this._browserContextId})}async doClearCookies(){await this._browser._session.send("Storage.clearCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){let n=new Map([["geolocation","geolocation"],["midi","midi"],["notifications","notifications"],["camera","videoCapture"],["microphone","audioCapture"],["background-sync","backgroundSync"],["ambient-light-sensor","sensors"],["accelerometer","sensors"],["gyroscope","sensors"],["magnetometer","sensors"],["accessibility-events","accessibilityEvents"],["clipboard-read","clipboardReadWrite"],["clipboard-write","clipboardSanitizedWrite"],["payment-handler","paymentHandler"],["midi-sysex","midiSysex"]]),s=t.map(o=>{let a=n.get(o);if(!a)throw new Error("Unknown permission: "+o);return a});await this._browser._session.send("Browser.grantPermissions",{origin:e==="*"?void 0:e,browserContextId:this._browserContextId,permissions:s})}async doClearPermissions(){await this._browser._session.send("Browser.resetPermissions",{browserContextId:this._browserContextId})}async setGeolocation(e){(0,r_.verifyGeolocation)(e),this._options.geolocation=e;for(let t of this.pages())await t._delegate.updateGeolocation()}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;for(let t of this.pages())await t._delegate.updateExtraHTTPHeaders();for(let t of this.serviceWorkers())await t.updateExtraHTTPHeaders()}async setUserAgent(e){this._options.userAgent=e;for(let t of this.pages())await t._delegate.updateUserAgent()}async setOffline(e){this._options.offline=e;for(let t of this.pages())await t._delegate.updateOffline();for(let t of this.serviceWorkers())await t.updateOffline()}async doSetHTTPCredentials(e){this._options.httpCredentials=e;for(let t of this.pages())await t._delegate.updateHttpCredentials();for(let t of this.serviceWorkers())await t.updateHttpCredentials()}async doAddInitScript(e){for(let t of this.pages())await t._delegate.addInitScript(e)}async doRemoveInitScripts(){for(let e of this.pages())await e._delegate.removeInitScripts()}async doExposeBinding(e){for(let t of this.pages())await t._delegate.exposeBinding(e)}async doRemoveExposedBindings(){for(let e of this.pages())await e._delegate.removeExposedBindings()}async doUpdateRequestInterception(){for(let e of this.pages())await e._delegate.updateRequestInterception();for(let e of this.serviceWorkers())await e.updateRequestInterception()}async doClose(e){let t=[];for(let n of this._crPages()){let s=[...n._page._frameManager._openedDialogs].filter(o=>o.type()==="beforeunload");t.push(...s)}if(await Promise.all(t.map(n=>n.dismiss())),!this._browserContextId){await this.stopVideoRecording(),await this._browser.close({reason:e});return}await this._browser._session.send("Target.disposeBrowserContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId);for(let[n,s]of this._browser._serviceWorkers)s._browserContext===this&&(s.didClose(),this._browser._serviceWorkers.delete(n))}async stopVideoRecording(){await Promise.all(this._crPages().map(e=>e._mainFrameSession._stopVideoRecording()))}onClosePersistent(){for(let[e,t]of this._browser._backgroundPages.entries())t._browserContext===this&&t._initializedPage&&(t.didClose(),this._browser._backgroundPages.delete(e))}async clearCache(){for(let e of this._crPages())await e._networkManager.clearCache()}async cancelDownload(e){await this._browser._session.send("Browser.cancelDownload",{guid:e,browserContextId:this._browserContextId})}backgroundPages(){let e=[];for(let t of this._browser._backgroundPages.values())t._browserContext===this&&t._initializedPage&&e.push(t._initializedPage);return e}serviceWorkers(){return Array.from(this._browser._serviceWorkers.values()).filter(e=>e._browserContext===this)}async newCDPSession(e){let t=null;if(e instanceof Wj.Page)t=e._delegate._targetId;else if(e instanceof Uj.Frame){let s=e._page._delegate._sessions.get(e._id);if(!s)throw new Error("This frame does not have a separate CDP session, it is a part of the parent frame's session");t=s._targetId}else throw new Error("page: expected Page or Frame");return(await this._browser._clientRootSession()).attachToTarget(t)}};fs.CRBrowserContext=di;di.CREvents={BackgroundPage:"backgroundpage",ServiceWorker:"serviceworker"}});var Rk=M(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:!0});zu.PipeTransport=void 0;var Xj=ie(),s_=class{constructor(e,t,n,s="le"){this._pipeWrite=void 0,this._data=Buffer.from([]),this._waitForNextTask=(0,Xj.makeWaitForNextTask)(),this._closed=!1,this._bytesLeft=0,this.onmessage=void 0,this.onclose=void 0,this._endian=void 0,this._closeableStream=void 0,this._pipeWrite=e,this._endian=s,this._closeableStream=n,t.on("data",o=>this._dispatch(o)),t.on("close",()=>{this._closed=!0,this.onclose&&this.onclose()}),this.onmessage=void 0,this.onclose=void 0}send(e){if(this._closed)throw new Error("Pipe has been closed");let t=Buffer.from(e,"utf-8"),n=Buffer.alloc(4);this._endian==="be"?n.writeUInt32BE(t.length,0):n.writeUInt32LE(t.length,0),this._pipeWrite.write(n),this._pipeWrite.write(t)}close(){this._closeableStream.close()}_dispatch(e){for(this._data=Buffer.concat([this._data,e]);!(!this._bytesLeft&&this._data.length<4||(this._bytesLeft||(this._bytesLeft=this._endian==="be"?this._data.readUInt32BE(0):this._data.readUInt32LE(0),this._data=this._data.slice(4)),!this._bytesLeft||this._data.length<this._bytesLeft));){let t=this._data.slice(0,this._bytesLeft);this._data=this._data.slice(this._bytesLeft),this._bytesLeft=0,this._waitForNextTask(()=>{this.onmessage&&this.onmessage(t.toString("utf-8"))})}}};zu.PipeTransport=s_});var o_=M(Vu=>{"use strict";Object.defineProperty(Vu,"__esModule",{value:!0});Vu.chromiumSwitches=void 0;var u7=Vu.chromiumSwitches=["--disable-field-trial-config","--disable-background-networking","--enable-features=NetworkService,NetworkServiceInProcess","--disable-background-timer-throttling","--disable-backgrounding-occluded-windows","--disable-back-forward-cache","--disable-breakpad","--disable-client-side-phishing-detection","--disable-component-extensions-with-background-pages","--disable-component-update","--no-default-browser-check","--disable-default-apps","--disable-dev-shm-usage","--disable-extensions","--disable-features=ImprovedCookieControls,LazyFrameLoading,GlobalMediaControls,DestroyProfileOnBrowserClose,MediaRouter,DialMediaRouteProvider,AcceptCHFrame,AutoExpandDetailsElement,CertificateTransparencyComponentUpdater,AvoidUnnecessaryBeforeUnloadCheckSync,Translate,HttpsUpgrades,PaintHolding","--allow-pre-commit-input","--disable-hang-monitor","--disable-ipc-flooding-protection","--disable-popup-blocking","--disable-prompt-on-repost","--disable-renderer-backgrounding","--force-color-profile=srgb","--metrics-recording-only","--no-first-run","--enable-automation","--password-store=basic","--use-mock-keychain","--no-service-autorun","--export-tagged-pdf","--disable-search-engine-choice-screen"]});var Ku=M(ms=>{"use strict";Object.defineProperty(ms,"__esModule",{value:!0});ms.AndroidDevice=ms.Android=void 0;var _t=Be(),Yj=require("events"),a_=h_(require("fs")),Qj=h_(require("os")),Fk=h_(require("path")),Gu=ie(),Zj=ht(),eq=$e(),tq=Ut(),nq=ps(),rq=yt(),iq=Rk(),sq=Le(),Mk=sr(),Nk=en(),l_=De(),oq=o_(),aq=qn();function h_(r){return r&&r.__esModule?r:{default:r}}var lq=Fk.default.join(Qj.default.tmpdir(),"playwright-artifacts-"),c_=class extends l_.SdkObject{constructor(e,t){super(e,"android"),this._backend=void 0,this._devices=new Map,this._timeoutSettings=void 0,this._backend=t,this._timeoutSettings=new Nk.TimeoutSettings}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async devices(e){let t=(await this._backend.devices(e)).filter(s=>s.status==="device"),n=new Set;for(let s of t){if(n.add(s.serial),this._devices.has(s.serial))continue;let o=await sa.create(this,s,e);this._devices.set(s.serial,o)}for(let s of this._devices.keys())n.has(s)||this._devices.delete(s);return[...this._devices.values()]}_deviceClosed(e){this._devices.delete(e.serial)}};ms.Android=c_;var sa=class r extends l_.SdkObject{constructor(e,t,n,s){super(e,"android-device"),this._backend=void 0,this.model=void 0,this.serial=void 0,this._options=void 0,this._driverPromise=void 0,this._lastId=0,this._callbacks=new Map,this._pollingWebViews=void 0,this._timeoutSettings=void 0,this._webViews=new Map,this._browserConnections=new Set,this._android=void 0,this._isClosed=!1,this._android=e,this._backend=t,this.model=n,this.serial=t.serial,this._options=s,this._timeoutSettings=new Nk.TimeoutSettings(e._timeoutSettings)}static async create(e,t,n){await t.init();let s=await t.runCommand("shell:getprop ro.product.model"),o=new r(e,t,s.toString().trim(),n);return await o._init(),o}async _init(){await this._refreshWebViews();let e=()=>{this._pollingWebViews=setTimeout(()=>this._refreshWebViews().then(e).catch(()=>{this.close().catch(()=>{})}),500)};e()}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async shell(e){let t=await this._backend.runCommand(`shell:${e}`);return await this._refreshWebViews(),t}async open(e){return await this._backend.open(`${e}`)}async screenshot(){return await this._backend.runCommand("shell:screencap -p")}async _driver(){if(!this._isClosed)return this._driverPromise||(this._driverPromise=this._installDriver()),this._driverPromise}async _installDriver(){if((0,_t.debug)("pw:android")("Stopping the old driver"),await this.shell("am force-stop com.microsoft.playwright.androiddriver"),this._options.omitDriverInstall)(0,_t.debug)("pw:android")("Skipping the driver installation");else{(0,_t.debug)("pw:android")("Uninstalling the old driver"),await this.shell("cmd package uninstall com.microsoft.playwright.androiddriver"),await this.shell("cmd package uninstall com.microsoft.playwright.androiddriver.test"),(0,_t.debug)("pw:android")("Installing the new driver");let n=aq.registry.findExecutable("android"),s=(0,Gu.getPackageManagerExecCommand)();for(let o of["android-driver.apk","android-driver-target.apk"]){let a=Fk.default.join(n.directory,o);if(!a_.default.existsSync(a))throw new Error(`Please install Android driver apk using '${s} playwright install android'`);await this.installApk(await a_.default.promises.readFile(a))}}(0,_t.debug)("pw:android")("Starting the new driver"),this.shell("am instrument -w com.microsoft.playwright.androiddriver.test/androidx.test.runner.AndroidJUnitRunner").catch(n=>(0,_t.debug)("pw:android")(n));let e=await this._waitForLocalAbstract("playwright_android_driver_socket"),t=new iq.PipeTransport(e,e,e,"be");return t.onmessage=n=>{let s=JSON.parse(n),{id:o,result:a,error:l}=s,c=this._callbacks.get(o);c&&(l?c.reject(new Error(l)):c.fulfill(a),this._callbacks.delete(o))},t}async _waitForLocalAbstract(e){let t;for((0,_t.debug)("pw:android")(`Polling the socket localabstract:${e}`);!t;)try{t=await this._backend.open(`localabstract:${e}`)}catch{await new Promise(s=>setTimeout(s,250))}return(0,_t.debug)("pw:android")(`Connected to localabstract:${e}`),t}async send(e,t={}){t.timeout=this._timeoutSettings.timeout(t);let n=await this._driver();if(!n)throw new Error("Device is closed");let s=++this._lastId,o=new Promise((a,l)=>this._callbacks.set(s,{fulfill:a,reject:l}));return n.send(JSON.stringify({id:s,method:e,params:t})),o}async close(){if(!this._isClosed){this._isClosed=!0,this._pollingWebViews&&clearTimeout(this._pollingWebViews);for(let e of this._browserConnections)await e.close();if(this._driverPromise){let e=await this._driver();e?.close()}await this._backend.close(),this._android._deviceClosed(this),this.emit(r.Events.Close)}}async launchBrowser(e="com.android.chrome",t){(0,_t.debug)("pw:android")("Force-stopping",e),await this._backend.runCommand(`shell:am force-stop ${e}`);let n=(0,Gu.isUnderTest)()?"webview_devtools_remote_playwright_test":"playwright_"+(0,Gu.createGuid)()+"_devtools_remote",s=this._defaultArgs(t,n).join(" ");(0,_t.debug)("pw:android")("Starting",e,s),await this._backend.runCommand(`shell:echo "${Buffer.from(s).toString("base64")}" | base64 -d > /data/local/tmp/chrome-command-line`),await this._backend.runCommand(`shell:am start -a android.intent.action.VIEW -d about:blank ${e}`);let o=await this._connectToBrowser(n,t);return await this._backend.runCommand("shell:rm /data/local/tmp/chrome-command-line"),o}_defaultArgs(e,t){return["_","--disable-fre","--no-default-browser-check",`--remote-debugging-socket-name=${t}`,...oq.chromiumSwitches,...this._innerDefaultArgs(e)]}_innerDefaultArgs(e){let{args:t=[],proxy:n}=e,s=[];if(n){s.push(`--proxy-server=${n.server}`);let o=[];n.bypass&&o.push(...n.bypass.split(",").map(a=>a.trim()).map(a=>a.startsWith(".")?"*"+a:a)),!process.env.PLAYWRIGHT_DISABLE_FORCED_CHROMIUM_PROXIED_LOOPBACK&&!o.includes("<-loopback>")&&o.push("<-loopback>"),o.length>0&&s.push(`--proxy-bypass-list=${o.join(";")}`)}return s.push(...t),s}async connectToWebView(e){if(!this._webViews.get(e))throw new Error("WebView has been closed");return await this._connectToBrowser(e)}async _connectToBrowser(e,t={}){let n=await this._waitForLocalAbstract(e),s=new u_(this,n);await s._init(),this._browserConnections.add(s);let o=await a_.default.promises.mkdtemp(lq),a=async()=>{let h=await(0,Zj.removeFolders)([o]);for(let p=0;p<(h||[]).length;++p)(0,_t.debug)("pw:android")(`exception while removing ${o}: ${h[p]}`)};Mk.gracefullyCloseSet.add(a),n.on("close",async()=>{Mk.gracefullyCloseSet.delete(a),a().catch(h=>(0,_t.debug)("pw:android")(`could not cleanup artifacts dir: ${h}`))});let l={name:"clank",isChromium:!0,slowMo:0,persistent:{...t,noDefaultViewport:!0},artifactsDir:o,downloadsPath:o,tracesDir:o,browserProcess:new d_(s),proxy:t.proxy,protocolLogger:rq.helper.debugProtocolLogger(),browserLogsCollector:new sq.RecentLogsCollector,originalLaunchOptions:{}};(0,eq.validateBrowserContextOptions)(t,l);let c=await nq.CRBrowser.connect(this.attribution.playwright,s,l),u=new tq.ProgressController((0,l_.serverSideCallMetadata)(),this),d=c._defaultContext;return await u.run(async h=>{await d._loadDefaultContextAsIs(h)}),d}webViews(){return[...this._webViews.values()]}async installApk(e,t){let n=t&&t.args?t.args:["-r","-t","-S"];(0,_t.debug)("pw:android")("Opening install socket");let s=await this._backend.open(`shell:cmd package install ${n.join(" ")} ${e.length}`);(0,_t.debug)("pw:android")("Writing driver bytes: "+e.length),await s.write(e);let o=await new Promise(a=>s.on("data",a));(0,_t.debug)("pw:android")("Written driver bytes: "+o),s.close()}async push(e,t,n=420){let s=await this._backend.open("sync:"),o=async(d,h)=>{let p=Buffer.alloc(d.length+4);p.write(d,0),p.writeUInt32LE(h,d.length),await s.write(p)},a=async(d,h)=>{await o(d,h.length),await s.write(h)};await a("SEND",Buffer.from(`${t},${n}`));let l=65535;for(let d=0;d<e.length;d+=l)await a("DATA",e.slice(d,d+l));await o("DONE",Date.now()/1e3|0);let u=(await new Promise(d=>s.once("data",d))).slice(0,4).toString();if(u!=="OKAY")throw new Error("Could not push: "+u);s.close()}async _refreshWebViews(){let e=(await this._backend.runCommand("shell:cat /proc/net/unix | grep webview_devtools_remote")).toString().split(`
`);if(this._isClosed)return;let t=new Set;for(let n of e){let s=n.match(/[^@]+@(.*?webview_devtools_remote_?.*)/);if(!s)continue;let o=s[1];if(t.add(o),this._webViews.has(o))continue;let a=n.match(/[^@]+@.*?webview_devtools_remote_?(\d*)/),l=-1;a&&a[1]&&(l=+a[1]);let c=await this._extractPkg(l);if(this._isClosed)return;let u={pid:l,pkg:c,socketName:o};this._webViews.set(o,u),this.emit(r.Events.WebViewAdded,u)}for(let n of this._webViews.keys())t.has(n)||(this._webViews.delete(n),this.emit(r.Events.WebViewRemoved,n))}async _extractPkg(e){let t="";if(e===-1)return t;let n=(await this._backend.runCommand(`shell:ps -A | grep ${e}`)).toString().split(`
`);for(let s of n)s.match(/[^\s]+\s+(\d+).*$/)&&(t=s.substring(s.lastIndexOf(" ")+1));return t}};ms.AndroidDevice=sa;sa.Events={WebViewAdded:"webViewAdded",WebViewRemoved:"webViewRemoved",Close:"close"};var u_=class extends Yj.EventEmitter{constructor(e,t){super(),this.device=void 0,this._socket=void 0,this._receiver=void 0,this._waitForNextTask=(0,Gu.makeWaitForNextTask)(),this.onmessage=void 0,this.onclose=void 0,this.setMaxListeners(0),this.device=e,this._socket=t,this._socket.on("close",()=>{this._waitForNextTask(()=>{this.onclose&&this.onclose()})}),this._receiver=new _t.wsReceiver,this._receiver.on("message",n=>{this._waitForNextTask(()=>{this.onmessage&&this.onmessage(JSON.parse(n))})})}async _init(){await this._socket.write(Buffer.from(`GET /devtools/browser HTTP/1.1\r
Upgrade: WebSocket\r
Connection: Upgrade\r
Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==\r
Sec-WebSocket-Version: 13\r
\r
`)),await new Promise(e=>this._socket.once("data",e)),this._socket.on("data",e=>this._receiver._write(e,"binary",()=>{}))}async send(e){await this._socket.write(cq(JSON.stringify(e)))}async close(){this._socket.close()}};function cq(r){return _t.wsSender.frame(Buffer.from(r),{opcode:1,mask:!0,fin:!0,readOnly:!0})[0]}var d_=class{constructor(e){this._browser=void 0,this.onclose=void 0,this._browser=e}async kill(){}async close(){await this._browser.close()}}});var jk=M(Yu=>{"use strict";Object.defineProperty(Yu,"__esModule",{value:!0});Yu.AdbBackend=void 0;var oa=Be(),Lk=dq(require("net")),uq=require("events"),hi=ie();function Dk(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Dk=function(n){return n?t:e})(r)}function dq(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Dk(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var p_=class{async devices(e={}){return(await Bk("host:devices",e.host,e.port)).toString().trim().split(`
`).map(s=>{let[o,a]=s.trim().split("	");return new f_(o,a,e.host,e.port)})}};Yu.AdbBackend=p_;var f_=class{constructor(e,t,n,s){this.serial=void 0,this.status=void 0,this.host=void 0,this.port=void 0,this._closed=!1,this.serial=e,this.status=t,this.host=n,this.port=s}async init(){}async close(){this._closed=!0}runCommand(e){if(this._closed)throw new Error("Device is closed");return Bk(e,this.host,this.port,this.serial)}async open(e){if(this._closed)throw new Error("Device is closed");let t=await hq(e,this.host,this.port,this.serial);return t.becomeSocket(),t}};async function Bk(r,e="127.0.0.1",t=5037,n){(0,oa.debug)("pw:adb:runCommand")(r,n);let s=new Xu(r,Lk.createConnection({host:e,port:t}));try{if(n){await s.write(Ju(`host:transport:${n}`));let l=await s.read(4);(0,hi.assert)(l.toString()==="OKAY",l.toString())}await s.write(Ju(r));let o=await s.read(4);(0,hi.assert)(o.toString()==="OKAY",o.toString());let a;if(r.startsWith("shell:"))a=await s.readAll();else{let l=parseInt((await s.read(4)).toString(),16);a=await s.read(l)}return a}finally{s.close()}}async function hq(r,e="127.0.0.1",t=5037,n){let s=new Xu(r,Lk.createConnection({host:e,port:t}));if(n){await s.write(Ju(`host:transport:${n}`));let a=await s.read(4);(0,hi.assert)(a.toString()==="OKAY",a.toString())}await s.write(Ju(r));let o=await s.read(4);return(0,hi.assert)(o.toString()==="OKAY",o.toString()),s}function Ju(r){let e=r.length.toString(16);return e="0".repeat(4-e.length)+e,Buffer.from(e+r)}var Xu=class extends uq.EventEmitter{constructor(e,t){super(),this.guid=(0,hi.createGuid)(),this._socket=void 0,this._buffer=Buffer.from([]),this._isSocket=!1,this._notifyReader=void 0,this._connectPromise=void 0,this._isClosed=!1,this._command=void 0,this._command=e,this._socket=t,this._connectPromise=new Promise(n=>this._socket.on("connect",n)),this._socket.on("data",n=>{if((0,oa.debug)("pw:adb:data")(n.toString()),this._isSocket){this.emit("data",n);return}this._buffer=Buffer.concat([this._buffer,n]),this._notifyReader&&this._notifyReader()}),this._socket.on("close",()=>{this._isClosed=!0,this._notifyReader&&this._notifyReader(),this.close(),this.emit("close")}),this._socket.on("error",n=>this.emit("error",n))}async write(e){(0,oa.debug)("pw:adb:send")(e.toString().substring(0,100)+"..."),await this._connectPromise,await new Promise(t=>this._socket.write(e,t))}close(){this._isClosed||((0,oa.debug)("pw:adb")("Close "+this._command),this._socket.destroy())}async read(e){for(await this._connectPromise,(0,hi.assert)(!this._isSocket,"Can not read by length in socket mode");this._buffer.length<e;)await new Promise(n=>this._notifyReader=n);let t=this._buffer.slice(0,e);return this._buffer=this._buffer.slice(e),(0,oa.debug)("pw:adb:recv")(t.toString().substring(0,100)+"..."),t}async readAll(){for(;!this._isClosed;)await new Promise(e=>this._notifyReader=e);return this._buffer}becomeSocket(){(0,hi.assert)(!this._buffer.length),this._isSocket=!0}}});var aa=M(gs=>{"use strict";Object.defineProperty(gs,"__esModule",{value:!0});gs.perMessageDeflate=gs.WebSocketTransport=void 0;var qk=Be(),pq=ie(),Hk=ko(),fq=gs.perMessageDeflate={zlibDeflateOptions:{level:3},zlibInflateOptions:{chunkSize:10*1024},threshold:10*1024},m_=class r{static async connect(e,t,n,s,o){return await r._connect(e,t,n||{},{follow:!!s,hadRedirects:!1},o)}static async _connect(e,t,n,s,o){let a=mq(t);e?.log(`<ws connecting> ${a}`);let l=new r(e,t,a,n,s.follow&&s.hadRedirects,o),c=!1;e?.cleanupWhenAborted(async()=>{c||await l.closeAndWait().catch(d=>null)});let u=await new Promise((d,h)=>{l._ws.on("open",async()=>{e?.log(`<ws connected> ${a}`),d({transport:l})}),l._ws.on("error",p=>{e?.log(`<ws connect error> ${a} ${p.message}`),h(new Error("WebSocket error: "+p.message)),l._ws.close()}),l._ws.on("unexpected-response",(p,f)=>{if(s.follow&&!s.hadRedirects&&(f.statusCode===301||f.statusCode===302||f.statusCode===307||f.statusCode===308)){d({redirect:f}),l._ws.close();return}for(let w=0;w<f.rawHeaders.length;w+=2)o&&f.rawHeaders[w]===o&&e?.log(f.rawHeaders[w+1]);let _=[],v=`${a} ${f.statusCode} ${f.statusMessage}`;f.on("data",w=>_.push(w)),f.on("close",()=>{let w=_.length?`${v}
${Buffer.concat(_)}`:v;e?.log(`<ws unexpected response> ${w}`),h(new Error("WebSocket error: "+w)),l._ws.close()})})});if(u.redirect){let d=Object.fromEntries(Object.entries(n||{}).filter(([h])=>!h.includes("access-key")&&h.toLowerCase()!=="authorization"));return r._connect(e,u.redirect.headers.location,d,{follow:!0,hadRedirects:!0},o)}return c=!0,l}constructor(e,t,n,s,o,a){var l;this._ws=void 0,this._progress=void 0,this._logUrl=void 0,this.onmessage=void 0,this.onclose=void 0,this.wsEndpoint=void 0,this.headers=[],this.wsEndpoint=t,this._logUrl=n,this._ws=new qk.ws(t,[],{maxPayload:256*1024*1024,handshakeTimeout:Math.max((l=e?.timeUntilDeadline())!==null&&l!==void 0?l:3e4,1),headers:s,followRedirects:o,agent:/^(https|wss):\/\//.test(t)?Hk.httpsHappyEyeballsAgent:Hk.httpHappyEyeballsAgent,perMessageDeflate:fq}),this._ws.on("upgrade",u=>{for(let d=0;d<u.rawHeaders.length;d+=2)this.headers.push({name:u.rawHeaders[d],value:u.rawHeaders[d+1]}),a&&u.rawHeaders[d]===a&&e?.log(u.rawHeaders[d+1])}),this._progress=e;let c=(0,pq.makeWaitForNextTask)();this._ws.addEventListener("message",u=>{c(()=>{let d=u.data,h;try{h=JSON.parse(d)}catch(_){var p;(p=this._progress)===null||p===void 0||p.log(`<closing ws> Closing websocket due to malformed JSON. eventData=${d} e=${_?.message}`),this._ws.close();return}try{this.onmessage&&this.onmessage.call(null,h)}catch(_){var f;(f=this._progress)===null||f===void 0||f.log(`<closing ws> Closing websocket due to failed onmessage callback. eventData=${d} e=${_?.message}`),this._ws.close()}})}),this._ws.addEventListener("close",u=>{var d;(d=this._progress)===null||d===void 0||d.log(`<ws disconnected> ${n} code=${u.code} reason=${u.reason}`),this.onclose&&this.onclose.call(null,u.reason)}),this._ws.addEventListener("error",u=>{var d;return(d=this._progress)===null||d===void 0?void 0:d.log(`<ws error> ${n} ${u.type} ${u.message}`)})}send(e){this._ws.send(JSON.stringify(e))}close(){var e;(e=this._progress)===null||e===void 0||e.log(`<ws disconnecting> ${this._logUrl}`),this._ws.close()}async closeAndWait(){if(this._ws.readyState===qk.ws.CLOSED)return;let e=new Promise(t=>this._ws.once("close",t));this.close(),await e}};gs.WebSocketTransport=m_;function mq(r){try{let e=new URL(r);return e.search="",e.hash="",e.toString()}catch{return r}}});var Wk=M(Qu=>{"use strict";Object.defineProperty(Qu,"__esModule",{value:!0});Qu.PipeTransport=void 0;var gq=ie(),$k=Le(),g_=class{constructor(e,t){this._pipeRead=void 0,this._pipeWrite=void 0,this._pendingBuffers=[],this._waitForNextTask=(0,gq.makeWaitForNextTask)(),this._closed=!1,this._onclose=void 0,this.onmessage=void 0,this._pipeRead=t,this._pipeWrite=e,t.on("data",n=>this._dispatch(n)),t.on("close",()=>{this._closed=!0,this._onclose&&this._onclose.call(null)}),t.on("error",n=>$k.debugLogger.log("error",n)),e.on("error",n=>$k.debugLogger.log("error",n)),this.onmessage=void 0}get onclose(){return this._onclose}set onclose(e){this._onclose=e,e&&!this._pipeRead.readable&&e()}send(e){if(this._closed)throw new Error("Pipe has been closed");this._pipeWrite.write(JSON.stringify(e)),this._pipeWrite.write("\0")}close(){throw new Error("unimplemented")}_dispatch(e){let t=e.indexOf("\0");if(t===-1){this._pendingBuffers.push(e);return}this._pendingBuffers.push(e.slice(0,t));let n=Buffer.concat(this._pendingBuffers).toString();this._waitForNextTask(()=>{this.onmessage&&this.onmessage.call(null,JSON.parse(n))});let s=t+1;for(t=e.indexOf("\0",s);t!==-1;){let o=e.toString(void 0,s,t);this._waitForNextTask(()=>{this.onmessage&&this.onmessage.call(null,JSON.parse(o))}),s=t+1,t=e.indexOf("\0",s)}this._pendingBuffers=[e.slice(s)]}};Qu.PipeTransport=g_});var ed=M(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.kNoXServerRunningError=_s.BrowserType=void 0;var la=Qk(require("fs")),Uk=Sq(require("os")),Zu=Qk(require("path")),zk=$e(),__=qn(),_q=aa(),Vk=sr(),wq=Wk(),Gk=Ut(),w_=en(),vq=ie(),Kk=ht(),Jk=yt(),bq=Le(),yq=De(),Xk=Qe(),xq=Wt();function Yk(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(Yk=function(n){return n?t:e})(r)}function Sq(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=Yk(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function Qk(r){return r&&r.__esModule?r:{default:r}}var g7=_s.kNoXServerRunningError=`Looks like you launched a headed browser without having a XServer running.
Set either 'headless: true' or use 'xvfb-run <your-playwright-app>' before running Playwright.

<3 Playwright Team`,v_=class extends yq.SdkObject{constructor(e,t){super(e,"browser-type"),this._name=void 0,this.attribution.browserType=this,this._name=t}executablePath(){return __.registry.findExecutable(this._name).executablePath(this.attribution.playwright.options.sdkLanguage)||""}name(){return this._name}async launch(e,t,n){t=this._validateLaunchOptions(t);let s=new Gk.ProgressController(e,this);return s.setLogName("browser"),await s.run(a=>{let l=t.__testHookSeleniumRemoteURL||process.env.SELENIUM_REMOTE_URL;return l?this._launchWithSeleniumHub(a,l,t):this._innerLaunchWithRetries(a,t,void 0,Jk.helper.debugProtocolLogger(n)).catch(c=>{throw this._rewriteStartupLog(c)})},w_.TimeoutSettings.launchTimeout(t))}async launchPersistentContext(e,t,n){n=this._validateLaunchOptions(n);let s=new Gk.ProgressController(e,this),o=n;return s.setLogName("browser"),(await s.run(l=>this._innerLaunchWithRetries(l,n,o,Jk.helper.debugProtocolLogger(),t).catch(c=>{throw this._rewriteStartupLog(c)}),w_.TimeoutSettings.launchTimeout(n)))._defaultContext}async _innerLaunchWithRetries(e,t,n,s,o){try{return await this._innerLaunch(e,t,n,s,o)}catch(a){if((typeof a=="object"&&typeof a.message=="string"?a.message:"").includes("Inconsistency detected by ld.so"))return e.log("<restarting browser due to hitting race condition in glibc>"),this._innerLaunch(e,t,n,s,o);throw a}}async _innerLaunch(e,t,n,s,o){t.proxy=t.proxy?(0,zk.normalizeProxySettings)(t.proxy):void 0;let a=new bq.RecentLogsCollector,{browserProcess:l,userDataDir:c,artifactsDir:u,transport:d}=await this._launchProcess(e,t,!!n,a,o);t.__testHookBeforeCreateBrowser&&await t.__testHookBeforeCreateBrowser();let h={name:this._name,isChromium:this._name==="chromium",channel:t.channel,slowMo:t.slowMo,persistent:n,headful:!t.headless,artifactsDir:u,downloadsPath:t.downloadsPath||u,tracesDir:t.tracesDir||u,browserProcess:l,customExecutablePath:t.executablePath,proxy:t.proxy,protocolLogger:s,browserLogsCollector:a,wsEndpoint:t.useWebSocket?d.wsEndpoint:void 0,originalLaunchOptions:t};n&&(0,zk.validateBrowserContextOptions)(n,h),Eq(t,h);let p=await this._connectToTransport(d,h);return p._userDataDirForTest=c,n&&!t.ignoreAllDefaultArgs&&await p._defaultContext._loadDefaultContext(e),p}async _launchProcess(e,t,n,s,o){var a;let{ignoreDefaultArgs:l,ignoreAllDefaultArgs:c,args:u=[],executablePath:d=null,handleSIGINT:h=!0,handleSIGTERM:p=!0,handleSIGHUP:f=!0}=t,_=t.env?(0,Vk.envArrayToObject)(t.env):process.env;await this._createArtifactDirs(t);let v=[],w=await la.default.promises.mkdtemp(Zu.default.join(Uk.tmpdir(),"playwright-artifacts-"));v.push(w),o?await(0,Kk.existsAsync)(o)||await la.default.promises.mkdir(o,{recursive:!0,mode:448}):(o=await la.default.promises.mkdtemp(Zu.default.join(Uk.tmpdir(),`playwright_${this._name}dev_profile-`)),v.push(o));let m=[];c?m.push(...u):l?m.push(...this._defaultArgs(t,n,o).filter(I=>l.indexOf(I)===-1)):m.push(...this._defaultArgs(t,n,o));let g;if(d){if(!await(0,Kk.existsAsync)(d))throw new Error(`Failed to launch ${this._name} because executable doesn't exist at ${d}`);g=d}else{let I=__.registry.findExecutable(t.channel||this._name);if(!I||I.browserName!==this._name)throw new Error(`Unsupported ${this._name} channel "${t.channel}"`);g=I.executablePathOrDie(this.attribution.playwright.options.sdkLanguage),await __.registry.validateHostRequirementsForExecutablesIfNeeded([I],this.attribution.playwright.options.sdkLanguage)}let x=t.useWebSocket||(a=t.args)!==null&&a!==void 0&&a.some(I=>I.startsWith("--remote-debugging-port"))?new Xk.ManualPromise:void 0,b=this._name==="firefox"?new Xk.ManualPromise:void 0,y,S,{launchedProcess:E,gracefullyClose:C,kill:k}=await(0,Vk.launchProcess)({command:g,args:m,env:this._amendEnvironment(_,o,g,m),handleSIGINT:h,handleSIGTERM:p,handleSIGHUP:f,log:I=>{if(x){let P=I.match(/DevTools listening on (.*)/);P&&x.resolve(P[1])}b&&I.includes("Juggler listening to the pipe")&&b.resolve(),e.log(I),s.log(I)},stdio:"pipe",tempDirectories:v,attemptToGracefullyClose:async()=>{t.__testHookGracefullyClose&&await t.__testHookGracefullyClose(),this._attemptToGracefullyCloseBrowser(y)},onExit:(I,P)=>{b?.resolve(),S&&S.onclose&&S.onclose(I,P)}});async function F(I){let P;try{await Promise.race([C(),new Promise((T,A)=>P=setTimeout(A,I))])}catch{await k().catch(A=>{})}finally{clearTimeout(P)}}S={onclose:void 0,process:E,close:()=>F(t.__testHookBrowserCloseTimeout||w_.DEFAULT_TIMEOUT),kill:k},e.cleanupWhenAborted(()=>F(e.timeUntilDeadline()));let O=await x;if(await b,t.useWebSocket)y=await _q.WebSocketTransport.connect(e,O);else{let I=E.stdio;y=new wq.PipeTransport(I[3],I[4])}return{browserProcess:S,artifactsDir:w,userDataDir:o,transport:y}}async _createArtifactDirs(e){e.downloadsPath&&await la.default.promises.mkdir(e.downloadsPath,{recursive:!0}),e.tracesDir&&await la.default.promises.mkdir(e.tracesDir,{recursive:!0})}async connectOverCDP(e,t,n,s){throw new Error("CDP connections are only supported by Chromium")}async _launchWithSeleniumHub(e,t,n){throw new Error("Connecting to SELENIUM_REMOTE_URL is only supported by Chromium")}_validateLaunchOptions(e){let{devtools:t=!1}=e,{headless:n=!t,downloadsPath:s,proxy:o}=e;return(0,vq.debugMode)()&&(n=!1),s&&!Zu.default.isAbsolute(s)&&(s=Zu.default.join(process.cwd(),s)),this.attribution.playwright.options.socksProxyPort&&(o={server:`socks5://127.0.0.1:${this.attribution.playwright.options.socksProxyPort}`}),{...e,devtools:t,headless:n,downloadsPath:s,proxy:o}}_createUserDataDirArgMisuseError(e){switch(this.attribution.playwright.options.sdkLanguage){case"java":return new Error(`Pass userDataDir parameter to 'BrowserType.launchPersistentContext(userDataDir, options)' instead of specifying '${e}' argument`);case"python":return new Error(`Pass user_data_dir parameter to 'browser_type.launch_persistent_context(user_data_dir, **kwargs)' instead of specifying '${e}' argument`);case"csharp":return new Error(`Pass userDataDir parameter to 'BrowserType.LaunchPersistentContextAsync(userDataDir, options)' instead of specifying '${e}' argument`);default:return new Error(`Pass userDataDir parameter to 'browserType.launchPersistentContext(userDataDir, options)' instead of specifying '${e}' argument`)}}_rewriteStartupLog(e){return(0,xq.isProtocolError)(e)?this._doRewriteStartupLog(e):e}};_s.BrowserType=v_;function Eq(r,e){for(let[t,n]of Object.entries(r))t.startsWith("__testHook")&&(e[t]=n)}});var eC=M(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.CRDevTools=void 0;var Zk=kq(require("fs"));function kq(r){return r&&r.__esModule?r:{default:r}}var b_="__pw_devtools__",y_=class{constructor(e){this._preferencesPath=void 0,this._prefs=void 0,this._savePromise=void 0,this.__testHookOnBinding=void 0,this._preferencesPath=e,this._savePromise=Promise.resolve()}install(e){e.on("Runtime.bindingCalled",async t=>{if(t.name!==b_)return;let n=JSON.parse(t.payload),s;if(this.__testHookOnBinding&&this.__testHookOnBinding(n),n.method==="getPreferences"){if(this._prefs===void 0)try{let o=await Zk.default.promises.readFile(this._preferencesPath,"utf8");this._prefs=JSON.parse(o)}catch{this._prefs={}}s=this._prefs}else n.method==="setPreference"?(this._prefs[n.params[0]]=n.params[1],this._save()):n.method==="removePreference"?(delete this._prefs[n.params[0]],this._save()):n.method==="clearPreferences"&&(this._prefs={},this._save());e.send("Runtime.evaluate",{expression:`window.DevToolsAPI.embedderMessageAck(${n.id}, ${JSON.stringify(s)})`,contextId:t.executionContextId}).catch(o=>null)}),Promise.all([e.send("Runtime.enable"),e.send("Runtime.addBinding",{name:b_}),e.send("Page.enable"),e.send("Page.addScriptToEvaluateOnNewDocument",{source:`
        (() => {
          const init = () => {
            // Lazy init happens when InspectorFrontendHost is initialized.
            // At this point DevToolsHost is ready to be used.
            const host = window.DevToolsHost;
            const old = host.sendMessageToEmbedder.bind(host);
            host.sendMessageToEmbedder = message => {
              if (['getPreferences', 'setPreference', 'removePreference', 'clearPreferences'].includes(JSON.parse(message).method))
                window.${b_}(message);
              else
                old(message);
            };
          };
          let value;
          Object.defineProperty(window, 'InspectorFrontendHost', {
            configurable: true,
            enumerable: true,
            get() { return value; },
            set(v) { value = v; init(); },
          });
        })()
      `}),e.send("Runtime.runIfWaitingForDebugger")]).catch(t=>null)}_save(){this._savePromise=this._savePromise.then(async()=>{await Zk.default.promises.writeFile(this._preferencesPath,JSON.stringify(this._prefs)).catch(e=>null)})}};td.CRDevTools=y_});var uC=M(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.Chromium=void 0;var Cq=E_(require("fs")),lC=E_(require("os")),cC=E_(require("path")),tC=ps(),nC=sr(),Tq=ra(),rC=ed(),Oq=aa(),Pq=eC(),Aq=li(),nd=xn(),iC=Nn(),Iq=ol(),x_=ie(),Rq=ht(),Mq=Le(),Fq=Ut(),Nq=en(),Lq=yt(),Dq=qn(),Bq=Qe(),jq=$e(),qq=o_();function E_(r){return r&&r.__esModule?r:{default:r}}var Hq=cC.default.join(lC.default.tmpdir(),"playwright-artifacts-"),S_=class extends rC.BrowserType{constructor(e){super(e,"chromium"),this._devtools=void 0,(0,x_.debugMode)()&&(this._devtools=this._createDevTools())}async connectOverCDP(e,t,n,s){let o=new Fq.ProgressController(e,this);return o.setLogName("browser"),o.run(async a=>await this._connectOverCDPInternal(a,t,n),Nq.TimeoutSettings.timeout({timeout:s}))}async _connectOverCDPInternal(e,t,n,s){let o;n.headers&&(o=(0,x_.headersArrayToObject)(n.headers,!1)),o?o&&!Object.keys(o).some(w=>w.toLowerCase()==="user-agent")&&(o["User-Agent"]=(0,iC.getUserAgent)()):o={"User-Agent":(0,iC.getUserAgent)()};let a=await Cq.default.promises.mkdtemp(Hq),l=await $q(e,t,o);e.throwIfAborted();let c=await Oq.WebSocketTransport.connect(e,l,o),u=new Bq.ManualPromise,d=async()=>{await(0,Rq.removeFolders)([a]),await s?.(),u.resolve()},h=async()=>{await c.closeAndWait(),await u},p={close:h,kill:h},f={noDefaultViewport:!0},_={slowMo:n.slowMo,name:"chromium",isChromium:!0,persistent:f,browserProcess:p,protocolLogger:Lq.helper.debugProtocolLogger(),browserLogsCollector:new Mq.RecentLogsCollector,artifactsDir:a,downloadsPath:n.downloadsPath||a,tracesDir:n.tracesDir||a,proxy:{server:"per-context"},originalLaunchOptions:{}};(0,jq.validateBrowserContextOptions)(f,_),e.throwIfAborted();let v=await tC.CRBrowser.connect(this.attribution.playwright,c,_);return v._isCollocatedWithServer=!1,v.on(Aq.Browser.Events.Disconnected,d),v}_createDevTools(){let e=Dq.registry.findExecutable("chromium").directory;return e?new Pq.CRDevTools(cC.default.join(e,"devtools-preferences.json")):void 0}async _connectToTransport(e,t){let n=this._devtools;return t.__testHookForDevTools&&(n=this._createDevTools(),await t.__testHookForDevTools(n)),tC.CRBrowser.connect(this.attribution.playwright,e,t,n)}_doRewriteStartupLog(e){return!e.logs||(e.logs.includes("Missing X server")&&(e.logs=`
`+(0,Iq.wrapInASCIIBox)(rC.kNoXServerRunningError,1)),!e.logs.includes("crbug.com/357670")&&!e.logs.includes("No usable sandbox!")&&!e.logs.includes("crbug.com/638180"))||(e.logs=["Chromium sandboxing failed!","================================","To avoid the sandboxing issue, do either of the following:","  - (preferred): Configure your environment to support sandboxing","  - (alternative): Launch Chromium without sandbox using 'chromiumSandbox: false' option","================================",""].join(`
`)),e}_amendEnvironment(e,t,n,s){return e}_attemptToGracefullyCloseBrowser(e){let t={method:"Browser.close",id:Tq.kBrowserCloseMessageId,params:{}};e.send(t)}async _launchWithSeleniumHub(e,t,n){await this._createArtifactDirs(n),t.endsWith("/")||(t=t+"/");let s=this._innerDefaultArgs(n);s.push("--remote-debugging-port=0");let o=n.channel&&n.channel.startsWith("msedge"),a={browserName:o?"MicrosoftEdge":"chrome",[o?"ms:edgeOptions":"goog:chromeOptions"]:{args:s}};if(process.env.SELENIUM_REMOTE_CAPABILITIES){let p=aC({name:"capabilities",value:process.env.SELENIUM_REMOTE_CAPABILITIES},e);p&&(a={...a,...p})}let l={};if(process.env.SELENIUM_REMOTE_HEADERS){let p=aC({name:"headers",value:process.env.SELENIUM_REMOTE_HEADERS},e);p&&(l=p)}e.log(`<selenium> connecting to ${t}`);let c=await(0,nd.fetchData)({url:t+"session",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8",...l},data:JSON.stringify({capabilities:{alwaysMatch:a}}),timeout:e.timeUntilDeadline()},sC),u=JSON.parse(c).value,d=u.sessionId;e.log(`<selenium> connected to sessionId=${d}`);let h=async()=>{e.log(`<selenium> disconnecting from sessionId=${d}`),await(0,nd.fetchData)({url:t+"session/"+d,method:"DELETE",headers:l}).catch(p=>e.log(`<error disconnecting from selenium>: ${p}`)),e.log(`<selenium> disconnected from sessionId=${d}`),nC.gracefullyCloseSet.delete(h)};nC.gracefullyCloseSet.add(h);try{let p=u.capabilities,f;if(p["se:cdp"]){e.log("<selenium> using selenium v4");let _=oC(p["se:cdp"]);f=new URL(_),(f.hostname==="localhost"||f.hostname==="127.0.0.1")&&(f.hostname=new URL(t).hostname),e.log(`<selenium> retrieved endpoint ${f.toString()} for sessionId=${d}`)}else{e.log("<selenium> using selenium v3");let _=p["goog:chromeOptions"],v=_&&typeof _=="object"?_:void 0,w=v&&typeof v.debuggerAddress=="string"?v.debuggerAddress:void 0,g=oC(w||(typeof _=="string"?_:void 0)).replace("localhost","127.0.0.1");if(e.log(`<selenium> retrieved endpoint ${g} for sessionId=${d}`),f=new URL(g),f.hostname==="localhost"||f.hostname==="127.0.0.1"){let x=new URL(t).origin+"/grid/api/testsession?session="+d;try{let b=await(0,nd.fetchData)({url:x,method:"GET",timeout:e.timeUntilDeadline(),headers:l},sC),y=JSON.parse(b).proxyId;f.hostname=new URL(y).hostname,e.log(`<selenium> resolved endpoint ip ${f.toString()} for sessionId=${d}`)}catch{e.log(`<selenium> unable to resolve endpoint ip for sessionId=${d}, running in standalone?`)}}}return await this._connectOverCDPInternal(e,f.toString(),{...n,headers:(0,x_.headersObjectToArray)(l)},h)}catch(p){throw await h(),p}}_defaultArgs(e,t,n){let s=this._innerDefaultArgs(e);return s.push(`--user-data-dir=${n}`),e.useWebSocket?s.push("--remote-debugging-port=0"):s.push("--remote-debugging-pipe"),t?s.push("about:blank"):s.push("--no-startup-window"),s}_innerDefaultArgs(e){let{args:t=[],proxy:n}=e;if(t.find(a=>a.startsWith("--user-data-dir")))throw this._createUserDataDirArgMisuseError("--user-data-dir");if(t.find(a=>a.startsWith("--remote-debugging-pipe")))throw new Error("Playwright manages remote debugging connection itself.");if(t.find(a=>!a.startsWith("-")))throw new Error("Arguments can not specify page to be opened");let o=[...qq.chromiumSwitches];if(lC.default.platform()==="darwin"&&(o.push("--enable-use-zoom-for-dsf=false"),e.headless&&o.push("--use-angle")),e.devtools&&o.push("--auto-open-devtools-for-tabs"),e.headless&&(process.env.PLAYWRIGHT_CHROMIUM_USE_HEADLESS_NEW?o.push("--headless=new"):o.push("--headless"),o.push("--hide-scrollbars","--mute-audio","--blink-settings=primaryHoverType=2,availableHoverTypes=2,primaryPointerType=4,availablePointerTypes=4")),e.chromiumSandbox!==!0&&o.push("--no-sandbox"),n){let a=new URL(n.server);a.protocol==="socks5:"&&!this.attribution.playwright.options.socksProxyPort&&o.push(`--host-resolver-rules="MAP * ~NOTFOUND , EXCLUDE ${a.hostname}"`),o.push(`--proxy-server=${n.server}`);let c=[];this.attribution.playwright.options.socksProxyPort&&c.push("<-loopback>"),n.bypass&&c.push(...n.bypass.split(",").map(u=>u.trim()).map(u=>u.startsWith(".")?"*"+u:u)),!process.env.PLAYWRIGHT_DISABLE_FORCED_CHROMIUM_PROXIED_LOOPBACK&&!c.includes("<-loopback>")&&c.push("<-loopback>"),c.length>0&&o.push(`--proxy-bypass-list=${c.join(";")}`)}return o.push(...t),o}};rd.Chromium=S_;async function $q(r,e,t){if(e.startsWith("ws"))return e;r.log(`<ws preparing> retrieving websocket url from ${e}`);let n=e.endsWith("/")?`${e}json/version/`:`${e}/json/version/`,s=await(0,nd.fetchData)({url:n,headers:t},async(o,a)=>new Error(`Unexpected status ${a.statusCode} when connecting to ${n}.
This does not look like a DevTools server, try connecting via ws://.`));return JSON.parse(s).webSocketDebuggerUrl}async function sC(r,e){let t=await Wq(e),n=t;try{let s=JSON.parse(t);n=s.value.localizedMessage||s.value.message}catch{}return new Error(`Error connecting to Selenium at ${r.url}: ${n}`)}function oC(r){return["ws://","wss://","http://","https://"].some(e=>r.startsWith(e))?r:"http://"+r}function Wq(r){return new Promise((e,t)=>{let n=[];r.on("data",s=>n.push(Buffer.from(s))),r.on("error",t),r.on("end",()=>e(Buffer.concat(n).toString("utf8")))})}function aC(r,e){try{let t=JSON.parse(r.value);return e.log(`<selenium> using additional ${r.name} "${r.value}"`),t}catch(t){e.log(`<selenium> ignoring additional ${r.name} "${r.value}": ${t}`)}}});var O_=M(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.ElectronApplication=bs.Electron=void 0;var Uq=T_(require("fs")),mC=T_(require("os")),zq=T_(require("path")),Vq=ps(),Gq=ra(),Kq=Au(),dC=vC(mr()),gC=en(),_C=ie(),hC=aa(),pC=sr(),Jq=$e(),Xq=Ut(),fC=yt(),ca=Ze(),Yq=vC(require("readline")),Qq=Le(),k_=De(),Zq=xr(),e3=Um();function wC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(wC=function(n){return n?t:e})(r)}function vC(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=wC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function T_(r){return r&&r.__esModule?r:{default:r}}var t3=zq.default.join(mC.default.tmpdir(),"playwright-artifacts-"),vs=class r extends k_.SdkObject{constructor(e,t,n,s){super(e,"electron-app"),this._browserContext=void 0,this._nodeConnection=void 0,this._nodeSession=void 0,this._nodeExecutionContext=void 0,this._nodeElectronHandlePromise=new _C.ManualPromise,this._timeoutSettings=new gC.TimeoutSettings,this._process=void 0,this._process=s,this._browserContext=t._defaultContext,this._nodeConnection=n,this._nodeSession=n.rootSession,this._nodeSession.on("Runtime.executionContextCreated",async a=>{if(!a.context.auxData||!a.context.auxData.isDefault)return;let l=new Kq.CRExecutionContext(this._nodeSession,a.context);this._nodeExecutionContext=new dC.ExecutionContext(this,l,"electron");let{result:c}=await l._client.send("Runtime.evaluate",{expression:"require('electron')",contextId:a.context.id,includeCommandLineAPI:!0});this._nodeElectronHandlePromise.resolve(new dC.JSHandle(this._nodeExecutionContext,"object","ElectronModule",c.objectId))}),this._nodeSession.on("Runtime.consoleAPICalled",a=>this._onConsoleAPI(a));let o=new Promise(a=>this.once(r.Events.Close,a));this._browserContext.setCustomCloseHandler(async()=>{await this._browserContext.stopVideoRecording(),await(await this._nodeElectronHandlePromise).evaluate(({app:l})=>l.quit()).catch(()=>{}),this._nodeConnection.close(),await o})}async _onConsoleAPI(e){if(e.executionContextId===0||!this._nodeExecutionContext)return;let t=e.args.map(s=>this._nodeExecutionContext.createHandle(s)),n=new e3.ConsoleMessage(null,e.type,void 0,t,(0,Zq.toConsoleMessageLocation)(e.stackTrace));this.emit(r.Events.Console,n)}async initialize(){await this._nodeSession.send("Runtime.enable",{}),await this._nodeSession.send("Runtime.evaluate",{expression:"__playwright_run()"})}process(){return this._process}context(){return this._browserContext}async close(){await this._browserContext.close({reason:"Application exited"})}async browserWindow(e){let t=e._delegate._targetId;return await(await this._nodeElectronHandlePromise).evaluateHandle(({BrowserWindow:s,webContents:o},a)=>{let l=o.fromDevToolsTargetId(a);return s.fromWebContents(l)},t)}};bs.ElectronApplication=vs;vs.Events={Close:"close",Console:"console"};var C_=class extends k_.SdkObject{constructor(e){super(e,"electron")}async launch(e){let{args:t=[]}=e,n=new Xq.ProgressController((0,k_.serverSideCallMetadata)(),this);return n.setLogName("browser"),n.run(async s=>{let o,a=["--inspect=0","--remote-debugging-port=0",...t];mC.default.platform()==="linux"&&process.geteuid&&process.geteuid()===0&&a.indexOf("--no-sandbox")===-1&&a.unshift("--no-sandbox");let l=await Uq.default.promises.mkdtemp(t3),c=new Qq.RecentLogsCollector,u=e.env?(0,pC.envArrayToObject)(e.env):process.env,d;if(e.executablePath)d=e.executablePath;else{try{d=require("electron/index.js")}catch(k){throw k?.code==="MODULE_NOT_FOUND"?new Error(`
`+(0,_C.wrapInASCIIBox)(["Electron executablePath not found!","Please install it using `npm install -D electron` or set the executablePath to your Electron executable."].join(`
`),1)):k}a.unshift("-r",require.resolve("./loader"))}let h=!1;process.platform==="win32"&&(h=!0,d=`"${d}"`,a=a.map(k=>`"${k}"`)),delete u.NODE_OPTIONS;let{launchedProcess:p,gracefullyClose:f,kill:_}=await(0,pC.launchProcess)({command:d,args:a,env:u,log:k=>{s.log(k),c.log(k)},shell:h,stdio:"pipe",cwd:e.cwd,tempDirectories:[l],attemptToGracefullyClose:()=>o.close(),handleSIGINT:!0,handleSIGTERM:!0,handleSIGHUP:!0,onExit:()=>{var k;return(k=o)===null||k===void 0?void 0:k.emit(vs.Events.Close)}}),v=new Promise(async(k,F)=>{id(s,p,/Unable to open X display/).then(()=>F(new Error(["Unable to open X display!","================================","Most likely this is because there is no X server available.","Use 'xvfb-run' on Linux to launch your tests with an emulated display server.","For example: 'xvfb-run npm run test:e2e'","================================",s.metadata.log].join(`
`)))).catch(()=>{})}),w=await id(s,p,/^Debugger listening on (ws:\/\/.*)$/),m=await hC.WebSocketTransport.connect(s,w[1]),g=new Gq.CRConnection(m,fC.helper.debugProtocolLogger(),c);id(s,p,/Waiting for the debugger to disconnect\.\.\./).then(()=>{m.close()}).catch(()=>{});let x=await Promise.race([id(s,p,/^DevTools listening on (ws:\/\/.*)$/),v]),b=await hC.WebSocketTransport.connect(s,x[1]),y={onclose:void 0,process:p,close:f,kill:_},S={...e,noDefaultViewport:!0},E={name:"electron",isChromium:!0,headful:!0,persistent:S,browserProcess:y,protocolLogger:fC.helper.debugProtocolLogger(),browserLogsCollector:c,artifactsDir:l,downloadsPath:l,tracesDir:e.tracesDir||l,originalLaunchOptions:{}};(0,Jq.validateBrowserContextOptions)(S,E);let C=await Vq.CRBrowser.connect(this.attribution.playwright,b,E);return o=new vs(this,C,g,p),await o.initialize(),o},gC.TimeoutSettings.launchTimeout(e))}};bs.Electron=C_;function id(r,e,t){return new Promise((n,s)=>{let o=Yq.createInterface({input:e.stderr}),a=new Error("Process failed to launch!"),l=[ca.eventsHelper.addEventListener(o,"line",c),ca.eventsHelper.addEventListener(o,"close",s.bind(null,a)),ca.eventsHelper.addEventListener(e,"exit",s.bind(null,a)),ca.eventsHelper.addEventListener(e,"error",s.bind(null,a))];r.cleanupWhenAborted(u);function c(d){let h=d.match(t);h&&(u(),n(h))}function u(){ca.eventsHelper.removeEventListeners(l)}})}});var sd=M(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.kBrowserCloseMessageId=On.FFSession=On.FFConnection=On.ConnectionEvents=void 0;var yC=require("events"),n3=Le(),r3=yt(),bC=Wt(),i3=On.ConnectionEvents={Disconnected:Symbol("Disconnected")},s3=On.kBrowserCloseMessageId=-9999,P_=class extends yC.EventEmitter{constructor(e,t,n){super(),this._lastId=void 0,this._transport=void 0,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this._browserDisconnectedLogs=void 0,this.rootSession=void 0,this._sessions=void 0,this._closed=void 0,this.setMaxListeners(0),this._transport=e,this._protocolLogger=t,this._browserLogsCollector=n,this._lastId=0,this._sessions=new Map,this._closed=!1,this.rootSession=new ua(this,"",s=>this._rawSend(s)),this._sessions.set("",this.rootSession),this._transport.onmessage=this._onMessage.bind(this),this._transport.onclose=this._onClose.bind(this)}nextMessageId(){return++this._lastId}_rawSend(e){this._protocolLogger("send",e),this._transport.send(e)}async _onMessage(e){if(this._protocolLogger("receive",e),e.id===s3)return;let t=this._sessions.get(e.sessionId||"");t&&t.dispatchMessage(e)}_onClose(e){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0,this._browserDisconnectedLogs=r3.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs(),e),this.rootSession.dispose(),Promise.resolve().then(()=>this.emit(i3.Disconnected))}close(){this._closed||this._transport.close()}createSession(e){let t=new ua(this,e,n=>this._rawSend({...n,sessionId:e}));return this._sessions.set(e,t),t}};On.FFConnection=P_;var ua=class extends yC.EventEmitter{constructor(e,t,n){super(),this._connection=void 0,this._disposed=!1,this._callbacks=void 0,this._sessionId=void 0,this._rawSend=void 0,this._crashed=!1,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this._callbacks=new Map,this._connection=e,this._sessionId=t,this._rawSend=n,this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}markAsCrashed(){this._crashed=!0}async send(e,t){if(this._crashed||this._disposed||this._connection._closed||this._connection._browserDisconnectedLogs)throw new bC.ProtocolError(this._crashed?"crashed":"closed",void 0,this._connection._browserDisconnectedLogs);let n=this._connection.nextMessageId();return this._rawSend({method:e,params:t,id:n}),new Promise((s,o)=>{this._callbacks.set(n,{resolve:s,reject:o,error:new bC.ProtocolError("error",e)})})}sendMayFail(e,t){return this.send(e,t).catch(n=>n3.debugLogger.log("error",n))}dispatchMessage(e){if(e.id){let t=this._callbacks.get(e.id);t&&(this._callbacks.delete(e.id),e.error?(t.error.setMessage(e.error.message),t.reject(t.error)):t.resolve(e.result))}else Promise.resolve().then(()=>this.emit(e.method,e.params))}dispose(){this._disposed=!0,this._connection._sessions.delete(this._sessionId);for(let e of this._callbacks.values())e.error.type=this._crashed?"crashed":"closed",e.error.logs=this._connection._browserDisconnectedLogs,e.reject(e.error);this._callbacks.clear()}};On.FFSession=ua});var xC=M(I_=>{"use strict";Object.defineProperty(I_,"__esModule",{value:!0});I_.getAccessibilityTree=o3;async function o3(r,e){let t=e?e._objectId:void 0,{tree:n}=await r.send("Accessibility.getFullAXTree",{objectId:t}),s=new A_(n);return{tree:s,needle:e?s._findNeedle():null}}var a3=new Map(Object.entries({pushbutton:"button",checkbutton:"checkbox",editcombobox:"combobox","content deletion":"deletion",footnote:"doc-footnote","non-native document":"document",grouping:"group",graphic:"img","content insertion":"insertion",animation:"marquee","flat equation":"math",menupopup:"menu","check menu item":"menuitemcheckbox","radio menu item":"menuitemradio","listbox option":"option",radiobutton:"radio",statusbar:"status",pagetab:"tab",pagetablist:"tablist",propertypage:"tabpanel",entry:"textbox",outline:"tree","tree table":"treegrid",outlineitem:"treeitem"})),A_=class r{constructor(e){this._children=void 0,this._payload=void 0,this._editable=void 0,this._richlyEditable=void 0,this._focusable=void 0,this._expanded=void 0,this._name=void 0,this._role=void 0,this._cachedHasFocusableChild=void 0,this._payload=e,this._children=(e.children||[]).map(t=>new r(t)),this._editable=!!e.editable,this._richlyEditable=this._editable&&e.tag!=="textarea"&&e.tag!=="input",this._focusable=!!e.focusable,this._expanded=!!e.expanded,this._name=this._payload.name,this._role=this._payload.role}_isPlainTextField(){return this._richlyEditable?!1:this._editable?!0:this._role==="entry"}_isTextOnlyObject(){let e=this._role;return e==="text leaf"||e==="text"||e==="statictext"}_hasFocusableChild(){if(this._cachedHasFocusableChild===void 0){this._cachedHasFocusableChild=!1;for(let e of this._children)if(e._focusable||e._hasFocusableChild()){this._cachedHasFocusableChild=!0;break}}return this._cachedHasFocusableChild}children(){return this._children}_findNeedle(){if(this._payload.foundObject)return this;for(let e of this._children){let t=e._findNeedle();if(t)return t}return null}isLeafNode(){if(!this._children.length||this._isPlainTextField()||this._isTextOnlyObject())return!0;switch(this._role){case"graphic":case"scrollbar":case"slider":case"separator":case"progressbar":return!0;default:break}return this._hasFocusableChild()?!1:!!(this._focusable&&this._role!=="document"&&this._name||this._role==="heading"&&this._name)}isControl(){switch(this._role){case"checkbutton":case"check menu item":case"check rich option":case"combobox":case"combobox option":case"color chooser":case"listbox":case"listbox option":case"listbox rich option":case"popup menu":case"menupopup":case"menuitem":case"menubar":case"button":case"pushbutton":case"radiobutton":case"radio menuitem":case"scrollbar":case"slider":case"spinbutton":case"switch":case"pagetab":case"entry":case"tree table":return!0;default:return!1}}isInteresting(e){return this._focusable||this._richlyEditable||this.isControl()?!0:e?!1:this.isLeafNode()&&!!this._name.trim()}serialize(){let e={role:a3.get(this._role)||this._role,name:this._name||""},t=["name","description","roledescription","valuetext","keyshortcuts"];for(let l of t)l in this._payload&&(e[l]=this._payload[l]);let n=["disabled","expanded","focused","modal","multiline","multiselectable","readonly","required","selected"];for(let l of n){if(this._role==="document"&&l==="focused")continue;let c=this._payload[l];c&&(e[l]=c)}let s=["level"];for(let l of s)l in this._payload&&(e[l]=this._payload[l]);let o=["autocomplete","haspopup","orientation"];for(let l of o){let c=this._payload[l];!c||c==="false"||(e[l]=c)}let a=e;return a.valueString=this._payload.value,"checked"in this._payload&&(a.checked=this._payload.checked===!0?"checked":this._payload.checked==="mixed"?"mixed":"unchecked"),"pressed"in this._payload&&(a.pressed=this._payload.pressed===!0?"pressed":"released"),"invalid"in this._payload&&(a.invalid=this._payload.invalid===!0?"true":"false"),a}}});var EC=M(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.FFExecutionContext=void 0;var ys=d3(mr()),l3=Lt(),c3=Zi(),u3=Wt();function SC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(SC=function(n){return n?t:e})(r)}function d3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=SC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var F_=class{constructor(e,t){this._session=void 0,this._executionContextId=void 0,this._session=e,this._executionContextId=t}async rawEvaluateJSON(e){let t=await this._session.send("Runtime.evaluate",{expression:e,returnByValue:!0,executionContextId:this._executionContextId}).catch(M_);return R_(t.exceptionDetails),t.result.value}async rawEvaluateHandle(e){let t=await this._session.send("Runtime.evaluate",{expression:e,returnByValue:!1,executionContextId:this._executionContextId}).catch(M_);return R_(t.exceptionDetails),t.result.objectId}rawCallFunctionNoReply(e,...t){this._session.send("Runtime.callFunction",{functionDeclaration:e.toString(),args:t.map(n=>n instanceof ys.JSHandle?{objectId:n._objectId}:{value:n}),returnByValue:!0,executionContextId:this._executionContextId}).catch(()=>{})}async evaluateWithArguments(e,t,n,s,o){let a=await this._session.send("Runtime.callFunction",{functionDeclaration:e,args:[{objectId:n._objectId,value:void 0},...s.map(l=>({value:l})),...o.map(l=>({objectId:l,value:void 0}))],returnByValue:t,executionContextId:this._executionContextId}).catch(M_);return R_(a.exceptionDetails),t?(0,c3.parseEvaluationResultValue)(a.result.value):n._context.createHandle(a.result)}async getProperties(e,t){let n=await this._session.send("Runtime.getObjectProperties",{executionContextId:this._executionContextId,objectId:t}),s=new Map;for(let o of n.properties)s.set(o.name,e.createHandle(o.value));return s}createHandle(e,t){return new ys.JSHandle(e,t.subtype||t.type||"",p3(t),t.objectId,h3(t))}async releaseHandle(e){await this._session.send("Runtime.disposeObject",{executionContextId:this._executionContextId,objectId:e})}objectCount(e){throw new Error("Method not implemented in Firefox.")}};od.FFExecutionContext=F_;function R_(r){if(r)throw r.value?new ys.JavaScriptErrorInEvaluate(JSON.stringify(r.value)):new ys.JavaScriptErrorInEvaluate(r.text+(r.stack?`
`+r.stack:""))}function M_(r){if(r.message.includes("cyclic object value")||r.message.includes("Object is not serializable"))return{result:{type:"undefined",value:void 0}};throw r instanceof TypeError&&r.message.startsWith("Converting circular structure to JSON")&&(0,l3.rewriteErrorMessage)(r,r.message+" Are you passing a nested JSHandle?"),!ys.isJavaScriptErrorInEvaluate(r)&&!(0,u3.isSessionClosedError)(r)?new Error("Execution context was destroyed, most likely because of a navigation."):r}function h3(r){let e=r.value,t=r.unserializableValue;return t?ys.parseUnserializableValue(t):e}function p3(r){if(r.type==="undefined")return"undefined";if(r.unserializableValue)return String(r.unserializableValue);if(r.type==="symbol")return"Symbol()";if(r.subtype==="regexp")return"RegExp";if(r.subtype==="weakmap")return"WeakMap";if(r.subtype==="weakset")return"WeakSet";if(r.subtype)return r.subtype[0].toUpperCase()+r.subtype.slice(1);if("value"in r)return String(r.value)}});var CC=M(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.RawTouchscreenImpl=kr.RawMouseImpl=kr.RawKeyboardImpl=void 0;function da(r){let e=0;return r.has("Alt")&&(e|=1),r.has("Control")&&(e|=2),r.has("Shift")&&(e|=4),r.has("Meta")&&(e|=8),e}function kC(r){return r==="left"?0:r==="middle"?1:r==="right"?2:0}function N_(r){let e=0;return r.has("left")&&(e|=1),r.has("right")&&(e|=2),r.has("middle")&&(e|=4),e}var L_=class{constructor(e){this._client=void 0,this._client=e}async keydown(e,t,n,s,o,a,l,c){c==="\r"&&(c=""),await this._client.send("Page.dispatchKeyEvent",{type:"keydown",keyCode:s,code:t,key:o,repeat:l,location:a,text:c})}async keyup(e,t,n,s,o,a){await this._client.send("Page.dispatchKeyEvent",{type:"keyup",key:o,keyCode:s,code:t,location:a,repeat:!1})}async sendText(e){await this._client.send("Page.insertText",{text:e})}};kr.RawKeyboardImpl=L_;var D_=class{constructor(e){this._client=void 0,this._page=void 0,this._client=e}async move(e,t,n,s,o,a){await this._client.send("Page.dispatchMouseEvent",{type:"mousemove",button:0,buttons:N_(s),x:Math.floor(e),y:Math.floor(t),modifiers:da(o)})}async down(e,t,n,s,o,a){await this._client.send("Page.dispatchMouseEvent",{type:"mousedown",button:kC(n),buttons:N_(s),x:Math.floor(e),y:Math.floor(t),modifiers:da(o),clickCount:a})}async up(e,t,n,s,o,a){await this._client.send("Page.dispatchMouseEvent",{type:"mouseup",button:kC(n),buttons:N_(s),x:Math.floor(e),y:Math.floor(t),modifiers:da(o),clickCount:a})}async wheel(e,t,n,s,o,a){await this._page.mainFrame().evaluateExpression("new Promise(requestAnimationFrame)",{world:"utility"}),await this._client.send("Page.dispatchWheelEvent",{deltaX:o,deltaY:a,x:Math.floor(e),y:Math.floor(t),deltaZ:0,modifiers:da(s)})}setPage(e){this._page=e}};kr.RawMouseImpl=D_;var B_=class{constructor(e){this._client=void 0,this._client=e}async tap(e,t,n){await this._client.send("Page.dispatchTapEvent",{x:e,y:t,modifiers:da(n)})}};kr.RawTouchscreenImpl=B_});var OC=M(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.FFNetworkManager=void 0;var ha=Ze(),$_=f3(Ct());function TC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(TC=function(n){return n?t:e})(r)}function f3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=TC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var j_=class{constructor(e,t){this._session=void 0,this._requests=void 0,this._page=void 0,this._eventListeners=void 0,this._session=e,this._requests=new Map,this._page=t,this._eventListeners=[ha.eventsHelper.addEventListener(e,"Network.requestWillBeSent",this._onRequestWillBeSent.bind(this)),ha.eventsHelper.addEventListener(e,"Network.responseReceived",this._onResponseReceived.bind(this)),ha.eventsHelper.addEventListener(e,"Network.requestFinished",this._onRequestFinished.bind(this)),ha.eventsHelper.addEventListener(e,"Network.requestFailed",this._onRequestFailed.bind(this))]}dispose(){ha.eventsHelper.removeEventListeners(this._eventListeners)}async setRequestInterception(e){await Promise.all([this._session.send("Network.setRequestInterception",{enabled:e}),this._session.send("Page.setCacheDisabled",{cacheDisabled:e})])}_onRequestWillBeSent(e){let t=e.redirectedFrom&&this._requests.get(e.redirectedFrom)||null,n=t?t.request.frame():e.frameId?this._page._frameManager.frame(e.frameId):null;if(!n)return;t&&this._requests.delete(t._id);let s=new q_(n,t,e),o;e.isIntercepted&&(o=new H_(this._session,s)),this._requests.set(s._id,s),this._page._frameManager.requestStarted(s.request,o)}_onResponseReceived(e){var t,n,s,o,a;let l=this._requests.get(e.requestId);if(!l)return;let c=async()=>{let f=await this._session.send("Network.getResponseBody",{requestId:l._id});if(f.evicted)throw new Error(`Response body for ${l.request.method()} ${l.request.url()} was evicted!`);return Buffer.from(f.base64body,"base64")},u=e.timing.startTime;function d(f){return f?(f-u)/1e3:-1}let h={startTime:u/1e3,domainLookupStart:d(e.timing.domainLookupStart),domainLookupEnd:d(e.timing.domainLookupEnd),connectStart:d(e.timing.connectStart),secureConnectionStart:d(e.timing.secureConnectionStart),connectEnd:d(e.timing.connectEnd),requestStart:d(e.timing.requestStart),responseStart:d(e.timing.responseStart)},p=new $_.Response(l.request,e.status,e.statusText,_3(e.headers),h,c,e.fromServiceWorker);e!=null&&e.remoteIPAddress&&typeof e?.remotePort=="number"?p._serverAddrFinished({ipAddress:e.remoteIPAddress,port:e.remotePort}):p._serverAddrFinished(),p._securityDetailsFinished({protocol:e==null||(t=e.securityDetails)===null||t===void 0?void 0:t.protocol,subjectName:e==null||(n=e.securityDetails)===null||n===void 0?void 0:n.subjectName,issuer:e==null||(s=e.securityDetails)===null||s===void 0?void 0:s.issuer,validFrom:e==null||(o=e.securityDetails)===null||o===void 0?void 0:o.validFrom,validTo:e==null||(a=e.securityDetails)===null||a===void 0?void 0:a.validTo}),p.setRawResponseHeaders(null),p.setResponseHeadersSize(null),this._page._frameManager.requestReceivedResponse(p)}_onRequestFinished(e){let t=this._requests.get(e.requestId);if(!t)return;let n=t.request._existingResponse();n.setTransferSize(e.transferSize),n.setEncodedBodySize(e.encodedBodySize);let s=n.status()>=300&&n.status()<=399,o=e.responseEndTime?e.responseEndTime/1e3-n.timing().startTime:-1;s||this._requests.delete(t._id),n._requestFinished(o),e.protocolVersion&&n._setHttpVersion(e.protocolVersion),this._page._frameManager.reportRequestFinished(t.request,n)}_onRequestFailed(e){let t=this._requests.get(e.requestId);if(!t)return;this._requests.delete(t._id);let n=t.request._existingResponse();n&&(n.setTransferSize(null),n.setEncodedBodySize(null),n._requestFinished(-1)),t.request._setFailureText(e.errorCode),this._page._frameManager.requestFailed(t.request,e.errorCode==="NS_BINDING_ABORTED")}};ad.FFNetworkManager=j_;var m3={TYPE_INVALID:"other",TYPE_OTHER:"other",TYPE_SCRIPT:"script",TYPE_IMAGE:"image",TYPE_STYLESHEET:"stylesheet",TYPE_OBJECT:"other",TYPE_DOCUMENT:"document",TYPE_SUBDOCUMENT:"document",TYPE_REFRESH:"document",TYPE_XBL:"other",TYPE_PING:"other",TYPE_XMLHTTPREQUEST:"xhr",TYPE_OBJECT_SUBREQUEST:"other",TYPE_DTD:"other",TYPE_FONT:"font",TYPE_MEDIA:"media",TYPE_WEBSOCKET:"websocket",TYPE_CSP_REPORT:"other",TYPE_XSLT:"other",TYPE_BEACON:"other",TYPE_FETCH:"fetch",TYPE_IMAGESET:"images",TYPE_WEB_MANIFEST:"manifest"},g3={TYPE_INTERNAL_EVENTSOURCE:"eventsource"},q_=class{constructor(e,t,n){this.request=void 0,this._id=void 0,this._redirectedTo=void 0,this._id=n.requestId,t&&(t._redirectedTo=this);let s=null;n.postData&&(s=Buffer.from(n.postData,"base64")),this.request=new $_.Request(e._page._browserContext,e,null,t?t.request:null,n.navigationId,n.url,g3[n.internalCause]||m3[n.cause]||"other",n.method,s,n.headers),this.request.setRawRequestHeaders(null)}_finalRequest(){let e=this;for(;e._redirectedTo;)e=e._redirectedTo;return e}},H_=class{constructor(e,t){this._request=void 0,this._session=void 0,this._session=e,this._request=t}async continue(e,t){await this._session.sendMayFail("Network.resumeInterceptedRequest",{requestId:this._request._id,url:t.url,method:t.method,headers:t.headers,postData:t.postData?Buffer.from(t.postData).toString("base64"):void 0})}async fulfill(e){let t=e.isBase64?e.body:Buffer.from(e.body).toString("base64");await this._session.sendMayFail("Network.fulfillInterceptedRequest",{requestId:this._request._id,status:e.status,statusText:$_.STATUS_TEXTS[String(e.status)]||"",headers:e.headers,base64body:t})}async abort(e){await this._session.sendMayFail("Network.abortInterceptedRequest",{requestId:this._request._id,errorCode:e})}};function _3(r){let e=[];for(let t of r){let n=t.name.toLowerCase()==="set-cookie"?`
`:",",s=t.value.split(n).map(o=>o.trim());for(let o of s)e.push({name:t.name,value:o})}return e}});var NC=M(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.UTILITY_WORLD_NAME=Ss.FFPage=void 0;var w3=FC(Eu()),PC=FC(Bo()),Me=Ze(),ld=Et(),v3=xC(),b3=sd(),AC=EC(),W_=CC(),y3=OC(),x3=Lt(),S3=Le(),E3=Qe(),IC=$e(),k3=Bt();function MC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(MC=function(n){return n?t:e})(r)}function FC(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=MC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var RC=Ss.UTILITY_WORLD_NAME="__playwright_utility_world__",z_=class{constructor(e,t,n){this.cspErrorsAsynchronousForInlineScripts=!0,this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._session=void 0,this._page=void 0,this._networkManager=void 0,this._browserContext=void 0,this._pagePromise=new E3.ManualPromise,this._initializedPage=null,this._initializationFailed=!1,this._opener=void 0,this._contextIdToContext=void 0,this._eventListeners=void 0,this._workers=new Map,this._screencastId=void 0,this._initScripts=[],this._session=e,this._opener=n,this.rawKeyboard=new W_.RawKeyboardImpl(e),this.rawMouse=new W_.RawMouseImpl(e),this.rawTouchscreen=new W_.RawTouchscreenImpl(e),this._contextIdToContext=new Map,this._browserContext=t,this._page=new ld.Page(this,t),this.rawMouse.setPage(this._page),this._networkManager=new y3.FFNetworkManager(e,this._page),this._page.on(ld.Page.Events.FrameDetached,s=>this._removeContextsForFrame(s)),this._eventListeners=[Me.eventsHelper.addEventListener(this._session,"Page.eventFired",this._onEventFired.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.frameAttached",this._onFrameAttached.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.frameDetached",this._onFrameDetached.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.navigationAborted",this._onNavigationAborted.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.navigationCommitted",this._onNavigationCommitted.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.navigationStarted",this._onNavigationStarted.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.sameDocumentNavigation",this._onSameDocumentNavigation.bind(this)),Me.eventsHelper.addEventListener(this._session,"Runtime.executionContextCreated",this._onExecutionContextCreated.bind(this)),Me.eventsHelper.addEventListener(this._session,"Runtime.executionContextDestroyed",this._onExecutionContextDestroyed.bind(this)),Me.eventsHelper.addEventListener(this._session,"Runtime.executionContextsCleared",this._onExecutionContextsCleared.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.linkClicked",s=>this._onLinkClicked(s.phase)),Me.eventsHelper.addEventListener(this._session,"Page.uncaughtError",this._onUncaughtError.bind(this)),Me.eventsHelper.addEventListener(this._session,"Runtime.console",this._onConsole.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.dialogOpened",this._onDialogOpened.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.bindingCalled",this._onBindingCalled.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.fileChooserOpened",this._onFileChooserOpened.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.workerCreated",this._onWorkerCreated.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.workerDestroyed",this._onWorkerDestroyed.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.dispatchMessageFromWorker",this._onDispatchMessageFromWorker.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.crashed",this._onCrashed.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.videoRecordingStarted",this._onVideoRecordingStarted.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.webSocketCreated",this._onWebSocketCreated.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.webSocketClosed",this._onWebSocketClosed.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.webSocketFrameReceived",this._onWebSocketFrameReceived.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.webSocketFrameSent",this._onWebSocketFrameSent.bind(this)),Me.eventsHelper.addEventListener(this._session,"Page.screencastFrame",this._onScreencastFrame.bind(this))],this._session.once("Page.ready",async()=>{await this._page.initOpener(this._opener),!this._initializationFailed&&(this._initializedPage=this._page,this._page.reportAsNew(),this._pagePromise.resolve(this._page))}),this.addInitScript("",RC).catch(s=>this._markAsError(s))}potentiallyUninitializedPage(){return this._page}async _markAsError(e){this._initializationFailed||(this._initializationFailed=!0,this._initializedPage||(await this._page.initOpener(this._opener),this._page.reportAsNew(e),this._pagePromise.resolve(e)))}async pageOrError(){return this._pagePromise}_onWebSocketCreated(e){this._page._frameManager.onWebSocketCreated(xs(e.frameId,e.wsid),e.requestURL),this._page._frameManager.onWebSocketRequest(xs(e.frameId,e.wsid))}_onWebSocketClosed(e){e.error&&this._page._frameManager.webSocketError(xs(e.frameId,e.wsid),e.error),this._page._frameManager.webSocketClosed(xs(e.frameId,e.wsid))}_onWebSocketFrameReceived(e){this._page._frameManager.webSocketFrameReceived(xs(e.frameId,e.wsid),e.opcode,e.data)}_onWebSocketFrameSent(e){this._page._frameManager.onWebSocketFrameSent(xs(e.frameId,e.wsid),e.opcode,e.data)}_onExecutionContextCreated(e){let{executionContextId:t,auxData:n}=e,s=this._page._frameManager.frame(n.frameId);if(!s)return;let o=new AC.FFExecutionContext(this._session,t),a=null;n.name===RC?a="utility":n.name||(a="main");let l=new PC.FrameExecutionContext(o,s,a);l[U_]=o,a&&s._contextCreated(a,l),this._contextIdToContext.set(t,l)}_onExecutionContextDestroyed(e){let{executionContextId:t}=e,n=this._contextIdToContext.get(t);n&&(this._contextIdToContext.delete(t),n.frame._contextDestroyed(n))}_onExecutionContextsCleared(){for(let e of Array.from(this._contextIdToContext.keys()))this._onExecutionContextDestroyed({executionContextId:e})}_removeContextsForFrame(e){for(let[t,n]of this._contextIdToContext)n.frame===e&&this._contextIdToContext.delete(t)}_onLinkClicked(e){e==="before"?this._page._frameManager.frameWillPotentiallyRequestNavigation():this._page._frameManager.frameDidPotentiallyRequestNavigation()}_onNavigationStarted(e){this._page._frameManager.frameRequestedNavigation(e.frameId,e.navigationId)}_onNavigationAborted(e){this._page._frameManager.frameAbortedNavigation(e.frameId,e.errorText,e.navigationId)}_onNavigationCommitted(e){for(let[t,n]of this._workers)n.frameId===e.frameId&&this._onWorkerDestroyed({workerId:t});this._page._frameManager.frameCommittedNewDocumentNavigation(e.frameId,e.url,e.name||"",e.navigationId||"",!1)}_onSameDocumentNavigation(e){this._page._frameManager.frameCommittedSameDocumentNavigation(e.frameId,e.url)}_onFrameAttached(e){this._page._frameManager.frameAttached(e.frameId,e.parentFrameId)}_onFrameDetached(e){this._page._frameManager.frameDetached(e.frameId)}_onEventFired(e){let{frameId:t,name:n}=e;n==="load"&&this._page._frameManager.frameLifecycleEvent(t,"load"),n==="DOMContentLoaded"&&this._page._frameManager.frameLifecycleEvent(t,"domcontentloaded")}_onUncaughtError(e){let{name:t,message:n}=(0,x3.splitErrorMessage)(e.message),s=new Error(n);s.stack=e.message+`
`+e.stack.split(`
`).filter(Boolean).map(o=>o.replace(/([^@]*)@(.*)/,"    at $1 ($2)")).join(`
`),s.name=t,this._page.emitOnContextOnceInitialized(IC.BrowserContext.Events.PageError,s,this._page)}_onConsole(e){let{type:t,args:n,executionContextId:s,location:o}=e,a=this._contextIdToContext.get(s);a&&this._page._addConsoleMessage(t==="warn"?"warning":t,n.map(l=>a.createHandle(l)),o)}_onDialogOpened(e){this._page.emitOnContext(IC.BrowserContext.Events.Dialog,new w3.Dialog(this._page,e.type,e.message,async(t,n)=>{await this._session.sendMayFail("Page.handleDialog",{dialogId:e.dialogId,accept:t,promptText:n})},e.defaultValue))}async _onBindingCalled(e){if(!(await this.pageOrError()instanceof Error)){let n=this._contextIdToContext.get(e.executionContextId);n&&await this._page._onBindingCalled(e.payload,n)}}async _onFileChooserOpened(e){let{executionContextId:t,element:n}=e,s=this._contextIdToContext.get(t);if(!s)return;let o=s.createHandle(n).asElement();await this._page._onFileChooserOpened(o)}async _onWorkerCreated(e){let t=e.workerId,n=new ld.Worker(this._page,e.url),s=new b3.FFSession(this._session._connection,t,o=>{this._session.send("Page.sendMessageToWorker",{frameId:e.frameId,workerId:t,message:JSON.stringify(o)}).catch(a=>{s.dispatchMessage({id:o.id,method:"",params:{},error:{message:a.message,data:void 0}})})});this._workers.set(t,{session:s,frameId:e.frameId}),this._page._addWorker(t,n),s.once("Runtime.executionContextCreated",o=>{n._createExecutionContext(new AC.FFExecutionContext(s,o.executionContextId))}),s.on("Runtime.console",o=>{let{type:a,args:l,location:c}=o,u=n._existingExecutionContext;this._page._addConsoleMessage(a,l.map(d=>u.createHandle(d)),c)})}_onWorkerDestroyed(e){let t=e.workerId,n=this._workers.get(t);n&&(n.session.dispose(),this._workers.delete(t),this._page._removeWorker(t))}async _onDispatchMessageFromWorker(e){let t=this._workers.get(e.workerId);t&&t.session.dispatchMessage(JSON.parse(e.message))}async _onCrashed(e){this._session.markAsCrashed(),this._page._didCrash()}_onVideoRecordingStarted(e){this._browserContext._browser._videoStarted(this._browserContext,e.screencastId,e.file,this.pageOrError())}async exposeBinding(e){await this._session.send("Page.addBinding",{name:e.name,script:e.source})}async removeExposedBindings(){}didClose(){this._markAsError(new k3.TargetClosedError),this._session.dispose(),Me.eventsHelper.removeEventListeners(this._eventListeners),this._networkManager.dispose(),this._page._didClose()}async navigateFrame(e,t,n){return{newDocumentId:(await this._session.send("Page.navigate",{url:t,referer:n,frameId:e._id})).navigationId||void 0}}async updateExtraHTTPHeaders(){await this._session.send("Network.setExtraHTTPHeaders",{headers:this._page.extraHTTPHeaders()||[]})}async updateEmulatedViewportSize(){let e=this._page.viewportSize();await this._session.send("Page.setViewportSize",{viewportSize:e})}async bringToFront(){await this._session.send("Page.bringToFront",{})}async updateEmulateMedia(){let e=this._page.emulatedMedia(),t=e.colorScheme==="no-override"?void 0:e.colorScheme,n=e.reducedMotion==="no-override"?void 0:e.reducedMotion,s=e.forcedColors==="no-override"?void 0:e.forcedColors;await this._session.send("Page.setEmulatedMedia",{type:e.media==="no-override"?"":e.media,colorScheme:t,reducedMotion:n,forcedColors:s})}async updateRequestInterception(){await this._networkManager.setRequestInterception(this._page.needsRequestInterception())}async updateFileChooserInterception(){let e=this._page.fileChooserIntercepted();await this._session.send("Page.setInterceptFileChooserDialog",{enabled:e}).catch(()=>{})}async reload(){await this._session.send("Page.reload")}async goBack(){let{success:e}=await this._session.send("Page.goBack",{frameId:this._page.mainFrame()._id});return e}async goForward(){let{success:e}=await this._session.send("Page.goForward",{frameId:this._page.mainFrame()._id});return e}async addInitScript(e,t){this._initScripts.push({script:e,worldName:t}),await this._session.send("Page.setInitScripts",{scripts:this._initScripts})}async removeInitScripts(){this._initScripts=[],await this._session.send("Page.setInitScripts",{scripts:[]})}async closePage(e){await this._session.send("Page.close",{runBeforeUnload:e})}async setBackgroundColor(e){if(e)throw new Error("Not implemented")}async takeScreenshot(e,t,n,s,o,a,l){if(!n){let u=await this._page.mainFrame().waitForFunctionValueInUtility(e,()=>({x:window.scrollX,y:window.scrollY}));n={x:s.x+u.x,y:s.y+u.y,width:s.width,height:s.height}}e.throwIfAborted();let{data:c}=await this._session.send("Page.screenshot",{mimeType:"image/"+t,clip:n,quality:o,omitDeviceScaleFactor:l==="css"});return Buffer.from(c,"base64")}async getContentFrame(e){let{contentFrameId:t}=await this._session.send("Page.describeNode",{frameId:e._context.frame._id,objectId:e._objectId});return t?this._page._frameManager.frame(t):null}async getOwnerFrame(e){let{ownerFrameId:t}=await this._session.send("Page.describeNode",{frameId:e._context.frame._id,objectId:e._objectId});return t||null}isElementHandle(e){return e.subtype==="node"}async getBoundingBox(e){let t=await this.getContentQuads(e);if(!t||!t.length)return null;let n=1/0,s=-1/0,o=1/0,a=-1/0;for(let l of t)for(let c of l)n=Math.min(n,c.x),s=Math.max(s,c.x),o=Math.min(o,c.y),a=Math.max(a,c.y);return{x:n,y:o,width:s-n,height:a-o}}async scrollRectIntoViewIfNeeded(e,t){return await this._session.send("Page.scrollIntoViewIfNeeded",{frameId:e._context.frame._id,objectId:e._objectId,rect:t}).then(()=>"done").catch(n=>{if(n instanceof Error&&n.message.includes("Node is detached from document"))return"error:notconnected";if(n instanceof Error&&n.message.includes("Node does not have a layout object"))return"error:notvisible";throw n})}async setScreencastOptions(e){if(e){let{screencastId:t}=await this._session.send("Page.startScreencast",e);this._screencastId=t}else await this._session.send("Page.stopScreencast")}_onScreencastFrame(e){if(!this._screencastId)return;let t=this._screencastId;this._page.throttleScreencastFrameAck(()=>{this._session.send("Page.screencastFrameAck",{screencastId:t}).catch(s=>S3.debugLogger.log("error",s))});let n=Buffer.from(e.data,"base64");this._page.emit(ld.Page.Events.ScreencastFrame,{buffer:n,width:e.deviceWidth,height:e.deviceHeight})}rafCountForStablePosition(){return 1}async getContentQuads(e){let t=await this._session.sendMayFail("Page.getContentQuads",{frameId:e._context.frame._id,objectId:e._objectId});return t?t.quads.map(n=>[n.p1,n.p2,n.p3,n.p4]):null}async setInputFiles(e,t){await e.evaluateInUtility(([n,s,o])=>n.setInputFiles(s,o),t)}async setInputFilePaths(e,t){await this._session.send("Page.setFileInputFiles",{frameId:e._context.frame._id,objectId:e._objectId,files:t})}async adoptElementHandle(e,t){let n=await this._session.send("Page.adoptNode",{frameId:e._context.frame._id,objectId:e._objectId,executionContextId:t[U_]._executionContextId});if(!n.remoteObject)throw new Error(PC.kUnableToAdoptErrorMessage);return t.createHandle(n.remoteObject)}async getAccessibilityTree(e){return(0,v3.getAccessibilityTree)(this._session,e)}async inputActionEpilogue(){}async resetForReuse(){await this.rawMouse.move(-1,-1,"none",new Set,new Set,!1)}async getFrameElement(e){let t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");let n=await t._mainContext(),s=await this._session.send("Page.adoptNode",{frameId:e._id,executionContextId:n[U_]._executionContextId});if(!s.remoteObject)throw new Error("Frame has been detached.");return n.createHandle(s.remoteObject)}shouldToggleStyleSheetToSyncAnimations(){return!1}};Ss.FFPage=z_;function xs(r,e){return`${r}---${e}`}var U_=Symbol("delegate")});var qC=M(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});Es.FFBrowserContext=Es.FFBrowser=void 0;var C3=Bt(),G_=ie(),T3=li(),V_=$e(),cd=P3(Ct()),LC=sd(),O3=NC();function BC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(BC=function(n){return n?t:e})(r)}function P3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=BC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var K_=class r extends T3.Browser{static async connect(e,t,n){var s;let o=new LC.FFConnection(t,n.protocolLogger,n.browserLogsCollector),a=new r(e,o,n);n.__testHookOnConnectToBrowser&&await n.__testHookOnConnectToBrowser();let l=(s=n.originalLaunchOptions.firefoxUserPrefs)!==null&&s!==void 0?s:{};Object.keys(DC).length&&(l={...DC,...l});let c=[a.session.send("Browser.enable",{attachToDefaultContext:!!n.persistent,userPrefs:Object.entries(l).map(([u,d])=>({name:u,value:d}))}),a._initVersion()];return n.persistent&&(a._defaultContext=new pa(a,void 0,n.persistent),c.push(a._defaultContext._initialize())),n.proxy&&c.push(a.session.send("Browser.setBrowserProxy",jC(n.proxy))),await Promise.all(c),a}constructor(e,t,n){super(e,n),this._connection=void 0,this.session=void 0,this._ffPages=void 0,this._contexts=void 0,this._version="",this._userAgent="",this._connection=t,this.session=t.rootSession,this._ffPages=new Map,this._contexts=new Map,this._connection.on(LC.ConnectionEvents.Disconnected,()=>this._onDisconnect()),this.session.on("Browser.attachedToTarget",this._onAttachedToTarget.bind(this)),this.session.on("Browser.detachedFromTarget",this._onDetachedFromTarget.bind(this)),this.session.on("Browser.downloadCreated",this._onDownloadCreated.bind(this)),this.session.on("Browser.downloadFinished",this._onDownloadFinished.bind(this)),this.session.on("Browser.videoRecordingFinished",this._onVideoRecordingFinished.bind(this))}async _initVersion(){let e=await this.session.send("Browser.getInfo");this._version=e.version.substring(e.version.indexOf("/")+1),this._userAgent=e.userAgent}isConnected(){return!this._connection._closed}async doCreateNewContext(e){if(e.isMobile)throw new Error("options.isMobile is not supported in Firefox");let{browserContextId:t}=await this.session.send("Browser.createBrowserContext",{removeOnDetach:!0}),n=new pa(this,t,e);return await n._initialize(),this._contexts.set(t,n),n}contexts(){return Array.from(this._contexts.values())}version(){return this._version}userAgent(){return this._userAgent}_onDetachedFromTarget(e){let t=this._ffPages.get(e.targetId);this._ffPages.delete(e.targetId),t.didClose()}_onAttachedToTarget(e){let{targetId:t,browserContextId:n,openerId:s,type:o}=e.targetInfo;(0,G_.assert)(o==="page");let a=n?this._contexts.get(n):this._defaultContext;(0,G_.assert)(a,`Unknown context id:${n}, _defaultContext: ${this._defaultContext}`);let l=this._connection.createSession(e.sessionId),c=s?this._ffPages.get(s):null,u=new O3.FFPage(l,a,c);this._ffPages.set(t,u)}_onDownloadCreated(e){let t=this._ffPages.get(e.pageTargetId);if(!t)return;t._page._frameManager.frameAbortedNavigation(e.frameId,"Download is starting");let n=t._initializedPage;n||(t._markAsError(new Error("Starting new page download")),t._opener&&(n=t._opener._initializedPage)),n&&this._downloadCreated(n,e.uuid,e.url,e.suggestedFileName)}_onDownloadFinished(e){let t=e.canceled?"canceled":e.error;this._downloadFinished(e.uuid,t)}_onVideoRecordingFinished(e){var t;(t=this._takeVideo(e.screencastId))===null||t===void 0||t.reportFinished()}_onDisconnect(){for(let e of this._idToVideo.values())e.artifact.reportFinished(new C3.TargetClosedError);this._idToVideo.clear();for(let e of this._ffPages.values())e.didClose();this._ffPages.clear(),this._didClose()}};Es.FFBrowser=K_;var pa=class extends V_.BrowserContext{constructor(e,t,n){super(e,n,t)}async _initialize(){(0,G_.assert)(!this._ffPages().length);let e=this._browserContextId,t=[super._initialize()];if(this._options.acceptDownloads!=="internal-browser-default"&&t.push(this._browser.session.send("Browser.setDownloadOptions",{browserContextId:e,downloadOptions:{behavior:this._options.acceptDownloads==="accept"?"saveToDisk":"cancel",downloadsDir:this._browser.options.downloadsPath}})),this._options.viewport){let n={viewportSize:{width:this._options.viewport.width,height:this._options.viewport.height},deviceScaleFactor:this._options.deviceScaleFactor||1};t.push(this._browser.session.send("Browser.setDefaultViewport",{browserContextId:e,viewport:n}))}this._options.hasTouch&&t.push(this._browser.session.send("Browser.setTouchOverride",{browserContextId:e,hasTouch:!0})),this._options.userAgent&&t.push(this._browser.session.send("Browser.setUserAgentOverride",{browserContextId:e,userAgent:this._options.userAgent})),this._options.bypassCSP&&t.push(this._browser.session.send("Browser.setBypassCSP",{browserContextId:e,bypassCSP:!0})),this._options.ignoreHTTPSErrors&&t.push(this._browser.session.send("Browser.setIgnoreHTTPSErrors",{browserContextId:e,ignoreHTTPSErrors:!0})),this._options.javaScriptEnabled===!1&&t.push(this._browser.session.send("Browser.setJavaScriptDisabled",{browserContextId:e,javaScriptDisabled:!0})),this._options.locale&&t.push(this._browser.session.send("Browser.setLocaleOverride",{browserContextId:e,locale:this._options.locale})),this._options.timezoneId&&t.push(this._browser.session.send("Browser.setTimezoneOverride",{browserContextId:e,timezoneId:this._options.timezoneId})),(this._options.extraHTTPHeaders||this._options.locale)&&t.push(this.setExtraHTTPHeaders(this._options.extraHTTPHeaders||[])),this._options.httpCredentials&&t.push(this.setHTTPCredentials(this._options.httpCredentials)),this._options.geolocation&&t.push(this.setGeolocation(this._options.geolocation)),this._options.offline&&t.push(this.setOffline(this._options.offline)),this._options.colorScheme!=="no-override"&&t.push(this._browser.session.send("Browser.setColorScheme",{browserContextId:e,colorScheme:this._options.colorScheme!==void 0?this._options.colorScheme:"light"})),this._options.reducedMotion!=="no-override"&&t.push(this._browser.session.send("Browser.setReducedMotion",{browserContextId:e,reducedMotion:this._options.reducedMotion!==void 0?this._options.reducedMotion:"no-preference"})),this._options.forcedColors!=="no-override"&&t.push(this._browser.session.send("Browser.setForcedColors",{browserContextId:e,forcedColors:this._options.forcedColors!==void 0?this._options.forcedColors:"none"})),this._options.recordVideo&&t.push(this._ensureVideosPath().then(()=>this._browser.session.send("Browser.setVideoRecordingOptions",{options:{...this._options.recordVideo.size,dir:this._options.recordVideo.dir},browserContextId:this._browserContextId}))),this._options.proxy&&t.push(this._browser.session.send("Browser.setContextProxy",{browserContextId:this._browserContextId,...jC(this._options.proxy)})),await Promise.all(t)}_ffPages(){return Array.from(this._browser._ffPages.values()).filter(e=>e._browserContext===this)}pages(){return this._ffPages().map(e=>e._initializedPage).filter(e=>!!e)}async newPageDelegate(){(0,V_.assertBrowserContextIsNotOwned)(this);let{targetId:e}=await this._browser.session.send("Browser.newPage",{browserContextId:this._browserContextId}).catch(t=>{throw t.message.includes("Failed to override timezone")?new Error(`Invalid timezone ID: ${this._options.timezoneId}`):t});return this._browser._ffPages.get(e)}async doGetCookies(e){let{cookies:t}=await this._browser.session.send("Browser.getCookies",{browserContextId:this._browserContextId});return cd.filterCookies(t.map(n=>{let s={...n};return delete s.size,delete s.session,s}),e)}async addCookies(e){let t=cd.rewriteCookies(e).map(n=>({...n,expires:n.expires===-1?void 0:n.expires}));await this._browser.session.send("Browser.setCookies",{browserContextId:this._browserContextId,cookies:t})}async doClearCookies(){await this._browser.session.send("Browser.clearCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){let n=new Map([["geolocation","geo"],["persistent-storage","persistent-storage"],["push","push"],["notifications","desktop-notification"]]),s=t.map(o=>{let a=n.get(o);if(!a)throw new Error("Unknown permission: "+o);return a});await this._browser.session.send("Browser.grantPermissions",{origin:e,browserContextId:this._browserContextId,permissions:s})}async doClearPermissions(){await this._browser.session.send("Browser.resetPermissions",{browserContextId:this._browserContextId})}async setGeolocation(e){(0,V_.verifyGeolocation)(e),this._options.geolocation=e,await this._browser.session.send("Browser.setGeolocationOverride",{browserContextId:this._browserContextId,geolocation:e||null})}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;let t=this._options.extraHTTPHeaders;this._options.locale&&(t=cd.mergeHeaders([t,cd.singleHeader("Accept-Language",this._options.locale)])),await this._browser.session.send("Browser.setExtraHTTPHeaders",{browserContextId:this._browserContextId,headers:t})}async setUserAgent(e){await this._browser.session.send("Browser.setUserAgentOverride",{browserContextId:this._browserContextId,userAgent:e||null})}async setOffline(e){this._options.offline=e,await this._browser.session.send("Browser.setOnlineOverride",{browserContextId:this._browserContextId,override:e?"offline":"online"})}async doSetHTTPCredentials(e){this._options.httpCredentials=e,await this._browser.session.send("Browser.setHTTPCredentials",{browserContextId:this._browserContextId,credentials:e||null})}async doAddInitScript(e){await this._browser.session.send("Browser.setInitScripts",{browserContextId:this._browserContextId,scripts:this.initScripts.map(t=>({script:t}))})}async doRemoveInitScripts(){await this._browser.session.send("Browser.setInitScripts",{browserContextId:this._browserContextId,scripts:[]})}async doExposeBinding(e){await this._browser.session.send("Browser.addBinding",{browserContextId:this._browserContextId,name:e.name,script:e.source})}async doRemoveExposedBindings(){}async doUpdateRequestInterception(){await Promise.all([this._browser.session.send("Browser.setRequestInterception",{browserContextId:this._browserContextId,enabled:!!this._requestInterceptor}),this._browser.session.send("Browser.setCacheDisabled",{browserContextId:this._browserContextId,cacheDisabled:!!this._requestInterceptor})])}onClosePersistent(){}async clearCache(){await this._browser.session.send("Browser.clearCache")}async doClose(e){this._browserContextId?(await this._browser.session.send("Browser.removeBrowserContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId)):(this._options.recordVideo&&await this._browser.session.send("Browser.setVideoRecordingOptions",{options:void 0,browserContextId:this._browserContextId}),await this._browser.close({reason:e}))}async cancelDownload(e){await this._browser.session.send("Browser.cancelDownload",{uuid:e})}};Es.FFBrowserContext=pa;function jC(r){let e=new URL(r.server),t=parseInt(e.port,10),n="http";return e.protocol==="socks5:"?n="socks":e.protocol==="socks4:"?n="socks4":e.protocol==="https:"&&(n="https"),e.port===""&&(e.protocol==="http:"?t=80:e.protocol==="https:"&&(t=443)),{type:n,bypass:r.bypass?r.bypass.split(",").map(s=>s.trim()):[],host:e.hostname,port:t,username:r.username,password:r.password}}var DC={}});var UC=M(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.Firefox=void 0;var J_=F3(require("os")),A3=M3(require("path")),I3=qC(),R3=sd(),HC=ed(),$C=ie();function M3(r){return r&&r.__esModule?r:{default:r}}function WC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(WC=function(n){return n?t:e})(r)}function F3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=WC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var X_=class extends HC.BrowserType{constructor(e){super(e,"firefox")}_connectToTransport(e,t){return I3.FFBrowser.connect(this.attribution.playwright,e,t)}_doRewriteStartupLog(e){return e.logs&&(e.logs.includes("as root in a regular user's session is not supported.")&&(e.logs=`
`+(0,$C.wrapInASCIIBox)(`Firefox is unable to launch if the $HOME folder isn't owned by the current user.
Workaround: Set the HOME=/root environment variable${process.env.GITHUB_ACTION?" in your GitHub Actions workflow file":""} when running Playwright.`,1)),e.logs.includes("no DISPLAY environment variable specified")&&(e.logs=`
`+(0,$C.wrapInASCIIBox)(HC.kNoXServerRunningError,1))),e}_amendEnvironment(e,t,n,s){if(!A3.default.isAbsolute(J_.homedir()))throw new Error(`Cannot launch Firefox with relative home directory. Did you set ${J_.platform()==="win32"?"USERPROFILE":"HOME"} to a relative path?`);return J_.platform()==="linux"?{...e,SNAP_NAME:void 0,SNAP_INSTANCE_NAME:void 0}:e}_attemptToGracefullyCloseBrowser(e){let t={method:"Browser.close",params:{},id:R3.kBrowserCloseMessageId};e.send(t)}_defaultArgs(e,t,n){let{args:s=[],headless:o}=e;if(s.find(c=>c.startsWith("-profile")||c.startsWith("--profile")))throw this._createUserDataDirArgMisuseError("--profile");if(s.find(c=>c.startsWith("-juggler")))throw new Error("Use the port parameter instead of -juggler argument");let l=["-no-remote"];return o?l.push("-headless"):(l.push("-wait-for-browser"),l.push("-foreground")),l.push("-profile",n),l.push("-juggler-pipe"),l.push(...s),t?l.push("about:blank"):l.push("-silent"),l}};ud.Firefox=X_});var Q_=M(hd=>{"use strict";Object.defineProperty(hd,"__esModule",{value:!0});hd.Selectors=void 0;var dd=ti(),N3=ie(),Y_=class{constructor(){this._builtinEngines=void 0,this._builtinEnginesInMainWorld=void 0,this._engines=void 0,this.guid=`selectors@${(0,N3.createGuid)()}`,this._testIdAttributeName="data-testid",this._builtinEngines=new Set(["css","css:light","xpath","xpath:light","_react","_vue","text","text:light","id","id:light","data-testid","data-testid:light","data-test-id","data-test-id:light","data-test","data-test:light","nth","visible","internal:control","internal:has","internal:has-not","internal:has-text","internal:has-not-text","internal:and","internal:or","internal:chain","role","internal:attr","internal:label","internal:text","internal:role","internal:testid"]),this._builtinEnginesInMainWorld=new Set(["_react","_vue"]),this._engines=new Map}async register(e,t,n=!1){if(!e.match(/^[a-zA-Z_0-9-]+$/))throw new Error("Selector engine name may only contain [a-zA-Z0-9_] characters");if(this._builtinEngines.has(e)||e==="zs"||e==="zs:light")throw new Error(`"${e}" is a predefined selector engine`);if(this._engines.has(e))throw new Error(`"${e}" selector engine has been already registered`);this._engines.set(e,{source:t,contentScript:n})}testIdAttributeName(){return this._testIdAttributeName}setTestIdAttributeName(e){this._testIdAttributeName=e}unregisterAll(){this._engines.clear()}parseSelector(e,t){let n=typeof e=="string"?(0,dd.parseSelector)(e):e,s=!1;return(0,dd.visitAllSelectorParts)(n,o=>{let a=o.name,l=this._engines.get(a);if(!l&&!this._builtinEngines.has(a))throw new dd.InvalidSelectorError(`Unknown engine "${a}" while parsing selector ${(0,dd.stringifySelector)(n)}`);l&&!l.contentScript&&(s=!0),this._builtinEnginesInMainWorld.has(a)&&(s=!0)}),{parsed:n,world:s?"main":"utility",strict:t}}};hd.Selectors=Y_});var fa=M(Pn=>{"use strict";Object.defineProperty(Pn,"__esModule",{value:!0});Pn.kPageProxyMessageReceived=Pn.kBrowserCloseMessageId=Pn.WKSession=Pn.WKConnection=void 0;var L3=require("events"),D3=ie(),B3=Le(),j3=yt(),zC=Wt(),q3=Pn.kBrowserCloseMessageId=-9999,H3=Pn.kPageProxyMessageReceived="kPageProxyMessageReceived",Z_=class{constructor(e,t,n,s){this._transport=void 0,this._onDisconnect=void 0,this._protocolLogger=void 0,this._browserLogsCollector=void 0,this._browserDisconnectedLogs=void 0,this._lastId=0,this._closed=!1,this.browserSession=void 0,this._transport=e,this._onDisconnect=t,this._protocolLogger=n,this._browserLogsCollector=s,this.browserSession=new pd(this,"",o=>{this.rawSend(o)}),this._transport.onmessage=this._dispatchMessage.bind(this),this._transport.onclose=this._onClose.bind(this)}nextMessageId(){return++this._lastId}rawSend(e){this._protocolLogger("send",e),this._transport.send(e)}_dispatchMessage(e){if(this._protocolLogger("receive",e),e.id!==q3){if(e.pageProxyId){let t={message:e,pageProxyId:e.pageProxyId};this.browserSession.dispatchMessage({method:H3,params:t});return}this.browserSession.dispatchMessage(e)}}_onClose(e){this._closed=!0,this._transport.onmessage=void 0,this._transport.onclose=void 0,this._browserDisconnectedLogs=j3.helper.formatBrowserLogs(this._browserLogsCollector.recentLogs(),e),this.browserSession.dispose(),this._onDisconnect()}isClosed(){return this._closed}close(){this._closed||this._transport.close()}};Pn.WKConnection=Z_;var pd=class extends L3.EventEmitter{constructor(e,t,n){super(),this.connection=void 0,this.sessionId=void 0,this._disposed=!1,this._rawSend=void 0,this._callbacks=new Map,this._crashed=!1,this.on=void 0,this.addListener=void 0,this.off=void 0,this.removeListener=void 0,this.once=void 0,this.setMaxListeners(0),this.connection=e,this.sessionId=t,this._rawSend=n,this.on=super.on,this.off=super.removeListener,this.addListener=super.addListener,this.removeListener=super.removeListener,this.once=super.once}async send(e,t){if(this._crashed||this._disposed||this.connection._browserDisconnectedLogs)throw new zC.ProtocolError(this._crashed?"crashed":"closed",void 0,this.connection._browserDisconnectedLogs);let n=this.connection.nextMessageId(),s={id:n,method:e,params:t};return this._rawSend(s),new Promise((o,a)=>{this._callbacks.set(n,{resolve:o,reject:a,error:new zC.ProtocolError("error",e)})})}sendMayFail(e,t){return this.send(e,t).catch(n=>B3.debugLogger.log("error",n))}markAsCrashed(){this._crashed=!0}isDisposed(){return this._disposed}dispose(){for(let e of this._callbacks.values())e.error.type=this._crashed?"crashed":"closed",e.error.logs=this.connection._browserDisconnectedLogs,e.reject(e.error);this._callbacks.clear(),this._disposed=!0}dispatchMessage(e){if(e.id&&this._callbacks.has(e.id)){let t=this._callbacks.get(e.id);this._callbacks.delete(e.id),e.error?(t.error.setMessage(e.error.message),t.reject(t.error)):t.resolve(e.result)}else e.id&&!e.error?(0,D3.assert)(this.isDisposed()):Promise.resolve().then(()=>this.emit(e.method,e.params))}};Pn.WKSession=pd});var VC=M(tw=>{"use strict";Object.defineProperty(tw,"__esModule",{value:!0});tw.getAccessibilityTree=$3;async function $3(r,e){let t=e?e._objectId:void 0,{axNode:n}=await r.send("Page.accessibilitySnapshot",{objectId:t}),s=new ew(n);return{tree:s,needle:e?s._findNeedle():null}}var W3=new Map(Object.entries({TextField:"textbox"})),U3=new Map(Object.entries({WebArea:"HTML content",Summary:"summary",DescriptionList:"description list",ImageMap:"image map",ListMarker:"list marker",Video:"video playback",Mark:"highlighted",contentinfo:"content information",Details:"details",DescriptionListDetail:"description",DescriptionListTerm:"term",alertdialog:"web alert dialog",dialog:"web dialog",status:"application status",tabpanel:"tab panel",application:"web application"})),ew=class r{constructor(e){this._payload=void 0,this._children=void 0,this._payload=e,this._children=[];for(let t of this._payload.children||[])this._children.push(new r(t))}children(){return this._children}_findNeedle(){if(this._payload.found)return this;for(let e of this._children){let t=e._findNeedle();if(t)return t}return null}isControl(){switch(this._payload.role){case"button":case"checkbox":case"ColorWell":case"combobox":case"DisclosureTriangle":case"listbox":case"menu":case"menubar":case"menuitem":case"menuitemcheckbox":case"menuitemradio":case"radio":case"scrollbar":case"searchbox":case"slider":case"spinbutton":case"switch":case"tab":case"textbox":case"TextField":case"tree":return!0;default:return!1}}_isTextControl(){switch(this._payload.role){case"combobox":case"searchfield":case"textbox":case"TextField":return!0}return!1}_name(){return this._payload.role==="text"?this._payload.value||"":this._payload.name||""}isInteresting(e){let{role:t,focusable:n}=this._payload,s=this._name();return t==="ScrollArea"?!1:t==="WebArea"||n||t==="MenuListOption"||this.isControl()?!0:e?!1:this.isLeafNode()&&!!s}_hasRedundantTextChild(){if(this._children.length!==1)return!1;let e=this._children[0];return e._payload.role==="text"&&this._payload.name===e._payload.value}isLeafNode(){return!!(!this._children.length||this._isTextControl()||this._hasRedundantTextChild())}serialize(){let e={role:W3.get(this._payload.role)||this._payload.role,name:this._name()};if("description"in this._payload&&this._payload.description!==e.name&&(e.description=this._payload.description),"roledescription"in this._payload){let l=this._payload.roledescription;l!==this._payload.role&&U3.get(this._payload.role)!==l&&(e.roledescription=l)}"value"in this._payload&&this._payload.role!=="text"&&(typeof this._payload.value=="string"?e.valueString=this._payload.value:typeof this._payload.value=="number"&&(e.valueNumber=this._payload.value)),"checked"in this._payload&&(e.checked=this._payload.checked==="true"?"checked":this._payload.checked==="false"?"unchecked":"mixed"),"pressed"in this._payload&&(e.pressed=this._payload.pressed==="true"?"pressed":this._payload.pressed==="false"?"released":"mixed");let t=["keyshortcuts","valuetext"];for(let l of t)l in this._payload&&(e[l]=this._payload[l]);let n=["disabled","expanded","focused","modal","multiselectable","readonly","required","selected"];for(let l of n){if(l==="focused"&&(this._payload.role==="WebArea"||this._payload.role==="ScrollArea"))continue;let c=this._payload[l];c&&(e[l]=c)}let s=["level","valuemax","valuemin"];for(let l of s)l in this._payload&&(e[l]=this._payload[l]);let o=["autocomplete","haspopup","invalid"];for(let l of o){let c=this._payload[l];!c||c==="false"||(e[l]=c)}let a=new Set(["ScrollArea","scrollbar","listbox","combobox","menu","tree","separator","slider","tablist","toolbar"]);return this._payload.orientation&&a.has(this._payload.role)&&(e.orientation=this._payload.orientation),e}}});var iw=M(fd=>{"use strict";Object.defineProperty(fd,"__esModule",{value:!0});fd.WKExecutionContext=void 0;var Gn=G3(mr()),z3=Zi(),V3=Wt();function GC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(GC=function(n){return n?t:e})(r)}function G3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=GC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var rw=class{constructor(e,t){this._session=void 0,this._contextId=void 0,this._session=e,this._contextId=t}async rawEvaluateJSON(e){try{let t=await this._session.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!0});if(t.wasThrown)throw new Gn.JavaScriptErrorInEvaluate(t.result.description);return t.result.value}catch(t){throw nw(t)}}async rawEvaluateHandle(e){try{let t=await this._session.send("Runtime.evaluate",{expression:e,contextId:this._contextId,returnByValue:!1});if(t.wasThrown)throw new Gn.JavaScriptErrorInEvaluate(t.result.description);return t.result.objectId}catch(t){throw nw(t)}}rawCallFunctionNoReply(e,...t){this._session.send("Runtime.callFunctionOn",{functionDeclaration:e.toString(),objectId:t.find(n=>n instanceof Gn.JSHandle)._objectId,arguments:t.map(n=>n instanceof Gn.JSHandle?{objectId:n._objectId}:{value:n}),returnByValue:!0,emulateUserGesture:!0}).catch(()=>{})}async evaluateWithArguments(e,t,n,s,o){try{let a=await this._session.send("Runtime.callFunctionOn",{functionDeclaration:e,objectId:n._objectId,arguments:[{objectId:n._objectId},...s.map(l=>({value:l})),...o.map(l=>({objectId:l}))],returnByValue:t,emulateUserGesture:!0,awaitPromise:!0});if(a.wasThrown)throw new Gn.JavaScriptErrorInEvaluate(a.result.description);return t?(0,z3.parseEvaluationResultValue)(a.result.value):n._context.createHandle(a.result)}catch(a){throw nw(a)}}async getProperties(e,t){let n=await this._session.send("Runtime.getProperties",{objectId:t,ownProperties:!0}),s=new Map;for(let o of n.properties)!o.enumerable||!o.value||s.set(o.name,e.createHandle(o.value));return s}createHandle(e,t){let n=t.className==="Promise";return new Gn.JSHandle(e,n?"promise":t.subtype||t.type,J3(t),t.objectId,K3(t))}async releaseHandle(e){await this._session.send("Runtime.releaseObject",{objectId:e})}objectCount(e){throw new Error("Method not implemented in WebKit.")}};fd.WKExecutionContext=rw;function K3(r){let e=r.value;return r.type==="number"&&["NaN","-Infinity","Infinity","-0"].includes(r.description)?Gn.parseUnserializableValue(r.description):e}function nw(r){return!Gn.isJavaScriptErrorInEvaluate(r)&&!(0,V3.isSessionClosedError)(r)?new Error("Execution context was destroyed, most likely because of a navigation."):r}function J3(r){if(r.type==="undefined")return"undefined";if("value"in r)return String(r.value);if(r.description==="Object"&&r.preview){let e=[];for(let{name:t,value:n}of r.preview.properties)e.push(`${t}: ${n}`);return`{${e.join(", ")}}`}return r.subtype==="array"&&r.preview?Gn.sparseArrayToString(r.preview.properties):r.description}});var XC=M(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.RawTouchscreenImpl=Cr.RawMouseImpl=Cr.RawKeyboardImpl=void 0;var KC=Q3(Wc()),X3=qg(),Y3=ie();function JC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(JC=function(n){return n?t:e})(r)}function Q3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=JC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function pi(r){let e=0;return r.has("Shift")&&(e|=1),r.has("Control")&&(e|=2),r.has("Alt")&&(e|=4),r.has("Meta")&&(e|=8),e}function sw(r){let e=0;return r.has("left")&&(e|=1),r.has("right")&&(e|=2),r.has("middle")&&(e|=4),e}var ow=class{constructor(e){this._pageProxySession=void 0,this._session=void 0,this._pageProxySession=e}setSession(e){this._session=e}async keydown(e,t,n,s,o,a,l,c){let u=[];for(let p of["Shift","Control","Alt","Meta"])e.has(p)&&u.push(p);u.push(t);let d=u.join("+"),h=X3.macEditingCommands[d];(0,Y3.isString)(h)&&(h=[h]),await this._pageProxySession.send("Input.dispatchKeyEvent",{type:"keyDown",modifiers:pi(e),windowsVirtualKeyCode:n,code:t,key:o,text:c,unmodifiedText:c,autoRepeat:l,macCommands:h,isKeypad:a===KC.keypadLocation})}async keyup(e,t,n,s,o,a){await this._pageProxySession.send("Input.dispatchKeyEvent",{type:"keyUp",modifiers:pi(e),key:o,windowsVirtualKeyCode:n,code:t,isKeypad:a===KC.keypadLocation})}async sendText(e){await this._session.send("Page.insertText",{text:e})}};Cr.RawKeyboardImpl=ow;var aw=class{constructor(e){this._pageProxySession=void 0,this._session=void 0,this._page=void 0,this._pageProxySession=e}setSession(e){this._session=e}async move(e,t,n,s,o,a){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"move",button:n,buttons:sw(s),x:e,y:t,modifiers:pi(o)})}async down(e,t,n,s,o,a){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"down",button:n,buttons:sw(s),x:e,y:t,modifiers:pi(o),clickCount:a})}async up(e,t,n,s,o,a){await this._pageProxySession.send("Input.dispatchMouseEvent",{type:"up",button:n,buttons:sw(s),x:e,y:t,modifiers:pi(o),clickCount:a})}async wheel(e,t,n,s,o,a){var l;if((l=this._page)!==null&&l!==void 0&&l._browserContext._options.isMobile)throw new Error("Mouse wheel is not supported in mobile WebKit");await this._session.send("Page.updateScrollingState"),await this._page.mainFrame().evaluateExpression("new Promise(requestAnimationFrame)",{world:"utility"}),await this._pageProxySession.send("Input.dispatchWheelEvent",{x:e,y:t,deltaX:o,deltaY:a,modifiers:pi(s)})}setPage(e){this._page=e}};Cr.RawMouseImpl=aw;var lw=class{constructor(e){this._pageProxySession=void 0,this._pageProxySession=e}async tap(e,t,n){await this._pageProxySession.send("Input.dispatchTapEvent",{x:e,y:t,modifiers:pi(n)})}};Cr.RawTouchscreenImpl=lw});var QC=M(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.WKRouteImpl=Cs.WKInterceptableRequest=void 0;var cw=Z3(Ct()),ks=ie();function YC(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(YC=function(n){return n?t:e})(r)}function Z3(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=YC(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var e4={aborted:"Cancellation",accessdenied:"AccessControl",addressunreachable:"General",blockedbyclient:"Cancellation",blockedbyresponse:"General",connectionaborted:"General",connectionclosed:"General",connectionfailed:"General",connectionrefused:"General",connectionreset:"General",internetdisconnected:"General",namenotresolved:"General",timedout:"Timeout",failed:"General"},uw=class{constructor(e,t,n,s,o){this._session=void 0,this.request=void 0,this._requestId=void 0,this._timestamp=void 0,this._wallTime=void 0,this._session=e,this._requestId=n.requestId;let a=n.type?n.type.toLowerCase():s?s.request.resourceType():"other",l=null;this._timestamp=n.timestamp,this._wallTime=n.walltime*1e3,n.request.postData&&(l=Buffer.from(n.request.postData,"base64")),this.request=new cw.Request(t._page._browserContext,t,null,s?.request||null,o,n.request.url,a,n.request.method,l,(0,ks.headersObjectToArray)(n.request.headers))}createResponse(e){let t=async()=>{let l=await this._session.send("Network.getResponseBody",{requestId:this._requestId});return Buffer.from(l.body,l.base64Encoded?"base64":"utf8")},n=e.timing,s={startTime:this._wallTime,domainLookupStart:n?fi(n.domainLookupStart):-1,domainLookupEnd:n?fi(n.domainLookupEnd):-1,connectStart:n?fi(n.connectStart):-1,secureConnectionStart:n?fi(n.secureConnectionStart):-1,connectEnd:n?fi(n.connectEnd):-1,requestStart:n?fi(n.requestStart):-1,responseStart:n?fi(n.responseStart):-1},o=process.platform==="darwin"?",":`
`,a=new cw.Response(this.request,e.status,e.statusText,(0,ks.headersObjectToArray)(e.headers,",",o),s,t,e.source==="service-worker");if(a.setRawResponseHeaders(null),a.setTransferSize(null),e.requestHeaders&&Object.keys(e.requestHeaders).length){let l={...e.requestHeaders};l.host||(l.Host=new URL(this.request.url()).host),this.request.setRawRequestHeaders((0,ks.headersObjectToArray)(l))}else this.request.setRawRequestHeaders(null);return a}};Cs.WKInterceptableRequest=uw;var dw=class{constructor(e,t){this._session=void 0,this._requestId=void 0,this._session=e,this._requestId=t}async abort(e){let t=e4[e];(0,ks.assert)(t,"Unknown error code: "+e),await this._session.sendMayFail("Network.interceptRequestWithError",{requestId:this._requestId,errorType:t})}async fulfill(e){if(300<=e.status&&e.status<400)throw new Error("Cannot fulfill with redirect status: "+e.status);let t=e.isBase64?"application/octet-stream":"text/plain",n=(0,ks.headersArrayToObject)(e.headers,!0),s=n["content-type"];s&&(t=s.split(";")[0].trim()),await this._session.sendMayFail("Network.interceptRequestWithResponse",{requestId:this._requestId,status:e.status,statusText:cw.STATUS_TEXTS[String(e.status)],mimeType:t,headers:n,base64Encoded:e.isBase64,content:e.body})}async continue(e,t){await this._session.sendMayFail("Network.interceptWithRequest",{requestId:this._requestId,url:t.url,method:t.method,headers:t.headers?(0,ks.headersArrayToObject)(t.headers,!1):void 0,postData:t.postData?Buffer.from(t.postData).toString("base64"):void 0})}};Cs.WKRouteImpl=dw;function fi(r){return r===-1e3||r<=0?-1:(r*1e3|0)/1e3}});var e1=M(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.WKProvisionalPage=void 0;var Ts=Ze(),ZC=ie(),hw=class{constructor(e,t){this._session=void 0,this._wkPage=void 0,this._sessionListeners=[],this._mainFrameId=null,this.initializationPromise=void 0,this._session=e,this._wkPage=t;let n=o=>a=>{a.frameId&&(a.frameId=this._wkPage._page._frameManager.mainFrame()._id),o(a)},s=this._wkPage;this._sessionListeners=[Ts.eventsHelper.addEventListener(e,"Network.requestWillBeSent",n(o=>s._onRequestWillBeSent(e,o))),Ts.eventsHelper.addEventListener(e,"Network.requestIntercepted",n(o=>s._onRequestIntercepted(e,o))),Ts.eventsHelper.addEventListener(e,"Network.responseReceived",n(o=>s._onResponseReceived(e,o))),Ts.eventsHelper.addEventListener(e,"Network.loadingFinished",n(o=>s._onLoadingFinished(o))),Ts.eventsHelper.addEventListener(e,"Network.loadingFailed",n(o=>s._onLoadingFailed(e,o)))],this.initializationPromise=this._wkPage._initializeSession(e,!0,({frameTree:o})=>this._handleFrameTree(o))}dispose(){Ts.eventsHelper.removeEventListeners(this._sessionListeners)}commit(){(0,ZC.assert)(this._mainFrameId),this._wkPage._onFrameAttached(this._mainFrameId,null)}_handleFrameTree(e){(0,ZC.assert)(!e.frame.parentId),this._mainFrameId=e.frame.id}};md.WKProvisionalPage=hw});var t1=M(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});_d.WKWorkers=void 0;var gd=Ze(),t4=Et(),n4=fa(),r4=iw(),pw=class{constructor(e){this._sessionListeners=[],this._page=void 0,this._workerSessions=new Map,this._page=e}setSession(e){gd.eventsHelper.removeEventListeners(this._sessionListeners),this.clear(),this._sessionListeners=[gd.eventsHelper.addEventListener(e,"Worker.workerCreated",t=>{let n=new t4.Worker(this._page,t.url),s=new n4.WKSession(e.connection,t.workerId,o=>{e.send("Worker.sendMessageToWorker",{workerId:t.workerId,message:JSON.stringify(o)}).catch(a=>{s.dispatchMessage({id:o.id,error:{message:a.message}})})});this._workerSessions.set(t.workerId,s),n._createExecutionContext(new r4.WKExecutionContext(s,void 0)),this._page._addWorker(t.workerId,n),s.on("Console.messageAdded",o=>this._onConsoleMessage(n,o)),Promise.all([s.send("Runtime.enable"),s.send("Console.enable"),e.send("Worker.initialized",{workerId:t.workerId})]).catch(o=>{this._page._removeWorker(t.workerId)})}),gd.eventsHelper.addEventListener(e,"Worker.dispatchMessageFromWorker",t=>{let n=this._workerSessions.get(t.workerId);n&&n.dispatchMessage(JSON.parse(t.message))}),gd.eventsHelper.addEventListener(e,"Worker.workerTerminated",t=>{let n=this._workerSessions.get(t.workerId);n&&(n.dispose(),this._workerSessions.delete(t.workerId),this._page._removeWorker(t.workerId))})]}clear(){this._page._clearWorkers(),this._workerSessions.clear()}async initializeSession(e){await e.send("Worker.enable")}async _onConsoleMessage(e,t){let{type:n,level:s,text:o,parameters:a,url:l,line:c,column:u}=t.message,d=n||"";n==="log"?d=s:n==="timing"&&(d="timeEnd");let h=(a||[]).map(f=>e._existingExecutionContext.createHandle(f)),p={url:l||"",lineNumber:(c||1)-1,columnNumber:(u||1)-1};this._page._addConsoleMessage(d,h,p,h.length?void 0:o)}};_d.WKWorkers=pw});var u1=M(vd=>{"use strict";Object.defineProperty(vd,"__esModule",{value:!0});vd.WKPage=void 0;var i4=m4(require("path")),n1=Be(),s4=Lt(),Vt=ie(),o4=go(),a4=_w(Eu()),r1=_w(Bo()),Te=Ze(),wd=yt(),i1=_w(Ct()),Os=Et(),l4=VC(),c4=fa(),u4=iw(),fw=XC(),s1=QC(),d4=e1(),h4=t1(),p4=Le(),f4=Qe(),o1=$e(),a1=Bt();function c1(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(c1=function(n){return n?t:e})(r)}function _w(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=c1(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function m4(r){return r&&r.__esModule?r:{default:r}}var l1="__playwright_utility_world__",gw=class r{constructor(e,t,n){if(this.rawMouse=void 0,this.rawKeyboard=void 0,this.rawTouchscreen=void 0,this._session=void 0,this._provisionalPage=null,this._page=void 0,this._pagePromise=new f4.ManualPromise,this._pageProxySession=void 0,this._opener=void 0,this._requestIdToRequest=new Map,this._requestIdToRequestWillBeSentEvent=new Map,this._workers=void 0,this._contextIdToContext=void 0,this._sessionListeners=[],this._eventListeners=void 0,this._browserContext=void 0,this._initializedPage=null,this._firstNonInitialNavigationCommittedPromise=void 0,this._firstNonInitialNavigationCommittedFulfill=()=>{},this._firstNonInitialNavigationCommittedReject=s=>{},this._lastConsoleMessage=null,this._requestIdToResponseReceivedPayloadEvent=new Map,this._nextWindowOpenPopupFeatures=void 0,this._recordingVideoFile=null,this._screencastGeneration=0,this._pageProxySession=t,this._opener=n,this.rawKeyboard=new fw.RawKeyboardImpl(t),this.rawMouse=new fw.RawMouseImpl(t),this.rawTouchscreen=new fw.RawTouchscreenImpl(t),this._contextIdToContext=new Map,this._page=new Os.Page(this,e),this.rawMouse.setPage(this._page),this._workers=new h4.WKWorkers(this._page),this._session=void 0,this._browserContext=e,this._page.on(Os.Page.Events.FrameDetached,s=>this._removeContextsForFrame(s,!1)),this._eventListeners=[Te.eventsHelper.addEventListener(this._pageProxySession,"Target.targetCreated",this._onTargetCreated.bind(this)),Te.eventsHelper.addEventListener(this._pageProxySession,"Target.targetDestroyed",this._onTargetDestroyed.bind(this)),Te.eventsHelper.addEventListener(this._pageProxySession,"Target.dispatchMessageFromTarget",this._onDispatchMessageFromTarget.bind(this)),Te.eventsHelper.addEventListener(this._pageProxySession,"Target.didCommitProvisionalTarget",this._onDidCommitProvisionalTarget.bind(this)),Te.eventsHelper.addEventListener(this._pageProxySession,"Screencast.screencastFrame",this._onScreencastFrame.bind(this))],this._firstNonInitialNavigationCommittedPromise=new Promise((s,o)=>{this._firstNonInitialNavigationCommittedFulfill=s,this._firstNonInitialNavigationCommittedReject=o}),n&&!e._options.noDefaultViewport&&n._nextWindowOpenPopupFeatures){let s=wd.helper.getViewportSizeFromWindowFeatures(n._nextWindowOpenPopupFeatures);n._nextWindowOpenPopupFeatures=void 0,s&&(this._page._emulatedSize={viewport:s,screen:s})}}potentiallyUninitializedPage(){return this._page}async _initializePageProxySession(){if(this._page._browserContext.isSettingStorageState())return;let e=[this._pageProxySession.send("Dialog.enable"),this._pageProxySession.send("Emulation.setActiveAndFocused",{active:!0})];if(this._browserContext._options.javaScriptEnabled===!1&&e.push(this._pageProxySession.send("Emulation.setJavaScriptEnabled",{enabled:!1})),e.push(this._updateViewport()),e.push(this.updateHttpCredentials()),this._browserContext._permissions.size)for(let[n,s]of this._browserContext._permissions)e.push(this._grantPermissions(n,s));if(this._browserContext._options.recordVideo){let n=i4.default.join(this._browserContext._options.recordVideo.dir,(0,Vt.createGuid)()+".webm");e.push(this._browserContext._ensureVideosPath().then(()=>this._startVideo({...this._browserContext._options.recordVideo.size,outputFile:n})))}await Promise.all(e)}_setSession(e){Te.eventsHelper.removeEventListeners(this._sessionListeners),this._session=e,this.rawKeyboard.setSession(e),this.rawMouse.setSession(e),this._addSessionListeners(),this._workers.setSession(e)}async _initializeSession(e,t,n){await this._initializeSessionMayThrow(e,n).catch(s=>{if(!(t&&e.isDisposed())&&this._session===e)throw s})}async _initializeSessionMayThrow(e,t){let[,n]=await Promise.all([e.send("Page.enable"),e.send("Page.getResourceTree")]);t(n);let s=[e.send("Runtime.enable"),e.send("Page.createUserWorld",{name:l1}).catch(u=>{}),e.send("Console.enable"),e.send("Network.enable"),this._workers.initializeSession(e)];if(this._page.needsRequestInterception()&&(s.push(e.send("Network.setInterceptionEnabled",{enabled:!0})),s.push(e.send("Network.setResourceCachingDisabled",{disabled:!0})),s.push(e.send("Network.addInterception",{url:".*",stage:"request",isRegex:!0}))),this._page._browserContext.isSettingStorageState()){await Promise.all(s);return}let o=this._browserContext._options;o.userAgent&&s.push(this.updateUserAgent());let a=this._page.emulatedMedia();(a.media||a.colorScheme||a.reducedMotion||a.forcedColors)&&s.push(r._setEmulateMedia(e,a.media,a.colorScheme,a.reducedMotion,a.forcedColors));for(let u of this._page.allBindings())s.push(e.send("Runtime.addBinding",{name:u.name}));let l=this._calculateBootstrapScript();l.length&&s.push(e.send("Page.setBootstrapScript",{source:l})),this._page.frames().map(u=>u.evaluateExpression(l).catch(d=>{})),o.bypassCSP&&s.push(e.send("Page.setBypassCSP",{enabled:!0}));let c=this._page.emulatedSize();c&&s.push(e.send("Page.setScreenSizeOverride",{width:c.screen.width,height:c.screen.height})),s.push(this.updateEmulateMedia()),s.push(e.send("Network.setExtraHTTPHeaders",{headers:(0,Vt.headersArrayToObject)(this._calculateExtraHTTPHeaders(),!1)})),o.offline&&s.push(e.send("Network.setEmulateOfflineState",{offline:!0})),s.push(e.send("Page.setTouchEmulationEnabled",{enabled:!!o.hasTouch})),o.timezoneId&&s.push(e.send("Page.setTimeZone",{timeZone:o.timezoneId}).catch(u=>{throw new Error(`Invalid timezone ID: ${o.timezoneId}`)})),this._page.fileChooserIntercepted()&&s.push(e.send("Page.setInterceptFileChooserDialog",{enabled:!0})),s.push(e.send("Page.overrideSetting",{setting:"DeviceOrientationEventEnabled",value:o.isMobile})),s.push(e.send("Page.overrideSetting",{setting:"FullScreenEnabled",value:!o.isMobile})),s.push(e.send("Page.overrideSetting",{setting:"NotificationsEnabled",value:!o.isMobile})),s.push(e.send("Page.overrideSetting",{setting:"PointerLockEnabled",value:!o.isMobile})),s.push(e.send("Page.overrideSetting",{setting:"InputTypeMonthEnabled",value:o.isMobile})),s.push(e.send("Page.overrideSetting",{setting:"InputTypeWeekEnabled",value:o.isMobile})),await Promise.all(s)}_onDidCommitProvisionalTarget(e){let{oldTargetId:t,newTargetId:n}=e;(0,Vt.assert)(this._provisionalPage),(0,Vt.assert)(this._provisionalPage._session.sessionId===n,"Unknown new target: "+n),(0,Vt.assert)(this._session.sessionId===t,"Unknown old target: "+t);let s=this._provisionalPage._session;this._provisionalPage.commit(),this._provisionalPage.dispose(),this._provisionalPage=null,this._setSession(s)}_onTargetDestroyed(e){let{targetId:t,crashed:n}=e;this._provisionalPage&&this._provisionalPage._session.sessionId===t?(this._provisionalPage._session.dispose(),this._provisionalPage.dispose(),this._provisionalPage=null):this._session.sessionId===t&&(this._session.dispose(),Te.eventsHelper.removeEventListeners(this._sessionListeners),n&&(this._session.markAsCrashed(),this._page._didCrash()))}didClose(){this._pageProxySession.dispose(),Te.eventsHelper.removeEventListeners(this._sessionListeners),Te.eventsHelper.removeEventListeners(this._eventListeners),this._session&&this._session.dispose(),this._provisionalPage&&(this._provisionalPage._session.dispose(),this._provisionalPage.dispose(),this._provisionalPage=null),this._firstNonInitialNavigationCommittedReject(new a1.TargetClosedError),this._page._didClose()}dispatchMessageToSession(e){this._pageProxySession.dispatchMessage(e)}handleProvisionalLoadFailed(e){if(!this._initializedPage){this._firstNonInitialNavigationCommittedReject(new Error("Initial load failed"));return}if(!this._provisionalPage)return;let t=e.error;t.includes("cancelled")&&(t+="; maybe frame was detached?"),this._page._frameManager.frameAbortedNavigation(this._page.mainFrame()._id,t,e.loaderId)}handleWindowOpen(e){(0,Vt.debugAssert)(!this._nextWindowOpenPopupFeatures),this._nextWindowOpenPopupFeatures=e.windowFeatures}async pageOrError(){return this._pagePromise}async _onTargetCreated(e){let{targetInfo:t}=e,n=new c4.WKSession(this._pageProxySession.connection,t.targetId,s=>{this._pageProxySession.send("Target.sendMessageToTarget",{message:JSON.stringify(s),targetId:t.targetId}).catch(o=>{n.dispatchMessage({id:s.id,error:{message:o.message}})})});if((0,Vt.assert)(t.type==="page","Only page targets are expected in WebKit, received: "+t.type),t.isProvisional)(0,Vt.assert)(t.isProvisional),(0,Vt.assert)(!this._provisionalPage),this._provisionalPage=new d4.WKProvisionalPage(n,this),t.isPaused&&this._provisionalPage.initializationPromise.then(()=>{this._pageProxySession.sendMayFail("Target.resume",{targetId:t.targetId})});else{(0,Vt.assert)(!this._initializedPage);let s;try{this._setSession(n),await Promise.all([this._initializePageProxySession(),this._initializeSession(n,!1,({frameTree:o})=>this._handleFrameTree(o))]),s=this._page}catch(o){s=o}if(t.isPaused&&this._pageProxySession.sendMayFail("Target.resume",{targetId:t.targetId}),s instanceof Os.Page&&this._page.mainFrame().url()==="")try{await this._firstNonInitialNavigationCommittedPromise}catch(o){s=o}else this._firstNonInitialNavigationCommittedPromise.catch(()=>{});await this._page.initOpener(this._opener),this._initializedPage=s instanceof Os.Page?s:null,this._page.reportAsNew(s instanceof Os.Page?void 0:s),this._pagePromise.resolve(s)}}_onDispatchMessageFromTarget(e){let{targetId:t,message:n}=e;if(this._provisionalPage&&this._provisionalPage._session.sessionId===t)this._provisionalPage._session.dispatchMessage(JSON.parse(n));else if(this._session.sessionId===t)this._session.dispatchMessage(JSON.parse(n));else throw new Error("Unknown target: "+t)}_addSessionListeners(){this._sessionListeners=[Te.eventsHelper.addEventListener(this._session,"Page.frameNavigated",e=>this._onFrameNavigated(e.frame,!1)),Te.eventsHelper.addEventListener(this._session,"Page.navigatedWithinDocument",e=>this._onFrameNavigatedWithinDocument(e.frameId,e.url)),Te.eventsHelper.addEventListener(this._session,"Page.frameAttached",e=>this._onFrameAttached(e.frameId,e.parentFrameId)),Te.eventsHelper.addEventListener(this._session,"Page.frameDetached",e=>this._onFrameDetached(e.frameId)),Te.eventsHelper.addEventListener(this._session,"Page.willCheckNavigationPolicy",e=>this._onWillCheckNavigationPolicy(e.frameId)),Te.eventsHelper.addEventListener(this._session,"Page.didCheckNavigationPolicy",e=>this._onDidCheckNavigationPolicy(e.frameId,e.cancel)),Te.eventsHelper.addEventListener(this._session,"Page.frameScheduledNavigation",e=>this._onFrameScheduledNavigation(e.frameId,e.delay,e.targetIsCurrentFrame)),Te.eventsHelper.addEventListener(this._session,"Page.loadEventFired",e=>this._page._frameManager.frameLifecycleEvent(e.frameId,"load")),Te.eventsHelper.addEventListener(this._session,"Page.domContentEventFired",e=>this._page._frameManager.frameLifecycleEvent(e.frameId,"domcontentloaded")),Te.eventsHelper.addEventListener(this._session,"Runtime.executionContextCreated",e=>this._onExecutionContextCreated(e.context)),Te.eventsHelper.addEventListener(this._session,"Runtime.bindingCalled",e=>this._onBindingCalled(e.contextId,e.argument)),Te.eventsHelper.addEventListener(this._session,"Console.messageAdded",e=>this._onConsoleMessage(e)),Te.eventsHelper.addEventListener(this._session,"Console.messageRepeatCountUpdated",e=>this._onConsoleRepeatCountUpdated(e)),Te.eventsHelper.addEventListener(this._pageProxySession,"Dialog.javascriptDialogOpening",e=>this._onDialog(e)),Te.eventsHelper.addEventListener(this._session,"Page.fileChooserOpened",e=>this._onFileChooserOpened(e)),Te.eventsHelper.addEventListener(this._session,"Network.requestWillBeSent",e=>this._onRequestWillBeSent(this._session,e)),Te.eventsHelper.addEventListener(this._session,"Network.requestIntercepted",e=>this._onRequestIntercepted(this._session,e)),Te.eventsHelper.addEventListener(this._session,"Network.responseReceived",e=>this._onResponseReceived(this._session,e)),Te.eventsHelper.addEventListener(this._session,"Network.loadingFinished",e=>this._onLoadingFinished(e)),Te.eventsHelper.addEventListener(this._session,"Network.loadingFailed",e=>this._onLoadingFailed(this._session,e)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketCreated",e=>this._page._frameManager.onWebSocketCreated(e.requestId,e.url)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketWillSendHandshakeRequest",e=>this._page._frameManager.onWebSocketRequest(e.requestId)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketHandshakeResponseReceived",e=>this._page._frameManager.onWebSocketResponse(e.requestId,e.response.status,e.response.statusText)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketFrameSent",e=>e.response.payloadData&&this._page._frameManager.onWebSocketFrameSent(e.requestId,e.response.opcode,e.response.payloadData)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketFrameReceived",e=>e.response.payloadData&&this._page._frameManager.webSocketFrameReceived(e.requestId,e.response.opcode,e.response.payloadData)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketClosed",e=>this._page._frameManager.webSocketClosed(e.requestId)),Te.eventsHelper.addEventListener(this._session,"Network.webSocketFrameError",e=>this._page._frameManager.webSocketError(e.requestId,e.errorMessage))]}async _updateState(e,t){await this._forAllSessions(n=>n.send(e,t).then())}async _forAllSessions(e){let t=[this._session];this._provisionalPage&&t.push(this._provisionalPage._session),await Promise.all(t.map(n=>e(n).catch(s=>{})))}_onWillCheckNavigationPolicy(e){this._provisionalPage||this._page._frameManager.frameRequestedNavigation(e)}_onDidCheckNavigationPolicy(e,t){t&&(this._provisionalPage||this._page._frameManager.frameAbortedNavigation(e,"Navigation canceled by policy check"))}_onFrameScheduledNavigation(e,t,n){n&&this._page._frameManager.frameRequestedNavigation(e)}_handleFrameTree(e){if(this._onFrameAttached(e.frame.id,e.frame.parentId||null),this._onFrameNavigated(e.frame,!0),this._page._frameManager.frameLifecycleEvent(e.frame.id,"domcontentloaded"),this._page._frameManager.frameLifecycleEvent(e.frame.id,"load"),!!e.childFrames)for(let t of e.childFrames)this._handleFrameTree(t)}_onFrameAttached(e,t){return this._page._frameManager.frameAttached(e,t)}_onFrameNavigated(e,t){let n=this._page._frameManager.frame(e.id);(0,Vt.assert)(n),this._removeContextsForFrame(n,!0),e.parentId||this._workers.clear(),this._page._frameManager.frameCommittedNewDocumentNavigation(e.id,e.url,e.name||"",e.loaderId,t),t||this._firstNonInitialNavigationCommittedFulfill()}_onFrameNavigatedWithinDocument(e,t){this._page._frameManager.frameCommittedSameDocumentNavigation(e,t)}_onFrameDetached(e){this._page._frameManager.frameDetached(e)}_removeContextsForFrame(e,t){for(let[n,s]of this._contextIdToContext)s.frame===e&&(this._contextIdToContext.delete(n),t&&e._contextDestroyed(s))}_onExecutionContextCreated(e){if(this._contextIdToContext.has(e.id))return;let t=this._page._frameManager.frame(e.frameId);if(!t)return;let n=new u4.WKExecutionContext(this._session,e.id),s=null;e.type==="normal"?s="main":e.type==="user"&&e.name===l1&&(s="utility");let o=new r1.FrameExecutionContext(n,t,s);o[mw]=n,s&&t._contextCreated(s,o),this._contextIdToContext.set(e.id,o)}async _onBindingCalled(e,t){if(!(await this.pageOrError()instanceof Error)){let s=this._contextIdToContext.get(e);s&&await this._page._onBindingCalled(t,s)}}async navigateFrame(e,t,n){if(this._pageProxySession.isDisposed())throw new a1.TargetClosedError;let s=this._pageProxySession.sessionId;return{newDocumentId:(await this._pageProxySession.connection.browserSession.send("Playwright.navigate",{url:t,pageProxyId:s,frameId:e._id,referrer:n})).loaderId}}_onConsoleMessage(e){let{type:t,level:n,text:s,parameters:o,url:a,line:l,column:c,source:u}=e.message;if(n==="error"&&u==="javascript"){let{name:p,message:f}=(0,s4.splitErrorMessage)(s),_;e.message.stackTrace?_=s+`
`+e.message.stackTrace.callFrames.map(w=>`    at ${w.functionName||"unknown"} (${w.url}:${w.lineNumber}:${w.columnNumber})`).join(`
`):_="",this._lastConsoleMessage=null;let v=new Error(f);v.stack=_,v.name=p,this._page.emitOnContextOnceInitialized(o1.BrowserContext.Events.PageError,v,this._page);return}let d=t||"";t==="log"?d=n:t==="timing"&&(d="timeEnd");let h=[];for(let p of o||[]){let f;if(p.objectId){let _=JSON.parse(p.objectId);f=this._contextIdToContext.get(_.injectedScriptId)}else f=[...this._contextIdToContext.values()].find(_=>_.frame===this._page.mainFrame());if(!f)return;h.push(f.createHandle(p))}this._lastConsoleMessage={derivedType:d,text:s,handles:h,count:0,location:{url:a||"",lineNumber:(l||1)-1,columnNumber:(c||1)-1}},this._onConsoleRepeatCountUpdated({count:1})}_onConsoleRepeatCountUpdated(e){if(this._lastConsoleMessage){let{derivedType:t,text:n,handles:s,count:o,location:a}=this._lastConsoleMessage;for(let l=o;l<e.count;++l)this._page._addConsoleMessage(t,s,a,s.length?void 0:n);this._lastConsoleMessage.count=e.count}}_onDialog(e){this._page.emitOnContext(o1.BrowserContext.Events.Dialog,new a4.Dialog(this._page,e.type,e.message,async(t,n)=>{await this._pageProxySession.send("Dialog.handleJavaScriptDialog",{accept:t,promptText:n})},e.defaultPrompt))}async _onFileChooserOpened(e){let t;try{t=(await this._page._frameManager.frame(e.frameId)._mainContext()).createHandle(e.element).asElement()}catch{return}await this._page._onFileChooserOpened(t)}static async _setEmulateMedia(e,t,n,s,o){let a=[];a.push(e.send("Page.setEmulatedMedia",{media:t==="no-override"?"":t}));let l;switch(n){case"light":l="Light";break;case"dark":l="Dark";break;case"no-override":l=void 0;break}a.push(e.send("Page.overrideUserPreference",{name:"PrefersColorScheme",value:l}));let c;switch(s){case"reduce":c="Reduce";break;case"no-preference":c="NoPreference";break;case"no-override":c=void 0;break}a.push(e.send("Page.overrideUserPreference",{name:"PrefersReducedMotion",value:c}));let u;switch(o){case"active":u="Active";break;case"none":u="None";break;case"no-override":u=void 0;break}a.push(e.send("Page.setForcedColors",{forcedColors:u})),await Promise.all(a)}async updateExtraHTTPHeaders(){await this._updateState("Network.setExtraHTTPHeaders",{headers:(0,Vt.headersArrayToObject)(this._calculateExtraHTTPHeaders(),!1)})}_calculateExtraHTTPHeaders(){let e=this._browserContext._options.locale;return i1.mergeHeaders([this._browserContext._options.extraHTTPHeaders,this._page.extraHTTPHeaders(),e?i1.singleHeader("Accept-Language",e):void 0])}async updateEmulateMedia(){let e=this._page.emulatedMedia(),t=e.colorScheme,n=e.reducedMotion,s=e.forcedColors;await this._forAllSessions(o=>r._setEmulateMedia(o,e.media,t,n,s))}async updateEmulatedViewportSize(){this._browserContext._validateEmulatedViewport(this._page.viewportSize()),await this._updateViewport()}async updateUserAgent(){let e=this._browserContext._options;this._updateState("Page.overrideUserAgent",{value:e.userAgent})}async bringToFront(){this._pageProxySession.send("Target.activate",{targetId:this._session.sessionId})}async _updateViewport(){let e=this._browserContext._options,t=this._page.emulatedSize();if(t===null)return;let n=t.viewport,s=t.screen,o=[this._pageProxySession.send("Emulation.setDeviceMetricsOverride",{width:n.width,height:n.height,fixedLayout:!!e.isMobile,deviceScaleFactor:e.deviceScaleFactor||1}),this._session.send("Page.setScreenSizeOverride",{width:s.width,height:s.height})];if(e.isMobile){let a=n.width>n.height?90:0;o.push(this._session.send("Page.setOrientationOverride",{angle:a}))}await Promise.all(o)}async updateRequestInterception(){let e=this._page.needsRequestInterception();await Promise.all([this._updateState("Network.setInterceptionEnabled",{enabled:e}),this._updateState("Network.setResourceCachingDisabled",{disabled:e}),this._updateState("Network.addInterception",{url:".*",stage:"request",isRegex:!0})])}async updateOffline(){await this._updateState("Network.setEmulateOfflineState",{offline:!!this._browserContext._options.offline})}async updateHttpCredentials(){let e=this._browserContext._options.httpCredentials||{username:"",password:"",origin:""};await this._pageProxySession.send("Emulation.setAuthCredentials",{username:e.username,password:e.password,origin:e.origin})}async updateFileChooserInterception(){let e=this._page.fileChooserIntercepted();await this._session.send("Page.setInterceptFileChooserDialog",{enabled:e}).catch(()=>{})}async reload(){await this._session.send("Page.reload")}goBack(){return this._session.send("Page.goBack").then(()=>!0).catch(e=>{if(e instanceof Error&&e.message.includes("Protocol error (Page.goBack): Failed to go"))return!1;throw e})}goForward(){return this._session.send("Page.goForward").then(()=>!0).catch(e=>{if(e instanceof Error&&e.message.includes("Protocol error (Page.goForward): Failed to go"))return!1;throw e})}async exposeBinding(e){this._session.send("Runtime.addBinding",{name:e.name}),await this._updateBootstrapScript(),await Promise.all(this._page.frames().map(t=>t.evaluateExpression(e.source).catch(n=>{})))}async removeExposedBindings(){await this._updateBootstrapScript()}async addInitScript(e){await this._updateBootstrapScript()}async removeInitScripts(){await this._updateBootstrapScript()}_calculateBootstrapScript(){let e=[];this._page.context()._options.isMobile||(e.push("delete window.orientation"),e.push("delete window.ondevicemotion"),e.push("delete window.ondeviceorientation")),e.push('if (!window.safari) window.safari = { pushNotification: { toString() { return "[object SafariRemoteNotification]"; } } };'),e.push("if (!window.GestureEvent) window.GestureEvent = function GestureEvent() {};");for(let t of this._page.allBindings())e.push(t.source);return e.push(...this._browserContext.initScripts),e.push(...this._page.initScripts),e.join(`;
`)}async _updateBootstrapScript(){await this._updateState("Page.setBootstrapScript",{source:this._calculateBootstrapScript()})}async closePage(e){await this._stopVideo(),await this._pageProxySession.sendMayFail("Target.close",{targetId:this._session.sessionId,runBeforeUnload:e})}async setBackgroundColor(e){await this._session.send("Page.setDefaultBackgroundColorOverride",{color:e})}_toolbarHeight(){var e;return(e=this._page._browserContext._browser)!==null&&e!==void 0&&e.options.headful?o4.hostPlatform==="mac10.15"?55:59:0}async _startVideo(e){(0,Vt.assert)(!this._recordingVideoFile);let{screencastId:t}=await this._pageProxySession.send("Screencast.startVideo",{file:e.outputFile,width:e.width,height:e.height,toolbarHeight:this._toolbarHeight()});this._recordingVideoFile=e.outputFile,this._browserContext._browser._videoStarted(this._browserContext,t,e.outputFile,this.pageOrError())}async _stopVideo(){this._recordingVideoFile&&(await this._pageProxySession.sendMayFail("Screencast.stopVideo"),this._recordingVideoFile=null)}validateScreenshotDimension(e,t){if(process.platform!=="darwin"&&(!t&&this._page._browserContext._options.deviceScaleFactor&&(e=Math.ceil(e*this._page._browserContext._options.deviceScaleFactor)),e>32767))throw new Error("Cannot take screenshot larger than 32767 pixels on any dimension")}async takeScreenshot(e,t,n,s,o,a,l){let c=n||s,u=l==="css";this.validateScreenshotDimension(c.width,u),this.validateScreenshotDimension(c.height,u);let d=await this._session.send("Page.snapshotRect",{...c,coordinateSystem:n?"Page":"Viewport",omitDeviceScaleFactor:u}),p=Buffer.from(d.dataURL.substr("data:image/png;base64,".length),"base64");return t==="jpeg"&&(p=n1.jpegjs.encode(n1.PNG.sync.read(p),o).data),p}async getContentFrame(e){let t=await this._session.send("DOM.describeNode",{objectId:e._objectId});return t.contentFrameId?this._page._frameManager.frame(t.contentFrameId):null}async getOwnerFrame(e){return e._objectId&&(await this._session.send("DOM.describeNode",{objectId:e._objectId})).ownerFrameId||null}isElementHandle(e){return e.subtype==="node"}async getBoundingBox(e){let t=await this.getContentQuads(e);if(!t||!t.length)return null;let n=1/0,s=-1/0,o=1/0,a=-1/0;for(let l of t)for(let c of l)n=Math.min(n,c.x),s=Math.max(s,c.x),o=Math.min(o,c.y),a=Math.max(a,c.y);return{x:n,y:o,width:s-n,height:a-o}}async scrollRectIntoViewIfNeeded(e,t){return await this._session.send("DOM.scrollIntoViewIfNeeded",{objectId:e._objectId,rect:t}).then(()=>"done").catch(n=>{if(n instanceof Error&&n.message.includes("Node does not have a layout object"))return"error:notvisible";if(n instanceof Error&&n.message.includes("Node is detached from document"))return"error:notconnected";throw n})}async setScreencastOptions(e){if(e){let t={...e,toolbarHeight:this._toolbarHeight()},{generation:n}=await this._pageProxySession.send("Screencast.startScreencast",t);this._screencastGeneration=n}else await this._pageProxySession.send("Screencast.stopScreencast")}_onScreencastFrame(e){let t=this._screencastGeneration;this._page.throttleScreencastFrameAck(()=>{this._pageProxySession.send("Screencast.screencastFrameAck",{generation:t}).catch(s=>p4.debugLogger.log("error",s))});let n=Buffer.from(e.data,"base64");this._page.emit(Os.Page.Events.ScreencastFrame,{buffer:n,width:e.deviceWidth,height:e.deviceHeight})}rafCountForStablePosition(){return process.platform==="win32"?5:1}async getContentQuads(e){let t=await this._session.sendMayFail("DOM.getContentQuads",{objectId:e._objectId});return t?t.quads.map(n=>[{x:n[0],y:n[1]},{x:n[2],y:n[3]},{x:n[4],y:n[5]},{x:n[6],y:n[7]}]):null}async setInputFiles(e,t){let n=e._objectId,s=t.map(o=>({name:o.name,type:o.mimeType,data:o.buffer}));await this._session.send("DOM.setInputFiles",{objectId:n,files:s})}async setInputFilePaths(e,t){let n=this._pageProxySession.sessionId,s=e._objectId;await Promise.all([this._pageProxySession.connection.browserSession.send("Playwright.grantFileReadAccess",{pageProxyId:n,paths:t}),this._session.send("DOM.setInputFiles",{objectId:s,paths:t})])}async adoptElementHandle(e,t){let n=await this._session.sendMayFail("DOM.resolveNode",{objectId:e._objectId,executionContextId:t[mw]._contextId});if(!n||n.object.subtype==="null")throw new Error(r1.kUnableToAdoptErrorMessage);return t.createHandle(n.object)}async getAccessibilityTree(e){return(0,l4.getAccessibilityTree)(this._session,e)}async inputActionEpilogue(){}async resetForReuse(){}async getFrameElement(e){let t=e.parentFrame();if(!t)throw new Error("Frame has been detached.");let n=await t._mainContext(),s=await this._session.send("DOM.resolveNode",{frameId:e._id,executionContextId:n[mw]._contextId});if(!s||s.object.subtype==="null")throw new Error("Frame has been detached.");return n.createHandle(s.object)}_onRequestWillBeSent(e,t){t.request.url.startsWith("data:")||(this._page.needsRequestInterception()&&!t.redirectResponse?this._requestIdToRequestWillBeSentEvent.set(t.requestId,t):this._onRequest(e,t,!1))}_onRequest(e,t,n){let s=null;if(t.redirectResponse){let d=this._requestIdToRequest.get(t.requestId);d&&(this._handleRequestRedirect(d,t.redirectResponse,t.timestamp),s=d)}let o=s?s.request.frame():this._page._frameManager.frame(t.frameId);if(!o)return;let l=t.type==="Document"?t.loaderId:void 0,c=new s1.WKInterceptableRequest(e,o,t,s,l),u;n&&(u=new s1.WKRouteImpl(e,c._requestId),c.request.setRawRequestHeaders(null)),this._requestIdToRequest.set(t.requestId,c),this._page._frameManager.requestStarted(c.request,u)}_handleRequestRedirect(e,t,n){let s=e.createResponse(t);s._securityDetailsFinished(),s._serverAddrFinished(),s.setResponseHeadersSize(null),s.setEncodedBodySize(null),s._requestFinished(t.timing?wd.helper.secondsToRoundishMillis(n-e._timestamp):-1),this._requestIdToRequest.delete(e._requestId),this._page._frameManager.requestReceivedResponse(s),this._page._frameManager.reportRequestFinished(e.request,s)}_onRequestIntercepted(e,t){let n=this._requestIdToRequestWillBeSentEvent.get(t.requestId);if(!n){e.sendMayFail("Network.interceptWithRequest",{requestId:t.requestId});return}this._requestIdToRequestWillBeSentEvent.delete(t.requestId),this._onRequest(e,n,!0)}_onResponseReceived(e,t){let n=this._requestIdToRequestWillBeSentEvent.get(t.requestId);n&&(this._requestIdToRequestWillBeSentEvent.delete(t.requestId),this._onRequest(e,n,!1));let s=this._requestIdToRequest.get(t.requestId);if(!s)return;this._requestIdToResponseReceivedPayloadEvent.set(s._requestId,t);let o=s.createResponse(t.response);this._page._frameManager.requestReceivedResponse(o),o.status()===204&&this._onLoadingFailed(e,{requestId:t.requestId,errorText:"Aborted: 204 No Content",timestamp:t.timestamp})}_onLoadingFinished(e){let t=this._requestIdToRequest.get(e.requestId);if(!t)return;let n=t.request._existingResponse();if(n){var s,o,a,l,c,u,d,h,p,f;let _=this._requestIdToResponseReceivedPayloadEvent.get(t._requestId);n._serverAddrFinished(g4(e==null||(s=e.metrics)===null||s===void 0?void 0:s.remoteAddress)),n._securityDetailsFinished({protocol:_4(n.url(),n.timing())?(o=e.metrics)===null||o===void 0||(o=o.securityConnection)===null||o===void 0?void 0:o.protocol:void 0,subjectName:_==null||(a=_.response.security)===null||a===void 0||(a=a.certificate)===null||a===void 0?void 0:a.subject,validFrom:_==null||(l=_.response.security)===null||l===void 0||(l=l.certificate)===null||l===void 0?void 0:l.validFrom,validTo:_==null||(c=_.response.security)===null||c===void 0||(c=c.certificate)===null||c===void 0?void 0:c.validUntil}),(u=e.metrics)!==null&&u!==void 0&&u.protocol&&n._setHttpVersion(e.metrics.protocol),n.setEncodedBodySize((d=(h=e.metrics)===null||h===void 0?void 0:h.responseBodyBytesReceived)!==null&&d!==void 0?d:null),n.setResponseHeadersSize((p=(f=e.metrics)===null||f===void 0?void 0:f.responseHeaderBytesReceived)!==null&&p!==void 0?p:null),n._requestFinished(wd.helper.secondsToRoundishMillis(e.timestamp-t._timestamp))}else t.request.setRawRequestHeaders(null);this._requestIdToResponseReceivedPayloadEvent.delete(t._requestId),this._requestIdToRequest.delete(t._requestId),this._page._frameManager.reportRequestFinished(t.request,n)}_onLoadingFailed(e,t){let n=this._requestIdToRequestWillBeSentEvent.get(t.requestId);n&&(this._requestIdToRequestWillBeSentEvent.delete(t.requestId),this._onRequest(e,n,!1));let s=this._requestIdToRequest.get(t.requestId);if(!s)return;let o=s.request._existingResponse();o?(o._serverAddrFinished(),o._securityDetailsFinished(),o.setResponseHeadersSize(null),o.setEncodedBodySize(null),o._requestFinished(wd.helper.secondsToRoundishMillis(t.timestamp-s._timestamp))):s.request.setRawRequestHeaders(null),this._requestIdToRequest.delete(s._requestId),s.request._setFailureText(t.errorText),this._page._frameManager.requestFailed(s.request,t.errorText.includes("cancelled"))}async _grantPermissions(e,t){let n=new Map([["geolocation","geolocation"],["clipboard-read","clipboard-read"]]),s=t.map(o=>{let a=n.get(o);if(!a)throw new Error("Unknown permission: "+o);return a});await this._pageProxySession.send("Emulation.grantPermissions",{origin:e,permissions:s})}async _clearPermissions(){await this._pageProxySession.send("Emulation.resetPermissions",{})}shouldToggleStyleSheetToSyncAnimations(){return!0}};vd.WKPage=gw;function g4(r){if(r)try{let e=r.lastIndexOf(":"),t=r.lastIndexOf(".");if(t<0)return{ipAddress:`[${r.slice(0,e)}]`,port:+r.slice(e+1)};if(e>t){let[n,s]=r.split(":");return{ipAddress:n,port:+s}}else{let[n,s]=r.split(".");return{ipAddress:`[${n}]`,port:+s}}}catch{}}function _4(r,e){try{let t=new URL(r);return!(t.protocol!=="https:"&&t.protocol!=="wss:"&&t.protocol!=="sftp:"||e.secureConnectionStart===-1&&e.connectStart!==-1)}catch{}}var mw=Symbol("delegate")});var p1=M(Ps=>{"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});Ps.WKBrowserContext=Ps.WKBrowser=void 0;var w4=li(),ww=$e(),v4=ie(),Kn=Ze(),d1=x4(Ct()),vw=fa(),b4=u1(),y4=Bt();function h1(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(h1=function(n){return n?t:e})(r)}function x4(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=h1(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var bw="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15",S4="17.4",yw=class r extends w4.Browser{static async connect(e,t,n){let s=new r(e,t,n);n.__testHookOnConnectToBrowser&&await n.__testHookOnConnectToBrowser();let o=[s._browserSession.send("Playwright.enable")];if(n.persistent){var a;(a=n.persistent).userAgent||(a.userAgent=bw),s._defaultContext=new ma(s,void 0,n.persistent),o.push(s._defaultContext._initialize())}return await Promise.all(o),s}constructor(e,t,n){super(e,n),this._connection=void 0,this._browserSession=void 0,this._contexts=new Map,this._wkPages=new Map,this._eventListeners=void 0,this._connection=new vw.WKConnection(t,this._onDisconnect.bind(this),n.protocolLogger,n.browserLogsCollector),this._browserSession=this._connection.browserSession,this._eventListeners=[Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.pageProxyCreated",this._onPageProxyCreated.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.pageProxyDestroyed",this._onPageProxyDestroyed.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.provisionalLoadFailed",s=>this._onProvisionalLoadFailed(s)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.windowOpen",s=>this._onWindowOpen(s)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadCreated",this._onDownloadCreated.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadFilenameSuggested",this._onDownloadFilenameSuggested.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.downloadFinished",this._onDownloadFinished.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,"Playwright.screencastFinished",this._onScreencastFinished.bind(this)),Kn.eventsHelper.addEventListener(this._browserSession,vw.kPageProxyMessageReceived,this._onPageProxyMessageReceived.bind(this))]}_onDisconnect(){for(let e of this._wkPages.values())e.didClose();this._wkPages.clear();for(let e of this._idToVideo.values())e.artifact.reportFinished(new y4.TargetClosedError);this._idToVideo.clear(),this._didClose()}async doCreateNewContext(e){let t=e.proxy?{proxyServer:process.platform==="win32"?e.proxy.server.replace(/^socks5:\/\//,"socks5h://"):e.proxy.server,proxyBypassList:e.proxy.bypass}:void 0,{browserContextId:n}=await this._browserSession.send("Playwright.createContext",t);e.userAgent=e.userAgent||bw;let s=new ma(this,n,e);return await s._initialize(),this._contexts.set(n,s),s}contexts(){return Array.from(this._contexts.values())}version(){return S4}userAgent(){return bw}_onDownloadCreated(e){let t=this._wkPages.get(e.pageProxyId);if(!t)return;t._page._frameManager.frameAbortedNavigation(e.frameId,"Download is starting");let n=t._initializedPage;n||(t._firstNonInitialNavigationCommittedReject(new Error("Starting new page download")),t._opener&&(n=t._opener._initializedPage)),n&&this._downloadCreated(n,e.uuid,e.url)}_onDownloadFilenameSuggested(e){this._downloadFilenameSuggested(e.uuid,e.suggestedFilename)}_onDownloadFinished(e){this._downloadFinished(e.uuid,e.error)}_onScreencastFinished(e){var t;(t=this._takeVideo(e.screencastId))===null||t===void 0||t.reportFinished()}_onPageProxyCreated(e){let t=e.pageProxyId,n=null;if(e.browserContextId&&(n=this._contexts.get(e.browserContextId)||null),n||(n=this._defaultContext),!n)return;let s=new vw.WKSession(this._connection,t,l=>{this._connection.rawSend({...l,pageProxyId:t})}),o=e.openerId?this._wkPages.get(e.openerId):void 0,a=new b4.WKPage(n,s,o||null);this._wkPages.set(t,a)}_onPageProxyDestroyed(e){let t=e.pageProxyId,n=this._wkPages.get(t);n&&(n.didClose(),this._wkPages.delete(t))}_onPageProxyMessageReceived(e){let t=this._wkPages.get(e.pageProxyId);t&&t.dispatchMessageToSession(e.message)}_onProvisionalLoadFailed(e){let t=this._wkPages.get(e.pageProxyId);t&&t.handleProvisionalLoadFailed(e)}_onWindowOpen(e){let t=this._wkPages.get(e.pageProxyId);t&&t.handleWindowOpen(e)}isConnected(){return!this._connection.isClosed()}};Ps.WKBrowser=yw;var ma=class extends ww.BrowserContext{constructor(e,t,n){super(e,n,t),this._validateEmulatedViewport(n.viewport),this._authenticateProxyViaHeader()}async _initialize(){(0,v4.assert)(!this._wkPages().length);let e=this._browserContextId,t=[super._initialize()];t.push(this._browser._browserSession.send("Playwright.setDownloadBehavior",{behavior:this._options.acceptDownloads==="accept"?"allow":"deny",downloadPath:this._browser.options.downloadsPath,browserContextId:e})),this._options.ignoreHTTPSErrors&&t.push(this._browser._browserSession.send("Playwright.setIgnoreCertificateErrors",{browserContextId:e,ignore:!0})),this._options.locale&&t.push(this._browser._browserSession.send("Playwright.setLanguages",{browserContextId:e,languages:[this._options.locale]})),this._options.geolocation&&t.push(this.setGeolocation(this._options.geolocation)),this._options.offline&&t.push(this.setOffline(this._options.offline)),this._options.httpCredentials&&t.push(this.setHTTPCredentials(this._options.httpCredentials)),await Promise.all(t)}_wkPages(){return Array.from(this._browser._wkPages.values()).filter(e=>e._browserContext===this)}pages(){return this._wkPages().map(e=>e._initializedPage).filter(e=>!!e)}async newPageDelegate(){(0,ww.assertBrowserContextIsNotOwned)(this);let{pageProxyId:e}=await this._browser._browserSession.send("Playwright.createPage",{browserContextId:this._browserContextId});return this._browser._wkPages.get(e)}async doGetCookies(e){let{cookies:t}=await this._browser._browserSession.send("Playwright.getAllCookies",{browserContextId:this._browserContextId});return d1.filterCookies(t.map(n=>{let s={...n};return s.expires=n.expires===-1?-1:n.expires/1e3,delete s.session,s}),e)}async addCookies(e){let t=d1.rewriteCookies(e).map(n=>({...n,session:n.expires===-1||n.expires===void 0,expires:n.expires&&n.expires!==-1?n.expires*1e3:n.expires}));await this._browser._browserSession.send("Playwright.setCookies",{cookies:t,browserContextId:this._browserContextId})}async doClearCookies(){await this._browser._browserSession.send("Playwright.deleteAllCookies",{browserContextId:this._browserContextId})}async doGrantPermissions(e,t){await Promise.all(this.pages().map(n=>n._delegate._grantPermissions(e,t)))}async doClearPermissions(){await Promise.all(this.pages().map(e=>e._delegate._clearPermissions()))}async setGeolocation(e){(0,ww.verifyGeolocation)(e),this._options.geolocation=e;let t=e?{...e,timestamp:Date.now()}:void 0;await this._browser._browserSession.send("Playwright.setGeolocationOverride",{browserContextId:this._browserContextId,geolocation:t})}async setExtraHTTPHeaders(e){this._options.extraHTTPHeaders=e;for(let t of this.pages())await t._delegate.updateExtraHTTPHeaders()}async setUserAgent(e){this._options.userAgent=e;for(let t of this.pages())await t._delegate.updateUserAgent()}async setOffline(e){this._options.offline=e;for(let t of this.pages())await t._delegate.updateOffline()}async doSetHTTPCredentials(e){this._options.httpCredentials=e;for(let t of this.pages())await t._delegate.updateHttpCredentials()}async doAddInitScript(e){for(let t of this.pages())await t._delegate._updateBootstrapScript()}async doRemoveInitScripts(){for(let e of this.pages())await e._delegate._updateBootstrapScript()}async doExposeBinding(e){for(let t of this.pages())await t._delegate.exposeBinding(e)}async doRemoveExposedBindings(){for(let e of this.pages())await e._delegate.removeExposedBindings()}async doUpdateRequestInterception(){for(let e of this.pages())await e._delegate.updateRequestInterception()}onClosePersistent(){}async clearCache(){await this._browser._browserSession.send("Playwright.clearMemoryCache",{browserContextId:this._browserContextId})}async doClose(e){this._browserContextId?(await this._browser._browserSession.send("Playwright.deleteContext",{browserContextId:this._browserContextId}),this._browser._contexts.delete(this._browserContextId)):(await Promise.all(this._wkPages().map(t=>t._stopVideo())),await this._browser.close({reason:e}))}async cancelDownload(e){await this._browser._browserSession.send("Playwright.cancelDownload",{uuid:e})}_validateEmulatedViewport(e){if(e&&process.platform==="win32"&&this._browser.options.headful&&(e.width<250||e.height<240))throw new Error("WebKit on Windows has a minimal viewport of 250x240.")}};Ps.WKBrowserContext=ma});var m1=M(bd=>{"use strict";Object.defineProperty(bd,"__esModule",{value:!0});bd.WebKit=void 0;var E4=p1(),k4=O4(require("path")),C4=fa(),f1=ed(),T4=ie();function O4(r){return r&&r.__esModule?r:{default:r}}var xw=class extends f1.BrowserType{constructor(e){super(e,"webkit")}_connectToTransport(e,t){return E4.WKBrowser.connect(this.attribution.playwright,e,t)}_amendEnvironment(e,t,n,s){return{...e,CURL_COOKIE_JAR_PATH:k4.default.join(t,"cookiejar.db")}}_doRewriteStartupLog(e){return e.logs&&e.logs.includes("cannot open display")&&(e.logs=`
`+(0,T4.wrapInASCIIBox)(f1.kNoXServerRunningError,1)),e}_attemptToGracefullyCloseBrowser(e){e.send({method:"Playwright.close",params:{},id:C4.kBrowserCloseMessageId})}_defaultArgs(e,t,n){let{args:s=[],proxy:o,headless:a}=e;if(s.find(u=>u.startsWith("--user-data-dir")))throw this._createUserDataDirArgMisuseError("--user-data-dir");if(s.find(u=>!u.startsWith("-")))throw new Error("Arguments can not specify page to be opened");let c=["--inspector-pipe"];return process.platform==="win32"&&c.push("--disable-accelerated-compositing"),a&&c.push("--headless"),t?c.push(`--user-data-dir=${n}`):c.push("--no-startup-window"),o&&(process.platform==="darwin"?(c.push(`--proxy=${o.server}`),o.bypass&&c.push(`--proxy-bypass-list=${o.bypass}`)):process.platform==="linux"?(c.push(`--proxy=${o.server}`),o.bypass&&c.push(...o.bypass.split(",").map(u=>`--ignore-host=${u}`))):process.platform==="win32"&&(c.push(`--curl-proxy=${o.server.replace(/^socks5:\/\//,"socks5h://")}`),o.bypass&&c.push(`--curl-noproxy=${o.bypass}`))),c.push(...s),t&&c.push("about:blank"),c}};bd.WebKit=xw});var Cw=M(yd=>{"use strict";Object.defineProperty(yd,"__esModule",{value:!0});yd.DebugController=void 0;var g1=sr(),Ew=De(),Sw=xd(),P4=Tw(),A4=Xt(),ga=(0,Ew.serverSideCallMetadata)(),Tr=class r extends Ew.SdkObject{constructor(e){super({attribution:{isInternalPlaywright:!0},instrumentation:(0,Ew.createInstrumentation)()},void 0,"DebugController"),this._autoCloseTimer=void 0,this._autoCloseAllowed=!1,this._trackHierarchyListener=void 0,this._playwright=void 0,this._sdkLanguage="javascript",this._codegenId="playwright-test",this._playwright=e}initialize(e,t){this._codegenId=e,this._sdkLanguage=t,Sw.Recorder.setAppFactory(async()=>new kw(this))}setAutoCloseAllowed(e){this._autoCloseAllowed=e}dispose(){this.setReportStateChanged(!1),this.setAutoCloseAllowed(!1),Sw.Recorder.setAppFactory(void 0)}setReportStateChanged(e){e&&!this._trackHierarchyListener?(this._trackHierarchyListener={onPageOpen:()=>this._emitSnapshot(),onPageClose:()=>this._emitSnapshot()},this._playwright.instrumentation.addListener(this._trackHierarchyListener,null)):!e&&this._trackHierarchyListener&&(this._playwright.instrumentation.removeListener(this._trackHierarchyListener),this._trackHierarchyListener=void 0)}async resetForReuse(){let e=new Set;for(let t of this._playwright.allPages())e.add(t.context());for(let t of e)await t.resetForReuse(ga,null)}async navigate(e){for(let t of this._playwright.allPages())await t.mainFrame().goto(ga,e)}async setRecorderMode(e){if(await this._closeBrowsersWithoutPages(),e.mode==="none"){for(let n of await this._allRecorders())n.hideHighlightedSelector(),n.setMode("none");this.setAutoCloseEnabled(!0);return}if(this._playwright.allBrowsers().length||await this._playwright.chromium.launch(ga,{headless:!!process.env.PW_DEBUG_CONTROLLER_HEADLESS}),!this._playwright.allPages().length){let[n]=this._playwright.allBrowsers(),{context:s}=await n.newContextForReuse({},ga);await s.newPage(ga)}if(e.testIdAttributeName)for(let n of this._playwright.allPages())n.context().selectors().setTestIdAttributeName(e.testIdAttributeName);for(let n of await this._allRecorders())n.hideHighlightedSelector(),e.mode!=="inspecting"&&n.setOutput(this._codegenId,e.file),n.setMode(e.mode);this.setAutoCloseEnabled(!0)}async setAutoCloseEnabled(e){if(!this._autoCloseAllowed||(this._autoCloseTimer&&clearTimeout(this._autoCloseTimer),!e))return;let t=()=>{this._playwright.allPages().length?this._autoCloseTimer=setTimeout(t,5e3):(0,g1.gracefullyProcessExitDoNotHang)(0)};this._autoCloseTimer=setTimeout(t,3e4)}async highlight(e){for(let t of await this._allRecorders())t.setHighlightedSelector(this._sdkLanguage,e)}async hideHighlight(){for(let e of await this._allRecorders())e.hideHighlightedSelector();await this._playwright.hideHighlight()}allBrowsers(){return[...this._playwright.allBrowsers()]}async resume(){for(let e of await this._allRecorders())e.resume()}async kill(){(0,g1.gracefullyProcessExitDoNotHang)(0)}async closeAllBrowsers(){await Promise.all(this.allBrowsers().map(e=>e.close({reason:"Close all browsers requested"})))}_emitSnapshot(){let e=[],t=0;for(let n of this._playwright.allBrowsers()){let s={contexts:[]};e.push(s);for(let o of n.contexts()){let a={pages:[]};s.contexts.push(a);for(let l of o.pages())a.pages.push(l.mainFrame().url());t+=o.pages().length}}this.emit(r.Events.StateChanged,{pageCount:t})}async _allRecorders(){let e=new Set;for(let n of this._playwright.allPages())e.add(n.context());return(await Promise.all([...e].map(n=>Sw.Recorder.show(n,{omitCallTracking:!0})))).filter(Boolean)}async _closeBrowsersWithoutPages(){for(let e of this._playwright.allBrowsers()){for(let t of e.contexts())t.pages().length||await t.close({reason:"Browser collected"});e.contexts()||await e.close({reason:"Browser collected"})}}};yd.DebugController=Tr;Tr.Events={StateChanged:"stateChanged",InspectRequested:"inspectRequested",SourceChanged:"sourceChanged",Paused:"paused",SetModeRequested:"setModeRequested"};var kw=class extends P4.EmptyRecorderApp{constructor(e){super(),this._debugController=void 0,this._debugController=e}async setSelector(e){let t=(0,A4.asLocator)(this._debugController._sdkLanguage,e);this._debugController.emit(Tr.Events.InspectRequested,{selector:e,locator:t})}async setSources(e){let t=e.find(l=>l.id===this._debugController._codegenId),{text:n,header:s,footer:o,actions:a}=t||{text:""};this._debugController.emit(Tr.Events.SourceChanged,{text:n,header:s,footer:o,actions:a})}async setPaused(e){this._debugController.emit(Tr.Events.Paused,{paused:e})}async setMode(e){this._debugController.emit(Tr.Events.SetModeRequested,{mode:e})}}});var mi=M(_a=>{"use strict";Object.defineProperty(_a,"__esModule",{value:!0});_a.Playwright=void 0;_a.createPlaywright=q4;var I4=Ku(),R4=jk(),M4=uC(),F4=O_(),N4=UC(),L4=Q_(),D4=m1(),_1=De(),B4=Le(),j4=Cw(),Sd=class extends _1.SdkObject{constructor(e){super({attribution:{},instrumentation:(0,_1.createInstrumentation)()},void 0,"Playwright"),this.selectors=void 0,this.chromium=void 0,this.android=void 0,this.electron=void 0,this.firefox=void 0,this.webkit=void 0,this.options=void 0,this.debugController=void 0,this._allPages=new Set,this._allBrowsers=new Set,this.options=e,this.attribution.playwright=this,this.instrumentation.addListener({onBrowserOpen:t=>this._allBrowsers.add(t),onBrowserClose:t=>this._allBrowsers.delete(t),onPageOpen:t=>this._allPages.add(t),onPageClose:t=>this._allPages.delete(t),onCallLog:(t,n,s,o)=>{B4.debugLogger.log(s,o)}},null),this.chromium=new M4.Chromium(this),this.firefox=new N4.Firefox(this),this.webkit=new D4.WebKit(this),this.electron=new F4.Electron(this),this.android=new I4.Android(this,new R4.AdbBackend),this.selectors=new L4.Selectors,this.debugController=new j4.DebugController(this)}async hideHighlight(){await Promise.all([...this._allPages].map(e=>e.hideHighlight().catch(()=>{})))}allBrowsers(){return[...this._allBrowsers]}allPages(){return[...this._allPages]}};_a.Playwright=Sd;function q4(r){return new Sd(r)}});var Tw=M(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.RecorderApp=As.EmptyRecorderApp=void 0;var H4=y1(require("fs")),$4=y1(require("path")),W4=Ut(),b1=require("events"),w1=De(),U4=ie(),z4=Be(),v1=Eg();function y1(r){return r&&r.__esModule?r:{default:r}}var Ow=class extends b1.EventEmitter{async close(){}async setPaused(e){}async setMode(e){}async setFileIfNeeded(e){}async setSelector(e,t){}async updateCallLogs(e){}async setSources(e){}};As.EmptyRecorderApp=Ow;var Pw=class r extends b1.EventEmitter{constructor(e,t,n){super(),this._page=void 0,this.wsEndpoint=void 0,this._recorder=void 0,this.setMaxListeners(0),this._recorder=e,this._page=t,this.wsEndpoint=n}async close(){await this._page.context().close({reason:"Recorder window closed"})}async _init(){await(0,v1.syncLocalStorageWithSettings)(this._page,"recorder"),await this._page._setServerRequestInterceptor(t=>{if(!t.request().url().startsWith("https://playwright/"))return!1;let n=t.request().url().substring(19),s=require.resolve("../../vite/recorder/"+n);return H4.default.promises.readFile(s).then(o=>{t.fulfill({requestUrl:t.request().url(),status:200,headers:[{name:"Content-Type",value:z4.mime.getType($4.default.extname(s))||"application/octet-stream"}],body:o.toString("base64"),isBase64:!0}).catch(()=>{})}),!0}),await this._page.exposeBinding("dispatch",!1,(t,n)=>this.emit("event",n)),this._page.once("close",()=>{this.emit("close"),this._page.context().close({reason:"Recorder window closed"}).catch(()=>{})}),await this._page.mainFrame().goto((0,w1.serverSideCallMetadata)(),"https://playwright/index.html")}static async open(e,t,n){let s=t.attribution.playwright.options.sdkLanguage,o=!!t._browser.options.headful,a=mi().createPlaywright({sdkLanguage:"javascript",isInternalPlaywright:!0}),{context:l,page:c}=await(0,v1.launchApp)(a.chromium,{sdkLanguage:s,windowSize:{width:600,height:600},windowPosition:{x:1020,y:10},persistentContextOptions:{noDefaultViewport:!0,headless:!!process.env.PWTEST_CLI_HEADLESS||(0,U4.isUnderTest)()&&!o,useWebSocket:!!process.env.PWTEST_RECORDER_PORT,handleSIGINT:n,args:process.env.PWTEST_RECORDER_PORT?[`--remote-debugging-port=${process.env.PWTEST_RECORDER_PORT}`]:[]}});await new W4.ProgressController((0,w1.serverSideCallMetadata)(),l._browser).run(async h=>{await l._browser._defaultContext._loadDefaultContextAsIs(h)});let d=new r(e,c,l._browser.options.wsEndpoint);return await d._init(),d}async setMode(e){await this._page.mainFrame().evaluateExpression((t=>{window.playwrightSetMode(t)}).toString(),{isFunction:!0},e).catch(()=>{})}async setFileIfNeeded(e){await this._page.mainFrame().evaluateExpression((t=>{window.playwrightSetFileIfNeeded(t)}).toString(),{isFunction:!0},e).catch(()=>{})}async setPaused(e){await this._page.mainFrame().evaluateExpression((t=>{window.playwrightSetPaused(t)}).toString(),{isFunction:!0},e).catch(()=>{})}async setSources(e){await this._page.mainFrame().evaluateExpression((t=>{window.playwrightSetSources(t)}).toString(),{isFunction:!0},e).catch(()=>{}),process.env.PWTEST_CLI_IS_UNDER_TEST&&e.length&&process._didSetSourcesForTest(e[0].text)}async setSelector(e,t){t&&(this._recorder.mode()==="inspecting"?(this._recorder.setMode("standby"),this._page.bringToFront()):this._recorder.setMode("recording")),await this._page.mainFrame().evaluateExpression((n=>{window.playwrightSetSelector(n.selector,n.userGesture)}).toString(),{isFunction:!0},{selector:e,userGesture:t}).catch(()=>{})}async updateCallLogs(e){await this._page.mainFrame().evaluateExpression((t=>{window.playwrightUpdateLogs(t)}).toString(),{isFunction:!0},e).catch(()=>{})}};As.RecorderApp=Pw});var x1=M(Aw=>{"use strict";Object.defineProperty(Aw,"__esModule",{value:!0});Aw.metadataToCallLog=V4;function V4(r,e){var t,n,s;let o=r.apiName||r.method;r.method==="waitForEventInfo"&&(o+=`(${r.params.info.event})`),o=o.replace("object.expect","expect"),r.error&&(e="error");let a={url:(t=r.params)===null||t===void 0?void 0:t.url,selector:(n=r.params)===null||n===void 0?void 0:n.selector},l=r.endTime?r.endTime-r.startTime:void 0;return typeof l=="number"&&r.pauseStartTime&&r.pauseEndTime&&(l-=r.pauseEndTime-r.pauseStartTime,l=Math.max(l,0)),{id:r.id,messages:r.log,title:o,status:e,error:(s=r.error)===null||s===void 0||(s=s.error)===null||s===void 0?void 0:s.message,params:a,duration:l}}});var T1=M(Iw=>{"use strict";Object.defineProperty(Iw,"__esModule",{value:!0});Iw.locatorOrSelectorAsSelector=X4;var wa=Ht(),G4=Xt(),K4=ti();function J4(r,e){r=r.replace(/AriaRole\s*\.\s*([\w]+)/g,(o,a)=>a.toLowerCase()).replace(/(get_by_role|getByRole)\s*\(\s*(?:["'`])([^'"`]+)['"`]/g,(o,a,l)=>`${a}(${l.toLowerCase()}`);let t=[],n="";for(let o=0;o<r.length;++o){let a=r[o];if(a!=='"'&&a!=="'"&&a!=="`"&&a!=="/"){n+=a;continue}let l=r[o-1]==="r"||r[o]==="/";++o;let c="";for(;o<r.length;){if(r[o]==="\\"){l?(r[o+1]!==a&&(c+=r[o]),++o,c+=r[o]):(++o,r[o]==="n"?c+=`
`:r[o]==="r"?c+="\r":r[o]==="t"?c+="	":c+=r[o]),++o;continue}if(r[o]!==a){c+=r[o++];continue}break}t.push({quote:a,text:c}),n+=(a==="/"?"r":"")+"$"+t.length}n=n.toLowerCase().replace(/get_by_alt_text/g,"getbyalttext").replace(/get_by_test_id/g,"getbytestid").replace(/get_by_([\w]+)/g,"getby$1").replace(/has_not_text/g,"hasnottext").replace(/has_text/g,"hastext").replace(/has_not/g,"hasnot").replace(/frame_locator/g,"framelocator").replace(/[{}\s]/g,"").replace(/new\(\)/g,"").replace(/new[\w]+\.[\w]+options\(\)/g,"").replace(/\.set/g,",set").replace(/\.or_\(/g,"or(").replace(/\.and_\(/g,"and(").replace(/:/g,"=").replace(/,re\.ignorecase/g,"i").replace(/,pattern.case_insensitive/g,"i").replace(/,regexoptions.ignorecase/g,"i").replace(/re.compile\(([^)]+)\)/g,"$1").replace(/pattern.compile\(([^)]+)\)/g,"r$1").replace(/newregex\(([^)]+)\)/g,"r$1").replace(/string=/g,"=").replace(/regex=/g,"=").replace(/,,/g,",");let s=t.map(o=>o.quote).filter(o=>"'\"`".includes(o))[0];return{selector:C1(n,t,e),preferredQuote:s}}function S1(r){return[...r.matchAll(/\$\d+/g)].length}function E1(r,e){return r.replace(/\$(\d+)/g,(t,n)=>`$${n-e}`)}function C1(r,e,t){for(;;){let s=r.match(/filter\(,?(has=|hasnot=|sethas\(|sethasnot\()/);if(!s)break;let o=s.index+s[0].length,a=0,l=o;for(;l<r.length&&(r[l]==="("?a++:r[l]===")"&&a--,!(a<0));l++);let c=r.substring(0,o),u=0;["sethas(","sethasnot("].includes(s[1])&&(u=1,c=c.replace(/sethas\($/,"has=").replace(/sethasnot\($/,"hasnot="));let d=S1(r.substring(0,o)),h=E1(r.substring(o,l),d),p=S1(h),f=e.slice(d,d+p),_=JSON.stringify(C1(h,f,t));r=c.replace(/=$/,"2=")+`$${d+1}`+E1(r.substring(l+u),p-1);let v=e.slice(0,d),w=e.slice(d+p);e=v.concat([{quote:'"',text:_}]).concat(w)}r=r.replace(/\,set([\w]+)\(([^)]+)\)/g,(s,o,a)=>","+o.toLowerCase()+"="+a.toLowerCase()).replace(/framelocator\(([^)]+)\)/g,"$1.internal:control=enter-frame").replace(/locator\(([^)]+),hastext=([^),]+)\)/g,"locator($1).internal:has-text=$2").replace(/locator\(([^)]+),hasnottext=([^),]+)\)/g,"locator($1).internal:has-not-text=$2").replace(/locator\(([^)]+),hastext=([^),]+)\)/g,"locator($1).internal:has-text=$2").replace(/locator\(([^)]+)\)/g,"$1").replace(/getbyrole\(([^)]+)\)/g,"internal:role=$1").replace(/getbytext\(([^)]+)\)/g,"internal:text=$1").replace(/getbylabel\(([^)]+)\)/g,"internal:label=$1").replace(/getbytestid\(([^)]+)\)/g,`internal:testid=[${t}=$1]`).replace(/getby(placeholder|alt|title)(?:text)?\(([^)]+)\)/g,"internal:attr=[$1=$2]").replace(/first(\(\))?/g,"nth=0").replace(/last(\(\))?/g,"nth=-1").replace(/nth\(([^)]+)\)/g,"nth=$1").replace(/filter\(,?hastext=([^)]+)\)/g,"internal:has-text=$1").replace(/filter\(,?hasnottext=([^)]+)\)/g,"internal:has-not-text=$1").replace(/filter\(,?has2=([^)]+)\)/g,"internal:has=$1").replace(/filter\(,?hasnot2=([^)]+)\)/g,"internal:has-not=$1").replace(/,exact=false/g,"").replace(/,exact=true/g,"s").replace(/\,/g,"][");let n=r.split(".");for(let s=0;s<n.length-1;s++)if(n[s]==="internal:control=enter-frame"&&n[s+1].startsWith("nth=")){let[o]=n.splice(s,1);n.splice(s+1,0,o)}return n.map(s=>!s.startsWith("internal:")||s==="internal:control"?s.replace(/\$(\d+)/g,(o,a)=>e[+a-1].text):(s=s.includes("[")?s.replace(/\]/,"")+"]":s,s=s.replace(/(?:r)\$(\d+)(i)?/g,(o,a,l)=>{let c=e[+a-1];return s.startsWith("internal:attr")||s.startsWith("internal:testid")||s.startsWith("internal:role")?(0,wa.escapeForAttributeSelector)(new RegExp(c.text),!1)+(l||""):(0,wa.escapeForTextSelector)(new RegExp(c.text,l),!1)}).replace(/\$(\d+)(i|s)?/g,(o,a,l)=>{let c=e[+a-1];return s.startsWith("internal:has=")||s.startsWith("internal:has-not=")?c.text:s.startsWith("internal:testid")?(0,wa.escapeForAttributeSelector)(c.text,!0):s.startsWith("internal:attr")||s.startsWith("internal:role")?(0,wa.escapeForAttributeSelector)(c.text,l==="s"):(0,wa.escapeForTextSelector)(c.text,l==="s")}),s)).join(" >> ")}function X4(r,e,t){try{return(0,K4.parseSelector)(e),e}catch{}try{let{selector:n,preferredQuote:s}=J4(e,t),o=(0,G4.asLocators)(r,n,void 0,void 0,s),a=k1(r,e);if(o.some(l=>k1(r,l)===a))return n}catch{}return""}function k1(r,e){return e=e.replace(/\s/g,""),r==="javascript"&&(e=e.replace(/\\?["`]/g,"'")),e}});var xd=M(Cd=>{"use strict";Object.defineProperty(Cd,"__esModule",{value:!0});Cd.Recorder=void 0;var L1=Nw(require("fs")),Y4=PE(),O1=as(),Q4=Et(),Z4=si(),Ed=$e(),P1=LE(),A1=mg(),e6=DE(),Rw=$E(),Mw=VE(),t6=Nw(GE()),n6=Nw(Sg()),I1=Tw(),Or=ie(),r6=x1(),i6=Ym(),s6=require("events"),o6=vo(),a6=T1(),R1=Ht(),M1=Ze();function D1(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(D1=function(n){return n?t:e})(r)}function Nw(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=D1(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var F1=Symbol("recorderSymbol"),kd=class r{static setAppFactory(e){r.recorderAppFactory=e}static showInspector(e){let t={};(0,Or.isUnderTest)()&&(t.language=process.env.TEST_INSPECTOR_LANGUAGE),r.show(e,t).catch(()=>{})}static show(e,t={}){let n=e[F1];if(!n){let s=new r(e,t);n=s.install().then(()=>s),e[F1]=n}return n}constructor(e,t){this._context=void 0,this._mode=void 0,this._highlightedSelector="",this._overlayState={offsetX:0},this._recorderApp=null,this._currentCallsMetadata=new Map,this._recorderSources=[],this._userSources=new Map,this._debugger=void 0,this._contextRecorder=void 0,this._handleSIGINT=void 0,this._omitCallTracking=!1,this._currentLanguage=void 0,this._mode=t.mode||"none",this._contextRecorder=new va(e,t),this._context=e,this._omitCallTracking=!!t.omitCallTracking,this._debugger=e.debugger(),this._handleSIGINT=t.handleSIGINT,e.instrumentation.addListener(this,e),this._currentLanguage=this._contextRecorder.languageName(),(0,Or.isUnderTest)()&&(this._overlayState.offsetX=200)}static async defaultRecorderAppFactory(e){return process.env.PW_CODEGEN_NO_INSPECTOR?new I1.EmptyRecorderApp:await I1.RecorderApp.open(e,e._context,e._handleSIGINT)}async install(){let e=await(r.recorderAppFactory||r.defaultRecorderAppFactory)(this);this._recorderApp=e,e.once("close",()=>{this._debugger.resume(!1),this._recorderApp=null}),e.on("event",t=>{if(t.event==="setMode"){this.setMode(t.params.mode);return}if(t.event==="selectorUpdated"){this.setHighlightedSelector(this._currentLanguage,t.params.selector);return}if(t.event==="step"){this._debugger.resume(!0);return}if(t.event==="fileChanged"){this._currentLanguage=this._contextRecorder.languageName(t.params.file),this._refreshOverlay();return}if(t.event==="resume"){this._debugger.resume(!1);return}if(t.event==="pause"){this._debugger.pauseOnNextStatement();return}if(t.event==="clear"){this._contextRecorder.clearScript();return}}),await Promise.all([e.setMode(this._mode),e.setPaused(this._debugger.isPaused()),this._pushAllSources()]),this._context.once(Ed.BrowserContext.Events.Close,()=>{this._contextRecorder.dispose(),this._context.instrumentation.removeListener(this),e.close().catch(()=>{})}),this._contextRecorder.on(va.Events.Change,t=>{var n;this._recorderSources=t.sources,this._pushAllSources(),(n=this._recorderApp)===null||n===void 0||n.setFileIfNeeded(t.primaryFileName)}),await this._context.exposeBinding("__pw_recorderState",!1,t=>{let n="",s;if(![...this._currentCallsMetadata.keys()].some(N1)){n=this._highlightedSelector;for(let[l,c]of this._currentCallsMetadata)t.page===c.attribution.page&&(s=l.point||s,n=n||l.params.selector)}return{mode:this._mode,actionPoint:s,actionSelector:n,language:this._currentLanguage,testIdAttributeName:this._contextRecorder.testIdAttributeName(),overlay:this._overlayState}}),await this._context.exposeBinding("__pw_recorderSetSelector",!1,async({frame:t},n)=>{var s;let o=[],a=t;for(;a;)o.push(B1(a)),a=a.parentFrame();let l=(await Promise.all(o)).filter(Boolean);l.push(n),await((s=this._recorderApp)===null||s===void 0?void 0:s.setSelector(l.join(" >> internal:control=enter-frame >> "),!0))}),await this._context.exposeBinding("__pw_recorderSetMode",!1,async({frame:t},n)=>{t.parentFrame()||this.setMode(n)}),await this._context.exposeBinding("__pw_recorderSetOverlayState",!1,async({frame:t},n)=>{t.parentFrame()||(this._overlayState=n)}),await this._context.exposeBinding("__pw_resume",!1,()=>{this._debugger.resume(!1)}),await this._context.extendInjectedScript(n6.source),await this._contextRecorder.install(),this._debugger.isPaused()&&this._pausedStateChanged(),this._debugger.on(i6.Debugger.Events.PausedStateChanged,()=>this._pausedStateChanged()),this._context.recorderAppForTest=e}_pausedStateChanged(){var e;for(let{metadata:t,sdkObject:n}of this._debugger.pausedDetails())this._currentCallsMetadata.has(t)||this.onBeforeCall(n,t);(e=this._recorderApp)===null||e===void 0||e.setPaused(this._debugger.isPaused()),this._updateUserSources(),this.updateCallLog([...this._currentCallsMetadata.keys()])}setMode(e){var t;this._mode!==e&&(this._highlightedSelector="",this._mode=e,(t=this._recorderApp)===null||t===void 0||t.setMode(this._mode),this._contextRecorder.setEnabled(this._mode==="recording"||this._mode==="assertingText"||this._mode==="assertingVisibility"||this._mode==="assertingValue"),this._debugger.setMuted(this._mode==="recording"||this._mode==="assertingText"||this._mode==="assertingVisibility"||this._mode==="assertingValue"),this._mode!=="none"&&this._mode!=="standby"&&this._context.pages().length===1&&this._context.pages()[0].bringToFront().catch(()=>{}),this._refreshOverlay())}resume(){this._debugger.resume(!1)}mode(){return this._mode}setHighlightedSelector(e,t){this._highlightedSelector=(0,a6.locatorOrSelectorAsSelector)(e,t,this._context.selectors().testIdAttributeName()),this._refreshOverlay()}hideHighlightedSelector(){this._highlightedSelector="",this._refreshOverlay()}setOutput(e,t){this._contextRecorder.setOutput(e,t)}_refreshOverlay(){for(let e of this._context.pages())e.mainFrame().evaluateExpression("window.__pw_refreshOverlay()").catch(()=>{})}async onBeforeCall(e,t){if(!(this._omitCallTracking||this._mode==="recording"||this._mode==="assertingText"||this._mode==="assertingVisibility"||this._mode==="assertingValue")){if(this._currentCallsMetadata.set(t,e),this._updateUserSources(),this.updateCallLog([t]),N1(t))this.hideHighlightedSelector();else if(t.params&&t.params.selector){var n;this._highlightedSelector=t.params.selector,(n=this._recorderApp)===null||n===void 0||n.setSelector(this._highlightedSelector).catch(()=>{})}}}async onAfterCall(e,t){this._omitCallTracking||this._mode==="recording"||this._mode==="assertingText"||this._mode==="assertingVisibility"||this._mode==="assertingValue"||(t.error||this._currentCallsMetadata.delete(t),this._updateUserSources(),this.updateCallLog([t]))}_updateUserSources(){var e;for(let n of this._userSources.values())n.highlight=[],n.revealLine=void 0;let t;for(let n of this._currentCallsMetadata.keys()){if(!n.location)continue;let{file:s,line:o}=n.location,a=this._userSources.get(s);if(a||(a={isRecorded:!1,label:s,id:s,text:this._readSource(s),highlight:[],language:l6(s)},this._userSources.set(s,a)),o){let l=this._debugger.isPaused(n);a.highlight.push({line:o,type:n.error?"error":l?"paused":"running"}),a.revealLine=o,t=a.id}}this._pushAllSources(),t&&((e=this._recorderApp)===null||e===void 0||e.setFileIfNeeded(t))}_pushAllSources(){var e;(e=this._recorderApp)===null||e===void 0||e.setSources([...this._recorderSources,...this._userSources.values()])}async onBeforeInputAction(e,t){}async onCallLog(e,t,n,s){this.updateCallLog([t])}updateCallLog(e){var t;if(this._mode==="recording"||this._mode==="assertingText"||this._mode==="assertingVisibility"||this._mode==="assertingValue")return;let n=[];for(let s of e){if(!s.method||s.internal)continue;let o="done";this._currentCallsMetadata.has(s)&&(o="in-progress"),this._debugger.isPaused(s)&&(o="paused"),n.push((0,r6.metadataToCallLog)(s,o))}(t=this._recorderApp)===null||t===void 0||t.updateCallLogs(n)}_readSource(e){try{return L1.readFileSync(e,"utf-8")}catch{return"// No source available"}}};Cd.Recorder=kd;kd.recorderAppFactory=void 0;var va=class r extends s6.EventEmitter{constructor(e,t){super(),this._generator=void 0,this._pageAliases=new Map,this._lastPopupOrdinal=0,this._lastDialogOrdinal=-1,this._lastDownloadOrdinal=-1,this._timers=new Set,this._context=void 0,this._params=void 0,this._recorderSources=void 0,this._throttledOutputFile=null,this._orderedLanguages=[],this._listeners=[],this._context=e,this._params=t,this._recorderSources=[];let n=t.language||e.attribution.playwright.options.sdkLanguage;this.setOutput(n,t.outputFile);let s=new Y4.CodeGenerator(e._browser.options.name,t.mode==="recording",t.launchOptions||{},t.contextOptions||{},t.device,t.saveStorage);s.on("change",()=>{this._recorderSources=[];for(let a of this._orderedLanguages){var o;let{header:l,footer:c,actions:u,text:d}=s.generateStructure(a),h={isRecorded:!0,label:a.name,group:a.groupName,id:a.id,text:d,header:l,footer:c,actions:u,language:a.highlighter,highlight:[]};h.revealLine=d.split(`
`).length-1,this._recorderSources.push(h),a===this._orderedLanguages[0]&&((o=this._throttledOutputFile)===null||o===void 0||o.setContent(h.text))}this.emit(r.Events.Change,{sources:this._recorderSources,primaryFileName:this._orderedLanguages[0].id})}),e.on(Ed.BrowserContext.Events.BeforeClose,()=>{var o;(o=this._throttledOutputFile)===null||o===void 0||o.flush()}),this._listeners.push(M1.eventsHelper.addEventListener(process,"exit",()=>{var o;(o=this._throttledOutputFile)===null||o===void 0||o.flush()})),this._generator=s}setOutput(e,t){var n;let s=new Set([new P1.JavaLanguageGenerator("junit"),new P1.JavaLanguageGenerator("library"),new A1.JavaScriptLanguageGenerator(!1),new A1.JavaScriptLanguageGenerator(!0),new Mw.PythonLanguageGenerator(!1,!0),new Mw.PythonLanguageGenerator(!1,!1),new Mw.PythonLanguageGenerator(!0,!1),new Rw.CSharpLanguageGenerator("mstest"),new Rw.CSharpLanguageGenerator("nunit"),new Rw.CSharpLanguageGenerator("library"),new e6.JsonlLanguageGenerator]),o=[...s].find(a=>a.id===e);if(!o)throw new Error(`
===============================
Unsupported language: '${e}'
===============================
`);s.delete(o),this._orderedLanguages=[o,...s],this._throttledOutputFile=t?new Fw(t):null,(n=this._generator)===null||n===void 0||n.restart()}languageName(e){for(let t of this._orderedLanguages)if(!e||t.id===e)return t.highlighter;return"javascript"}async install(){this._context.on(Ed.BrowserContext.Events.Page,e=>this._onPage(e));for(let e of this._context.pages())this._onPage(e);this._context.on(Ed.BrowserContext.Events.Dialog,e=>this._onDialog(e.page())),await this._context.exposeBinding("__pw_recorderPerformAction",!1,(e,t)=>this._performAction(e.frame,t)),await this._context.exposeBinding("__pw_recorderRecordAction",!1,(e,t)=>this._recordAction(e.frame,t)),await this._context.extendInjectedScript(t6.source)}setEnabled(e){this._generator.setEnabled(e)}dispose(){for(let e of this._timers)clearTimeout(e);this._timers.clear(),M1.eventsHelper.removeEventListeners(this._listeners)}async _onPage(e){let t=e.mainFrame();e.on("close",()=>{this._generator.addAction({frame:this._describeMainFrame(e),committed:!0,action:{name:"closePage",signals:[]}}),this._pageAliases.delete(e)}),t.on(Z4.Frame.Events.InternalNavigation,o=>{o.isPublic&&this._onFrameNavigated(t,e)}),e.on(Q4.Page.Events.Download,()=>this._onDownload(e));let s="page"+(this._pageAliases.size?String(++this._lastPopupOrdinal):"");this._pageAliases.set(e,s),e.opener()?this._onPopup(e.opener(),e):this._generator.addAction({frame:this._describeMainFrame(e),committed:!0,action:{name:"openPage",url:e.mainFrame().url(),signals:[]}})}clearScript(){if(this._generator.restart(),this._params.mode==="recording")for(let e of this._context.pages())this._onFrameNavigated(e.mainFrame(),e)}_describeMainFrame(e){return{pageAlias:this._pageAliases.get(e),isMainFrame:!0}}async _describeFrame(e){let t=e._page,n=this._pageAliases.get(t),s=[];for(let c=e;c;c=c.parentFrame())s.push(c);if(s.reverse(),s.length===1)return this._describeMainFrame(t);let o=[];for(let c=0;c<s.length-1;c++)o.push(B1(s[c+1]));let a=await(0,o6.raceAgainstDeadline)(()=>Promise.all(o),(0,Or.monotonicTime)()+2e3);if(!a.timedOut&&a.result.every(c=>!!c))return{pageAlias:n,isMainFrame:!1,selectorsChain:a.result};let l=[];for(let c=0;c<s.length-1;c++)s[c].name()?l.push(`iframe[name=${(0,R1.quoteCSSAttributeValue)(s[c].name())}]`):l.push(`iframe[src=${(0,R1.quoteCSSAttributeValue)(s[c].url())}]`);return{pageAlias:n,isMainFrame:!1,selectorsChain:l}}testIdAttributeName(){return this._params.testIdAttributeName||this._context.selectors().testIdAttributeName()||"data-testid"}async _performAction(e,t){this._generator.commitLastAction();let s={frame:await this._describeFrame(e),action:t},o=async(l,c,u)=>{let d={id:`call@${(0,Or.createGuid)()}`,apiName:"frame."+l,objectId:e.guid,pageId:e._page.guid,frameId:e.guid,startTime:(0,Or.monotonicTime)(),endTime:0,wallTime:Date.now(),type:"Frame",method:l,params:c,log:[]};this._generator.willPerformAction(s);try{await e.instrumentation.onBeforeCall(e,d),await u(d)}catch{d.endTime=(0,Or.monotonicTime)(),await e.instrumentation.onAfterCall(e,d),this._generator.performedActionFailed(s);return}d.endTime=(0,Or.monotonicTime)(),await e.instrumentation.onAfterCall(e,d),this._setCommittedAfterTimeout(s),this._generator.didPerformAction(s)},a=5e3;if(t.name==="click"){let{options:l}=(0,O1.toClickOptions)(t);await o("click",{selector:t.selector},c=>e.click(c,t.selector,{...l,timeout:a,strict:!0}))}if(t.name==="press"){let c=[...(0,O1.toModifiers)(t.modifiers),t.key].join("+");await o("press",{selector:t.selector,key:c},u=>e.press(u,t.selector,c,{timeout:a,strict:!0}))}if(t.name==="check"&&await o("check",{selector:t.selector},l=>e.check(l,t.selector,{timeout:a,strict:!0})),t.name==="uncheck"&&await o("uncheck",{selector:t.selector},l=>e.uncheck(l,t.selector,{timeout:a,strict:!0})),t.name==="select"){let l=t.options.map(c=>({value:c}));await o("selectOption",{selector:t.selector,values:l},c=>e.selectOption(c,t.selector,[],l,{timeout:a,strict:!0}))}}async _recordAction(e,t){this._generator.commitLastAction();let s={frame:await this._describeFrame(e),action:t};this._setCommittedAfterTimeout(s),this._generator.addAction(s)}_setCommittedAfterTimeout(e){let t=setTimeout(()=>{e.committed=!0,this._timers.delete(t)},(0,Or.isUnderTest)()?500:5e3);this._timers.add(t)}_onFrameNavigated(e,t){let n=this._pageAliases.get(t);this._generator.signal(n,e,{name:"navigation",url:e.url()})}_onPopup(e,t){let n=this._pageAliases.get(e),s=this._pageAliases.get(t);this._generator.signal(n,e.mainFrame(),{name:"popup",popupAlias:s})}_onDownload(e){let t=this._pageAliases.get(e);++this._lastDownloadOrdinal,this._generator.signal(t,e.mainFrame(),{name:"download",downloadAlias:this._lastDownloadOrdinal?String(this._lastDownloadOrdinal):""})}_onDialog(e){let t=this._pageAliases.get(e);++this._lastDialogOrdinal,this._generator.signal(t,e.mainFrame(),{name:"dialog",dialogAlias:this._lastDialogOrdinal?String(this._lastDialogOrdinal):""})}};va.Events={Change:"change"};function l6(r){return r.endsWith(".py")?"python":r.endsWith(".java")?"java":r.endsWith(".cs")?"csharp":"javascript"}var Fw=class{constructor(e){this._file=void 0,this._timer=void 0,this._text=void 0,this._file=e}setContent(e){this._text=e,this._timer||(this._timer=setTimeout(()=>this.flush(),250))}flush(){this._timer&&(clearTimeout(this._timer),this._timer=void 0),this._text&&L1.writeFileSync(this._file,this._text),this._text=void 0}};function N1(r){return r.method.toLowerCase().includes("screenshot")}async function B1(r){try{let e=r.parentFrame(),t=await r.frameElement();return!t||!e?void 0:await(await(await e._utilityContext()).injectedScript()).evaluate((a,l)=>a.generateSelectorSimple(l,{testIdAttributeName:"",omitInternalEngines:!0}),t)}catch{}}});var $e=M(Pr=>{"use strict";Object.defineProperty(Pr,"__esModule",{value:!0});Pr.BrowserContext=void 0;Pr.assertBrowserContextIsNotOwned=w6;Pr.normalizeProxySettings=V1;Pr.validateBrowserContextOptions=v6;Pr.verifyGeolocation=z1;var c6=jw(require("os")),u6=en(),Lw=ie(),d6=ht(),h6=yt(),j1=jw(Ct()),Dw=Et(),p6=W1(require("path")),f6=W1(require("fs")),Td=De(),q1=Ym(),m6=ug(),H1=OE(),Bw=xd(),g6=jw(Sg()),_6=No();function W1(r){return r&&r.__esModule?r:{default:r}}function U1(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(U1=function(n){return n?t:e})(r)}function jw(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=U1(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Od=class r extends Td.SdkObject{constructor(e,t,n){super(e,"browser-context"),this._timeoutSettings=new u6.TimeoutSettings,this._pageBindings=new Map,this._activeProgressControllers=new Set,this._options=void 0,this._requestInterceptor=void 0,this._isPersistentContext=void 0,this._closedStatus="open",this._closePromise=void 0,this._closePromiseFulfill=void 0,this._permissions=new Map,this._downloads=new Set,this._browser=void 0,this._browserContextId=void 0,this._selectors=void 0,this._origins=new Set,this._harRecorders=new Map,this.tracing=void 0,this.fetchRequest=void 0,this._customCloseHandler=void 0,this._tempDirs=[],this._settingStorageState=!1,this.initScripts=[],this._routesInFlight=new Set,this._debugger=void 0,this._closeReason=void 0,this.attribution.context=this,this._browser=e,this._options=t,this._browserContextId=n,this._isPersistentContext=!n,this._closePromise=new Promise(s=>this._closePromiseFulfill=s),this.fetchRequest=new _6.BrowserContextAPIRequestContext(this),this._options.recordHar&&this._harRecorders.set("",new H1.HarRecorder(this,null,this._options.recordHar)),this.tracing=new m6.Tracing(this,e.options.tracesDir)}isPersistentContext(){return this._isPersistentContext}setSelectors(e){this._selectors=e}selectors(){return this._selectors||this.attribution.playwright.selectors}async _initialize(){this.attribution.playwright.options.isInternalPlaywright||(this._debugger=new q1.Debugger(this),(0,Lw.debugMode)()==="inspector"&&await Bw.Recorder.show(this,{pauseOnNextStatement:!0}),this._debugger.isPaused()&&Bw.Recorder.showInspector(this),this._debugger.on(q1.Debugger.Events.PausedStateChanged,()=>{Bw.Recorder.showInspector(this)}),(0,Lw.debugMode)()==="console"&&await this.extendInjectedScript(g6.source),this._options.serviceWorkers==="block"&&await this.addInitScript(`
navigator.serviceWorker.register = async () => { console.warn('Service Worker registration blocked by Playwright'); };
`),this._options.permissions&&await this.grantPermissions(this._options.permissions))}debugger(){return this._debugger}async _ensureVideosPath(){this._options.recordVideo&&await(0,d6.mkdirIfNeeded)(p6.default.join(this._options.recordVideo.dir,"dummy"))}canResetForReuse(){return this._closedStatus==="open"}async stopPendingOperations(e){for(let t of this._activeProgressControllers)t.abort(new Error(e));await new Promise(t=>setTimeout(t,0))}static reusableContextHash(e){let t={...e};for(let n of Object.keys(t)){let s=n;t[s]===b6[s]&&delete t[s]}for(let n of $1)delete t[n];return JSON.stringify(t)}async resetForReuse(e,t){var n,s,o,a,l;if(this.setDefaultNavigationTimeout(void 0),this.setDefaultTimeout(void 0),this.tracing.resetForReuse(),t)for(let d of $1)this._options[d]=t[d];await this._cancelAllRoutesInFlight();let c=this.pages()[0],[,...u]=this.pages();for(let d of u)await d.close(e);c&&c.hasCrashed()&&(await c.close(e),c=void 0),(n=c)===null||n===void 0||n._frameManager.setCloseAllOpeningDialogs(!0),await((s=c)===null||s===void 0?void 0:s._frameManager.closeOpenDialogs()),await((o=c)===null||o===void 0?void 0:o.mainFrame().goto(e,"about:blank",{timeout:0})),(a=c)===null||a===void 0||a._frameManager.setCloseAllOpeningDialogs(!1),await this._resetStorage(),await this._removeExposedBindings(),await this._removeInitScripts(),this._options.permissions?await this.grantPermissions(this._options.permissions):await this.clearPermissions(),await this.setExtraHTTPHeaders(this._options.extraHTTPHeaders||[]),await this.setGeolocation(this._options.geolocation),await this.setOffline(!!this._options.offline),await this.setUserAgent(this._options.userAgent),await this.clearCache(),await this._resetCookies(),await((l=c)===null||l===void 0?void 0:l.resetForReuse(e))}_browserClosed(){for(let e of this.pages())e._didClose();this._didCloseInternal()}_didCloseInternal(){this._closedStatus!=="closed"&&(this.tracing.abort(),this._isPersistentContext&&this.onClosePersistent(),this._closePromiseFulfill(new Error("Context closed")),this.emit(r.Events.Close))}async cookies(e=[]){return e&&!Array.isArray(e)&&(e=[e]),await this.doGetCookies(e)}async clearCookies(e){let t=await this.cookies();await this.doClearCookies();let n=(o,a,l)=>l?l instanceof RegExp?(l.lastIndex=0,l.test(o[a])):o[a]===l:!0,s=t.filter(o=>!n(o,"name",e.name)||!n(o,"domain",e.domain)||!n(o,"path",e.path));await this.addCookies(s)}setHTTPCredentials(e){return this.doSetHTTPCredentials(e)}async exposeBinding(e,t,n){if(this._pageBindings.has(e))throw new Error(`Function "${e}" has been already registered`);for(let o of this.pages())if(o.getBinding(e))throw new Error(`Function "${e}" has been already registered in one of the pages`);let s=new Dw.PageBinding(e,n,t);this._pageBindings.set(e,s),await this.doExposeBinding(s)}async _removeExposedBindings(){for(let e of this._pageBindings.keys())e.startsWith("__pw")||this._pageBindings.delete(e);await this.doRemoveExposedBindings()}async grantPermissions(e,t){let n="*";t&&(n=new URL(t).origin);let s=new Set(this._permissions.get(n)||[]);e.forEach(a=>s.add(a));let o=[...s.values()];this._permissions.set(n,o),await this.doGrantPermissions(n,o)}async clearPermissions(){this._permissions.clear(),await this.doClearPermissions()}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e)}async _loadDefaultContextAsIs(e){if(!this.pages().length){let n=h6.helper.waitForEvent(e,this,r.Events.Page);e.cleanupWhenAborted(()=>n.dispose);let s=await n.promise;if(s._pageIsError)throw s._pageIsError}let t=this.pages();if(t[0]._pageIsError)throw t[0]._pageIsError;return await t[0].mainFrame()._waitForLoadState(e,"load"),t}async _loadDefaultContext(e){let t=await this._loadDefaultContextAsIs(e),n=this._browser.options.name;if(this._options.isMobile&&n==="chromium"||this._options.locale&&n==="webkit"){let s=t[0];await this.newPage(e.metadata),await s.close(e.metadata)}}_authenticateProxyViaHeader(){let e=this._options.proxy||this._browser.options.proxy||{username:void 0,password:void 0},{username:t,password:n}=e;if(t){this._options.httpCredentials={username:t,password:n};let s=Buffer.from(`${t}:${n}`).toString("base64");this._options.extraHTTPHeaders=j1.mergeHeaders([this._options.extraHTTPHeaders,j1.singleHeader("Proxy-Authorization",`Basic ${s}`)])}}_authenticateProxyViaCredentials(){let e=this._options.proxy||this._browser.options.proxy;if(!e)return;let{username:t,password:n}=e;t&&(this._options.httpCredentials={username:t,password:n||""})}async addInitScript(e){this.initScripts.push(e),await this.doAddInitScript(e)}async _removeInitScripts(){this.initScripts.splice(0,this.initScripts.length),await this.doRemoveInitScripts()}async setRequestInterceptor(e){this._requestInterceptor=e,await this.doUpdateRequestInterception()}isClosingOrClosed(){return this._closedStatus!=="open"}async _deleteAllDownloads(){await Promise.all(Array.from(this._downloads).map(e=>e.artifact.deleteOnContextClose()))}async _deleteAllTempDirs(){await Promise.all(this._tempDirs.map(async e=>await f6.default.promises.unlink(e).catch(t=>{})))}setCustomCloseHandler(e){this._customCloseHandler=e}async close(e){if(this._closedStatus==="open"){e.reason&&(this._closeReason=e.reason),this.emit(r.Events.BeforeClose),this._closedStatus="closing";for(let n of this._harRecorders.values())await n.flush();await this.tracing.flush();let t=[];for(let{context:n,artifact:s}of this._browser._idToVideo.values())n===this&&t.push(s.finishedPromise());this._customCloseHandler?await this._customCloseHandler():await this.doClose(e.reason),t.push(this._deleteAllDownloads()),t.push(this._deleteAllTempDirs()),await Promise.all(t),this._customCloseHandler||this._didCloseInternal()}await this._closePromise}async newPage(e){let t=await this.newPageDelegate();e.isServerSide&&t.potentiallyUninitializedPage().markAsServerSideOnly();let n=await t.pageOrError();if(n instanceof Dw.Page){if(n.isClosed())throw new Error("Page has been closed.");return n}throw n}addVisitedOrigin(e){this._origins.add(e)}async storageState(){let e={cookies:await this.cookies(),origins:[]},t=new Set(this._origins);for(let n of this.pages()){let s=n.mainFrame().origin();if(!(!s||!t.has(s)))try{let o=await n.mainFrame().nonStallingEvaluateInExistingContext(`({
          localStorage: Object.keys(localStorage).map(name => ({ name, value: localStorage.getItem(name) })),
        })`,!1,"utility");o.localStorage.length&&e.origins.push({origin:s,localStorage:o.localStorage}),t.delete(s)}catch{}}if(t.size){let n=(0,Td.serverSideCallMetadata)(),s=await this.newPage(n);await s._setServerRequestInterceptor(o=>(o.fulfill({body:"<html></html>",requestUrl:o.request().url()}).catch(()=>{}),!0));for(let o of t){let a={origin:o,localStorage:[]},l=s.mainFrame();await l.goto(n,o);let c=await l.evaluateExpression(`({
          localStorage: Object.keys(localStorage).map(name => ({ name, value: localStorage.getItem(name) })),
        })`,{world:"utility"});a.localStorage=c.localStorage,c.localStorage.length&&e.origins.push(a)}await s.close(n)}return e}async _resetStorage(){var e;let t=this._origins,n=new Map(((e=this._options.storageState)===null||e===void 0||(e=e.origins)===null||e===void 0?void 0:e.map(a=>[a.origin,a]))||[]);if(!t.size&&!n.size)return;let s=this.pages()[0],o=(0,Td.serverSideCallMetadata)();s=s||await this.newPage({...o,isServerSide:!1}),await s._setServerRequestInterceptor(a=>(a.fulfill({body:"<html></html>",requestUrl:a.request().url()}).catch(()=>{}),!0));for(let a of new Set([...t,...n.keys()])){let l=s.mainFrame();await l.goto(o,a),await l.resetStorageForCurrentOriginBestEffort(n.get(a))}await s._setServerRequestInterceptor(void 0),this._origins=new Set([...n.keys()])}async _resetCookies(){var e,t;await this.doClearCookies(),(e=this._options.storageState)!==null&&e!==void 0&&e.cookies&&await this.addCookies((t=this._options.storageState)===null||t===void 0?void 0:t.cookies)}isSettingStorageState(){return this._settingStorageState}async setStorageState(e,t){this._settingStorageState=!0;try{if(t.cookies&&await this.addCookies(t.cookies),t.origins&&t.origins.length){let n=(0,Td.serverSideCallMetadata)(),s=await this.newPage(n);await s._setServerRequestInterceptor(o=>(o.fulfill({body:"<html></html>",requestUrl:o.request().url()}).catch(()=>{}),!0));for(let o of t.origins){let a=s.mainFrame();await a.goto(e,o.origin),await a.evaluateExpression(`
            originState => {
              for (const { name, value } of (originState.localStorage || []))
                localStorage.setItem(name, value);
            }`,{isFunction:!0,world:"utility"},o)}await s.close(n)}}finally{this._settingStorageState=!1}}async extendInjectedScript(e,t){let n=o=>o.extendInjectedScript(e,t).catch(()=>{}),s=o=>(o.on(Dw.Page.Events.InternalFrameNavigatedToNewDocument,n),Promise.all(o.frames().map(n)));return this.on(r.Events.Page,s),Promise.all(this.pages().map(s))}async _harStart(e,t){let n=(0,Lw.createGuid)();return this._harRecorders.set(n,new H1.HarRecorder(this,e,t)),n}async _harExport(e){return this._harRecorders.get(e||"").export()}addRouteInFlight(e){this._routesInFlight.add(e)}removeRouteInFlight(e){this._routesInFlight.delete(e)}async _cancelAllRoutesInFlight(){await Promise.all([...this._routesInFlight].map(e=>e.abort())).catch(()=>{}),this._routesInFlight.clear()}};Pr.BrowserContext=Od;Od.Events={Console:"console",Close:"close",Dialog:"dialog",Page:"page",PageError:"pageerror",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished",RequestAborted:"requestaborted",RequestFulfilled:"requestfulfilled",RequestContinued:"requestcontinued",BeforeClose:"beforeclose",VideoStarted:"videostarted"};function w6(r){for(let e of r.pages())if(e._ownedContext)throw new Error("Please use browser.newContext() for multi-page scripts that share the context.")}function v6(r,e){if(r.noDefaultViewport&&r.deviceScaleFactor!==void 0)throw new Error('"deviceScaleFactor" option is not supported with null "viewport"');if(r.noDefaultViewport&&r.isMobile)throw new Error('"isMobile" option is not supported with null "viewport"');if(r.acceptDownloads===void 0&&(r.acceptDownloads="accept"),!r.viewport&&!r.noDefaultViewport&&(r.viewport={width:1280,height:720}),r.recordVideo){if(!r.recordVideo.size)if(r.noDefaultViewport)r.recordVideo.size={width:800,height:600};else{let t=r.viewport,n=Math.min(1,800/Math.max(t.width,t.height));r.recordVideo.size={width:Math.floor(t.width*n),height:Math.floor(t.height*n)}}r.recordVideo.size.width&=-2,r.recordVideo.size.height&=-2}if(r.proxy){if(!e.proxy&&e.isChromium&&c6.platform()==="win32")throw new Error(`Browser needs to be launched with the global proxy. If all contexts override the proxy, global proxy will be never used and can be any string, for example "launch({ proxy: { server: 'http://per-context' } })"`);r.proxy=V1(r.proxy)}z1(r.geolocation)}function z1(r){if(!r)return;r.accuracy=r.accuracy||0;let{longitude:e,latitude:t,accuracy:n}=r;if(e<-180||e>180)throw new Error("geolocation.longitude: precondition -180 <= LONGITUDE <= 180 failed.");if(t<-90||t>90)throw new Error("geolocation.latitude: precondition -90 <= LATITUDE <= 90 failed.");if(n<0)throw new Error("geolocation.accuracy: precondition 0 <= ACCURACY failed.")}function V1(r){let{server:e,bypass:t}=r,n;try{n=new URL(e),(!n.host||!n.protocol)&&(n=new URL("http://"+e))}catch{n=new URL("http://"+e)}if(n.protocol==="socks4:"&&(r.username||r.password))throw new Error("Socks4 proxy protocol does not support authentication");if(n.protocol==="socks5:"&&(r.username||r.password))throw new Error("Browser does not support socks5 proxy authentication");return e=n.protocol+"//"+n.host,t&&(t=t.split(",").map(s=>s.trim()).join(",")),{...r,server:e,bypass:t}}var $1=["colorScheme","forcedColors","reducedMotion","screen","userAgent","viewport"],b6={noDefaultViewport:!1,ignoreHTTPSErrors:!1,javaScriptEnabled:!0,bypassCSP:!1,offline:!1,isMobile:!1,hasTouch:!1,acceptDownloads:"accept",strictSelectors:!1,serviceWorkers:"allow",locale:"en-US"}});var K1=M(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.CookieStore=void 0;ba.domainMatches=G1;var qw=class{constructor(e){this._raw=void 0,this._raw=e}name(){return this._raw.name}matches(e){return!(this._raw.secure&&e.protocol!=="https:"&&e.hostname!=="localhost"||!G1(e.hostname,this._raw.domain)||!y6(e.pathname,this._raw.path))}equals(e){return this._raw.name===e._raw.name&&this._raw.domain===e._raw.domain&&this._raw.path===e._raw.path}networkCookie(){return this._raw}updateExpiresFrom(e){this._raw.expires=e._raw.expires}expired(){return this._raw.expires===-1?!1:this._raw.expires*1e3<Date.now()}},Hw=class r{constructor(){this._nameToCookies=new Map}addCookies(e){for(let t of e)this._addCookie(new qw(t))}cookies(e){let t=[];for(let n of this._cookiesIterator())n.matches(e)&&t.push(n.networkCookie());return t}allCookies(){let e=[];for(let t of this._cookiesIterator())e.push(t.networkCookie());return e}_addCookie(e){let t=this._nameToCookies.get(e.name());t||(t=new Set,this._nameToCookies.set(e.name(),t));for(let n of t)n.equals(e)&&t.delete(n);t.add(e),r.pruneExpired(t)}*_cookiesIterator(){for(let[e,t]of this._nameToCookies){r.pruneExpired(t);for(let n of t)yield n;t.size===0&&this._nameToCookies.delete(e)}}static pruneExpired(e){for(let t of e)t.expired()&&e.delete(t)}};ba.CookieStore=Hw;function G1(r,e){return r===e?!0:e.startsWith(".")?(r="."+r,r.endsWith(e)):!1}function y6(r,e){return r===e?!0:(r.endsWith("/")||(r=r+"/"),e.endsWith("/")||(e=e+"/"),r.startsWith(e))}});var X1=M(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});Pd.MultipartFormData=void 0;var x6=Be(),$w=class{constructor(){this._boundary=void 0,this._chunks=[],this._boundary=S6()}contentTypeHeader(){return`multipart/form-data; boundary=${this._boundary}`}addField(e,t){this._beginMultiPartHeader(e),this._finishMultiPartHeader(),this._chunks.push(Buffer.from(t)),this._finishMultiPartField()}addFileField(e,t){this._beginMultiPartHeader(e),this._chunks.push(Buffer.from(`; filename="${t.name}"`)),this._chunks.push(Buffer.from(`\r
content-type: ${t.mimeType||x6.mime.getType(t.name)||"application/octet-stream"}`)),this._finishMultiPartHeader(),this._chunks.push(t.buffer),this._finishMultiPartField()}finish(){return this._addBoundary(!0),Buffer.concat(this._chunks)}_beginMultiPartHeader(e){this._addBoundary(),this._chunks.push(Buffer.from(`content-disposition: form-data; name="${e}"`))}_finishMultiPartHeader(){this._chunks.push(Buffer.from(`\r
\r
`))}_finishMultiPartField(){this._chunks.push(Buffer.from(`\r
`))}_addBoundary(e){this._chunks.push(Buffer.from("--"+this._boundary)),e&&this._chunks.push(Buffer.from("--")),this._chunks.push(Buffer.from(`\r
`))}};Pd.MultipartFormData=$w;var J1=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,65,66];function S6(){let r=[];for(let e=0;e<16;e++)r.push(J1[Math.floor(Math.random()*J1.length)]);return"----WebKitFormBoundary"+String.fromCharCode(...r)}});var No=M(Ar=>{"use strict";Object.defineProperty(Ar,"__esModule",{value:!0});Ar.GlobalAPIRequestContext=Ar.BrowserContextAPIRequestContext=Ar.APIRequestContext=void 0;var E6=iT(require("http")),k6=iT(require("https")),eT=require("stream"),C6=nT(require("url")),ya=nT(require("zlib")),T6=en(),O6=Nn(),xa=ie(),Y1=Be(),P6=$e(),tT=K1(),A6=X1(),Q1=ko(),I6=De(),R6=Ut(),M6=ug(),Z1=Ct();function nT(r){return r&&r.__esModule?r:{default:r}}function rT(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(rT=function(n){return n?t:e})(r)}function iT(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=rT(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var gi=class r extends I6.SdkObject{static findResponseBody(e){for(let t of r.allInstances){let n=t.fetchResponses.get(e);if(n)return n}}constructor(e){super(e,"request-context"),this.fetchResponses=new Map,this.fetchLog=new Map,this._activeProgressControllers=new Set,this._closeReason=void 0,r.allInstances.add(this)}_disposeImpl(){r.allInstances.delete(this),this.fetchResponses.clear(),this.fetchLog.clear(),this.emit(r.Events.Dispose)}disposeResponse(e){this.fetchResponses.delete(e),this.fetchLog.delete(e)}_storeResponseBody(e){let t=(0,xa.createGuid)();return this.fetchResponses.set(t,e),t}async fetch(e,t){var n;let s=this._defaultOptions(),o={"user-agent":s.userAgent,accept:"*/*","accept-encoding":"gzip,deflate,br"};if(s.extraHTTPHeaders)for(let{name:g,value:x}of s.extraHTTPHeaders)Jn(o,g,x);if(e.headers)for(let{name:g,value:x}of e.headers)Jn(o,g,x);let a=new URL(e.url,s.baseURL);if(e.params)for(let{name:g,value:x}of e.params)a.searchParams.set(g,x);let l=((n=e.method)===null||n===void 0?void 0:n.toUpperCase())||"GET",c=s.proxy,u;if(c&&c.server!=="per-context"&&!B6(a,c.bypass)){var d;let g=C6.default.parse(c.server);(d=g.protocol)!==null&&d!==void 0&&d.startsWith("socks")?u=new Y1.SocksProxyAgent({host:g.hostname,port:g.port||void 0}):(c.username&&(g.auth=`${c.username}:${c.password||""}`),u=new Y1.HttpsProxyAgent(g))}let h=s.timeoutSettings.timeout(e),p=h&&(0,xa.monotonicTime)()+h,f={method:l,headers:o,agent:u,maxRedirects:e.maxRedirects===0?-1:e.maxRedirects===void 0?20:e.maxRedirects,timeout:h,deadline:p,__testHookLookup:e.__testHookLookup};(e.ignoreHTTPSErrors||s.ignoreHTTPSErrors)&&(f.rejectUnauthorized=!1);let _=D6(e,o);_&&Jn(o,"content-length",String(_.byteLength));let v=new R6.ProgressController(t,this),w=await v.run(g=>this._sendRequest(g,a,f,_)),m=this._storeResponseBody(w.body);if(this.fetchLog.set(m,v.metadata.log),e.failOnStatusCode&&(w.status<200||w.status>=400))throw new Error(`${w.status} ${w.statusText}`);return{...w,fetchUid:m}}_parseSetCookieHeader(e,t){if(!t)return[];let n=new URL(e),s="/"+n.pathname.substr(1).split("/").slice(0,-1).join("/"),o=[];for(let a of t){let l=L6(a);l&&(l.domain?(0,xa.assert)(l.domain.startsWith(".")||!l.domain.includes(".")):l.domain=n.hostname,(0,tT.domainMatches)(n.hostname,l.domain)&&((!l.path||!l.path.startsWith("/"))&&(l.path=s),o.push(l)))}return o}async _updateRequestCookieHeader(e,t){if(Ww(t,"cookie")!==void 0)return;let n=await this._cookies(e);if(n.length){let s=n.map(o=>`${o.name}=${o.value}`);Jn(t,"cookie",s.join("; "))}}async _sendRequest(e,t,n,s){var o;await this._updateRequestCookieHeader(t,n.headers);let a=((o=Ww(n.headers,"cookie"))===null||o===void 0?void 0:o.split(";").map(c=>{let[u,d]=c.split("=").map(h=>h.trim());return{name:u,value:d}}))||[],l={url:t,method:n.method,headers:n.headers,cookies:a,postData:s};return this.emit(r.Events.Request,l),new Promise((c,u)=>{let d=(t.protocol==="https:"?k6:E6).request,h=n.agent||(t.protocol==="https:"?Q1.httpsHappyEyeballsAgent:Q1.httpHappyEyeballsAgent),p={...n,agent:h},f=d(t,p,async v=>{let w=E=>{let C={requestEvent:l,httpVersion:v.httpVersion,statusCode:v.statusCode||0,statusMessage:v.statusMessage||"",headers:v.headers,rawHeaders:v.rawHeaders,cookies:m,body:E};this.emit(r.Events.RequestFinished,C)};e.log(`\u2190 ${v.statusCode} ${v.statusMessage}`);for(let[E,C]of Object.entries(v.headers))e.log(`  ${E}: ${C}`);let m=this._parseSetCookieHeader(v.url||t.toString(),v.headers["set-cookie"]);if(m.length)try{await this._addCookies(m)}catch{await Promise.all(m.map(C=>this._addCookies([C]).catch(()=>{})))}if(N6.includes(v.statusCode)&&n.maxRedirects>=0){if(!n.maxRedirects){u(new Error("Max redirect count exceeded")),f.destroy();return}let E={...n.headers};Is(E,"cookie");let C=v.statusCode,k=n.method;((C===301||C===302)&&k==="POST"||C===303&&!["GET","HEAD"].includes(k))&&(k="GET",s=void 0,Is(E,"content-encoding"),Is(E,"content-language"),Is(E,"content-length"),Is(E,"content-location"),Is(E,"content-type"));let F={method:k,headers:E,agent:n.agent,maxRedirects:n.maxRedirects-1,timeout:n.timeout,deadline:n.deadline,__testHookLookup:n.__testHookLookup};if(n.rejectUnauthorized===!1&&(F.rejectUnauthorized=!1),v.headers.location){let O;try{O=new URL(v.headers.location,t)}catch{u(new Error(`uri requested responds with an invalid redirect URL: ${v.headers.location}`)),f.destroy();return}E.host&&(E.host=O.host),w(),c(this._sendRequest(e,O,F,s)),f.destroy();return}}if(v.statusCode===401&&!Ww(n.headers,"authorization")){let E=v.headers["www-authenticate"],C=this._getHttpCredentials(t);if(E!=null&&E.trim().startsWith("Basic")&&C){let{username:k,password:F}=C,O=Buffer.from(`${k||""}:${F||""}`).toString("base64");Jn(n.headers,"authorization",`Basic ${O}`),w(),c(this._sendRequest(e,t,n,s)),f.destroy();return}}v.on("aborted",()=>u(new Error("aborted")));let g=[],x=()=>{let E=Buffer.concat(g);w(E),c({url:v.url||t.toString(),status:v.statusCode||0,statusText:v.statusMessage||"",headers:F6(v.rawHeaders),body:E})},b=v,y,S=v.headers["content-encoding"];if(S==="gzip"||S==="x-gzip"?y=ya.default.createGunzip({flush:ya.default.constants.Z_SYNC_FLUSH,finishFlush:ya.default.constants.Z_SYNC_FLUSH}):S==="br"?y=ya.default.createBrotliDecompress():S==="deflate"&&(y=ya.default.createInflate()),y){let E=new Uw(x);b=(0,eT.pipeline)(v,E,y,C=>{C&&u(new Error(`failed to decompress '${S}' encoding: ${C.message}`))}),b.on("error",C=>u(new Error(`failed to decompress '${S}' encoding: ${C}`)))}else b.on("error",u);b.on("data",E=>g.push(E)),b.on("end",x)});f.on("error",u);let _=()=>{u(new Error("Request context disposed.")),f.destroy()};if(this.on(r.Events.Dispose,_),f.on("close",()=>this.off(r.Events.Dispose,_)),e.log(`\u2192 ${n.method} ${t.toString()}`),n.headers)for(let[v,w]of Object.entries(n.headers))e.log(`  ${v}: ${w}`);if(n.deadline){let v=()=>{u(new Error(`Request timed out after ${n.timeout}ms`)),f.destroy()},w=n.deadline-(0,xa.monotonicTime)();if(w<=0){v();return}f.setTimeout(w,v)}s&&f.write(s),f.end()})}_getHttpCredentials(e){var t,n;if(!((t=this._defaultOptions().httpCredentials)!==null&&t!==void 0&&t.origin)||e.origin.toLowerCase()===((n=this._defaultOptions().httpCredentials)===null||n===void 0||(n=n.origin)===null||n===void 0?void 0:n.toLowerCase()))return this._defaultOptions().httpCredentials}};Ar.APIRequestContext=gi;gi.Events={Dispose:"dispose",Request:"request",RequestFinished:"requestfinished"};gi.allInstances=new Set;var Uw=class extends eT.Transform{constructor(e){super(),this._receivedSomeData=!1,this._onEmptyStreamCallback=void 0,this._onEmptyStreamCallback=e}_transform(e,t,n){this._receivedSomeData=!0,n(null,e)}_flush(e){this._receivedSomeData?e(null):this._onEmptyStreamCallback()}},zw=class extends gi{constructor(e){super(e),this._context=void 0,this._context=e,e.once(P6.BrowserContext.Events.Close,()=>this._disposeImpl())}tracing(){return this._context.tracing}async dispose(){this.fetchResponses.clear()}_defaultOptions(){return{userAgent:this._context._options.userAgent||this._context._browser.userAgent(),extraHTTPHeaders:this._context._options.extraHTTPHeaders,httpCredentials:this._context._options.httpCredentials,proxy:this._context._options.proxy||this._context._browser.options.proxy,timeoutSettings:this._context._timeoutSettings,ignoreHTTPSErrors:this._context._options.ignoreHTTPSErrors,baseURL:this._context._options.baseURL}}async _addCookies(e){await this._context.addCookies(e)}async _cookies(e){return await this._context.cookies(e.toString())}async storageState(){return this._context.storageState()}};Ar.BrowserContextAPIRequestContext=zw;var Vw=class extends gi{constructor(e,t){super(e),this._cookieStore=new tT.CookieStore,this._options=void 0,this._origins=void 0,this._tracing=void 0,this.attribution.context=this;let n=new T6.TimeoutSettings;t.timeout!==void 0&&n.setDefaultTimeout(t.timeout);let s=t.proxy;if(s!=null&&s.server){let o=s?.server.trim();/^\w+:\/\//.test(o)||(o="http://"+o),s.server=o}t.storageState&&(this._origins=t.storageState.origins,this._cookieStore.addCookies(t.storageState.cookies||[])),this._options={baseURL:t.baseURL,userAgent:t.userAgent||(0,O6.getUserAgent)(),extraHTTPHeaders:t.extraHTTPHeaders,ignoreHTTPSErrors:!!t.ignoreHTTPSErrors,httpCredentials:t.httpCredentials,proxy:s,timeoutSettings:n},this._tracing=new M6.Tracing(this,t.tracesDir)}tracing(){return this._tracing}async dispose(){await this._tracing.flush(),await this._tracing.deleteTmpTracesDir(),this._disposeImpl()}_defaultOptions(){return this._options}async _addCookies(e){this._cookieStore.addCookies(e)}async _cookies(e){return this._cookieStore.cookies(e)}async storageState(){return{cookies:this._cookieStore.allCookies(),origins:this._origins||[]}}};Ar.GlobalAPIRequestContext=Vw;function F6(r){let e=[];for(let t=0;t<r.length;t+=2)e.push({name:r[t],value:r[t+1]});return e}var N6=[301,302,303,307,308];function L6(r){let e=r.split(";").filter(o=>o.trim().length>0).map(o=>{let a="",l="",c=o.indexOf("=");return c===-1?a=o.trim():(a=o.slice(0,c).trim(),l=o.slice(c+1).trim()),[a,l]});if(!e.length)return null;let[t,n]=e[0],s={name:t,value:n,domain:"",path:"",expires:-1,httpOnly:!1,secure:!1,sameSite:"Lax"};for(let o=1;o<e.length;o++){let[a,l]=e[o];switch(a.toLowerCase()){case"expires":let c=+new Date(l);isFinite(c)&&(c<=0?s.expires=0:s.expires=Math.min(c/1e3,Z1.kMaxCookieExpiresDateInSeconds));break;case"max-age":let u=parseInt(l,10);isFinite(u)&&(u<=0?s.expires=0:s.expires=Math.min(Date.now()/1e3+u,Z1.kMaxCookieExpiresDateInSeconds));break;case"domain":s.domain=l.toLocaleLowerCase()||"",s.domain&&!s.domain.startsWith(".")&&s.domain.includes(".")&&(s.domain="."+s.domain);break;case"path":s.path=l||"";break;case"secure":s.secure=!0;break;case"httponly":s.httpOnly=!0;break;case"samesite":switch(l.toLowerCase()){case"none":s.sameSite="None";break;case"lax":s.sameSite="Lax";break;case"strict":s.sameSite="Strict";break}break}}return s}function D6(r,e){if((0,xa.assert)((r.postData?1:0)+(r.jsonData?1:0)+(r.formData?1:0)+(r.multipartData?1:0)<=1,"Only one of 'data', 'form' or 'multipart' can be specified"),r.jsonData!==void 0)return Jn(e,"content-type","application/json",!0),Buffer.from(r.jsonData,"utf8");if(r.formData){let t=new URLSearchParams;for(let{name:n,value:s}of r.formData)t.append(n,s);return Jn(e,"content-type","application/x-www-form-urlencoded",!0),Buffer.from(t.toString(),"utf8")}else if(r.multipartData){let t=new A6.MultipartFormData;for(let n of r.multipartData)n.file?t.addFileField(n.name,n.file):n.value&&t.addField(n.name,n.value);return Jn(e,"content-type",t.contentTypeHeader(),!0),t.finish()}else if(r.postData!==void 0)return Jn(e,"content-type","application/octet-stream",!0),r.postData}function Jn(r,e,t,n=!1){let s=Object.entries(r).find(o=>o[0].toLowerCase()===e.toLowerCase());s?n||(r[s[0]]=t):r[e]=t}function Ww(r,e){let t=Object.entries(r).find(n=>n[0].toLowerCase()===e.toLowerCase());return t?t[1]:void 0}function Is(r,e){delete r[e]}function B6(r,e){if(!e)return!1;let t=e.split(",").map(s=>(s=s.trim(),s.startsWith(".")||(s="."+s),s)),n="."+r.hostname;return t.some(s=>n.endsWith(s))}});var Rs=M(bi=>{"use strict";Object.defineProperty(bi,"__esModule",{value:!0});bi.SocksProxyHandler=bi.SocksProxy=void 0;bi.parsePattern=Kw;var oT=lT(require("events")),vi=lT(require("net")),_i=Le(),aT=ko(),Sa=ie();function lT(r){return r&&r.__esModule?r:{default:r}}var cT=function(r){return r[r.NO_AUTHENTICATION_REQUIRED=0]="NO_AUTHENTICATION_REQUIRED",r[r.GSSAPI=1]="GSSAPI",r[r.USERNAME_PASSWORD=2]="USERNAME_PASSWORD",r[r.NO_ACCEPTABLE_METHODS=255]="NO_ACCEPTABLE_METHODS",r}(cT||{}),Ad=function(r){return r[r.IPv4=1]="IPv4",r[r.FqName=3]="FqName",r[r.IPv6=4]="IPv6",r}(Ad||{}),uT=function(r){return r[r.CONNECT=1]="CONNECT",r[r.BIND=2]="BIND",r[r.UDP_ASSOCIATE=3]="UDP_ASSOCIATE",r}(uT||{}),wi=function(r){return r[r.Succeeded=0]="Succeeded",r[r.GeneralServerFailure=1]="GeneralServerFailure",r[r.NotAllowedByRuleSet=2]="NotAllowedByRuleSet",r[r.NetworkUnreachable=3]="NetworkUnreachable",r[r.HostUnreachable=4]="HostUnreachable",r[r.ConnectionRefused=5]="ConnectionRefused",r[r.TtlExpired=6]="TtlExpired",r[r.CommandNotSupported=7]="CommandNotSupported",r[r.AddressTypeNotSupported=8]="AddressTypeNotSupported",r}(wi||{}),Gw=class{constructor(e,t,n){this._buffer=Buffer.from([]),this._offset=0,this._fence=0,this._fenceCallback=void 0,this._socket=void 0,this._boundOnData=void 0,this._uid=void 0,this._client=void 0,this._uid=e,this._socket=t,this._client=n,this._boundOnData=this._onData.bind(this),t.on("data",this._boundOnData),t.on("close",()=>this._onClose()),t.on("end",()=>this._onClose()),t.on("error",()=>this._onClose()),this._run().catch(()=>this._socket.end())}async _run(){(0,Sa.assert)(await this._authenticate());let{command:e,host:t,port:n}=await this._parseRequest();if(e!==uT.CONNECT){this._writeBytes(Buffer.from([5,wi.CommandNotSupported,0,1,0,0,0,0,0,0]));return}this._socket.off("data",this._boundOnData),this._client.onSocketRequested({uid:this._uid,host:t,port:n})}async _authenticate(){let e=await this._readByte();(0,Sa.assert)(e===5,"The VER field must be set to x05 for this version of the protocol, was "+e);let t=await this._readByte();(0,Sa.assert)(t,"No authentication methods specified");let n=await this._readBytes(t);for(let s of n)if(s===0)return this._writeBytes(Buffer.from([e,s])),!0;return this._writeBytes(Buffer.from([e,cT.NO_ACCEPTABLE_METHODS])),!1}async _parseRequest(){let e=await this._readByte();(0,Sa.assert)(e===5,"The VER field must be set to x05 for this version of the protocol, was "+e);let t=await this._readByte();await this._readByte();let n=await this._readByte(),s="";switch(n){case Ad.IPv4:s=(await this._readBytes(4)).join(".");break;case Ad.FqName:let a=await this._readByte();s=(await this._readBytes(a)).toString();break;case Ad.IPv6:let l=await this._readBytes(16),c=[];for(let u=0;u<8;++u)c.push(l.readUInt16BE(u*2).toString(16));s=c.join(":");break}let o=(await this._readBytes(2)).readUInt16BE(0);return this._buffer=Buffer.from([]),this._offset=0,this._fence=0,{command:t,host:s,port:o}}async _readByte(){return(await this._readBytes(1))[0]}async _readBytes(e){return this._fence=this._offset+e,(!this._buffer||this._buffer.length<this._fence)&&await new Promise(t=>this._fenceCallback=t),this._offset+=e,this._buffer.slice(this._offset-e,this._offset)}_writeBytes(e){this._socket.writable&&this._socket.write(e)}_onClose(){this._client.onSocketClosed({uid:this._uid})}_onData(e){if(this._buffer=Buffer.concat([this._buffer,e]),this._fenceCallback&&this._buffer.length>=this._fence){let t=this._fenceCallback;this._fenceCallback=void 0,t()}}socketConnected(e,t){this._writeBytes(Buffer.from([5,wi.Succeeded,0,...sT(e),t>>8,t&255])),this._socket.on("data",n=>this._client.onSocketData({uid:this._uid,data:n}))}socketFailed(e){let t=Buffer.from([5,0,0,...sT("0.0.0.0"),0,0]);switch(e){case"ENOENT":case"ENOTFOUND":case"ETIMEDOUT":case"EHOSTUNREACH":t[1]=wi.HostUnreachable;break;case"ENETUNREACH":t[1]=wi.NetworkUnreachable;break;case"ECONNREFUSED":t[1]=wi.ConnectionRefused;break;case"ERULESET":t[1]=wi.NotAllowedByRuleSet;break}this._writeBytes(t),this._socket.end()}sendData(e){this._socket.write(e)}end(){this._socket.end()}error(e){this._socket.destroy(new Error(e))}};function j6(r){return[...r].reduce((e,t)=>{let n=t.charCodeAt(0);if(n>=48&&n<=57)return e+n;if(n>=97&&n<=102)return e+(n-97)+10;if(n>=65&&n<=70)return e+(n-65)+10;throw new Error("Invalid IPv6 token "+r)},0)}function sT(r){if(vi.default.isIPv4(r))return[1,...r.split(".",4).map(e=>+e&255)];if(vi.default.isIPv6(r)){let e=[4],t=r.split(":",8);for(;t.length<8;)t.unshift("");for(let n of t){let s=j6(n);e.push(s>>8&255,s&255)}return e}throw new Error("Only IPv4 and IPv6 addresses are supported")}function q6(r){let e=r.split("*").map(t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join(".*");return new RegExp("^"+e+"$")}function Kw(r){if(!r)return()=>!1;let e=r.split(",").map(t=>{let n=t.match(/^(.*?)(?::(\d+))?$/);if(!n)throw new Error(`Unsupported token "${t}" in pattern "${r}"`);let s=n[2]?+n[2]:void 0,o=c=>s===void 0||s===c,a=n[1];if(a==="<loopback>")return(c,u)=>o(u)?c==="localhost"||c.endsWith(".localhost")||c==="127.0.0.1"||c==="[::1]":!1;if(a==="*")return(c,u)=>o(u);if(vi.default.isIPv4(a)||vi.default.isIPv6(a))return(c,u)=>c===a&&o(u);a[0]==="."&&(a="*"+a);let l=q6(a);return(c,u)=>!o(u)||vi.default.isIPv4(c)||vi.default.isIPv6(c)?!1:!!c.match(l)});return(t,n)=>e.some(s=>s(t,n))}var Id=class r extends oT.default{constructor(){super(),this._server=void 0,this._connections=new Map,this._sockets=new Set,this._closed=!1,this._port=void 0,this._patternMatcher=()=>!1,this._directSockets=new Map,this._server=new vi.default.Server(e=>{let t=(0,Sa.createGuid)(),n=new Gw(t,e,this);this._connections.set(t,n)}),this._server.on("connection",e=>{if(this._closed){e.destroy();return}this._sockets.add(e),e.once("close",()=>this._sockets.delete(e))})}setPattern(e){try{this._patternMatcher=Kw(e)}catch{this._patternMatcher=()=>!1}}async _handleDirect(e){try{var t;let s=await(0,aT.createSocket)(e.host,e.port);s.on("data",l=>{var c;return(c=this._connections.get(e.uid))===null||c===void 0?void 0:c.sendData(l)}),s.on("error",l=>{var c;(c=this._connections.get(e.uid))===null||c===void 0||c.error(l.message),this._directSockets.delete(e.uid)}),s.on("end",()=>{var l;(l=this._connections.get(e.uid))===null||l===void 0||l.end(),this._directSockets.delete(e.uid)});let o=s.localAddress,a=s.localPort;this._directSockets.set(e.uid,s),(t=this._connections.get(e.uid))===null||t===void 0||t.socketConnected(o,a)}catch(s){var n;(n=this._connections.get(e.uid))===null||n===void 0||n.socketFailed(s.code)}}port(){return this._port}async listen(e){return new Promise(t=>{this._server.listen(e,()=>{let n=this._server.address().port;this._port=n,t(n)})})}async close(){if(!this._closed){this._closed=!0;for(let e of this._sockets)e.destroy();this._sockets.clear(),await new Promise(e=>this._server.close(e))}}onSocketRequested(e){if(!this._patternMatcher(e.host,e.port)){this._handleDirect(e);return}this.emit(r.Events.SocksRequested,e)}onSocketData(e){let t=this._directSockets.get(e.uid);if(t){t.write(e.data);return}this.emit(r.Events.SocksData,e)}onSocketClosed(e){let t=this._directSockets.get(e.uid);if(t){t.destroy(),this._directSockets.delete(e.uid);return}this.emit(r.Events.SocksClosed,e)}socketConnected({uid:e,host:t,port:n}){var s;(s=this._connections.get(e))===null||s===void 0||s.socketConnected(t,n)}socketFailed({uid:e,errorCode:t}){var n;(n=this._connections.get(e))===null||n===void 0||n.socketFailed(t)}sendSocketData({uid:e,data:t}){var n;(n=this._connections.get(e))===null||n===void 0||n.sendData(t)}sendSocketEnd({uid:e}){var t;(t=this._connections.get(e))===null||t===void 0||t.end()}sendSocketError({uid:e,error:t}){var n;(n=this._connections.get(e))===null||n===void 0||n.error(t)}};bi.SocksProxy=Id;Id.Events={SocksRequested:"socksRequested",SocksData:"socksData",SocksClosed:"socksClosed"};var Rd=class r extends oT.default{constructor(e,t){super(),this._sockets=new Map,this._patternMatcher=()=>!1,this._redirectPortForTest=void 0,this._patternMatcher=Kw(e),this._redirectPortForTest=t}cleanup(){for(let e of this._sockets.keys())this.socketClosed({uid:e})}async socketRequested({uid:e,host:t,port:n}){if(_i.debugLogger.log("socks",`[${e}] => request ${t}:${n}`),!this._patternMatcher(t,n)){let s={uid:e,errorCode:"ERULESET"};_i.debugLogger.log("socks",`[${e}] <= pattern error ${s.errorCode}`),this.emit(r.Events.SocksFailed,s);return}t==="local.playwright"&&(t="localhost");try{this._redirectPortForTest&&(n=this._redirectPortForTest);let s=await(0,aT.createSocket)(t,n);s.on("data",c=>{let u={uid:e,data:c};this.emit(r.Events.SocksData,u)}),s.on("error",c=>{let u={uid:e,error:c.message};_i.debugLogger.log("socks",`[${e}] <= network socket error ${u.error}`),this.emit(r.Events.SocksError,u),this._sockets.delete(e)}),s.on("end",()=>{let c={uid:e};_i.debugLogger.log("socks",`[${e}] <= network socket closed`),this.emit(r.Events.SocksEnd,c),this._sockets.delete(e)});let o=s.localAddress,a=s.localPort;this._sockets.set(e,s);let l={uid:e,host:o,port:a};_i.debugLogger.log("socks",`[${e}] <= connected to network ${l.host}:${l.port}`),this.emit(r.Events.SocksConnected,l)}catch(s){let o={uid:e,errorCode:s.code};_i.debugLogger.log("socks",`[${e}] <= connect error ${o.errorCode}`),this.emit(r.Events.SocksFailed,o)}}sendSocketData({uid:e,data:t}){var n;(n=this._sockets.get(e))===null||n===void 0||n.write(t)}socketClosed({uid:e}){var t;_i.debugLogger.log("socks",`[${e}] <= browser socket closed`),(t=this._sockets.get(e))===null||t===void 0||t.destroy(),this._sockets.delete(e)}};bi.SocksProxyHandler=Rd;Rd.Events={SocksConnected:"socksConnected",SocksData:"socksData",SocksError:"socksError",SocksFailed:"socksFailed",SocksEnd:"socksEnd"}});var Ea=M(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.JSHandleDispatcher=void 0;yi.parseArgument=Yw;yi.parseValue=$6;yi.serializeResult=Qw;var H6=He(),Jw=Ms(),Zw=Io(),Xw=class extends H6.Dispatcher{constructor(e,t){super(e,t,t.asElement()?"ElementHandle":"JSHandle",{preview:t.toString()}),this._type_JSHandle=!0,t._setPreviewCallback(n=>this._dispatchEvent("previewUpdated",{preview:n}))}async evaluateExpression(e){return{value:Qw(await this._object.evaluateExpression(e.expression,{isFunction:e.isFunction},Yw(e.arg)))}}async evaluateExpressionHandle(e){let t=await this._object.evaluateExpressionHandle(e.expression,{isFunction:e.isFunction},Yw(e.arg));return{handle:Jw.ElementHandleDispatcher.fromJSHandle(this.parentScope(),t)}}async getProperty(e){let t=await this._object.getProperty(e.name);return{handle:Jw.ElementHandleDispatcher.fromJSHandle(this.parentScope(),t)}}async getPropertyList(){let e=await this._object.getProperties(),t=[];for(let[n,s]of e)t.push({name:n,value:Jw.ElementHandleDispatcher.fromJSHandle(this.parentScope(),s)});return{properties:t}}async jsonValue(){return{value:Qw(await this._object.jsonValue())}}async objectCount(e){return{count:await this._object.objectCount()}}async dispose(e,t){t.potentiallyClosesScope=!0,this._object.dispose(),this._dispose()}};yi.JSHandleDispatcher=Xw;function Yw(r){return(0,Zw.parseSerializedValue)(r.value,r.handles.map(e=>e._object))}function $6(r){return(0,Zw.parseSerializedValue)(r,[])}function Qw(r){return(0,Zw.serializeValue)(r,e=>({fallThrough:e}))}});var Ms=M(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});Md.ElementHandleDispatcher=void 0;var ev=He(),xi=Ea(),tv=Fd(),dT=Fs(),hT=ka(),nv=class r extends xi.JSHandleDispatcher{static from(e,t){return(0,ev.existingDispatcher)(t)||new r(e,t)}static fromNullable(e,t){if(t)return(0,ev.existingDispatcher)(t)||new r(e,t)}static fromJSHandle(e,t){let n=(0,ev.existingDispatcher)(t);return n||(t.asElement()?new r(e,t.asElement()):new xi.JSHandleDispatcher(e,t))}constructor(e,t){super(e,t),this._type_ElementHandle=!0,this._elementHandle=void 0,this._elementHandle=t}async ownerFrame(e,t){let n=await this._elementHandle.ownerFrame();return{frame:n?tv.FrameDispatcher.from(this._browserContextDispatcher(),n):void 0}}async contentFrame(e,t){let n=await this._elementHandle.contentFrame();return{frame:n?tv.FrameDispatcher.from(this._browserContextDispatcher(),n):void 0}}async getAttribute(e,t){let n=await this._elementHandle.getAttribute(t,e.name);return{value:n===null?void 0:n}}async inputValue(e,t){return{value:await this._elementHandle.inputValue(t)}}async textContent(e,t){let n=await this._elementHandle.textContent(t);return{value:n===null?void 0:n}}async innerText(e,t){return{value:await this._elementHandle.innerText(t)}}async innerHTML(e,t){return{value:await this._elementHandle.innerHTML(t)}}async isChecked(e,t){return{value:await this._elementHandle.isChecked(t)}}async isDisabled(e,t){return{value:await this._elementHandle.isDisabled(t)}}async isEditable(e,t){return{value:await this._elementHandle.isEditable(t)}}async isEnabled(e,t){return{value:await this._elementHandle.isEnabled(t)}}async isHidden(e,t){return{value:await this._elementHandle.isHidden(t)}}async isVisible(e,t){return{value:await this._elementHandle.isVisible(t)}}async dispatchEvent(e,t){await this._elementHandle.dispatchEvent(t,e.type,(0,xi.parseArgument)(e.eventInit))}async scrollIntoViewIfNeeded(e,t){await this._elementHandle.scrollIntoViewIfNeeded(t,e)}async hover(e,t){return await this._elementHandle.hover(t,e)}async click(e,t){return await this._elementHandle.click(t,e)}async dblclick(e,t){return await this._elementHandle.dblclick(t,e)}async tap(e,t){return await this._elementHandle.tap(t,e)}async selectOption(e,t){let n=(e.elements||[]).map(s=>s._elementHandle);return{values:await this._elementHandle.selectOption(t,n,e.options||[],e)}}async fill(e,t){return await this._elementHandle.fill(t,e.value,e)}async selectText(e,t){await this._elementHandle.selectText(t,e)}async setInputFiles(e,t){return await this._elementHandle.setInputFiles(t,e)}async focus(e,t){await this._elementHandle.focus(t)}async type(e,t){return await this._elementHandle.type(t,e.text,e)}async press(e,t){return await this._elementHandle.press(t,e.key,e)}async check(e,t){return await this._elementHandle.check(t,e)}async uncheck(e,t){return await this._elementHandle.uncheck(t,e)}async boundingBox(e,t){return{value:await this._elementHandle.boundingBox()||void 0}}async screenshot(e,t){let n=(e.mask||[]).map(({frame:s,selector:o})=>({frame:s._object,selector:o}));return{binary:await this._elementHandle.screenshot(t,{...e,mask:n})}}async querySelector(e,t){let n=await this._elementHandle.querySelector(e.selector,e);return{element:r.fromNullable(this.parentScope(),n)}}async querySelectorAll(e,t){return{elements:(await this._elementHandle.querySelectorAll(e.selector)).map(s=>r.from(this.parentScope(),s))}}async evalOnSelector(e,t){return{value:(0,xi.serializeResult)(await this._elementHandle.evalOnSelector(e.selector,!!e.strict,e.expression,e.isFunction,(0,xi.parseArgument)(e.arg)))}}async evalOnSelectorAll(e,t){return{value:(0,xi.serializeResult)(await this._elementHandle.evalOnSelectorAll(e.selector,e.expression,e.isFunction,(0,xi.parseArgument)(e.arg)))}}async waitForElementState(e,t){await this._elementHandle.waitForElementState(t,e.state,e)}async waitForSelector(e,t){return{element:r.fromNullable(this.parentScope(),await this._elementHandle.waitForSelector(t,e.selector,e))}}_browserContextDispatcher(){let e=this.parentScope();if(e instanceof dT.BrowserContextDispatcher)return e;if(e instanceof hT.PageDispatcher)return e.parentScope();if(e instanceof hT.WorkerDispatcher||e instanceof tv.FrameDispatcher){let t=e.parentScope();return t instanceof dT.BrowserContextDispatcher?t:t.parentScope()}throw new Error("ElementHandle belongs to unexpected scope")}};Md.ElementHandleDispatcher=nv});var fT=M(Nd=>{"use strict";Object.defineProperty(Nd,"__esModule",{value:!0});Nd.StreamDispatcher=void 0;var W6=He(),pT=ie(),rv=class extends W6.Dispatcher{constructor(e,t){super(e,{guid:"stream@"+(0,pT.createGuid)(),stream:t},"Stream",{}),this._type_Stream=!0,this._ended=!1,t.once("end",()=>this._ended=!0),t.once("error",()=>this._ended=!0)}async read(e){let t=this._object.stream;if(this._ended)return{binary:Buffer.from("")};if(!t.readableLength){let s=new pT.ManualPromise,o=()=>s.resolve();t.on("readable",o),t.on("end",o),t.on("error",o),await s,t.off("readable",o),t.off("end",o),t.off("error",o)}return{binary:t.read(Math.min(t.readableLength,e.size||t.readableLength))||Buffer.from("")}}async close(){this._object.stream.destroy()}};Nd.StreamDispatcher=rv});var Ca=M(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});Ld.ArtifactDispatcher=void 0;var mT=He(),gT=fT(),iv=z6(require("fs")),U6=ht();function z6(r){return r&&r.__esModule?r:{default:r}}var sv=class r extends mT.Dispatcher{static from(e,t){return r.fromNullable(e,t)}static fromNullable(e,t){return t?(0,mT.existingDispatcher)(t)||new r(e,t):void 0}constructor(e,t){super(e,t,"Artifact",{absolutePath:t.localPath()}),this._type_Artifact=!0}async pathAfterFinished(){return{value:await this._object.localPathAfterFinished()}}async saveAs(e){return await new Promise((t,n)=>{this._object.saveAs(async(s,o)=>{if(o){n(o);return}try{await(0,U6.mkdirIfNeeded)(e.path),await iv.default.promises.copyFile(s,e.path),t()}catch(a){n(a)}})})}async saveAsStream(){return await new Promise((e,t)=>{this._object.saveAs(async(n,s)=>{if(s){t(s);return}try{let o=iv.default.createReadStream(n,{highWaterMark:1048576}),a=new gT.StreamDispatcher(this,o);e({stream:a}),await new Promise(l=>{o.on("close",l),o.on("end",l),o.on("error",l)})}catch(o){t(o)}})})}async stream(){let e=await this._object.localPathAfterFinished(),t=iv.default.createReadStream(e,{highWaterMark:1024*1024});return{stream:new gT.StreamDispatcher(this,t)}}async failure(){return{error:await this._object.failureError()||void 0}}async cancel(){await this._object.cancel()}async delete(e,t){t.potentiallyClosesScope=!0,await this._object.delete(),this._dispose()}};Ld.ArtifactDispatcher=sv});var av=M(Dd=>{"use strict";Object.defineProperty(Dd,"__esModule",{value:!0});Dd.TracingDispatcher=void 0;var V6=Ca(),_T=He(),ov=class r extends _T.Dispatcher{static from(e,t){return(0,_T.existingDispatcher)(t)||new r(e,t)}constructor(e,t){super(e,t,"Tracing",{}),this._type_Tracing=!0}async tracingStart(e){await this._object.start(e)}async tracingStartChunk(e){return await this._object.startChunk(e)}async tracingStopChunk(e){let{artifact:t,entries:n}=await this._object.stopChunk(e);return{artifact:t?V6.ArtifactDispatcher.from(this,t):void 0,entries:n}}async tracingStop(e){await this._object.stop()}};Dd.TracingDispatcher=ov});var Ta=M(sn=>{"use strict";Object.defineProperty(sn,"__esModule",{value:!0});sn.WebSocketDispatcher=sn.RouteDispatcher=sn.ResponseDispatcher=sn.RequestDispatcher=sn.APIRequestContextDispatcher=void 0;var Bd=Ct(),An=He(),G6=av(),wT=Fd(),K6=ka(),jd=class r extends An.Dispatcher{static from(e,t){return(0,An.existingDispatcher)(t)||new r(e,t)}static fromNullable(e,t){return t?r.from(e,t):void 0}constructor(e,t){var n;let s=t.postDataBuffer(),o=t.frame(),a=(n=t.frame())===null||n===void 0?void 0:n._page,l=a?(0,An.existingDispatcher)(a):null,c=o?wT.FrameDispatcher.from(e,o):null;super(l||c||e,t,"Request",{frame:wT.FrameDispatcher.fromNullable(e,t.frame()),serviceWorker:K6.WorkerDispatcher.fromNullable(e,t.serviceWorker()),url:t.url(),resourceType:t.resourceType(),method:t.method(),postData:s===null?void 0:s,headers:t.headers(),isNavigationRequest:t.isNavigationRequest(),redirectedFrom:r.fromNullable(e,t.redirectedFrom())}),this._type_Request=void 0,this._browserContextDispatcher=void 0,this._type_Request=!0,this._browserContextDispatcher=e}async rawRequestHeaders(e){return{headers:await this._object.rawRequestHeaders()}}async response(){return{response:qd.fromNullable(this._browserContextDispatcher,await this._object.response())}}};sn.RequestDispatcher=jd;var qd=class r extends An.Dispatcher{static from(e,t){let n=(0,An.existingDispatcher)(t),s=jd.from(e,t.request());return n||new r(s,t)}static fromNullable(e,t){return t?r.from(e,t):void 0}constructor(e,t){super(e,t,"Response",{request:e,url:t.url(),status:t.status(),statusText:t.statusText(),headers:t.headers(),timing:t.timing(),fromServiceWorker:t.fromServiceWorker()}),this._type_Response=!0}async body(){return{binary:await this._object.body()}}async securityDetails(){return{value:await this._object.securityDetails()||void 0}}async serverAddr(){return{value:await this._object.serverAddr()||void 0}}async rawResponseHeaders(e){return{headers:await this._object.rawResponseHeaders()}}async sizes(e){return{sizes:await this._object.sizes()}}};sn.ResponseDispatcher=qd;var lv=class r extends An.Dispatcher{static from(e,t){return(0,An.existingDispatcher)(t)||new r(e,t)}constructor(e,t){super(e,t,"Route",{request:e}),this._type_Route=!0}async continue(e,t){await this._object.continue({url:e.url,method:e.method,headers:e.headers,postData:e.postData,isFallback:e.isFallback})}async fulfill(e,t){await this._object.fulfill(e)}async abort(e,t){await this._object.abort(e.errorCode||"failed")}async redirectNavigationRequest(e){await this._object.redirectNavigationRequest(e.url)}};sn.RouteDispatcher=lv;var cv=class extends An.Dispatcher{constructor(e,t){super(e,t,"WebSocket",{url:t.url()}),this._type_EventTarget=!0,this._type_WebSocket=!0,this.addObjectListener(Bd.WebSocket.Events.FrameSent,n=>this._dispatchEvent("frameSent",n)),this.addObjectListener(Bd.WebSocket.Events.FrameReceived,n=>this._dispatchEvent("frameReceived",n)),this.addObjectListener(Bd.WebSocket.Events.SocketError,n=>this._dispatchEvent("socketError",{error:n})),this.addObjectListener(Bd.WebSocket.Events.Close,()=>this._dispatchEvent("close",{}))}};sn.WebSocketDispatcher=cv;var uv=class r extends An.Dispatcher{static from(e,t){return(0,An.existingDispatcher)(t)||new r(e,t)}static fromNullable(e,t){return t?r.from(e,t):void 0}constructor(e,t){let n=G6.TracingDispatcher.from(e,t.tracing());super(e,t,"APIRequestContext",{tracing:n}),this._type_APIRequestContext=!0,this.adopt(n)}async storageState(){return this._object.storageState()}async dispose(e,t){t.potentiallyClosesScope=!0,await this._object.dispose(),this._dispose()}async fetch(e,t){let n=await this._object.fetch(e,t);return{response:{url:n.url,status:n.status,statusText:n.statusText,headers:n.headers,fetchUid:n.fetchUid}}}async fetchResponseBody(e){return{binary:this._object.fetchResponses.get(e.fetchUid)}}async fetchLog(e){return{log:this._object.fetchLog.get(e.fetchUid)||[]}}async disposeAPIResponse(e){this._object.disposeResponse(e.fetchUid)}};sn.APIRequestContextDispatcher=uv});var Fd=M(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.FrameDispatcher=void 0;var dv=si(),hv=He(),Ir=Ms(),_n=Ea(),vT=Ta(),J6=ie(),pv=class r extends hv.Dispatcher{static from(e,t){return(0,hv.existingDispatcher)(t)||new r(e,t)}static fromNullable(e,t){if(t)return r.from(e,t)}constructor(e,t){(0,J6.debugAssert)(t._page.mainFrame(),"Cannot determine whether the frame is a main frame");let n=t._page.mainFrame()===t?"MainFrame":"Frame",s=(0,hv.existingDispatcher)(t._page);super(s||e,t,"Frame",{url:t.url(),name:t.name(),parentFrame:r.fromNullable(e,t.parentFrame()),loadStates:Array.from(t._firedLifecycleEvents)},n),this._type_Frame=!0,this._frame=void 0,this._browserContextDispatcher=void 0,this._browserContextDispatcher=e,this._frame=t,this.addObjectListener(dv.Frame.Events.AddLifecycle,o=>{this._dispatchEvent("loadstate",{add:o})}),this.addObjectListener(dv.Frame.Events.RemoveLifecycle,o=>{this._dispatchEvent("loadstate",{remove:o})}),this.addObjectListener(dv.Frame.Events.InternalNavigation,o=>{if(!o.isPublic)return;let a={url:o.url,name:o.name,error:o.error?o.error.message:void 0};o.newDocument&&(a.newDocument={request:vT.RequestDispatcher.fromNullable(this._browserContextDispatcher,o.newDocument.request||null)}),this._dispatchEvent("navigated",a)})}async goto(e,t){return{response:vT.ResponseDispatcher.fromNullable(this._browserContextDispatcher,await this._frame.goto(t,e.url,e))}}async frameElement(){return{element:Ir.ElementHandleDispatcher.from(this,await this._frame.frameElement())}}async evaluateExpression(e,t){return{value:(0,_n.serializeResult)(await this._frame.evaluateExpression(e.expression,{isFunction:e.isFunction,exposeUtilityScript:e.exposeUtilityScript},(0,_n.parseArgument)(e.arg)))}}async evaluateExpressionHandle(e,t){return{handle:Ir.ElementHandleDispatcher.fromJSHandle(this,await this._frame.evaluateExpressionHandle(e.expression,{isFunction:e.isFunction},(0,_n.parseArgument)(e.arg)))}}async waitForSelector(e,t){return{element:Ir.ElementHandleDispatcher.fromNullable(this,await this._frame.waitForSelector(t,e.selector,e))}}async dispatchEvent(e,t){return this._frame.dispatchEvent(t,e.selector,e.type,(0,_n.parseArgument)(e.eventInit),e)}async evalOnSelector(e,t){return{value:(0,_n.serializeResult)(await this._frame.evalOnSelector(e.selector,!!e.strict,e.expression,e.isFunction,(0,_n.parseArgument)(e.arg)))}}async evalOnSelectorAll(e,t){return{value:(0,_n.serializeResult)(await this._frame.evalOnSelectorAll(e.selector,e.expression,e.isFunction,(0,_n.parseArgument)(e.arg)))}}async querySelector(e,t){return{element:Ir.ElementHandleDispatcher.fromNullable(this,await this._frame.querySelector(e.selector,e))}}async querySelectorAll(e,t){return{elements:(await this._frame.querySelectorAll(e.selector)).map(s=>Ir.ElementHandleDispatcher.from(this,s))}}async queryCount(e){return{value:await this._frame.queryCount(e.selector)}}async content(){return{value:await this._frame.content()}}async setContent(e,t){return await this._frame.setContent(t,e.html,e)}async addScriptTag(e,t){return{element:Ir.ElementHandleDispatcher.from(this,await this._frame.addScriptTag(e))}}async addStyleTag(e,t){return{element:Ir.ElementHandleDispatcher.from(this,await this._frame.addStyleTag(e))}}async click(e,t){return t.potentiallyClosesScope=!0,await this._frame.click(t,e.selector,e)}async dblclick(e,t){return await this._frame.dblclick(t,e.selector,e)}async dragAndDrop(e,t){return await this._frame.dragAndDrop(t,e.source,e.target,e)}async tap(e,t){return await this._frame.tap(t,e.selector,e)}async fill(e,t){return await this._frame.fill(t,e.selector,e.value,e)}async focus(e,t){await this._frame.focus(t,e.selector,e)}async blur(e,t){await this._frame.blur(t,e.selector,e)}async textContent(e,t){let n=await this._frame.textContent(t,e.selector,e);return{value:n===null?void 0:n}}async innerText(e,t){return{value:await this._frame.innerText(t,e.selector,e)}}async innerHTML(e,t){return{value:await this._frame.innerHTML(t,e.selector,e)}}async getAttribute(e,t){let n=await this._frame.getAttribute(t,e.selector,e.name,e);return{value:n===null?void 0:n}}async inputValue(e,t){return{value:await this._frame.inputValue(t,e.selector,e)}}async isChecked(e,t){return{value:await this._frame.isChecked(t,e.selector,e)}}async isDisabled(e,t){return{value:await this._frame.isDisabled(t,e.selector,e)}}async isEditable(e,t){return{value:await this._frame.isEditable(t,e.selector,e)}}async isEnabled(e,t){return{value:await this._frame.isEnabled(t,e.selector,e)}}async isHidden(e,t){return{value:await this._frame.isHidden(t,e.selector,e)}}async isVisible(e,t){return{value:await this._frame.isVisible(t,e.selector,e)}}async hover(e,t){return await this._frame.hover(t,e.selector,e)}async selectOption(e,t){let n=(e.elements||[]).map(s=>s._elementHandle);return{values:await this._frame.selectOption(t,e.selector,n,e.options||[],e)}}async setInputFiles(e,t){return await this._frame.setInputFiles(t,e.selector,e)}async type(e,t){return await this._frame.type(t,e.selector,e.text,e)}async press(e,t){return await this._frame.press(t,e.selector,e.key,e)}async check(e,t){return await this._frame.check(t,e.selector,e)}async uncheck(e,t){return await this._frame.uncheck(t,e.selector,e)}async waitForTimeout(e,t){return await this._frame.waitForTimeout(t,e.timeout)}async waitForFunction(e,t){return{handle:Ir.ElementHandleDispatcher.fromJSHandle(this,await this._frame._waitForFunctionExpression(t,e.expression,e.isFunction,(0,_n.parseArgument)(e.arg),e))}}async title(e,t){return{value:await this._frame.title()}}async highlight(e,t){return await this._frame.highlight(e.selector)}async expect(e,t){t.potentiallyClosesScope=!0;let n=e.expectedValue?(0,_n.parseArgument)(e.expectedValue):void 0,s=await this._frame.expect(t,e.selector,{...e,expectedValue:n});return s.received!==void 0&&(s.received=(0,_n.serializeResult)(s.received)),s}};Hd.FrameDispatcher=pv});var ka=M(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.WorkerDispatcher=Rr.PageDispatcher=Rr.BindingCallDispatcher=void 0;var wn=Et(),Pa=He(),X6=Bt(),$d=Fd(),Ns=Ta(),Oa=Ea(),gv=Ms(),fv=Ca(),bT=ie(),mv=class r extends Pa.Dispatcher{static from(e,t){return r.fromNullable(e,t)}static fromNullable(e,t){return t?(0,Pa.existingDispatcher)(t)||new r(e,t):void 0}constructor(e,t){let n=$d.FrameDispatcher.from(e,t.mainFrame());super(e,t,"Page",{mainFrame:n,viewportSize:t.viewportSize()||void 0,isClosed:t.isClosed(),opener:r.fromNullable(e,t.opener())}),this._type_EventTarget=!0,this._type_Page=!0,this._page=void 0,this._subscriptions=new Set,this.adopt(n),this._page=t,this.addObjectListener(wn.Page.Events.Close,()=>{this._dispatchEvent("close"),this._dispose()}),this.addObjectListener(wn.Page.Events.Crash,()=>this._dispatchEvent("crash")),this.addObjectListener(wn.Page.Events.Download,o=>{this._dispatchEvent("download",{url:o.url,suggestedFilename:o.suggestedFilename(),artifact:fv.ArtifactDispatcher.from(e,o.artifact)})}),this.addObjectListener(wn.Page.Events.FileChooser,o=>this._dispatchEvent("fileChooser",{element:gv.ElementHandleDispatcher.from(n,o.element()),isMultiple:o.isMultiple()})),this.addObjectListener(wn.Page.Events.FrameAttached,o=>this._onFrameAttached(o)),this.addObjectListener(wn.Page.Events.FrameDetached,o=>this._onFrameDetached(o)),this.addObjectListener(wn.Page.Events.LocatorHandlerTriggered,o=>this._dispatchEvent("locatorHandlerTriggered",{uid:o})),this.addObjectListener(wn.Page.Events.WebSocket,o=>this._dispatchEvent("webSocket",{webSocket:new Ns.WebSocketDispatcher(this,o)})),this.addObjectListener(wn.Page.Events.Worker,o=>this._dispatchEvent("worker",{worker:new Wd(this,o)})),this.addObjectListener(wn.Page.Events.Video,o=>this._dispatchEvent("video",{artifact:fv.ArtifactDispatcher.from(e,o)})),t._video&&this._dispatchEvent("video",{artifact:fv.ArtifactDispatcher.from(this.parentScope(),t._video)});let s=t._frameManager.frames();for(let o=1;o<s.length;o++)this._onFrameAttached(s[o])}page(){return this._page}async setDefaultNavigationTimeoutNoReply(e,t){this._page.setDefaultNavigationTimeout(e.timeout)}async setDefaultTimeoutNoReply(e,t){this._page.setDefaultTimeout(e.timeout)}async exposeBinding(e,t){await this._page.exposeBinding(e.name,!!e.needsHandle,(n,...s)=>{if(this._disposed)return;let o=new Ud(this,e.name,!!e.needsHandle,n,s);return this._dispatchEvent("bindingCall",{binding:o}),o.promise()})}async setExtraHTTPHeaders(e,t){await this._page.setExtraHTTPHeaders(e.headers)}async reload(e,t){return{response:Ns.ResponseDispatcher.fromNullable(this.parentScope(),await this._page.reload(t,e))}}async goBack(e,t){return{response:Ns.ResponseDispatcher.fromNullable(this.parentScope(),await this._page.goBack(t,e))}}async goForward(e,t){return{response:Ns.ResponseDispatcher.fromNullable(this.parentScope(),await this._page.goForward(t,e))}}async registerLocatorHandler(e,t){return{uid:this._page.registerLocatorHandler(e.selector,e.noWaitAfter)}}async resolveLocatorHandlerNoReply(e,t){this._page.resolveLocatorHandler(e.uid,e.remove)}async unregisterLocatorHandler(e,t){this._page.unregisterLocatorHandler(e.uid)}async emulateMedia(e,t){await this._page.emulateMedia({media:e.media,colorScheme:e.colorScheme,reducedMotion:e.reducedMotion,forcedColors:e.forcedColors})}async setViewportSize(e,t){await this._page.setViewportSize(e.viewportSize)}async addInitScript(e,t){await this._page.addInitScript(e.source)}async setNetworkInterceptionPatterns(e,t){if(!e.patterns.length){await this._page.setClientRequestInterceptor(void 0);return}let n=e.patterns.map(s=>s.regexSource?new RegExp(s.regexSource,s.regexFlags):s.glob);await this._page.setClientRequestInterceptor((s,o)=>n.some(l=>(0,bT.urlMatches)(this._page._browserContext._options.baseURL,o.url(),l))?(this._dispatchEvent("route",{route:Ns.RouteDispatcher.from(Ns.RequestDispatcher.from(this.parentScope(),o),s)}),!0):!1)}async expectScreenshot(e,t){let n=(e.mask||[]).map(({frame:o,selector:a})=>({frame:o._object,selector:a})),s=e.locator?{frame:e.locator.frame._object,selector:e.locator.selector}:void 0;return await this._page.expectScreenshot(t,{...e,locator:s,mask:n})}async screenshot(e,t){let n=(e.mask||[]).map(({frame:s,selector:o})=>({frame:s._object,selector:o}));return{binary:await this._page.screenshot(t,{...e,mask:n})}}async close(e,t){e.runBeforeUnload||(t.potentiallyClosesScope=!0),await this._page.close(t,e)}async updateSubscription(e){e.event==="fileChooser"&&await this._page.setFileChooserIntercepted(e.enabled),e.enabled?this._subscriptions.add(e.event):this._subscriptions.delete(e.event)}async keyboardDown(e,t){await this._page.keyboard.down(e.key)}async keyboardUp(e,t){await this._page.keyboard.up(e.key)}async keyboardInsertText(e,t){await this._page.keyboard.insertText(e.text)}async keyboardType(e,t){await this._page.keyboard.type(e.text,e)}async keyboardPress(e,t){await this._page.keyboard.press(e.key,e)}async mouseMove(e,t){await this._page.mouse.move(e.x,e.y,e,t)}async mouseDown(e,t){await this._page.mouse.down(e,t)}async mouseUp(e,t){await this._page.mouse.up(e,t)}async mouseClick(e,t){await this._page.mouse.click(e.x,e.y,e,t)}async mouseWheel(e,t){await this._page.mouse.wheel(e.deltaX,e.deltaY)}async touchscreenTap(e,t){await this._page.touchscreen.tap(e.x,e.y,t)}async accessibilitySnapshot(e,t){return{rootAXNode:await this._page.accessibility.snapshot({interestingOnly:e.interestingOnly,root:e.root?e.root._elementHandle:void 0})||void 0}}async pdf(e,t){if(!this._page.pdf)throw new Error("PDF generation is only supported for Headless Chromium");return{pdf:await this._page.pdf(e)}}async bringToFront(e,t){await this._page.bringToFront()}async startJSCoverage(e,t){await this._page.coverage.startJSCoverage(e)}async stopJSCoverage(e,t){return await this._page.coverage.stopJSCoverage()}async startCSSCoverage(e,t){await this._page.coverage.startCSSCoverage(e)}async stopCSSCoverage(e,t){return await this._page.coverage.stopCSSCoverage()}_onFrameAttached(e){this._dispatchEvent("frameAttached",{frame:$d.FrameDispatcher.from(this.parentScope(),e)})}_onFrameDetached(e){this._dispatchEvent("frameDetached",{frame:$d.FrameDispatcher.from(this.parentScope(),e)})}_onDispose(){this._page.isClosedOrClosingOrCrashed()||this._page.setClientRequestInterceptor(void 0).catch(()=>{})}};Rr.PageDispatcher=mv;var Wd=class r extends Pa.Dispatcher{static fromNullable(e,t){return t?(0,Pa.existingDispatcher)(t)||new r(e,t):void 0}constructor(e,t){super(e,t,"Worker",{url:t.url()}),this._type_Worker=!0,this.addObjectListener(wn.Worker.Events.Close,()=>this._dispatchEvent("close"))}async evaluateExpression(e,t){return{value:(0,Oa.serializeResult)(await this._object.evaluateExpression(e.expression,e.isFunction,(0,Oa.parseArgument)(e.arg)))}}async evaluateExpressionHandle(e,t){return{handle:gv.ElementHandleDispatcher.fromJSHandle(this,await this._object.evaluateExpressionHandle(e.expression,e.isFunction,(0,Oa.parseArgument)(e.arg)))}}};Rr.WorkerDispatcher=Wd;var Ud=class extends Pa.Dispatcher{constructor(e,t,n,s,o){super(e,{guid:"bindingCall@"+(0,bT.createGuid)()},"BindingCall",{frame:$d.FrameDispatcher.from(e.parentScope(),s.frame),name:t,args:n?void 0:o.map(Oa.serializeResult),handle:n?gv.ElementHandleDispatcher.fromJSHandle(e,o[0]):void 0}),this._type_BindingCall=!0,this._resolve=void 0,this._reject=void 0,this._promise=void 0,this._promise=new Promise((a,l)=>{this._resolve=a,this._reject=l})}promise(){return this._promise}async resolve(e,t){this._resolve((0,Oa.parseArgument)(e.result)),this._dispose()}async reject(e,t){this._reject((0,X6.parseError)(e.error)),this._dispose()}};Rr.BindingCallDispatcher=Ud});var wv=M(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.CDPSessionDispatcher=void 0;var yT=ra(),Y6=He(),_v=class extends Y6.Dispatcher{constructor(e,t){super(e,t,"CDPSession",{}),this._type_CDPSession=!0,this.addObjectListener(yT.CDPSession.Events.Event,({method:n,params:s})=>this._dispatchEvent("event",{method:n,params:s})),this.addObjectListener(yT.CDPSession.Events.Closed,()=>this._dispose())}async send(e){return{result:await this._object.send(e.method,e.params)}}async detach(e,t){t.potentiallyClosesScope=!0,await this._object.detach()}};zd.CDPSessionDispatcher=_v});var ST=M(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.WritableStreamDispatcher=void 0;var Q6=He(),Z6=tH(require("fs")),eH=ie();function xT(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(xT=function(n){return n?t:e})(r)}function tH(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=xT(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var vv=class extends Q6.Dispatcher{constructor(e,t,n){super(e,{guid:"writableStream@"+(0,eH.createGuid)(),stream:t},"WritableStream",{}),this._type_WritableStream=!0,this._lastModifiedMs=void 0,this._lastModifiedMs=n}async write(e){let t=this._object.stream;await new Promise((n,s)=>{t.write(e.binary,o=>{o?s(o):n()})})}async close(){let e=this._object.stream;await new Promise(t=>e.end(t)),this._lastModifiedMs&&await Z6.promises.utimes(this.path(),new Date(this._lastModifiedMs),new Date(this._lastModifiedMs))}path(){return this._object.stream.path}};Vd.WritableStreamDispatcher=vv});var ET=M(Gd=>{"use strict";Object.defineProperty(Gd,"__esModule",{value:!0});Gd.DialogDispatcher=void 0;var nH=He(),rH=ka(),bv=class extends nH.Dispatcher{constructor(e,t){let n=rH.PageDispatcher.fromNullable(e,t.page().initializedOrUndefined());super(n||e,t,"Dialog",{page:n,type:t.type(),message:t.message(),defaultValue:t.defaultValue()}),this._type_Dialog=!0}async accept(e){await this._object.accept(e.promptText)}async dismiss(){await this._object.dismiss()}};Gd.DialogDispatcher=bv});var Fs=M(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});Kd.BrowserContextDispatcher=void 0;var In=$e(),Ls=He(),Ot=ka(),Mr=Ta(),kT=ps(),iH=wv(),sH=xd(),CT=Ca(),oH=av(),TT=IT(require("fs")),OT=IT(require("path")),PT=ie(),aH=ST(),lH=ET(),cH=Bt(),uH=Ms();function AT(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(AT=function(n){return n?t:e})(r)}function IT(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=AT(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var yv=class extends Ls.Dispatcher{constructor(e,t){let n=Mr.APIRequestContextDispatcher.from(e,t.fetchRequest),s=oH.TracingDispatcher.from(e,t.tracing);super(e,t,"BrowserContext",{isChromium:t._browser.options.isChromium,isLocalBrowserOnServer:t._browser._isCollocatedWithServer,requestContext:n,tracing:s}),this._type_EventTarget=!0,this._type_BrowserContext=!0,this._context=void 0,this._subscriptions=new Set,this.adopt(n),this.adopt(s),this._context=t;let o=a=>{let l=CT.ArtifactDispatcher.from(e,a);this._dispatchEvent("video",{artifact:l})};this.addObjectListener(In.BrowserContext.Events.VideoStarted,o);for(let a of t._browser._idToVideo.values())a.context===t&&o(a.artifact);for(let a of t.pages())this._dispatchEvent("page",{page:Ot.PageDispatcher.from(this,a)});if(this.addObjectListener(In.BrowserContext.Events.Page,a=>{this._dispatchEvent("page",{page:Ot.PageDispatcher.from(this,a)})}),this.addObjectListener(In.BrowserContext.Events.Close,()=>{this._dispatchEvent("close"),this._dispose()}),this.addObjectListener(In.BrowserContext.Events.PageError,(a,l)=>{this._dispatchEvent("pageError",{error:(0,cH.serializeError)(a),page:Ot.PageDispatcher.from(this,l)})}),this.addObjectListener(In.BrowserContext.Events.Console,a=>{let l=a.page();if(this._shouldDispatchEvent(l,"console")){let c=Ot.PageDispatcher.from(this,l);this._dispatchEvent("console",{page:c,type:a.type(),text:a.text(),args:a.args().map(u=>uH.ElementHandleDispatcher.fromJSHandle(c,u)),location:a.location()})}}),this.addObjectListener(In.BrowserContext.Events.Dialog,a=>{this._shouldDispatchEvent(a.page(),"dialog")?this._dispatchEvent("dialog",{dialog:new lH.DialogDispatcher(this,a)}):a.close().catch(()=>{})}),t._browser.options.name==="chromium"){for(let a of t.backgroundPages())this._dispatchEvent("backgroundPage",{page:Ot.PageDispatcher.from(this,a)});this.addObjectListener(kT.CRBrowserContext.CREvents.BackgroundPage,a=>this._dispatchEvent("backgroundPage",{page:Ot.PageDispatcher.from(this,a)}));for(let a of t.serviceWorkers())this._dispatchEvent("serviceWorker",{worker:new Ot.WorkerDispatcher(this,a)});this.addObjectListener(kT.CRBrowserContext.CREvents.ServiceWorker,a=>this._dispatchEvent("serviceWorker",{worker:new Ot.WorkerDispatcher(this,a)}))}this.addObjectListener(In.BrowserContext.Events.Request,a=>{var l;if(!(a.redirectedFrom()&&(0,Ls.existingDispatcher)(a.redirectedFrom()))&&!this._shouldDispatchNetworkEvent(a,"request")&&!a.isNavigationRequest())return;let u=Mr.RequestDispatcher.from(this,a);this._dispatchEvent("request",{request:u,page:Ot.PageDispatcher.fromNullable(this,(l=a.frame())===null||l===void 0?void 0:l._page.initializedOrUndefined())})}),this.addObjectListener(In.BrowserContext.Events.Response,a=>{var l;!(0,Ls.existingDispatcher)(a.request())&&!this._shouldDispatchNetworkEvent(a.request(),"response")||this._dispatchEvent("response",{response:Mr.ResponseDispatcher.from(this,a),page:Ot.PageDispatcher.fromNullable(this,(l=a.frame())===null||l===void 0?void 0:l._page.initializedOrUndefined())})}),this.addObjectListener(In.BrowserContext.Events.RequestFailed,a=>{var l;!(0,Ls.existingDispatcher)(a)&&!this._shouldDispatchNetworkEvent(a,"requestFailed")||this._dispatchEvent("requestFailed",{request:Mr.RequestDispatcher.from(this,a),failureText:a._failureText||void 0,responseEndTiming:a._responseEndTiming,page:Ot.PageDispatcher.fromNullable(this,(l=a.frame())===null||l===void 0?void 0:l._page.initializedOrUndefined())})}),this.addObjectListener(In.BrowserContext.Events.RequestFinished,({request:a,response:l})=>{var c;!(0,Ls.existingDispatcher)(a)&&!this._shouldDispatchNetworkEvent(a,"requestFinished")||this._dispatchEvent("requestFinished",{request:Mr.RequestDispatcher.from(this,a),response:Mr.ResponseDispatcher.fromNullable(this,l),responseEndTiming:a._responseEndTiming,page:Ot.PageDispatcher.fromNullable(this,(c=a.frame())===null||c===void 0?void 0:c._page.initializedOrUndefined())})})}_shouldDispatchNetworkEvent(e,t){var n;return this._shouldDispatchEvent((n=e.frame())===null||n===void 0||(n=n._page)===null||n===void 0?void 0:n.initializedOrUndefined(),t)}_shouldDispatchEvent(e,t){if(this._subscriptions.has(t))return!0;let n=e?(0,Ls.existingDispatcher)(e):void 0;return!!(n!=null&&n._subscriptions.has(t))}async createTempFile(e){let t=this._context._browser.options.artifactsDir,n=OT.join(t,"upload-"+(0,PT.createGuid)());await TT.promises.mkdir(n),this._context._tempDirs.push(n);let s=TT.createWriteStream(OT.join(n,e.name));return{writableStream:new aH.WritableStreamDispatcher(this,s,e.lastModifiedMs)}}async setDefaultNavigationTimeoutNoReply(e){this._context.setDefaultNavigationTimeout(e.timeout)}async setDefaultTimeoutNoReply(e){this._context.setDefaultTimeout(e.timeout)}async exposeBinding(e){await this._context.exposeBinding(e.name,!!e.needsHandle,(t,...n)=>{if(this._disposed)return;let s=Ot.PageDispatcher.from(this,t.page),o=new Ot.BindingCallDispatcher(s,e.name,!!e.needsHandle,t,n);return this._dispatchEvent("bindingCall",{binding:o}),o.promise()})}async newPage(e,t){return{page:Ot.PageDispatcher.from(this,await this._context.newPage(t))}}async cookies(e){return{cookies:await this._context.cookies(e.urls)}}async addCookies(e){await this._context.addCookies(e.cookies)}async clearCookies(e){let t=e.nameRegexSource!==void 0&&e.nameRegexFlags!==void 0?new RegExp(e.nameRegexSource,e.nameRegexFlags):void 0,n=e.domainRegexSource!==void 0&&e.domainRegexFlags!==void 0?new RegExp(e.domainRegexSource,e.domainRegexFlags):void 0,s=e.pathRegexSource!==void 0&&e.pathRegexFlags!==void 0?new RegExp(e.pathRegexSource,e.pathRegexFlags):void 0;await this._context.clearCookies({name:t||e.name,domain:n||e.domain,path:s||e.path})}async grantPermissions(e){await this._context.grantPermissions(e.permissions,e.origin)}async clearPermissions(){await this._context.clearPermissions()}async setGeolocation(e){await this._context.setGeolocation(e.geolocation)}async setExtraHTTPHeaders(e){await this._context.setExtraHTTPHeaders(e.headers)}async setOffline(e){await this._context.setOffline(e.offline)}async setHTTPCredentials(e){await this._context.setHTTPCredentials(e.httpCredentials)}async addInitScript(e){await this._context.addInitScript(e.source)}async setNetworkInterceptionPatterns(e){if(!e.patterns.length){await this._context.setRequestInterceptor(void 0);return}let t=e.patterns.map(n=>n.regexSource?new RegExp(n.regexSource,n.regexFlags):n.glob);await this._context.setRequestInterceptor((n,s)=>t.some(a=>(0,PT.urlMatches)(this._context._options.baseURL,s.url(),a))?(this._dispatchEvent("route",{route:Mr.RouteDispatcher.from(Mr.RequestDispatcher.from(this,s),n)}),!0):!1)}async storageState(e,t){return await this._context.storageState()}async close(e,t){t.potentiallyClosesScope=!0,await this._context.close(e)}async recorderSupplementEnable(e){await sH.Recorder.show(this._context,e)}async pause(e,t){}async newCDPSession(e){if(!this._object._browser.options.isChromium)throw new Error("CDP session is only available in Chromium");if(!e.page&&!e.frame||e.page&&e.frame)throw new Error("CDP session must be initiated with either Page or Frame, not none or both");let t=this._object;return{session:new iH.CDPSessionDispatcher(this,await t.newCDPSession((e.page?e.page:e.frame)._object))}}async harStart(e){return{harId:await this._context._harStart(e.page?e.page._object:null,e.options)}}async harExport(e){let t=await this._context._harExport(e.harId);if(!t)throw new Error("No HAR artifact. Ensure record.harPath is set.");return{artifact:CT.ArtifactDispatcher.from(this,t)}}async updateSubscription(e){e.enabled?this._subscriptions.add(e.event):this._subscriptions.delete(e.event)}_onDispose(){this._context.isClosingOrClosed()||this._context.setRequestInterceptor(void 0).catch(()=>{})}};Kd.BrowserContextDispatcher=yv});var MT=M(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.AndroidSocketDispatcher=Fr.AndroidDispatcher=Fr.AndroidDeviceDispatcher=void 0;var Jd=He(),xv=Ku(),RT=Fs(),Ev=class extends Jd.Dispatcher{constructor(e,t){super(e,t,"Android",{}),this._type_Android=!0}async devices(e){return{devices:(await this._object.devices(e)).map(n=>Xd.from(this,n))}}async setDefaultTimeoutNoReply(e){this._object.setDefaultTimeout(e.timeout)}};Fr.AndroidDispatcher=Ev;var Xd=class r extends Jd.Dispatcher{static from(e,t){return(0,Jd.existingDispatcher)(t)||new r(e,t)}constructor(e,t){super(e,t,"AndroidDevice",{model:t.model,serial:t.serial}),this._type_EventTarget=!0,this._type_AndroidDevice=!0;for(let n of t.webViews())this._dispatchEvent("webViewAdded",{webView:n});this.addObjectListener(xv.AndroidDevice.Events.WebViewAdded,n=>this._dispatchEvent("webViewAdded",{webView:n})),this.addObjectListener(xv.AndroidDevice.Events.WebViewRemoved,n=>this._dispatchEvent("webViewRemoved",{socketName:n})),this.addObjectListener(xv.AndroidDevice.Events.Close,n=>this._dispatchEvent("close"))}async wait(e){await this._object.send("wait",e)}async fill(e){await this._object.send("click",{selector:e.selector}),await this._object.send("fill",e)}async tap(e){await this._object.send("click",e)}async drag(e){await this._object.send("drag",e)}async fling(e){await this._object.send("fling",e)}async longTap(e){await this._object.send("longClick",e)}async pinchClose(e){await this._object.send("pinchClose",e)}async pinchOpen(e){await this._object.send("pinchOpen",e)}async scroll(e){await this._object.send("scroll",e)}async swipe(e){await this._object.send("swipe",e)}async info(e){return{info:await this._object.send("info",e)}}async inputType(e){let t=e.text,n=[];for(let s=0;s<t.length;++s){let o=Sv.get(t[s].toUpperCase());if(o===void 0)throw new Error("No mapping for "+t[s]+" found");n.push(o)}await Promise.all(n.map(s=>this._object.send("inputPress",{keyCode:s})))}async inputPress(e){if(!Sv.has(e.key))throw new Error("Unknown key: "+e.key);await this._object.send("inputPress",{keyCode:Sv.get(e.key)})}async inputTap(e){await this._object.send("inputClick",e)}async inputSwipe(e){await this._object.send("inputSwipe",e)}async inputDrag(e){await this._object.send("inputDrag",e)}async screenshot(e){return{binary:await this._object.screenshot()}}async shell(e){return{result:await this._object.shell(e.command)}}async open(e,t){let n=await this._object.open(e.command);return{socket:new Yd(this,n)}}async installApk(e){await this._object.installApk(e.file,{args:e.args})}async push(e){await this._object.push(e.file,e.path,e.mode)}async launchBrowser(e){let t=await this._object.launchBrowser(e.pkg,e);return{context:new RT.BrowserContextDispatcher(this,t)}}async close(e){await this._object.close()}async setDefaultTimeoutNoReply(e){this._object.setDefaultTimeout(e.timeout)}async connectToWebView(e){return{context:new RT.BrowserContextDispatcher(this,await this._object.connectToWebView(e.socketName))}}};Fr.AndroidDeviceDispatcher=Xd;var Yd=class extends Jd.Dispatcher{constructor(e,t){super(e,t,"AndroidSocket",{}),this._type_AndroidSocket=!0,this.addObjectListener("data",n=>this._dispatchEvent("data",{data:n})),this.addObjectListener("close",()=>{this._dispatchEvent("close"),this._dispose()})}async write(e,t){await this._object.write(e.data)}async close(e,t){this._object.close()}};Fr.AndroidSocketDispatcher=Yd;var Sv=new Map([["Unknown",0],["SoftLeft",1],["SoftRight",2],["Home",3],["Back",4],["Call",5],["EndCall",6],["0",7],["1",8],["2",9],["3",10],["4",11],["5",12],["6",13],["7",14],["8",15],["9",16],["Star",17],["*",17],["Pound",18],["#",18],["DialUp",19],["DialDown",20],["DialLeft",21],["DialRight",22],["DialCenter",23],["VolumeUp",24],["VolumeDown",25],["Power",26],["Camera",27],["Clear",28],["A",29],["B",30],["C",31],["D",32],["E",33],["F",34],["G",35],["H",36],["I",37],["J",38],["K",39],["L",40],["M",41],["N",42],["O",43],["P",44],["Q",45],["R",46],["S",47],["T",48],["U",49],["V",50],["W",51],["X",52],["Y",53],["Z",54],["Comma",55],[",",55],["Period",56],[".",56],["AltLeft",57],["AltRight",58],["ShiftLeft",59],["ShiftRight",60],["Tab",61],["	",61],["Space",62],[" ",62],["Sym",63],["Explorer",64],["Envelop",65],["Enter",66],["Del",67],["Grave",68],["Minus",69],["-",69],["Equals",70],["=",70],["LeftBracket",71],["(",71],["RightBracket",72],[")",72],["Backslash",73],["\\",73],["Semicolon",74],[";",74],["Apostrophe",75],["`",75],["Slash",76],["/",76],["At",77],["@",77],["Num",78],["HeadsetHook",79],["Focus",80],["Plus",81],["Menu",82],["Notification",83],["Search",84],["AppSwitch",187],["Assist",219],["Cut",277],["Copy",278],["Paste",279]])});var Pv=M(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.ConnectedBrowserDispatcher=Ds.BrowserDispatcher=void 0;var dH=li(),Tv=Fs(),FT=wv(),Ov=He(),hH=$e(),pH=Q_(),NT=Ca(),kv=class extends Ov.Dispatcher{constructor(e,t){super(e,t,"Browser",{version:t.version(),name:t.options.name}),this._type_Browser=!0,this.addObjectListener(dH.Browser.Events.Disconnected,()=>this._didClose())}_didClose(){this._dispatchEvent("close"),this._dispose()}async newContext(e,t){let n=await this._object.newContext(t,e);return{context:new Tv.BrowserContextDispatcher(this,n)}}async newContextForReuse(e,t){return await LT(this._object,this,e,null,t)}async stopPendingOperations(e,t){await this._object.stopPendingOperations(e.reason)}async close(e,t){t.potentiallyClosesScope=!0,await this._object.close(e)}async killForTests(e,t){t.potentiallyClosesScope=!0,await this._object.killForTests()}async defaultUserAgentForTest(){return{userAgent:this._object.userAgent()}}async newBrowserCDPSession(){if(!this._object.options.isChromium)throw new Error("CDP session is only available in Chromium");let e=this._object;return{session:new FT.CDPSessionDispatcher(this,await e.newBrowserCDPSession())}}async startTracing(e){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");await this._object.startTracing(e.page?e.page._object:void 0,e)}async stopTracing(){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");let e=this._object;return{artifact:NT.ArtifactDispatcher.from(this,await e.stopTracing())}}};Ds.BrowserDispatcher=kv;var Cv=class extends Ov.Dispatcher{constructor(e,t){super(e,t,"Browser",{version:t.version(),name:t.options.name}),this._type_Browser=!0,this._contexts=new Set,this.selectors=void 0,this.selectors=new pH.Selectors}async newContext(e,t){e.recordVideo&&(e.recordVideo.dir=this._object.options.artifactsDir);let n=await this._object.newContext(t,e);return this._contexts.add(n),n.setSelectors(this.selectors),n.on(hH.BrowserContext.Events.Close,()=>this._contexts.delete(n)),{context:new Tv.BrowserContextDispatcher(this,n)}}async newContextForReuse(e,t){return await LT(this._object,this,e,this.selectors,t)}async stopPendingOperations(e,t){await this._object.stopPendingOperations(e.reason)}async close(){}async killForTests(){}async defaultUserAgentForTest(){throw new Error("Client should not send us Browser.defaultUserAgentForTest")}async newBrowserCDPSession(){if(!this._object.options.isChromium)throw new Error("CDP session is only available in Chromium");let e=this._object;return{session:new FT.CDPSessionDispatcher(this,await e.newBrowserCDPSession())}}async startTracing(e){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");await this._object.startTracing(e.page?e.page._object:void 0,e)}async stopTracing(){if(!this._object.options.isChromium)throw new Error("Tracing is only available in Chromium");let e=this._object;return{artifact:NT.ArtifactDispatcher.from(this,await e.stopTracing())}}async cleanupContexts(){await Promise.all(Array.from(this._contexts).map(e=>e.close({reason:"Global context cleanup (connection terminated)"})))}};Ds.ConnectedBrowserDispatcher=Cv;async function LT(r,e,t,n,s){let{context:o,needsReset:a}=await r.newContextForReuse(t,s);if(a){let c=(0,Ov.existingDispatcher)(o);c&&c._dispose(),await o.resetForReuse(s,t)}return n&&o.setSelectors(n),{context:new Tv.BrowserContextDispatcher(e,o)}}});var jT=M(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.BrowserTypeDispatcher=void 0;var DT=Pv(),fH=He(),BT=Fs(),Av=class extends fH.Dispatcher{constructor(e,t){super(e,t,"BrowserType",{executablePath:t.executablePath(),name:t.name()}),this._type_BrowserType=!0}async launch(e,t){let n=await this._object.launch(t,e);return{browser:new DT.BrowserDispatcher(this,n)}}async launchPersistentContext(e,t){let n=await this._object.launchPersistentContext(t,e.userDataDir,e);return{context:new BT.BrowserContextDispatcher(this,n)}}async connectOverCDP(e,t){let n=await this._object.connectOverCDP(t,e.endpointURL,e,e.timeout),s=new DT.BrowserDispatcher(this,n);return{browser:s,defaultContext:n._defaultContext?new BT.BrowserContextDispatcher(s,n._defaultContext):void 0}}};Qd.BrowserTypeDispatcher=Av});var $T=M(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.ElectronDispatcher=Bs.ElectronApplicationDispatcher=void 0;var HT=He(),qT=O_(),mH=Fs(),Iv=Ea(),Rv=Ms(),Mv=class extends HT.Dispatcher{constructor(e,t){super(e,t,"Electron",{}),this._type_Electron=!0}async launch(e){let t=await this._object.launch(e);return{electronApplication:new Zd(this,t)}}};Bs.ElectronDispatcher=Mv;var Zd=class extends HT.Dispatcher{constructor(e,t){super(e,t,"ElectronApplication",{context:new mH.BrowserContextDispatcher(e,t.context())}),this._type_EventTarget=!0,this._type_ElectronApplication=!0,this._subscriptions=new Set,this.addObjectListener(qT.ElectronApplication.Events.Close,()=>{this._dispatchEvent("close"),this._dispose()}),this.addObjectListener(qT.ElectronApplication.Events.Console,n=>{this._subscriptions.has("console")&&this._dispatchEvent("console",{type:n.type(),text:n.text(),args:n.args().map(s=>Rv.ElementHandleDispatcher.fromJSHandle(this,s)),location:n.location()})})}async browserWindow(e){let t=await this._object.browserWindow(e.page.page());return{handle:Rv.ElementHandleDispatcher.fromJSHandle(this,t)}}async evaluateExpression(e){let t=await this._object._nodeElectronHandlePromise;return{value:(0,Iv.serializeResult)(await t.evaluateExpression(e.expression,{isFunction:e.isFunction},(0,Iv.parseArgument)(e.arg)))}}async evaluateExpressionHandle(e){let n=await(await this._object._nodeElectronHandlePromise).evaluateExpressionHandle(e.expression,{isFunction:e.isFunction},(0,Iv.parseArgument)(e.arg));return{handle:Rv.ElementHandleDispatcher.fromJSHandle(this,n)}}async updateSubscription(e){e.enabled?this._subscriptions.add(e.event):this._subscriptions.delete(e.event)}async close(){await this._object.close()}};Bs.ElectronApplicationDispatcher=Zd});var WT=M(eh=>{"use strict";Object.defineProperty(eh,"__esModule",{value:!0});eh.JsonPipeDispatcher=void 0;var gH=He(),_H=ie(),Fv=class extends gH.Dispatcher{constructor(e){super(e,{guid:"jsonPipe@"+(0,_H.createGuid)()},"JsonPipe",{}),this._type_JsonPipe=!0}async send(e){this.emit("message",e.message)}async close(){this.emit("close"),this._disposed||(this._dispatchEvent("closed",{}),this._dispose())}dispatch(e){this._disposed||this._dispatchEvent("message",{message:e})}wasClosed(e){this._disposed||(this._dispatchEvent("closed",{reason:e}),this._dispose())}dispose(){this._dispose()}};eh.JsonPipeDispatcher=Fv});var VT=M(th=>{"use strict";Object.defineProperty(th,"__esModule",{value:!0});th.SocksInterceptor=void 0;var js=bH(Rs()),wH=vH(require("events")),Nv=Ao();function vH(r){return r&&r.__esModule?r:{default:r}}function zT(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(zT=function(n){return n?t:e})(r)}function bH(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=zT(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var Lv=class{constructor(e,t,n){this._handler=void 0,this._channel=void 0,this._socksSupportObjectGuid=void 0,this._ids=new Set,this._handler=new js.SocksProxyHandler(t,n);let s=-1;this._channel=new Proxy(new wH.default,{get:(o,a)=>a in o||o[a]!==void 0||typeof a!="string"?o[a]:l=>{try{let c=--s;this._ids.add(c),l=(0,Nv.findValidator)("SocksSupport",a,"Params")(l,"",{tChannelImpl:UT,binary:"toBase64"}),e.send({id:c,guid:this._socksSupportObjectGuid,method:a,params:l,metadata:{stack:[],apiName:"",internal:!0}})}catch{}}}),this._handler.on(js.SocksProxyHandler.Events.SocksConnected,o=>this._channel.socksConnected(o)),this._handler.on(js.SocksProxyHandler.Events.SocksData,o=>this._channel.socksData(o)),this._handler.on(js.SocksProxyHandler.Events.SocksError,o=>this._channel.socksError(o)),this._handler.on(js.SocksProxyHandler.Events.SocksFailed,o=>this._channel.socksFailed(o)),this._handler.on(js.SocksProxyHandler.Events.SocksEnd,o=>this._channel.socksEnd(o)),this._channel.on("socksRequested",o=>this._handler.socketRequested(o)),this._channel.on("socksClosed",o=>this._handler.socketClosed(o)),this._channel.on("socksData",o=>this._handler.sendSocketData(o))}cleanup(){this._handler.cleanup()}interceptMessage(e){if(this._ids.has(e.id))return this._ids.delete(e.id),!0;if(e.method==="__create__"&&e.params.type==="SocksSupport")return this._socksSupportObjectGuid=e.params.guid,!1;if(this._socksSupportObjectGuid&&e.guid===this._socksSupportObjectGuid){let n=(0,Nv.findValidator)("SocksSupport",e.method,"Event")(e.params,"",{tChannelImpl:UT,binary:"fromBase64"});return this._channel.emit(e.method,n),!0}return!1}};th.SocksInterceptor=Lv;function UT(r,e,t,n){throw new Nv.ValidationError(`${t}: channels are not expected in SocksSupport`)}});var KT=M((mV,GT)=>{GT.exports=ls()});var ZT=M(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});Aa.LocalUtilsDispatcher=void 0;Aa.urlToWSEndpoint=QT;var Gt=Bv(require("fs")),Si=Bv(require("path")),yH=Bv(require("os")),xH=Qe(),qs=ie(),SH=He(),JT=yo(),XT=nf(),EH=WT(),kH=aa(),CH=VT(),YT=Nn(),TH=Ut(),OH=xn(),PH=De();function Bv(r){return r&&r.__esModule?r:{default:r}}var Dv=class extends SH.Dispatcher{constructor(e,t){let n=new PH.SdkObject(t,"localUtils","localUtils"),s=KT(),o=Object.entries(s).map(([a,l])=>({name:a,descriptor:l}));super(e,n,"LocalUtils",{deviceDescriptors:o}),this._type_LocalUtils=void 0,this._harBackends=new Map,this._stackSessions=new Map,this._type_LocalUtils=!0}async zip(e){let t=new xH.ManualPromise,n=new JT.yazl.ZipFile;n.on("error",l=>t.reject(l));let s=(l,c)=>{try{Gt.default.statSync(l).isFile()&&n.addFile(l,c)}catch{}};for(let l of e.entries)s(l.value,l.name);let o=e.stacksId?this._stackSessions.get(e.stacksId):void 0;if(o!=null&&o.callStacks.length)if(await o.writer,process.env.PW_LIVE_TRACE_STACKS)n.addFile(o.file,"trace.stacks");else{let l=Buffer.from(JSON.stringify((0,qs.serializeClientSideCallMetadata)(o.callStacks)));n.addBuffer(l,"trace.stacks")}if(e.includeSources){let l=new Set;for(let{stack:c}of o?.callStacks||[])if(c)for(let{file:u}of c)l.add(u);for(let c of l)s(c,"resources/src@"+(0,qs.calculateSha1)(c)+".txt")}if(e.mode==="write"){await Gt.default.promises.mkdir(Si.default.dirname(e.zipFile),{recursive:!0}),n.end(void 0,()=>{n.outputStream.pipe(Gt.default.createWriteStream(e.zipFile)).on("close",()=>t.resolve()).on("error",l=>t.reject(l))}),await t,await this._deleteStackSession(e.stacksId);return}let a=e.zipFile+".tmp";await Gt.default.promises.rename(e.zipFile,a),JT.yauzl.open(a,(l,c)=>{if(l){t.reject(l);return}(0,qs.assert)(c);let u=c.entryCount;c.on("entry",d=>{c.openReadStream(d,(h,p)=>{if(h){t.reject(h);return}n.addReadStream(p,d.fileName),--u===0&&n.end(void 0,()=>{n.outputStream.pipe(Gt.default.createWriteStream(e.zipFile)).on("close",()=>{Gt.default.promises.unlink(a).then(()=>{t.resolve()}).catch(f=>t.reject(f))})})})})}),await t,await this._deleteStackSession(e.stacksId)}async harOpen(e,t){let n;if(e.file.endsWith(".zip")){let s=new XT.ZipFile(e.file),a=(await s.entries()).find(u=>u.endsWith(".har"));if(!a)return{error:"Specified archive does not have a .har file"};let l=await s.read(a),c=JSON.parse(l.toString());n=new nh(c,null,s)}else{let s=JSON.parse(await Gt.default.promises.readFile(e.file,"utf-8"));n=new nh(s,Si.default.dirname(e.file),null)}return this._harBackends.set(n.id,n),{harId:n.id}}async harLookup(e,t){let n=this._harBackends.get(e.harId);return n?await n.lookup(e.url,e.method,e.headers,e.postData,e.isNavigationRequest):{action:"error",message:"Internal error: har was not opened"}}async harClose(e,t){let n=this._harBackends.get(e.harId);n&&(this._harBackends.delete(n.id),n.dispose())}async harUnzip(e,t){let n=Si.default.dirname(e.zipFile),s=new XT.ZipFile(e.zipFile);for(let o of await s.entries()){let a=await s.read(o);o==="har.har"?await Gt.default.promises.writeFile(e.harFile,a):await Gt.default.promises.writeFile(Si.default.join(n,o),a)}s.close(),await Gt.default.promises.unlink(e.zipFile)}async connect(e,t){let n=new TH.ProgressController(t,this._object);return n.setLogName("browser"),await n.run(async s=>{var o;let a={"User-Agent":(0,YT.getUserAgent)(),"x-playwright-proxy":(o=e.exposeNetwork)!==null&&o!==void 0?o:"",...e.headers},l=await QT(s,e.wsEndpoint),c=await kH.WebSocketTransport.connect(s,l,a,!0,"x-playwright-debug-log"),u=new CH.SocksInterceptor(c,e.exposeNetwork,e.socksProxyRedirectPortForTest),d=new EH.JsonPipeDispatcher(this);return c.onmessage=h=>{if(u.interceptMessage(h))return;let p=()=>{try{d.dispatch(h)}catch{c.close()}};e.slowMo?setTimeout(p,e.slowMo):p()},d.on("message",h=>{c.send(h)}),c.onclose=h=>{u?.cleanup(),d.wasClosed(h)},d.on("close",()=>c.close()),{pipe:d,headers:c.headers}},e.timeout||0)}async tracingStarted(e,t){let n;e.tracesDir||(n=await Gt.default.promises.mkdtemp(Si.default.join(yH.default.tmpdir(),"playwright-tracing-")));let s=Si.default.join(e.tracesDir||n,e.traceName+".stacks");return this._stackSessions.set(s,{callStacks:[],file:s,writer:Promise.resolve(),tmpDir:n}),{stacksId:s}}async traceDiscarded(e,t){await this._deleteStackSession(e.stacksId)}async addStackToTracingNoReply(e,t){for(let n of this._stackSessions.values())n.callStacks.push(e.callData),process.env.PW_LIVE_TRACE_STACKS&&(n.writer=n.writer.then(()=>{let s=Buffer.from(JSON.stringify((0,qs.serializeClientSideCallMetadata)(n.callStacks)));return Gt.default.promises.writeFile(n.file,s)}))}async _deleteStackSession(e){let t=e?this._stackSessions.get(e):void 0;t&&(await t.writer,t.tmpDir&&await(0,qs.removeFolders)([t.tmpDir]),this._stackSessions.delete(e))}};Aa.LocalUtilsDispatcher=Dv;var AH=[301,302,303,307,308],nh=class{constructor(e,t,n){this.id=(0,qs.createGuid)(),this._harFile=void 0,this._zipFile=void 0,this._baseDir=void 0,this._harFile=e,this._baseDir=t,this._zipFile=n}async lookup(e,t,n,s,o){let a;try{a=await this._harFindResponse(e,t,n,s)}catch(c){return{action:"error",message:"HAR error: "+c.message}}if(!a)return{action:"noentry"};if(a.request.url!==e&&o)return{action:"redirect",redirectURL:a.request.url};let l=a.response;try{let c=await this._loadContent(l.content);return{action:"fulfill",status:l.status,headers:l.headers,body:c}}catch(c){return{action:"error",message:c.message}}}async _loadContent(e){let t=e._file,n;return t?this._zipFile?n=await this._zipFile.read(t):n=await Gt.default.promises.readFile(Si.default.resolve(this._baseDir,t)):n=Buffer.from(e.text||"",e.encoding==="base64"?"base64":"utf-8"),n}async _harFindResponse(e,t,n,s){let o=this._harFile.log,a=new Set;for(;;){let l=[];for(let d of o.entries)d.request.url!==e||d.request.method!==t||t==="POST"&&s&&d.request.postData&&!(await this._loadContent(d.request.postData)).equals(s)||l.push(d);if(!l.length)return;let c=l[0];if(l.length>1){let d=[];for(let h of l){let p=IH(h.request.headers,n);d.push({candidate:h,matchingHeaders:p})}d.sort((h,p)=>p.matchingHeaders-h.matchingHeaders),c=d[0].candidate}if(a.has(c))throw new Error(`Found redirect cycle for ${e}`);a.add(c);let u=c.response.headers.find(d=>d.name.toLowerCase()==="location");if(AH.includes(c.response.status)&&u){e=new URL(u.value,e).toString(),((c.response.status===301||c.response.status===302)&&t==="POST"||c.response.status===303&&!["GET","HEAD"].includes(t))&&(t="GET");continue}return c}}dispose(){var e;(e=this._zipFile)===null||e===void 0||e.close()}};function IH(r,e){let t=new Set(e.map(s=>s.name.toLowerCase()+":"+s.value)),n=0;for(let s of r)t.has(s.name.toLowerCase()+":"+s.value)&&++n;return n}async function QT(r,e){var t;if(e.startsWith("ws"))return e;r?.log(`<ws preparing> retrieving websocket url from ${e}`);let n=new URL(e);n.pathname.endsWith("/")||(n.pathname+="/"),n.pathname+="json";let s=await(0,OH.fetchData)({url:n.toString(),method:"GET",timeout:(t=r?.timeUntilDeadline())!==null&&t!==void 0?t:3e4,headers:{"User-Agent":(0,YT.getUserAgent)()}},async(l,c)=>new Error(`Unexpected status ${c.statusCode} when connecting to ${n.toString()}.
This does not look like a Playwright server, try connecting via ws://.`));r?.throwIfAborted();let o=new URL(e),a=JSON.parse(s).wsEndpointPath;return a.startsWith("/")&&(a=a.substring(1)),o.pathname.endsWith("/")||(o.pathname+="/"),o.pathname+=a,o.protocol=o.protocol==="https:"?"wss:":"ws:",o.toString()}});var eO=M(rh=>{"use strict";Object.defineProperty(rh,"__esModule",{value:!0});rh.SelectorsDispatcher=void 0;var RH=He(),jv=class extends RH.Dispatcher{constructor(e,t){super(e,t,"Selectors",{}),this._type_Selectors=!0}async register(e){await this._object.register(e.name,e.source,e.contentScript)}async setTestIdAttributeName(e){this._object.setTestIdAttributeName(e.testIdAttributeName)}};rh.SelectorsDispatcher=jv});var rO=M(sh=>{"use strict";Object.defineProperty(sh,"__esModule",{value:!0});sh.PlaywrightDispatcher=void 0;var MH=No(),qv=Rs(),tO=MT(),Hv=jT(),nO=He(),FH=$T(),NH=ZT(),LH=Ta(),DH=eO(),BH=Pv(),jH=ie(),ih=Ze(),$v=class extends nO.Dispatcher{constructor(e,t,n,s,o){let a=s?new BH.ConnectedBrowserDispatcher(e,s):void 0,l=new tO.AndroidDispatcher(e,t.android),c=o?new tO.AndroidDeviceDispatcher(l,o):void 0;super(e,t,"Playwright",{chromium:new Hv.BrowserTypeDispatcher(e,t.chromium),firefox:new Hv.BrowserTypeDispatcher(e,t.firefox),webkit:new Hv.BrowserTypeDispatcher(e,t.webkit),android:l,electron:new FH.ElectronDispatcher(e,t.electron),utils:t.options.isServer?void 0:new NH.LocalUtilsDispatcher(e,t),selectors:new DH.SelectorsDispatcher(e,a?.selectors||t.selectors),preLaunchedBrowser:a,preConnectedAndroidDevice:c,socksSupport:n?new Wv(e,n):void 0}),this._type_Playwright=void 0,this._browserDispatcher=void 0,this._type_Playwright=!0,this._browserDispatcher=a}async newRequest(e){let t=new MH.GlobalAPIRequestContext(this._object,e);return{request:LH.APIRequestContextDispatcher.from(this.parentScope(),t)}}async cleanup(){var e;await((e=this._browserDispatcher)===null||e===void 0?void 0:e.cleanupContexts())}};sh.PlaywrightDispatcher=$v;var Wv=class extends nO.Dispatcher{constructor(e,t){super(e,{guid:"socksSupport@"+(0,jH.createGuid)()},"SocksSupport",{}),this._type_SocksSupport=void 0,this._socksProxy=void 0,this._socksListeners=void 0,this._type_SocksSupport=!0,this._socksProxy=t,this._socksListeners=[ih.eventsHelper.addEventListener(t,qv.SocksProxy.Events.SocksRequested,n=>this._dispatchEvent("socksRequested",n)),ih.eventsHelper.addEventListener(t,qv.SocksProxy.Events.SocksData,n=>this._dispatchEvent("socksData",n)),ih.eventsHelper.addEventListener(t,qv.SocksProxy.Events.SocksClosed,n=>this._dispatchEvent("socksClosed",n))]}async socksConnected(e){var t;(t=this._socksProxy)===null||t===void 0||t.socketConnected(e)}async socksFailed(e){var t;(t=this._socksProxy)===null||t===void 0||t.socketFailed(e)}async socksData(e){var t;(t=this._socksProxy)===null||t===void 0||t.sendSocketData(e)}async socksError(e){var t;(t=this._socksProxy)===null||t===void 0||t.sendSocketError(e)}async socksEnd(e){var t;(t=this._socksProxy)===null||t===void 0||t.sendSocketEnd(e)}_onDispose(){ih.eventsHelper.removeEventListeners(this._socksListeners)}}});var uO=M(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.installRootRedirect=Vv;Lr.openTraceInBrowser=cO;Lr.openTraceViewerApp=lO;Lr.runTraceInBrowser=zH;Lr.runTraceViewerApp=UH;Lr.startTraceViewerServer=zv;var Hs=oO(require("path")),$s=oO(require("fs")),qH=Dp(),Nr=ie(),iO=Eg(),sO=De(),HH=mi(),$H=Ut(),WH=Be();function oO(r){return r&&r.__esModule?r:{default:r}}function aO(r){for(let e of r){let t=e;if(e.endsWith(".json")&&(t=e.substring(0,e.length-5)),!e.startsWith("http://")&&!e.startsWith("https://")&&!$s.default.existsSync(t)&&!$s.default.existsSync(t+".trace"))throw new Error(`Trace file ${e} does not exist!`)}}async function zv(r){let e=new qH.HttpServer;e.routePrefix("/trace",(o,a)=>{let l=new URL("http://localhost"+o.url),c=l.pathname.slice(6);if(c.endsWith("/stall.js"))return!0;if(c.startsWith("/file")){try{let d=l.searchParams.get("path");if($s.default.existsSync(d))return e.serveFile(o,a,l.searchParams.get("path"));if(d.endsWith(".json")){let h=d.substring(0,d.length-5);return a.statusCode=200,a.setHeader("Content-Type","application/json"),a.end(JSON.stringify(VH(h))),!0}}catch{}return a.statusCode=404,a.end(),!0}let u=Hs.default.join(__dirname,"..","..","..","vite","traceViewer",...c.split("/"));return e.serveFile(o,a,u)});let t=r?.transport||(r!=null&&r.isServer?new Uv:void 0);t&&e.createWebSocket(t);let{host:n,port:s}=r||{};return await e.start({preferredPort:s,host:n}),e}async function Vv(r,e,t){let n=new URLSearchParams;for(let o of e)n.append("trace",o);r.wsGuid()&&n.append("ws",r.wsGuid()),t!=null&&t.isServer&&n.append("isServer",""),(0,Nr.isUnderTest)()&&n.append("isUnderTest","true");for(let o of t.args||[])n.append("arg",o);t.grep&&n.append("grep",t.grep),t.grepInvert&&n.append("grepInvert",t.grepInvert);for(let o of t.project||[])n.append("project",o);t.workers&&n.append("workers",String(t.workers)),t.timeout&&n.append("timeout",String(t.timeout)),t.headed&&n.append("headed","");for(let o of t.reporter||[])n.append("reporter",o);let s=`/trace/${t.webApp||"index.html"}?${n.toString()}`;r.routePath("/",(o,a)=>(a.statusCode=302,a.setHeader("Location",s),a.end(),!0))}async function UH(r,e,t,n){aO(r);let s=await zv(t);await Vv(s,r,t);let o=await lO(s.urlPrefix("precise"),e,t);return n&&o.on("close",()=>(0,Nr.gracefullyProcessExitDoNotHang)(0)),o}async function zH(r,e){aO(r);let t=await zv(e);await Vv(t,r,e),await cO(t.urlPrefix("human-readable"))}async function lO(r,e,t){let n=(0,HH.createPlaywright)({sdkLanguage:"javascript",isInternalPlaywright:!0}),s=(0,Nr.isUnderTest)()?"chromium":e,{context:o,page:a}=await(0,iO.launchApp)(n[s],{sdkLanguage:n.options.sdkLanguage,windowSize:{width:1280,height:800},persistentContextOptions:{...t?.persistentContextOptions,useWebSocket:(0,Nr.isUnderTest)(),headless:!!(t!=null&&t.headless)}});return await new $H.ProgressController((0,sO.serverSideCallMetadata)(),o._browser).run(async c=>{await o._browser._defaultContext._loadDefaultContextAsIs(c)}),process.env.PWTEST_PRINT_WS_ENDPOINT&&process.stderr.write("DevTools listening on: "+o._browser.options.wsEndpoint+`
`),(0,Nr.isUnderTest)()||await(0,iO.syncLocalStorageWithSettings)(a,"traceviewer"),(0,Nr.isUnderTest)()&&a.on("close",()=>o.close({reason:"Trace viewer closed"}).catch(()=>{})),await a.mainFrame().goto((0,sO.serverSideCallMetadata)(),r),a}async function cO(r){console.log(`
Listening on `+r),(0,Nr.isUnderTest)()||await(0,WH.open)(r.replace("0.0.0.0","localhost")).catch(()=>{})}var Uv=class{constructor(){this._pollTimer=void 0,this._traceUrl=void 0,this.sendEvent=void 0,this.close=void 0,process.stdin.on("data",e=>{let t=e.toString().trim();t!==this._traceUrl&&(t.endsWith(".json")?this._pollLoadTrace(t):this._loadTrace(t))}),process.stdin.on("close",()=>(0,Nr.gracefullyProcessExitDoNotHang)(0))}async dispatch(e,t){e==="initialize"&&this._traceUrl&&this._loadTrace(this._traceUrl)}onclose(){}_loadTrace(e){var t;this._traceUrl=e,clearTimeout(this._pollTimer),(t=this.sendEvent)===null||t===void 0||t.call(this,"loadTraceRequested",{traceUrl:e})}_pollLoadTrace(e){this._loadTrace(e),this._pollTimer=setTimeout(()=>{this._pollLoadTrace(e)},500)}};function VH(r){let e={entries:[]},t=Hs.default.dirname(r),n=Hs.default.basename(r);for(let o of $s.default.readdirSync(t))o.startsWith(n)&&e.entries.push({name:o,path:Hs.default.join(t,o)});let s=Hs.default.join(t,"resources");if($s.default.existsSync(s))for(let o of $s.default.readdirSync(s))e.entries.push({name:"resources/"+o,path:Hs.default.join(s,o)});return e}});var Gv=M(at=>{"use strict";Object.defineProperty(at,"__esModule",{value:!0});Object.defineProperty(at,"DispatcherConnection",{enumerable:!0,get:function(){return dO.DispatcherConnection}});Object.defineProperty(at,"PlaywrightDispatcher",{enumerable:!0,get:function(){return GH.PlaywrightDispatcher}});Object.defineProperty(at,"Registry",{enumerable:!0,get:function(){return Ws.Registry}});Object.defineProperty(at,"RootDispatcher",{enumerable:!0,get:function(){return dO.RootDispatcher}});Object.defineProperty(at,"SocksProxy",{enumerable:!0,get:function(){return XH.SocksProxy}});Object.defineProperty(at,"createPlaywright",{enumerable:!0,get:function(){return KH.createPlaywright}});Object.defineProperty(at,"installBrowsersForNpmInstall",{enumerable:!0,get:function(){return Ws.installBrowsersForNpmInstall}});Object.defineProperty(at,"installDefaultBrowsersForNpmInstall",{enumerable:!0,get:function(){return Ws.installDefaultBrowsersForNpmInstall}});Object.defineProperty(at,"installRootRedirect",{enumerable:!0,get:function(){return Ia.installRootRedirect}});Object.defineProperty(at,"openTraceInBrowser",{enumerable:!0,get:function(){return Ia.openTraceInBrowser}});Object.defineProperty(at,"openTraceViewerApp",{enumerable:!0,get:function(){return Ia.openTraceViewerApp}});Object.defineProperty(at,"registry",{enumerable:!0,get:function(){return Ws.registry}});Object.defineProperty(at,"registryDirectory",{enumerable:!0,get:function(){return Ws.registryDirectory}});Object.defineProperty(at,"runTraceViewerApp",{enumerable:!0,get:function(){return Ia.runTraceViewerApp}});Object.defineProperty(at,"serverSideCallMetadata",{enumerable:!0,get:function(){return JH.serverSideCallMetadata}});Object.defineProperty(at,"startTraceViewerServer",{enumerable:!0,get:function(){return Ia.startTraceViewerServer}});Object.defineProperty(at,"writeDockerVersion",{enumerable:!0,get:function(){return Ws.writeDockerVersion}});var Ws=qn(),dO=He(),GH=rO(),KH=mi(),Ia=uO(),JH=De(),XH=Rs()});var on=M(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.TimeoutError=Xn.TargetClosedError=void 0;Xn.isTargetClosedError=QH;Xn.parseError=e5;Xn.serializeError=ZH;var YH=ie(),hO=Io(),oh=class extends Error{constructor(e){super(e),this.name="TimeoutError"}};Xn.TimeoutError=oh;var Ra=class extends Error{constructor(e){super(e||"Target page, context or browser has been closed")}};Xn.TargetClosedError=Ra;function QH(r){return r instanceof Ra}function ZH(r){return(0,YH.isError)(r)?{error:{message:r.message,stack:r.stack,name:r.name}}:{value:(0,hO.serializeValue)(r,e=>({fallThrough:e}))}}function e5(r){if(!r.error){if(r.value===void 0)throw new Error("Serialized error must have either an error or a value");return(0,hO.parseSerializedValue)(r.value,void 0)}if(r.error.name==="TimeoutError"){let t=new oh(r.error.message);return t.stack=r.error.stack||"",t}if(r.error.name==="TargetClosedError"){let t=new Ra(r.error.message);return t.stack=r.error.stack||"",t}let e=new Error(r.error.message);return e.stack=r.error.stack||"",e.name=r.error.name,e}});var fO=M(ah=>{"use strict";Object.defineProperty(ah,"__esModule",{value:!0});ah.Accessibility=void 0;function pO(r){let e={...r,value:r.valueNumber!==void 0?r.valueNumber:r.valueString,checked:r.checked==="checked"?!0:r.checked==="unchecked"?!1:r.checked,pressed:r.pressed==="pressed"?!0:r.pressed==="released"?!1:r.pressed,children:r.children?r.children.map(pO):void 0};return delete e.valueNumber,delete e.valueString,e}var Kv=class{constructor(e){this._channel=void 0,this._channel=e}async snapshot(e={}){let t=e.root?e.root._elementChannel:void 0,n=await this._channel.accessibilitySnapshot({interestingOnly:e.interestingOnly,root:t});return n.rootAXNode?pO(n.rootAXNode):null}};ah.Accessibility=Kv});var ze=M(ch=>{"use strict";Object.defineProperty(ch,"__esModule",{value:!0});ch.ChannelOwner=void 0;var mO=require("events"),_O=Ao(),t5=Le(),gO=Lt(),n5=ie(),Jv=of(),lh=class r extends mO.EventEmitter{constructor(e,t,n,s){super(),this._connection=void 0,this._parent=void 0,this._objects=new Map,this._type=void 0,this._guid=void 0,this._channel=void 0,this._initializer=void 0,this._logger=void 0,this._instrumentation=void 0,this._eventToSubscriptionMapping=new Map,this._wasCollected=!1,this.setMaxListeners(0),this._connection=e instanceof r?e._connection:e,this._type=t,this._guid=n,this._parent=e instanceof r?e:void 0,this._instrumentation=this._connection._instrumentation,this._connection._objects.set(n,this),this._parent&&(this._parent._objects.set(n,this),this._logger=this._parent._logger),this._channel=this._createChannel(new mO.EventEmitter),this._initializer=s}_setEventToSubscriptionMapping(e){this._eventToSubscriptionMapping=e}_updateSubscription(e,t){let n=this._eventToSubscriptionMapping.get(String(e));n&&this._wrapApiCall(async()=>{await this._channel.updateSubscription({event:n,enabled:t})},!0).catch(()=>{})}on(e,t){return this.listenerCount(e)||this._updateSubscription(e,!0),super.on(e,t),this}addListener(e,t){return this.listenerCount(e)||this._updateSubscription(e,!0),super.addListener(e,t),this}prependListener(e,t){return this.listenerCount(e)||this._updateSubscription(e,!0),super.prependListener(e,t),this}off(e,t){return super.off(e,t),this.listenerCount(e)||this._updateSubscription(e,!1),this}removeListener(e,t){return super.removeListener(e,t),this.listenerCount(e)||this._updateSubscription(e,!1),this}_adopt(e){e._parent._objects.delete(e._guid),this._objects.set(e._guid,e),e._parent=this}_dispose(e){this._parent&&this._parent._objects.delete(this._guid),this._connection._objects.delete(this._guid),this._wasCollected=e==="gc";for(let t of[...this._objects.values()])t._dispose(e);this._objects.clear()}_debugScopeState(){return{_guid:this._guid,objects:Array.from(this._objects.values()).map(e=>e._debugScopeState())}}_createChannel(e){let t=new Proxy(e,{get:(n,s)=>{if(typeof s=="string"){let o=(0,_O.maybeFindValidator)(this._type,s,"Params");if(o)return async a=>await this._wrapApiCall(async l=>{let{apiName:c,frames:u,csi:d,callCookie:h,wallTime:p}=l.reported?{apiName:void 0,csi:void 0,callCookie:void 0,frames:[],wallTime:void 0}:l;return l.reported=!0,d&&c&&d.onApiCallBegin(c,a,u,p,h),await this._connection.sendMessageToServer(this,s,o(a,"",{tChannelImpl:r5,binary:this._connection.rawBuffers()?"buffer":"toBase64"}),c,u,p)})}return n[s]}});return t._object=this,t}async _wrapApiCall(e,t=!1){let n=this._logger,s=Jv.zones.zoneData("apiZone");if(s)return await e(s);let o=(0,gO.captureLibraryStackTrace)(),a=o.apiName,l=o.frames;t=t||this._type==="LocalUtils",t&&(a=void 0);let c=Jv.zones.zoneData("expectZone"),u=c?c.wallTime:Date.now();!t&&c&&(a=c.title);let d=t||c?void 0:this._instrumentation,h={};try{Xv(n,`=> ${a} started`,t);let p={apiName:a,frames:l,isInternal:t,reported:!1,csi:d,callCookie:h,wallTime:u},f=await Jv.zones.run("apiZone",p,async()=>await e(p));return d?.onApiCallEnd(h),Xv(n,`<= ${a} succeeded`,t),f}catch(p){let f=(process.env.PWDEBUGIMPL||(0,n5.isUnderTest)())&&p.stack?`
<inner error>
`+p.stack:"";a&&!a.includes("<anonymous>")&&(p.message=a+": "+p.message);let _=`
`+(0,gO.stringifyStackFrames)(o.frames).join(`
`)+f;throw _.trim()?p.stack=p.message+_:p.stack="",d?.onApiCallEnd(h,p),Xv(n,`<= ${a} failed`,t),p}}_toImpl(){var e,t;return(e=(t=this._connection).toImpl)===null||e===void 0?void 0:e.call(t,this)}toJSON(){return{_type:this._type,_guid:this._guid}}};ch.ChannelOwner=lh;function Xv(r,e,t){t||(r&&r.isEnabled("api","info")&&r.log("api","info",e,[],{color:"cyan"}),t5.debugLogger.log("api",e))}function r5(r,e,t,n){if(e._object instanceof lh&&(r==="*"||r.includes(e._object._type)))return{guid:e._object._guid};throw new _O.ValidationError(`${t}: expected channel ${r.toString()}`)}});var Zv=M(uh=>{"use strict";Object.defineProperty(uh,"__esModule",{value:!0});uh.Stream=void 0;var i5=require("stream"),s5=ze(),Yv=class extends s5.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s)}stream(){return new Qv(this._channel)}};uh.Stream=Yv;var Qv=class extends i5.Readable{constructor(e){super(),this._channel=void 0,this._channel=e}async _read(){let e=await this._channel.read({size:1048576});e.binary.byteLength?this.push(e.binary):this.push(null)}_destroy(e,t){this._channel.close().catch(n=>null),super._destroy(e,t)}}});var Us=M(dh=>{"use strict";Object.defineProperty(dh,"__esModule",{value:!0});dh.Artifact=void 0;var o5=c5(require("fs")),wO=Zv(),a5=ht(),l5=ze();function vO(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(vO=function(n){return n?t:e})(r)}function c5(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=vO(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}var eb=class extends l5.ChannelOwner{static from(e){return e._object}async pathAfterFinished(){if(this._connection.isRemote())throw new Error("Path is not available when connecting remotely. Use saveAs() to save a local copy.");return(await this._channel.pathAfterFinished()).value}async saveAs(e){if(!this._connection.isRemote()){await this._channel.saveAs({path:e});return}let t=await this._channel.saveAsStream(),n=wO.Stream.from(t.stream);await(0,a5.mkdirIfNeeded)(e),await new Promise((s,o)=>{n.stream().pipe(o5.createWriteStream(e)).on("finish",s).on("error",o)})}async failure(){return(await this._channel.failure()).error||null}async createReadStream(){let e=await this._channel.stream();return wO.Stream.from(e.stream).stream()}async readIntoBuffer(){let e=await this.createReadStream();return await new Promise((t,n)=>{let s=[];e.on("data",o=>{s.push(o)}),e.on("end",()=>{t(Buffer.concat(s))}),e.on("error",n)})}async cancel(){return await this._channel.cancel()}async delete(){return await this._channel.delete()}};dh.Artifact=eb});var Dr=M(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.addSourceUrlToScript=bO;Ma.envObjectToArray=p5;Ma.evaluationScript=f5;var u5=h5(require("fs")),d5=ie();function h5(r){return r&&r.__esModule?r:{default:r}}function p5(r){let e=[];for(let t in r)Object.is(r[t],void 0)||e.push({name:t,value:String(r[t])});return e}async function f5(r,e,t=!0){if(typeof r=="function"){let n=r.toString(),s=Object.is(e,void 0)?"undefined":JSON.stringify(e);return`(${n})(${s})`}if(e!==void 0)throw new Error("Cannot evaluate a string with arguments");if((0,d5.isString)(r))return r;if(r.content!==void 0)return r.content;if(r.path!==void 0){let n=await u5.default.promises.readFile(r.path,"utf8");return t&&(n=bO(n,r.path)),n}throw new Error("Either path or content property must be present")}function bO(r,e){return`${r}
//# sourceURL=${e.replace(/\n/g,"")}`}});var yO=M(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});hh.Coverage=void 0;var tb=class{constructor(e){this._channel=void 0,this._channel=e}async startJSCoverage(e={}){await this._channel.startJSCoverage(e)}async stopJSCoverage(){return(await this._channel.stopJSCoverage()).entries}async startCSSCoverage(e={}){await this._channel.startCSSCoverage(e)}async stopCSSCoverage(){return(await this._channel.stopCSSCoverage()).entries}};hh.Coverage=tb});var xO=M(ph=>{"use strict";Object.defineProperty(ph,"__esModule",{value:!0});ph.Download=void 0;var nb=class{constructor(e,t,n,s){this._page=void 0,this._url=void 0,this._suggestedFilename=void 0,this._artifact=void 0,this._page=e,this._url=t,this._suggestedFilename=n,this._artifact=s}page(){return this._page}url(){return this._url}suggestedFilename(){return this._suggestedFilename}async path(){return await this._artifact.pathAfterFinished()}async saveAs(e){return await this._artifact.saveAs(e)}async failure(){return await this._artifact.failure()}async createReadStream(){return await this._artifact.createReadStream()}async cancel(){return await this._artifact.cancel()}async delete(){return await this._artifact.delete()}};ph.Download=nb});var Yn=M(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.JSHandle=void 0;Ei.assertMaxArguments=_5;Ei.parseResult=ib;Ei.serializeArgument=rb;var m5=ze(),SO=Io(),g5=on(),EO;EO=Symbol.asyncDispose;var fh=class r extends m5.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._preview=void 0,this._preview=this._initializer.preview,this._channel.on("previewUpdated",({preview:o})=>this._preview=o)}async evaluate(e,t){let n=await this._channel.evaluateExpression({expression:String(e),isFunction:typeof e=="function",arg:rb(t)});return ib(n.value)}async evaluateHandle(e,t){let n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:typeof e=="function",arg:rb(t)});return r.from(n.handle)}async getProperty(e){let t=await this._channel.getProperty({name:e});return r.from(t.handle)}async getProperties(){let e=new Map;for(let{name:t,value:n}of(await this._channel.getPropertyList()).properties)e.set(t,r.from(n));return e}async jsonValue(){return ib((await this._channel.jsonValue()).value)}asElement(){return null}async[EO](){await this.dispose()}async dispose(){try{await this._channel.dispose()}catch(e){if((0,g5.isTargetClosedError)(e))return;throw e}}async _objectCount(){return await this._wrapApiCall(async()=>{let{count:e}=await this._channel.objectCount();return e})}toString(){return this._preview}};Ei.JSHandle=fh;function rb(r){let e=[],t=s=>(e.push(s),e.length-1);return{value:(0,SO.serializeValue)(r,s=>s instanceof fh?{h:t(s._channel)}:{fallThrough:s}),handles:e}}function ib(r){return(0,SO.parseSerializedValue)(r,void 0)}function _5(r,e){if(r>e)throw new Error("Too many arguments. If you need to pass more than 1 argument to the function wrap them in an object.")}});var ob=M(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.getByAltTextSelector=b5;Qn.getByLabelSelector=v5;Qn.getByPlaceholderSelector=x5;Qn.getByRoleSelector=E5;Qn.getByTestIdSelector=w5;Qn.getByTextSelector=S5;Qn.getByTitleSelector=y5;var Fa=Ht();function sb(r,e,t){return`internal:attr=[${r}=${(0,Fa.escapeForAttributeSelector)(e,t?.exact||!1)}]`}function w5(r,e){return`internal:testid=[${r}=${(0,Fa.escapeForAttributeSelector)(e,!0)}]`}function v5(r,e){return"internal:label="+(0,Fa.escapeForTextSelector)(r,!!(e!=null&&e.exact))}function b5(r,e){return sb("alt",r,e)}function y5(r,e){return sb("title",r,e)}function x5(r,e){return sb("placeholder",r,e)}function S5(r,e){return"internal:text="+(0,Fa.escapeForTextSelector)(r,!!(e!=null&&e.exact))}function E5(r,e={}){let t=[];return e.checked!==void 0&&t.push(["checked",String(e.checked)]),e.disabled!==void 0&&t.push(["disabled",String(e.disabled)]),e.selected!==void 0&&t.push(["selected",String(e.selected)]),e.expanded!==void 0&&t.push(["expanded",String(e.expanded)]),e.includeHidden!==void 0&&t.push(["include-hidden",String(e.includeHidden)]),e.level!==void 0&&t.push(["level",String(e.level)]),e.name!==void 0&&t.push(["name",(0,Fa.escapeForAttributeSelector)(e.name,!!e.exact)]),e.pressed!==void 0&&t.push(["pressed",String(e.pressed)]),`internal:role=${r}${t.map(([n,s])=>`[${n}=${s}]`).join("")}`}});var lb=M(Br=>{"use strict";Object.defineProperty(Br,"__esModule",{value:!0});Br.Locator=Br.FrameLocator=void 0;Br.setTestIdAttribute=O5;Br.testIdAttributeName=ab;var k5=T5(require("util")),Na=ie(),C5=Da(),kO=Yn(),CO=Ht(),qt=ob(),TO;function OO(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(OO=function(n){return n?t:e})(r)}function T5(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=OO(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}TO=k5.inspect.custom;var zs=class r{constructor(e,t,n){if(this._frame=void 0,this._selector=void 0,this._frame=e,this._selector=t,n!=null&&n.hasText&&(this._selector+=` >> internal:has-text=${(0,CO.escapeForTextSelector)(n.hasText,!1)}`),n!=null&&n.hasNotText&&(this._selector+=` >> internal:has-not-text=${(0,CO.escapeForTextSelector)(n.hasNotText,!1)}`),n!=null&&n.has){let s=n.has;if(s._frame!==e)throw new Error('Inner "has" locator must belong to the same frame.');this._selector+=" >> internal:has="+JSON.stringify(s._selector)}if(n!=null&&n.hasNot){let s=n.hasNot;if(s._frame!==e)throw new Error('Inner "hasNot" locator must belong to the same frame.');this._selector+=" >> internal:has-not="+JSON.stringify(s._selector)}}async _withElement(e,t){t=this._frame.page()._timeoutSettings.timeout({timeout:t});let n=t?(0,Na.monotonicTime)()+t:0;return await this._frame._wrapApiCall(async()=>{let s=await this._frame._channel.waitForSelector({selector:this._selector,strict:!0,state:"attached",timeout:t}),o=C5.ElementHandle.fromNullable(s.element);if(!o)throw new Error(`Could not resolve ${this._selector} to DOM Element`);try{return await e(o,n?n-(0,Na.monotonicTime)():0)}finally{await o.dispose()}})}_equals(e){return this._frame===e._frame&&this._selector===e._selector}page(){return this._frame.page()}async boundingBox(e){return await this._withElement(t=>t.boundingBox(),e?.timeout)}async check(e={}){return await this._frame.check(this._selector,{strict:!0,...e})}async click(e={}){return await this._frame.click(this._selector,{strict:!0,...e})}async dblclick(e={}){return await this._frame.dblclick(this._selector,{strict:!0,...e})}async dispatchEvent(e,t={},n){return await this._frame.dispatchEvent(this._selector,e,t,{strict:!0,...n})}async dragTo(e,t={}){return await this._frame.dragAndDrop(this._selector,e._selector,{strict:!0,...t})}async evaluate(e,t,n){return await this._withElement(s=>s.evaluate(e,t),n?.timeout)}async evaluateAll(e,t){return await this._frame.$$eval(this._selector,e,t)}async evaluateHandle(e,t,n){return await this._withElement(s=>s.evaluateHandle(e,t),n?.timeout)}async fill(e,t={}){return await this._frame.fill(this._selector,e,{strict:!0,...t})}async clear(e={}){return await this.fill("",e)}async _highlight(){return await this._frame._highlight(this._selector)}async highlight(){return await this._frame._highlight(this._selector)}locator(e,t){if((0,Na.isString)(e))return new r(this._frame,this._selector+" >> "+e,t);if(e._frame!==this._frame)throw new Error("Locators must belong to the same frame.");return new r(this._frame,this._selector+" >> internal:chain="+JSON.stringify(e._selector),t)}getByTestId(e){return this.locator((0,qt.getByTestIdSelector)(ab(),e))}getByAltText(e,t){return this.locator((0,qt.getByAltTextSelector)(e,t))}getByLabel(e,t){return this.locator((0,qt.getByLabelSelector)(e,t))}getByPlaceholder(e,t){return this.locator((0,qt.getByPlaceholderSelector)(e,t))}getByText(e,t){return this.locator((0,qt.getByTextSelector)(e,t))}getByTitle(e,t){return this.locator((0,qt.getByTitleSelector)(e,t))}getByRole(e,t={}){return this.locator((0,qt.getByRoleSelector)(e,t))}frameLocator(e){return new La(this._frame,this._selector+" >> "+e)}filter(e){return new r(this._frame,this._selector,e)}async elementHandle(e){return await this._frame.waitForSelector(this._selector,{strict:!0,state:"attached",...e})}async elementHandles(){return await this._frame.$$(this._selector)}contentFrame(){return new La(this._frame,this._selector)}first(){return new r(this._frame,this._selector+" >> nth=0")}last(){return new r(this._frame,this._selector+" >> nth=-1")}nth(e){return new r(this._frame,this._selector+` >> nth=${e}`)}and(e){if(e._frame!==this._frame)throw new Error("Locators must belong to the same frame.");return new r(this._frame,this._selector+" >> internal:and="+JSON.stringify(e._selector))}or(e){if(e._frame!==this._frame)throw new Error("Locators must belong to the same frame.");return new r(this._frame,this._selector+" >> internal:or="+JSON.stringify(e._selector))}async focus(e){return await this._frame.focus(this._selector,{strict:!0,...e})}async blur(e){await this._frame._channel.blur({selector:this._selector,strict:!0,...e})}async count(){return await this._frame._queryCount(this._selector)}async getAttribute(e,t){return await this._frame.getAttribute(this._selector,e,{strict:!0,...t})}async hover(e={}){return await this._frame.hover(this._selector,{strict:!0,...e})}async innerHTML(e){return await this._frame.innerHTML(this._selector,{strict:!0,...e})}async innerText(e){return await this._frame.innerText(this._selector,{strict:!0,...e})}async inputValue(e){return await this._frame.inputValue(this._selector,{strict:!0,...e})}async isChecked(e){return await this._frame.isChecked(this._selector,{strict:!0,...e})}async isDisabled(e){return await this._frame.isDisabled(this._selector,{strict:!0,...e})}async isEditable(e){return await this._frame.isEditable(this._selector,{strict:!0,...e})}async isEnabled(e){return await this._frame.isEnabled(this._selector,{strict:!0,...e})}async isHidden(e){return await this._frame.isHidden(this._selector,{strict:!0,...e})}async isVisible(e){return await this._frame.isVisible(this._selector,{strict:!0,...e})}async press(e,t={}){return await this._frame.press(this._selector,e,{strict:!0,...t})}async screenshot(e={}){return await this._withElement((t,n)=>t.screenshot({...e,timeout:n}),e.timeout)}async scrollIntoViewIfNeeded(e={}){return await this._withElement((t,n)=>t.scrollIntoViewIfNeeded({...e,timeout:n}),e.timeout)}async selectOption(e,t={}){return await this._frame.selectOption(this._selector,e,{strict:!0,...t})}async selectText(e={}){return await this._withElement((t,n)=>t.selectText({...e,timeout:n}),e.timeout)}async setChecked(e,t){e?await this.check(t):await this.uncheck(t)}async setInputFiles(e,t={}){return await this._frame.setInputFiles(this._selector,e,{strict:!0,...t})}async tap(e={}){return await this._frame.tap(this._selector,{strict:!0,...e})}async textContent(e){return await this._frame.textContent(this._selector,{strict:!0,...e})}async type(e,t={}){return await this._frame.type(this._selector,e,{strict:!0,...t})}async pressSequentially(e,t={}){return await this.type(e,t)}async uncheck(e={}){return await this._frame.uncheck(this._selector,{strict:!0,...e})}async all(){return new Array(await this.count()).fill(0).map((e,t)=>this.nth(t))}async allInnerTexts(){return await this._frame.$$eval(this._selector,e=>e.map(t=>t.innerText))}async allTextContents(){return await this._frame.$$eval(this._selector,e=>e.map(t=>t.textContent||""))}async waitFor(e){await this._frame._channel.waitForSelector({selector:this._selector,strict:!0,omitReturnValue:!0,...e})}async _expect(e,t){let n={selector:this._selector,expression:e,...t,isNot:!!t.isNot};n.expectedValue=(0,kO.serializeArgument)(t.expectedValue);let s=await this._frame._channel.expect(n);return s.received!==void 0&&(s.received=(0,kO.parseResult)(s.received)),s}[TO](){return this.toString()}toString(){return(0,Na.asLocator)("javascript",this._selector)}};Br.Locator=zs;var La=class r{constructor(e,t){this._frame=void 0,this._frameSelector=void 0,this._frame=e,this._frameSelector=t}locator(e,t){if((0,Na.isString)(e))return new zs(this._frame,this._frameSelector+" >> internal:control=enter-frame >> "+e,t);if(e._frame!==this._frame)throw new Error("Locators must belong to the same frame.");return new zs(this._frame,this._frameSelector+" >> internal:control=enter-frame >> "+e._selector,t)}getByTestId(e){return this.locator((0,qt.getByTestIdSelector)(ab(),e))}getByAltText(e,t){return this.locator((0,qt.getByAltTextSelector)(e,t))}getByLabel(e,t){return this.locator((0,qt.getByLabelSelector)(e,t))}getByPlaceholder(e,t){return this.locator((0,qt.getByPlaceholderSelector)(e,t))}getByText(e,t){return this.locator((0,qt.getByTextSelector)(e,t))}getByTitle(e,t){return this.locator((0,qt.getByTitleSelector)(e,t))}getByRole(e,t={}){return this.locator((0,qt.getByRoleSelector)(e,t))}owner(){return new zs(this._frame,this._frameSelector)}frameLocator(e){return new r(this._frame,this._frameSelector+" >> internal:control=enter-frame >> "+e)}first(){return new r(this._frame,this._frameSelector+" >> nth=0")}last(){return new r(this._frame,this._frameSelector+" >> nth=-1")}nth(e){return new r(this._frame,this._frameSelector+` >> nth=${e}`)}};Br.FrameLocator=La;var PO="data-testid";function ab(){return PO}function O5(r){PO=r}});var Rn=M(mh=>{"use strict";Object.defineProperty(mh,"__esModule",{value:!0});mh.Events=void 0;var RV=mh.Events={AndroidDevice:{WebView:"webview",Close:"close"},AndroidSocket:{Data:"data",Close:"close"},AndroidWebView:{Close:"close"},Browser:{Disconnected:"disconnected"},BrowserContext:{Console:"console",Close:"close",Dialog:"dialog",Page:"page",WebError:"weberror",BackgroundPage:"backgroundpage",ServiceWorker:"serviceworker",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished"},BrowserServer:{Close:"close"},Page:{Close:"close",Crash:"crash",Console:"console",Dialog:"dialog",Download:"download",FileChooser:"filechooser",DOMContentLoaded:"domcontentloaded",PageError:"pageerror",Request:"request",Response:"response",RequestFailed:"requestfailed",RequestFinished:"requestfinished",FrameAttached:"frameattached",FrameDetached:"framedetached",FrameNavigated:"framenavigated",Load:"load",Popup:"popup",WebSocket:"websocket",Worker:"worker"},WebSocket:{Close:"close",Error:"socketerror",FrameReceived:"framereceived",FrameSent:"framesent"},Worker:{Close:"close"},ElectronApplication:{Close:"close",Console:"console",Window:"window"}}});var Ba=M(gh=>{"use strict";Object.defineProperty(gh,"__esModule",{value:!0});gh.Worker=void 0;var AO=Rn(),P5=ze(),Vs=Yn(),A5=ie(),I5=on(),cb=class extends P5.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._page=void 0,this._context=void 0,this._closedScope=new A5.LongStandingScope,this._channel.on("close",()=>{this._page&&this._page._workers.delete(this),this._context&&this._context._serviceWorkers.delete(this),this.emit(AO.Events.Worker.Close,this)}),this.once(AO.Events.Worker.Close,()=>{var o;return this._closedScope.close(((o=this._page)===null||o===void 0?void 0:o._closeErrorWithReason())||new I5.TargetClosedError)})}url(){return this._initializer.url}async evaluate(e,t){(0,Vs.assertMaxArguments)(arguments.length,2);let n=await this._channel.evaluateExpression({expression:String(e),isFunction:typeof e=="function",arg:(0,Vs.serializeArgument)(t)});return(0,Vs.parseResult)(n.value)}async evaluateHandle(e,t){(0,Vs.assertMaxArguments)(arguments.length,2);let n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:typeof e=="function",arg:(0,Vs.serializeArgument)(t)});return Vs.JSHandle.from(n.handle)}};gh.Worker=cb});var ki=M(_h=>{"use strict";Object.defineProperty(_h,"__esModule",{value:!0});_h.Waiter=void 0;var R5=Lt(),M5=on(),F5=ie(),ub=class r{constructor(e,t){this._dispose=void 0,this._failures=[],this._immediateError=void 0,this._logs=[],this._channelOwner=void 0,this._waitId=void 0,this._error=void 0,this._waitId=(0,F5.createGuid)(),this._channelOwner=e,this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"before",event:t}}).catch(()=>{}),this._dispose=[()=>this._channelOwner._wrapApiCall(async()=>{await this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"after",error:this._error}})},!0).catch(()=>{})]}static createForEvent(e,t){return new r(e,t)}async waitForEvent(e,t,n){let{promise:s,dispose:o}=IO(e,t,n);return await this.waitForPromise(s,o)}rejectOnEvent(e,t,n,s){let{promise:o,dispose:a}=IO(e,t,s);this._rejectOn(o.then(()=>{throw typeof n=="function"?n():n}),a)}rejectOnTimeout(e,t){if(!e)return;let{promise:n,dispose:s}=N5(e);this._rejectOn(n.then(()=>{throw new M5.TimeoutError(t)}),s)}rejectImmediately(e){this._immediateError=e}dispose(){for(let e of this._dispose)e()}async waitForPromise(e,t){try{if(this._immediateError)throw this._immediateError;let n=await Promise.race([e,...this._failures]);return t&&t(),n}catch(n){throw t&&t(),this._error=n.message,this.dispose(),(0,R5.rewriteErrorMessage)(n,n.message+L5(this._logs)),n}}log(e){this._logs.push(e),this._channelOwner._wrapApiCall(async()=>{await this._channelOwner._channel.waitForEventInfo({info:{waitId:this._waitId,phase:"log",message:e}}).catch(()=>{})},!0)}_rejectOn(e,t){this._failures.push(e),t&&this._dispose.push(t)}};_h.Waiter=ub;function IO(r,e,t){let n;return{promise:new Promise((a,l)=>{n=async c=>{try{if(t&&!await t(c))return;r.removeListener(e,n),a(c)}catch(u){r.removeListener(e,n),l(u)}},r.addListener(e,n)}),dispose:()=>r.removeListener(e,n)}}function N5(r){let e;return{promise:new Promise(s=>e=setTimeout(s,r)),dispose:()=>clearTimeout(e)}}function L5(r){if(!r.length)return"";let e=" logs ",t=60,n=(t-e.length)/2,s=t-e.length-n;return`
${"=".repeat(n)}${e}${"=".repeat(s)}
${r.join(`
`)}
${"=".repeat(t)}`}});var vh=M(wh=>{"use strict";Object.defineProperty(wh,"__esModule",{value:!0});wh.Tracing=void 0;var D5=Us(),B5=ze(),db=class extends B5.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._includeSources=!1,this._tracesDir=void 0,this._stacksId=void 0,this._isTracing=!1}async start(e={}){this._includeSources=!!e.sources;let t=await this._wrapApiCall(async()=>(await this._channel.tracingStart({name:e.name,snapshots:e.snapshots,screenshots:e.screenshots,live:e._live}),(await this._channel.tracingStartChunk({name:e.name,title:e.title})).traceName),!0);await this._startCollectingStacks(t)}async startChunk(e={}){let{traceName:t}=await this._channel.tracingStartChunk(e);await this._startCollectingStacks(t)}async _startCollectingStacks(e){this._isTracing||(this._isTracing=!0,this._connection.setIsTracing(!0));let t=await this._connection.localUtils()._channel.tracingStarted({tracesDir:this._tracesDir,traceName:e});this._stacksId=t.stacksId}async stopChunk(e={}){await this._wrapApiCall(async()=>{await this._doStopChunk(e.path)},!0)}async stop(e={}){await this._wrapApiCall(async()=>{await this._doStopChunk(e.path),await this._channel.tracingStop()},!0)}async _doStopChunk(e){if(this._resetStackCounter(),!e){await this._channel.tracingStopChunk({mode:"discard"}),this._stacksId&&await this._connection.localUtils()._channel.traceDiscarded({stacksId:this._stacksId});return}if(!this._connection.isRemote()){let o=await this._channel.tracingStopChunk({mode:"entries"});await this._connection.localUtils()._channel.zip({zipFile:e,entries:o.entries,mode:"write",stacksId:this._stacksId,includeSources:this._includeSources});return}let n=await this._channel.tracingStopChunk({mode:"archive"});if(!n.artifact){this._stacksId&&await this._connection.localUtils()._channel.traceDiscarded({stacksId:this._stacksId});return}let s=D5.Artifact.from(n.artifact);await s.saveAs(e),await s.delete(),await this._connection.localUtils()._channel.zip({zipFile:e,entries:[],mode:"append",stacksId:this._stacksId,includeSources:this._includeSources})}_resetStackCounter(){this._isTracing&&(this._isTracing=!1,this._connection.setIsTracing(!1))}};wh.Tracing=db});var ja=M(jr=>{"use strict";Object.defineProperty(jr,"__esModule",{value:!0});jr.APIResponse=jr.APIRequestContext=jr.APIRequest=void 0;var pb=DO(require("fs")),j5=DO(require("path")),q5=V5(require("util")),Zn=ie(),H5=ht(),$5=ze(),W5=Gs(),U5=vh(),z5=on(),MO,FO,NO;function LO(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(LO=function(n){return n?t:e})(r)}function V5(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=LO(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function DO(r){return r&&r.__esModule?r:{default:r}}var hb=class{constructor(e){this._playwright=void 0,this._contexts=new Set,this._defaultContextOptions=void 0,this._playwright=e}async newContext(e={}){var t;e={...this._defaultContextOptions,...e};let n=typeof e.storageState=="string"?JSON.parse(await pb.default.promises.readFile(e.storageState,"utf8")):e.storageState,s=(t=this._defaultContextOptions)===null||t===void 0?void 0:t.tracesDir,o=bh.from((await this._playwright._channel.newRequest({...e,extraHTTPHeaders:e.extraHTTPHeaders?(0,Zn.headersObjectToArray)(e.extraHTTPHeaders):void 0,storageState:n,tracesDir:s})).request);return this._contexts.add(o),o._request=this,o._tracing._tracesDir=s,await o._instrumentation.onDidCreateRequestContext(o),o}};jr.APIRequest=hb;MO=Symbol.asyncDispose;var bh=class extends $5.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._request=void 0,this._tracing=void 0,this._tracing=U5.Tracing.from(s.tracing)}async[MO](){await this.dispose()}async dispose(){var e;await this._instrumentation.onWillCloseRequestContext(this),await this._channel.dispose(),this._tracing._resetStackCounter(),(e=this._request)===null||e===void 0||e._contexts.delete(this)}async delete(e,t){return await this.fetch(e,{...t,method:"DELETE"})}async head(e,t){return await this.fetch(e,{...t,method:"HEAD"})}async get(e,t){return await this.fetch(e,{...t,method:"GET"})}async patch(e,t){return await this.fetch(e,{...t,method:"PATCH"})}async post(e,t){return await this.fetch(e,{...t,method:"POST"})}async put(e,t){return await this.fetch(e,{...t,method:"PUT"})}async fetch(e,t={}){let n=(0,Zn.isString)(e)?e:void 0,s=(0,Zn.isString)(e)?void 0:e;return await this._innerFetch({url:n,request:s,...t})}async _innerFetch(e={}){return await this._wrapApiCall(async()=>{var t,n,s;(0,Zn.assert)(e.request||typeof e.url=="string","First argument must be either URL string or Request"),(0,Zn.assert)((e.data===void 0?0:1)+(e.form===void 0?0:1)+(e.multipart===void 0?0:1)<=1,"Only one of 'data', 'form' or 'multipart' can be specified"),(0,Zn.assert)(e.maxRedirects===void 0||e.maxRedirects>=0,"'maxRedirects' should be greater than or equal to '0'");let o=e.url!==void 0?e.url:e.request.url(),a=RO(e.params),l=e.method||((t=e.request)===null||t===void 0?void 0:t.method()),c=e.maxRedirects,u=e.headers||((n=e.request)===null||n===void 0?void 0:n.headers()),d=u?(0,Zn.headersObjectToArray)(u):void 0,h,p,f,_;if(e.data!==void 0)if((0,Zn.isString)(e.data))Y5(d)?h=K5(e.data)?e.data:JSON.stringify(e.data):_=Buffer.from(e.data,"utf8");else if(Buffer.isBuffer(e.data))_=e.data;else if(typeof e.data=="object"||typeof e.data=="number"||typeof e.data=="boolean")h=JSON.stringify(e.data);else throw new Error("Unexpected 'data' type");else if(e.form)p=RO(e.form);else if(e.multipart)if(f=[],globalThis.FormData&&e.multipart instanceof FormData){let m=e.multipart;for(let[g,x]of m.entries())if((0,Zn.isString)(x))f.push({name:g,value:x});else{let b={name:x.name,mimeType:x.type,buffer:Buffer.from(await x.arrayBuffer())};f.push({name:g,file:b})}}else for(let[m,g]of Object.entries(e.multipart))f.push(await G5(m,g));_===void 0&&h===void 0&&p===void 0&&f===void 0&&(_=((s=e.request)===null||s===void 0?void 0:s.postDataBuffer())||void 0);let v={__testHookLookup:e.__testHookLookup},w=await this._channel.fetch({url:o,params:a,method:l,headers:d,postData:_,jsonData:h,formData:p,multipartData:f,timeout:e.timeout,failOnStatusCode:e.failOnStatusCode,ignoreHTTPSErrors:e.ignoreHTTPSErrors,maxRedirects:c,...v});return new yh(this,w.response)})}async storageState(e={}){let t=await this._channel.storageState();return e.path&&(await(0,H5.mkdirIfNeeded)(e.path),await pb.default.promises.writeFile(e.path,JSON.stringify(t,void 0,2),"utf8")),t}};jr.APIRequestContext=bh;async function G5(r,e){if(Q5(e)){let t=e;if(!Buffer.isBuffer(t.buffer))throw new Error(`Unexpected buffer type of 'data.${r}'`);return{name:r,file:J5(t)}}else return e instanceof pb.default.ReadStream?{name:r,file:await X5(e)}:{name:r,value:String(e)}}function K5(r){if(typeof r!="string")return!1;try{return JSON.parse(r),!0}catch(e){if(e instanceof SyntaxError)return!1;throw e}}FO=Symbol.asyncDispose;NO=q5.inspect.custom;var yh=class{constructor(e,t){this._initializer=void 0,this._headers=void 0,this._request=void 0,this._request=e,this._initializer=t,this._headers=new W5.RawHeaders(this._initializer.headers)}ok(){return this._initializer.status>=200&&this._initializer.status<=299}url(){return this._initializer.url}status(){return this._initializer.status}statusText(){return this._initializer.statusText}headers(){return this._headers.headers()}headersArray(){return this._headers.headersArray()}async body(){try{let e=await this._request._channel.fetchResponseBody({fetchUid:this._fetchUid()});if(e.binary===void 0)throw new Error("Response has been disposed");return e.binary}catch(e){throw(0,z5.isTargetClosedError)(e)?new Error("Response has been disposed"):e}}async text(){return(await this.body()).toString("utf8")}async json(){let e=await this.text();return JSON.parse(e)}async[FO](){await this.dispose()}async dispose(){await this._request._channel.disposeAPIResponse({fetchUid:this._fetchUid()})}[NO](){let e=this.headersArray().map(({name:t,value:n})=>`  ${t}: ${n}`);return`APIResponse: ${this.status()} ${this.statusText()}
${e.join(`
`)}`}_fetchUid(){return this._initializer.fetchUid}async _fetchLog(){let{log:e}=await this._request._channel.fetchLog({fetchUid:this._fetchUid()});return e}};jr.APIResponse=yh;function J5(r){return{name:r.name,mimeType:r.mimeType,buffer:r.buffer}}async function X5(r){let e=await new Promise((n,s)=>{let o=[];r.on("data",a=>o.push(a)),r.on("end",()=>n(Buffer.concat(o))),r.on("error",a=>s(a))}),t=Buffer.isBuffer(r.path)?r.path.toString("utf8"):r.path;return{name:j5.default.basename(t),buffer:e}}function Y5(r){if(!r)return!1;for(let{name:e,value:t}of r)if(e.toLocaleLowerCase()==="content-type")return t==="application/json";return!1}function RO(r){if(!r)return;let e=[];for(let[t,n]of Object.entries(r))e.push({name:t,value:String(n)});return e}function Q5(r){return typeof r=="object"&&r.name&&r.mimeType&&r.buffer}});var Gs=M(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.WebSocket=Pt.RouteHandler=Pt.Route=Pt.Response=Pt.Request=Pt.RawHeaders=void 0;Pt.validateHeaders=l$;var Z5=require("url"),xh=ze(),BO=Ks(),e$=Ba(),t$=a$(require("fs")),n$=Be(),er=ie(),Sh=Qe(),vn=Rn(),r$=ki(),i$=xn(),s$=wl(),o$=ja();function a$(r){return r&&r.__esModule?r:{default:r}}var qa=class r extends xh.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){super(e,t,n,s),this._redirectedFrom=null,this._redirectedTo=null,this._failureText=null,this._provisionalHeaders=void 0,this._actualHeadersPromise=void 0,this._timing=void 0,this._fallbackOverrides={},this._redirectedFrom=r.fromNullable(s.redirectedFrom),this._redirectedFrom&&(this._redirectedFrom._redirectedTo=this),this._provisionalHeaders=new tr(s.headers),this._fallbackOverrides.postDataBuffer=s.postData,this._timing={startTime:0,domainLookupStart:-1,domainLookupEnd:-1,connectStart:-1,secureConnectionStart:-1,connectEnd:-1,requestStart:-1,responseStart:-1,responseEnd:-1}}url(){return this._fallbackOverrides.url||this._initializer.url}resourceType(){return this._initializer.resourceType}method(){return this._fallbackOverrides.method||this._initializer.method}postData(){var e;return((e=this._fallbackOverrides.postDataBuffer)===null||e===void 0?void 0:e.toString("utf-8"))||null}postDataBuffer(){return this._fallbackOverrides.postDataBuffer||null}postDataJSON(){let e=this.postData();if(!e)return null;let t=this.headers()["content-type"];if(t!=null&&t.includes("application/x-www-form-urlencoded")){let n={},s=new Z5.URLSearchParams(e);for(let[o,a]of s.entries())n[o]=a;return n}try{return JSON.parse(e)}catch{throw new Error("POST data is not a valid JSON object: "+e)}}headers(){return this._fallbackOverrides.headers?tr._fromHeadersObjectLossy(this._fallbackOverrides.headers).headers():this._provisionalHeaders.headers()}async _actualHeaders(){return this._fallbackOverrides.headers?tr._fromHeadersObjectLossy(this._fallbackOverrides.headers):(this._actualHeadersPromise||(this._actualHeadersPromise=this._wrapApiCall(async()=>new tr((await this._channel.rawRequestHeaders()).headers))),await this._actualHeadersPromise)}async allHeaders(){return(await this._actualHeaders()).headers()}async headersArray(){return(await this._actualHeaders()).headersArray()}async headerValue(e){return(await this._actualHeaders()).get(e)}async response(){return Ha.fromNullable((await this._channel.response()).response)}async _internalResponse(){return await this._wrapApiCall(async()=>Ha.fromNullable((await this._channel.response()).response),!0)}frame(){if(!this._initializer.frame)throw(0,er.assert)(this.serviceWorker()),new Error("Service Worker requests do not have an associated frame.");let e=BO.Frame.from(this._initializer.frame);if(!e._page)throw new Error(["Frame for this navigation request is not available, because the request","was issued before the frame is created. You can check whether the request","is a navigation request by calling isNavigationRequest() method."].join(`
`));return e}_safePage(){var e;return((e=BO.Frame.fromNullable(this._initializer.frame))===null||e===void 0?void 0:e._page)||null}serviceWorker(){return this._initializer.serviceWorker?e$.Worker.from(this._initializer.serviceWorker):null}isNavigationRequest(){return this._initializer.isNavigationRequest}redirectedFrom(){return this._redirectedFrom}redirectedTo(){return this._redirectedTo}failure(){return this._failureText===null?null:{errorText:this._failureText}}timing(){return this._timing}async sizes(){let e=await this.response();if(!e)throw new Error("Unable to fetch sizes for failed request");return(await e._channel.sizes()).sizes}_setResponseEndTiming(e){this._timing.responseEnd=e,this._timing.responseStart===-1&&(this._timing.responseStart=e)}_finalRequest(){return this._redirectedTo?this._redirectedTo._finalRequest():this}_applyFallbackOverrides(e){e.url&&(this._fallbackOverrides.url=e.url),e.method&&(this._fallbackOverrides.method=e.method),e.headers&&(this._fallbackOverrides.headers=e.headers),(0,er.isString)(e.postData)?this._fallbackOverrides.postDataBuffer=Buffer.from(e.postData,"utf-8"):e.postData instanceof Buffer?this._fallbackOverrides.postDataBuffer=e.postData:e.postData&&(this._fallbackOverrides.postDataBuffer=Buffer.from(JSON.stringify(e.postData),"utf-8"))}_fallbackOverridesForContinue(){return this._fallbackOverrides}_targetClosedScope(){var e,t;return((e=this.serviceWorker())===null||e===void 0?void 0:e._closedScope)||((t=this._safePage())===null||t===void 0?void 0:t._closedOrCrashedScope)||new Sh.LongStandingScope}};Pt.Request=qa;var fb=class extends xh.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._handlingPromise=null,this._context=void 0,this._didThrow=!1}request(){return qa.from(this._initializer.request)}async _raceWithTargetClose(e){return await this.request()._targetClosedScope().safeRace(e)}async _startHandling(){return this._handlingPromise=new Sh.ManualPromise,await this._handlingPromise}async fallback(e={}){this._checkNotHandled(),this.request()._applyFallbackOverrides(e),this._reportHandled(!1)}async abort(e){await this._handleRoute(async()=>{await this._raceWithTargetClose(this._channel.abort({requestUrl:this.request()._initializer.url,errorCode:e}))})}async _redirectNavigationRequest(e){await this._handleRoute(async()=>{await this._raceWithTargetClose(this._channel.redirectNavigationRequest({url:e}))})}async fetch(e={}){return await this._wrapApiCall(async()=>await this._context.request._innerFetch({request:this.request(),data:e.postData,...e}))}async fulfill(e={}){await this._handleRoute(async()=>{await this._wrapApiCall(async()=>{await this._innerFulfill(e)})})}async _handleRoute(e){this._checkNotHandled();try{await e(),this._reportHandled(!0)}catch(t){throw this._didThrow=!0,t}}async _innerFulfill(e={}){let t,{status:n,headers:s,body:o}=e;if(e.json!==void 0&&((0,er.assert)(e.body===void 0,"Can specify either body or json parameters"),o=JSON.stringify(e.json)),e.response instanceof o$.APIResponse){var a,l;(a=n)!==null&&a!==void 0||(n=e.response.status()),(l=s)!==null&&l!==void 0||(s=e.response.headers()),o===void 0&&e.path===void 0&&(e.response._request._connection===this._connection?t=e.response._fetchUid():o=await e.response.body())}let c=!1,u=0;if(e.path){let h=await t$.default.promises.readFile(e.path);o=h.toString("base64"),c=!0,u=h.length}else(0,er.isString)(o)?(c=!1,u=Buffer.byteLength(o)):o&&(u=o.length,o=o.toString("base64"),c=!0);let d={};for(let h of Object.keys(s||{}))d[h.toLowerCase()]=String(s[h]);e.contentType?d["content-type"]=String(e.contentType):e.json?d["content-type"]="application/json":e.path&&(d["content-type"]=n$.mime.getType(e.path)||"application/octet-stream"),u&&!("content-length"in d)&&(d["content-length"]=String(u)),await this._raceWithTargetClose(this._channel.fulfill({requestUrl:this.request()._initializer.url,status:n||200,headers:(0,er.headersObjectToArray)(d),body:o,isBase64:c,fetchResponseUid:t}))}async continue(e={}){await this._handleRoute(async()=>{this.request()._applyFallbackOverrides(e),await this._innerContinue()})}_checkNotHandled(){if(!this._handlingPromise)throw new Error("Route is already handled!")}_reportHandled(e){let t=this._handlingPromise;this._handlingPromise=null,t.resolve(e)}async _innerContinue(e=!1){let t=this.request()._fallbackOverridesForContinue();return await this._wrapApiCall(async()=>{await this._raceWithTargetClose(this._channel.continue({requestUrl:this.request()._initializer.url,url:t.url,method:t.method,headers:t.headers?(0,er.headersObjectToArray)(t.headers):void 0,postData:t.postDataBuffer,isFallback:e}))},!!e)}};Pt.Route=fb;var Ha=class r extends xh.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){super(e,t,n,s),this._provisionalHeaders=void 0,this._actualHeadersPromise=void 0,this._request=void 0,this._finishedPromise=new Sh.ManualPromise,this._provisionalHeaders=new tr(s.headers),this._request=qa.from(this._initializer.request),Object.assign(this._request._timing,this._initializer.timing)}url(){return this._initializer.url}ok(){return this._initializer.status===0||this._initializer.status>=200&&this._initializer.status<=299}status(){return this._initializer.status}statusText(){return this._initializer.statusText}fromServiceWorker(){return this._initializer.fromServiceWorker}headers(){return this._provisionalHeaders.headers()}async _actualHeaders(){return this._actualHeadersPromise||(this._actualHeadersPromise=(async()=>new tr((await this._channel.rawResponseHeaders()).headers))()),await this._actualHeadersPromise}async allHeaders(){return(await this._actualHeaders()).headers()}async headersArray(){return(await this._actualHeaders()).headersArray().slice()}async headerValue(e){return(await this._actualHeaders()).get(e)}async headerValues(e){return(await this._actualHeaders()).getAll(e)}async finished(){return await this.request()._targetClosedScope().race(this._finishedPromise)}async body(){return(await this._channel.body()).binary}async text(){return(await this.body()).toString("utf8")}async json(){let e=await this.text();return JSON.parse(e)}request(){return this._request}frame(){return this._request.frame()}async serverAddr(){return(await this._channel.serverAddr()).value||null}async securityDetails(){return(await this._channel.securityDetails()).value||null}};Pt.Response=Ha;var mb=class extends xh.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._page=void 0,this._isClosed=void 0,this._isClosed=!1,this._page=e,this._channel.on("frameSent",o=>{o.opcode===1?this.emit(vn.Events.WebSocket.FrameSent,{payload:o.data}):o.opcode===2&&this.emit(vn.Events.WebSocket.FrameSent,{payload:Buffer.from(o.data,"base64")})}),this._channel.on("frameReceived",o=>{o.opcode===1?this.emit(vn.Events.WebSocket.FrameReceived,{payload:o.data}):o.opcode===2&&this.emit(vn.Events.WebSocket.FrameReceived,{payload:Buffer.from(o.data,"base64")})}),this._channel.on("socketError",({error:o})=>this.emit(vn.Events.WebSocket.Error,o)),this._channel.on("close",()=>{this._isClosed=!0,this.emit(vn.Events.WebSocket.Close,this)})}url(){return this._initializer.url}isClosed(){return this._isClosed}async waitForEvent(e,t={}){return await this._wrapApiCall(async()=>{let n=this._page._timeoutSettings.timeout(typeof t=="function"?{}:t),s=typeof t=="function"?t:t.predicate,o=r$.Waiter.createForEvent(this,e);o.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==vn.Events.WebSocket.Error&&o.rejectOnEvent(this,vn.Events.WebSocket.Error,new Error("Socket error")),e!==vn.Events.WebSocket.Close&&o.rejectOnEvent(this,vn.Events.WebSocket.Close,new Error("Socket closed")),o.rejectOnEvent(this._page,vn.Events.Page.Close,()=>this._page._closeErrorWithReason());let a=await o.waitForEvent(this,e,s);return o.dispose(),a})}};Pt.WebSocket=mb;function l$(r){for(let e of Object.keys(r)){let t=r[e];if(!Object.is(t,void 0)&&!(0,er.isString)(t))throw new Error(`Expected value of header "${e}" to be String, but "${typeof t}" is found.`)}}var gb=class{constructor(e,t,n,s=Number.MAX_SAFE_INTEGER){this.handledCount=0,this._baseURL=void 0,this._times=void 0,this.url=void 0,this.handler=void 0,this._ignoreException=!1,this._activeInvocations=new Set,this._baseURL=e,this._times=s,this.url=t,this.handler=n}static prepareInterceptionPatterns(e){let t=[],n=!1;for(let s of e)(0,er.isString)(s.url)?t.push({glob:s.url}):(0,er.isRegExp)(s.url)?t.push({regexSource:s.url.source,regexFlags:s.url.flags}):n=!0;return n?[{glob:"**/*"}]:t}matches(e){return(0,i$.urlMatches)(this._baseURL,e,this.url)}async handle(e){let t={complete:new Sh.ManualPromise,route:e};this._activeInvocations.add(t);try{return await this._handleInternal(e)}catch(n){if(this._ignoreException)return!1;throw n}finally{t.complete.resolve(),this._activeInvocations.delete(t)}}async stop(e){if(e==="ignoreErrors")this._ignoreException=!0;else{let t=[];for(let n of this._activeInvocations)n.route._didThrow||t.push(n.complete);await Promise.all(t)}}async _handleInternal(e){++this.handledCount;let t=e._startHandling(),n=this.handler,[s]=await Promise.all([t,n(e,e.request())]);return s}willExpire(){return this.handledCount+1>=this._times}};Pt.RouteHandler=gb;var tr=class r{static _fromHeadersObjectLossy(e){let t=Object.entries(e).map(([n,s])=>({name:n,value:s})).filter(n=>n.value!==void 0);return new r(t)}constructor(e){this._headersArray=void 0,this._headersMap=new s$.MultiMap,this._headersArray=e;for(let t of e)this._headersMap.set(t.name.toLowerCase(),t.value)}get(e){let t=this.getAll(e);return!t||!t.length?null:t.join(e.toLowerCase()==="set-cookie"?`
`:", ")}getAll(e){return[...this._headersMap.get(e.toLowerCase())]}headers(){let e={};for(let t of this._headersMap.keys())e[t]=this.get(t);return e}headersArray(){return this._headersArray}};Pt.RawHeaders=tr});var jO=M(Eh=>{"use strict";Object.defineProperty(Eh,"__esModule",{value:!0});Eh.kLifecycleEvents=void 0;var jV=Eh.kLifecycleEvents=new Set(["load","domcontentloaded","networkidle","commit"])});var Ks=M(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.Frame=void 0;Wa.verifyLoadState=$a;var c$=ie(),u$=ze(),_b=lb(),Ci=ob(),qr=Da(),dt=Yn(),qO=g$(require("fs")),HO=m$(Gs()),d$=require("events"),h$=ki(),Js=Rn(),p$=jO(),$O=xn(),f$=Dr();function WO(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(WO=function(n){return n?t:e})(r)}function m$(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=WO(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}function g$(r){return r&&r.__esModule?r:{default:r}}var wb=class r extends u$.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){super(e,t,n,s),this._eventEmitter=void 0,this._loadStates=void 0,this._parentFrame=null,this._url="",this._name="",this._detached=!1,this._childFrames=new Set,this._page=void 0,this._eventEmitter=new d$.EventEmitter,this._eventEmitter.setMaxListeners(0),this._parentFrame=r.fromNullable(s.parentFrame),this._parentFrame&&this._parentFrame._childFrames.add(this),this._name=s.name,this._url=s.url,this._loadStates=new Set(s.loadStates),this._channel.on("loadstate",o=>{o.add&&(this._loadStates.add(o.add),this._eventEmitter.emit("loadstate",o.add)),o.remove&&this._loadStates.delete(o.remove),!this._parentFrame&&o.add==="load"&&this._page&&this._page.emit(Js.Events.Page.Load,this._page),!this._parentFrame&&o.add==="domcontentloaded"&&this._page&&this._page.emit(Js.Events.Page.DOMContentLoaded,this._page)}),this._channel.on("navigated",o=>{this._url=o.url,this._name=o.name,this._eventEmitter.emit("navigated",o),!o.error&&this._page&&this._page.emit(Js.Events.Page.FrameNavigated,this)})}page(){return this._page}async goto(e,t={}){let n=$a("waitUntil",t.waitUntil===void 0?"load":t.waitUntil);return HO.Response.fromNullable((await this._channel.goto({url:e,...t,waitUntil:n})).response)}_setupNavigationWaiter(e){let t=new h$.Waiter(this._page,"");this._page.isClosed()&&t.rejectImmediately(this._page._closeErrorWithReason()),t.rejectOnEvent(this._page,Js.Events.Page.Close,()=>this._page._closeErrorWithReason()),t.rejectOnEvent(this._page,Js.Events.Page.Crash,new Error("Navigation failed because page crashed!")),t.rejectOnEvent(this._page,Js.Events.Page.FrameDetached,new Error("Navigating frame was detached!"),s=>s===this);let n=this._page._timeoutSettings.navigationTimeout(e);return t.rejectOnTimeout(n,`Timeout ${n}ms exceeded.`),t}async waitForNavigation(e={}){return await this._page._wrapApiCall(async()=>{let t=$a("waitUntil",e.waitUntil===void 0?"load":e.waitUntil),n=this._setupNavigationWaiter(e),s=typeof e.url=="string"?` to "${e.url}"`:"";n.log(`waiting for navigation${s} until "${t}"`);let o=await n.waitForEvent(this._eventEmitter,"navigated",c=>{var u;return c.error?!0:(n.log(`  navigated to "${c.url}"`),(0,$O.urlMatches)((u=this._page)===null||u===void 0?void 0:u.context()._options.baseURL,c.url,e.url))});if(o.error){let c=new Error(o.error);c.stack="",await n.waitForPromise(Promise.reject(c))}this._loadStates.has(t)||await n.waitForEvent(this._eventEmitter,"loadstate",c=>(n.log(`  "${c}" event fired`),c===t));let a=o.newDocument?HO.Request.fromNullable(o.newDocument.request):null,l=a?await n.waitForPromise(a._finalRequest()._internalResponse()):null;return n.dispose(),l})}async waitForLoadState(e="load",t={}){return e=$a("state",e),await this._page._wrapApiCall(async()=>{let n=this._setupNavigationWaiter(t);this._loadStates.has(e)?n.log(`  not waiting, "${e}" event already fired`):await n.waitForEvent(this._eventEmitter,"loadstate",s=>(n.log(`  "${s}" event fired`),s===e)),n.dispose()})}async waitForURL(e,t={}){var n;if((0,$O.urlMatches)((n=this._page)===null||n===void 0?void 0:n.context()._options.baseURL,this.url(),e))return await this.waitForLoadState(t.waitUntil,t);await this.waitForNavigation({url:e,...t})}async frameElement(){return qr.ElementHandle.from((await this._channel.frameElement()).element)}async evaluateHandle(e,t){(0,dt.assertMaxArguments)(arguments.length,2);let n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:typeof e=="function",arg:(0,dt.serializeArgument)(t)});return dt.JSHandle.from(n.handle)}async evaluate(e,t){(0,dt.assertMaxArguments)(arguments.length,2);let n=await this._channel.evaluateExpression({expression:String(e),isFunction:typeof e=="function",arg:(0,dt.serializeArgument)(t)});return(0,dt.parseResult)(n.value)}async _evaluateExposeUtilityScript(e,t){(0,dt.assertMaxArguments)(arguments.length,2);let n=await this._channel.evaluateExpression({expression:String(e),isFunction:typeof e=="function",exposeUtilityScript:!0,arg:(0,dt.serializeArgument)(t)});return(0,dt.parseResult)(n.value)}async $(e,t){let n=await this._channel.querySelector({selector:e,...t});return qr.ElementHandle.fromNullable(n.element)}async waitForSelector(e,t={}){if(t.visibility)throw new Error("options.visibility is not supported, did you mean options.state?");if(t.waitFor&&t.waitFor!=="visible")throw new Error("options.waitFor is not supported, did you mean options.state?");let n=await this._channel.waitForSelector({selector:e,...t});return qr.ElementHandle.fromNullable(n.element)}async dispatchEvent(e,t,n,s={}){await this._channel.dispatchEvent({selector:e,type:t,eventInit:(0,dt.serializeArgument)(n),...s})}async $eval(e,t,n){(0,dt.assertMaxArguments)(arguments.length,3);let s=await this._channel.evalOnSelector({selector:e,expression:String(t),isFunction:typeof t=="function",arg:(0,dt.serializeArgument)(n)});return(0,dt.parseResult)(s.value)}async $$eval(e,t,n){(0,dt.assertMaxArguments)(arguments.length,3);let s=await this._channel.evalOnSelectorAll({selector:e,expression:String(t),isFunction:typeof t=="function",arg:(0,dt.serializeArgument)(n)});return(0,dt.parseResult)(s.value)}async $$(e){return(await this._channel.querySelectorAll({selector:e})).elements.map(n=>qr.ElementHandle.from(n))}async _queryCount(e){return(await this._channel.queryCount({selector:e})).value}async content(){return(await this._channel.content()).value}async setContent(e,t={}){let n=$a("waitUntil",t.waitUntil===void 0?"load":t.waitUntil);await this._channel.setContent({html:e,...t,waitUntil:n})}name(){return this._name||""}url(){return this._url}parentFrame(){return this._parentFrame}childFrames(){return Array.from(this._childFrames)}isDetached(){return this._detached}async addScriptTag(e={}){let t={...e};return t.path&&(t.content=(await qO.default.promises.readFile(t.path)).toString(),t.content=(0,f$.addSourceUrlToScript)(t.content,t.path)),qr.ElementHandle.from((await this._channel.addScriptTag({...t})).element)}async addStyleTag(e={}){let t={...e};return t.path&&(t.content=(await qO.default.promises.readFile(t.path)).toString(),t.content+="/*# sourceURL="+t.path.replace(/\n/g,"")+"*/"),qr.ElementHandle.from((await this._channel.addStyleTag({...t})).element)}async click(e,t={}){return await this._channel.click({selector:e,...t})}async dblclick(e,t={}){return await this._channel.dblclick({selector:e,...t})}async dragAndDrop(e,t,n={}){return await this._channel.dragAndDrop({source:e,target:t,...n})}async tap(e,t={}){return await this._channel.tap({selector:e,...t})}async fill(e,t,n={}){return await this._channel.fill({selector:e,value:t,...n})}async _highlight(e){return await this._channel.highlight({selector:e})}locator(e,t){return new _b.Locator(this,e,t)}getByTestId(e){return this.locator((0,Ci.getByTestIdSelector)((0,_b.testIdAttributeName)(),e))}getByAltText(e,t){return this.locator((0,Ci.getByAltTextSelector)(e,t))}getByLabel(e,t){return this.locator((0,Ci.getByLabelSelector)(e,t))}getByPlaceholder(e,t){return this.locator((0,Ci.getByPlaceholderSelector)(e,t))}getByText(e,t){return this.locator((0,Ci.getByTextSelector)(e,t))}getByTitle(e,t){return this.locator((0,Ci.getByTitleSelector)(e,t))}getByRole(e,t={}){return this.locator((0,Ci.getByRoleSelector)(e,t))}frameLocator(e){return new _b.FrameLocator(this,e)}async focus(e,t={}){await this._channel.focus({selector:e,...t})}async textContent(e,t={}){let n=(await this._channel.textContent({selector:e,...t})).value;return n===void 0?null:n}async innerText(e,t={}){return(await this._channel.innerText({selector:e,...t})).value}async innerHTML(e,t={}){return(await this._channel.innerHTML({selector:e,...t})).value}async getAttribute(e,t,n={}){let s=(await this._channel.getAttribute({selector:e,name:t,...n})).value;return s===void 0?null:s}async inputValue(e,t={}){return(await this._channel.inputValue({selector:e,...t})).value}async isChecked(e,t={}){return(await this._channel.isChecked({selector:e,...t})).value}async isDisabled(e,t={}){return(await this._channel.isDisabled({selector:e,...t})).value}async isEditable(e,t={}){return(await this._channel.isEditable({selector:e,...t})).value}async isEnabled(e,t={}){return(await this._channel.isEnabled({selector:e,...t})).value}async isHidden(e,t={}){return(await this._channel.isHidden({selector:e,...t})).value}async isVisible(e,t={}){return(await this._channel.isVisible({selector:e,...t})).value}async hover(e,t={}){await this._channel.hover({selector:e,...t})}async selectOption(e,t,n={}){return(await this._channel.selectOption({selector:e,...(0,qr.convertSelectOptionValues)(t),...n})).values}async setInputFiles(e,t,n={}){let s=await(0,qr.convertInputFiles)(t,this.page().context());await this._channel.setInputFiles({selector:e,...s,...n})}async type(e,t,n={}){await this._channel.type({selector:e,text:t,...n})}async press(e,t,n={}){await this._channel.press({selector:e,key:t,...n})}async check(e,t={}){await this._channel.check({selector:e,...t})}async uncheck(e,t={}){await this._channel.uncheck({selector:e,...t})}async setChecked(e,t,n){t?await this.check(e,n):await this.uncheck(e,n)}async waitForTimeout(e){await this._channel.waitForTimeout({timeout:e})}async waitForFunction(e,t,n={}){typeof n.polling=="string"&&(0,c$.assert)(n.polling==="raf","Unknown polling option: "+n.polling);let s=await this._channel.waitForFunction({...n,pollingInterval:n.polling==="raf"?void 0:n.polling,expression:String(e),isFunction:typeof e=="function",arg:(0,dt.serializeArgument)(t)});return dt.JSHandle.from(s.handle)}async title(){return(await this._channel.title()).value}};Wa.Frame=wb;function $a(r,e){if(e==="networkidle0"&&(e="networkidle"),!p$.kLifecycleEvents.has(e))throw new Error(`${r}: expected one of (load|domcontentloaded|networkidle|commit)`);return e}});var yb=M(kh=>{"use strict";Object.defineProperty(kh,"__esModule",{value:!0});kh.WritableStream=void 0;var _$=require("stream"),w$=ze(),vb=class extends w$.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s)}stream(){return new bb(this._channel)}};kh.WritableStream=vb;var bb=class extends _$.Writable{constructor(e){super(),this._channel=void 0,this._channel=e}async _write(e,t,n){let s=await this._channel.write({binary:typeof e=="string"?Buffer.from(e):e}).catch(o=>o);n(s||null)}async _final(e){let t=await this._channel.close().catch(n=>n);e(t||null)}}});var Da=M(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ElementHandle=void 0;Ti.convertInputFiles=XO;Ti.convertSelectOptionValues=JO;Ti.determineScreenshotType=YO;var UO=Ks(),Xs=Yn(),xb=KO(require("fs")),v$=Be(),zO=KO(require("path")),VO=ie(),GO=ht(),b$=yb(),y$=require("stream"),x$=require("util");function KO(r){return r&&r.__esModule?r:{default:r}}var S$=(0,x$.promisify)(y$.pipeline),Ch=class r extends Xs.JSHandle{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){super(e,t,n,s),this._elementChannel=void 0,this._elementChannel=this._channel}asElement(){return this}async ownerFrame(){return UO.Frame.fromNullable((await this._elementChannel.ownerFrame()).frame)}async contentFrame(){return UO.Frame.fromNullable((await this._elementChannel.contentFrame()).frame)}async getAttribute(e){let t=(await this._elementChannel.getAttribute({name:e})).value;return t===void 0?null:t}async inputValue(){return(await this._elementChannel.inputValue()).value}async textContent(){let e=(await this._elementChannel.textContent()).value;return e===void 0?null:e}async innerText(){return(await this._elementChannel.innerText()).value}async innerHTML(){return(await this._elementChannel.innerHTML()).value}async isChecked(){return(await this._elementChannel.isChecked()).value}async isDisabled(){return(await this._elementChannel.isDisabled()).value}async isEditable(){return(await this._elementChannel.isEditable()).value}async isEnabled(){return(await this._elementChannel.isEnabled()).value}async isHidden(){return(await this._elementChannel.isHidden()).value}async isVisible(){return(await this._elementChannel.isVisible()).value}async dispatchEvent(e,t={}){await this._elementChannel.dispatchEvent({type:e,eventInit:(0,Xs.serializeArgument)(t)})}async scrollIntoViewIfNeeded(e={}){await this._elementChannel.scrollIntoViewIfNeeded(e)}async hover(e={}){await this._elementChannel.hover(e)}async click(e={}){return await this._elementChannel.click(e)}async dblclick(e={}){return await this._elementChannel.dblclick(e)}async tap(e={}){return await this._elementChannel.tap(e)}async selectOption(e,t={}){return(await this._elementChannel.selectOption({...JO(e),...t})).values}async fill(e,t={}){return await this._elementChannel.fill({value:e,...t})}async selectText(e={}){await this._elementChannel.selectText(e)}async setInputFiles(e,t={}){let n=await this.ownerFrame();if(!n)throw new Error("Cannot set input files to detached element");let s=await XO(e,n.page().context());await this._elementChannel.setInputFiles({...s,...t})}async focus(){await this._elementChannel.focus()}async type(e,t={}){await this._elementChannel.type({text:e,...t})}async press(e,t={}){await this._elementChannel.press({key:e,...t})}async check(e={}){return await this._elementChannel.check(e)}async uncheck(e={}){return await this._elementChannel.uncheck(e)}async setChecked(e,t){e?await this.check(t):await this.uncheck(t)}async boundingBox(){let e=(await this._elementChannel.boundingBox()).value;return e===void 0?null:e}async screenshot(e={}){let t={...e,mask:void 0};t.type||(t.type=YO(e)),e.mask&&(t.mask=e.mask.map(s=>({frame:s._frame._channel,selector:s._selector})));let n=await this._elementChannel.screenshot(t);return e.path&&(await(0,GO.mkdirIfNeeded)(e.path),await xb.default.promises.writeFile(e.path,n.binary)),n.binary}async $(e){return r.fromNullable((await this._elementChannel.querySelector({selector:e})).element)}async $$(e){return(await this._elementChannel.querySelectorAll({selector:e})).elements.map(n=>r.from(n))}async $eval(e,t,n){let s=await this._elementChannel.evalOnSelector({selector:e,expression:String(t),isFunction:typeof t=="function",arg:(0,Xs.serializeArgument)(n)});return(0,Xs.parseResult)(s.value)}async $$eval(e,t,n){let s=await this._elementChannel.evalOnSelectorAll({selector:e,expression:String(t),isFunction:typeof t=="function",arg:(0,Xs.serializeArgument)(n)});return(0,Xs.parseResult)(s.value)}async waitForElementState(e,t={}){return await this._elementChannel.waitForElementState({state:e,...t})}async waitForSelector(e,t={}){let n=await this._elementChannel.waitForSelector({selector:e,...t});return r.fromNullable(n.element)}};Ti.ElementHandle=Ch;function JO(r){if(r===null)return{};if(Array.isArray(r)||(r=[r]),!r.length)return{};for(let e=0;e<r.length;e++)(0,VO.assert)(r[e]!==null,`options[${e}]: expected object, got null`);return r[0]instanceof Ch?{elements:r.map(e=>e._elementChannel)}:(0,VO.isString)(r[0])?{options:r.map(e=>({valueOrLabel:e}))}:{options:r}}function E$(r){return r.reduce((e,t)=>e+(t.buffer?t.buffer.byteLength:0),0)>=GO.fileUploadSizeLimit}async function XO(r,e){let t=Array.isArray(r)?r.slice():[r];if(t.some(s=>typeof s=="string")){if(!t.every(s=>typeof s=="string"))throw new Error("File paths cannot be mixed with buffers");return e._connection.isRemote()?{streams:await Promise.all(t.map(async o=>{let a=(await xb.default.promises.stat(o)).mtimeMs,{writableStream:l}=await e._wrapApiCall(()=>e._channel.createTempFile({name:zO.default.basename(o),lastModifiedMs:a}),!0),c=b$.WritableStream.from(l);return await S$(xb.default.createReadStream(o),c.stream()),l}))}:{localPaths:t.map(s=>zO.default.resolve(s))}}let n=t;if(E$(n))throw new Error("Cannot set buffer larger than 50Mb, please write it to a file and pass its path instead.");return{payloads:n}}function YO(r){if(r.path){let e=v$.mime.getType(r.path);if(e==="image/png")return"png";if(e==="image/jpeg")return"jpeg";throw new Error(`path: unsupported mime type "${e}"`)}return r.type}});var QO=M(Th=>{"use strict";Object.defineProperty(Th,"__esModule",{value:!0});Th.FileChooser=void 0;var Sb=class{constructor(e,t,n){this._page=void 0,this._elementHandle=void 0,this._isMultiple=void 0,this._page=e,this._elementHandle=t,this._isMultiple=n}element(){return this._elementHandle}isMultiple(){return this._isMultiple}page(){return this._page}async setFiles(e,t){return await this._elementHandle.setInputFiles(e,t)}};Th.FileChooser=Sb});var ZO=M(Hr=>{"use strict";Object.defineProperty(Hr,"__esModule",{value:!0});Hr.Touchscreen=Hr.Mouse=Hr.Keyboard=void 0;var Eb=class{constructor(e){this._page=void 0,this._page=e}async down(e){await this._page._channel.keyboardDown({key:e})}async up(e){await this._page._channel.keyboardUp({key:e})}async insertText(e){await this._page._channel.keyboardInsertText({text:e})}async type(e,t={}){await this._page._channel.keyboardType({text:e,...t})}async press(e,t={}){await this._page._channel.keyboardPress({key:e,...t})}};Hr.Keyboard=Eb;var kb=class{constructor(e){this._page=void 0,this._page=e}async move(e,t,n={}){await this._page._channel.mouseMove({x:e,y:t,...n})}async down(e={}){await this._page._channel.mouseDown({...e})}async up(e={}){await this._page._channel.mouseUp(e)}async click(e,t,n={}){await this._page._channel.mouseClick({x:e,y:t,...n})}async dblclick(e,t,n={}){await this.click(e,t,{...n,clickCount:2})}async wheel(e,t){await this._page._channel.mouseWheel({deltaX:e,deltaY:t})}};Hr.Mouse=kb;var Cb=class{constructor(e){this._page=void 0,this._page=e}async tap(e,t){await this._page._channel.touchscreenTap({x:e,y:t})}};Hr.Touchscreen=Cb});var eP=M(Oh=>{"use strict";Object.defineProperty(Oh,"__esModule",{value:!0});Oh.Video=void 0;var k$=ie(),Tb=class{constructor(e,t){this._artifact=null,this._artifactReadyPromise=new k$.ManualPromise,this._isRemote=!1,this._isRemote=t.isRemote(),this._artifact=e._closedOrCrashedScope.safeRace(this._artifactReadyPromise)}_artifactReady(e){this._artifactReadyPromise.resolve(e)}async path(){if(this._isRemote)throw new Error("Path is not available when connecting remotely. Use saveAs() to save a local copy.");let e=await this._artifact;if(!e)throw new Error("Page did not produce any video frames");return e._initializer.absolutePath}async saveAs(e){let t=await this._artifact;if(!t)throw new Error("Page did not produce any video frames");return await t.saveAs(e)}async delete(){let e=await this._artifact;e&&await e.delete()}};Oh.Video=Tb});var Pb=M(Ph=>{"use strict";Object.defineProperty(Ph,"__esModule",{value:!0});Ph.HarRouter=void 0;var tP=Le(),nP;nP=Symbol.asyncDispose;var Ob=class r{static async create(e,t,n,s){let{harId:o,error:a}=await e._channel.harOpen({file:t});if(a)throw new Error(a);return new r(e,o,n,s)}constructor(e,t,n,s){this._localUtils=void 0,this._harId=void 0,this._notFoundAction=void 0,this._options=void 0,this._localUtils=e,this._harId=t,this._options=s,this._notFoundAction=n}async _handle(e){let t=e.request(),n=await this._localUtils._channel.harLookup({harId:this._harId,url:t.url(),method:t.method(),headers:await t.headersArray(),postData:t.postDataBuffer()||void 0,isNavigationRequest:t.isNavigationRequest()});if(n.action==="redirect"){tP.debugLogger.log("api",`HAR: ${e.request().url()} redirected to ${n.redirectURL}`),await e._redirectNavigationRequest(n.redirectURL);return}if(n.action==="fulfill"){if(n.status===-1)return;await e.fulfill({status:n.status,headers:Object.fromEntries(n.headers.map(s=>[s.name,s.value])),body:n.body});return}if(n.action==="error"&&tP.debugLogger.log("api","HAR: "+n.message),this._notFoundAction==="abort"){await e.abort();return}await e.fallback()}async addContextRoute(e){await e.route(this._options.urlMatch||"**/*",t=>this._handle(t))}async addPageRoute(e){await e.route(this._options.urlMatch||"**/*",t=>this._handle(t))}async[nP](){await this.dispose()}dispose(){this._localUtils._channel.harClose({harId:this._harId}).catch(()=>{})}};Ph.HarRouter=Ob});var Ua=M(Ys=>{"use strict";Object.defineProperty(Ys,"__esModule",{value:!0});Ys.Page=Ys.BindingCall=void 0;var Ab=cP(require("fs")),C$=cP(require("path")),Ah=on(),Ib=xn(),T$=en(),an=ie(),O$=ht(),P$=fO(),rP=Us(),aP=ze(),A$=Dr(),I$=yO(),R$=xO(),iP=Da(),Ve=Rn(),M$=QO(),Oi=Ks(),Rb=ZO(),Pi=Yn(),sP=Ht(),$r=Gs(),F$=eP(),N$=ki(),L$=Ba(),D$=Pb(),lP;function cP(r){return r&&r.__esModule?r:{default:r}}lP=Symbol.asyncDispose;var Mb=class r extends aP.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){super(e,t,n,s),this._browserContext=void 0,this._ownedContext=void 0,this._mainFrame=void 0,this._frames=new Set,this._workers=new Set,this._closed=!1,this._closedOrCrashedScope=new an.LongStandingScope,this._viewportSize=void 0,this._routes=[],this.accessibility=void 0,this.coverage=void 0,this.keyboard=void 0,this.mouse=void 0,this.request=void 0,this.touchscreen=void 0,this._bindings=new Map,this._timeoutSettings=void 0,this._video=null,this._opener=void 0,this._closeReason=void 0,this._closeWasCalled=!1,this._harRouters=[],this._locatorHandlers=new Map,this._browserContext=e,this._timeoutSettings=new T$.TimeoutSettings(this._browserContext._timeoutSettings),this.accessibility=new P$.Accessibility(this._channel),this.keyboard=new Rb.Keyboard(this),this.mouse=new Rb.Mouse(this),this.request=this._browserContext.request,this.touchscreen=new Rb.Touchscreen(this),this._mainFrame=Oi.Frame.from(s.mainFrame),this._mainFrame._page=this,this._frames.add(this._mainFrame),this._viewportSize=s.viewportSize||null,this._closed=s.isClosed,this._opener=r.fromNullable(s.opener),this._channel.on("bindingCall",({binding:o})=>this._onBinding(Ih.from(o))),this._channel.on("close",()=>this._onClose()),this._channel.on("crash",()=>this._onCrash()),this._channel.on("download",({url:o,suggestedFilename:a,artifact:l})=>{let c=rP.Artifact.from(l);this.emit(Ve.Events.Page.Download,new R$.Download(this,o,a,c))}),this._channel.on("fileChooser",({element:o,isMultiple:a})=>this.emit(Ve.Events.Page.FileChooser,new M$.FileChooser(this,iP.ElementHandle.from(o),a))),this._channel.on("frameAttached",({frame:o})=>this._onFrameAttached(Oi.Frame.from(o))),this._channel.on("frameDetached",({frame:o})=>this._onFrameDetached(Oi.Frame.from(o))),this._channel.on("locatorHandlerTriggered",({uid:o})=>this._onLocatorHandlerTriggered(o)),this._channel.on("route",({route:o})=>this._onRoute($r.Route.from(o))),this._channel.on("video",({artifact:o})=>{let a=rP.Artifact.from(o);this._forceVideo()._artifactReady(a)}),this._channel.on("webSocket",({webSocket:o})=>this.emit(Ve.Events.Page.WebSocket,$r.WebSocket.from(o))),this._channel.on("worker",({worker:o})=>this._onWorker(L$.Worker.from(o))),this.coverage=new I$.Coverage(this._channel),this.once(Ve.Events.Page.Close,()=>this._closedOrCrashedScope.close(this._closeErrorWithReason())),this.once(Ve.Events.Page.Crash,()=>this._closedOrCrashedScope.close(new Ah.TargetClosedError)),this._setEventToSubscriptionMapping(new Map([[Ve.Events.Page.Console,"console"],[Ve.Events.Page.Dialog,"dialog"],[Ve.Events.Page.Request,"request"],[Ve.Events.Page.Response,"response"],[Ve.Events.Page.RequestFinished,"requestFinished"],[Ve.Events.Page.RequestFailed,"requestFailed"],[Ve.Events.Page.FileChooser,"fileChooser"]]))}_onFrameAttached(e){e._page=this,this._frames.add(e),e._parentFrame&&e._parentFrame._childFrames.add(e),this.emit(Ve.Events.Page.FrameAttached,e)}_onFrameDetached(e){this._frames.delete(e),e._detached=!0,e._parentFrame&&e._parentFrame._childFrames.delete(e),this.emit(Ve.Events.Page.FrameDetached,e)}async _onRoute(e){e._context=this.context();let t=this._routes.slice();for(let n of t){if(this._closeWasCalled||this._browserContext._closeWasCalled)return;if(!n.matches(e.request().url()))continue;let s=this._routes.indexOf(n);if(s===-1)continue;n.willExpire()&&this._routes.splice(s,1);let o=await n.handle(e);if(this._routes.length||this._wrapApiCall(()=>this._updateInterceptionPatterns(),!0).catch(()=>{}),o)return}await this._browserContext._onRoute(e)}async _onBinding(e){let t=this._bindings.get(e._initializer.name);if(t){await e.call(t);return}await this._browserContext._onBinding(e)}_onWorker(e){this._workers.add(e),e._page=this,this.emit(Ve.Events.Page.Worker,e)}_onClose(){this._closed=!0,this._browserContext._pages.delete(this),this._browserContext._backgroundPages.delete(this),this._disposeHarRouters(),this.emit(Ve.Events.Page.Close,this)}_onCrash(){this.emit(Ve.Events.Page.Crash,this)}context(){return this._browserContext}async opener(){return!this._opener||this._opener.isClosed()?null:this._opener}mainFrame(){return this._mainFrame}frame(e){let t=(0,an.isString)(e)?e:e.name,n=(0,an.isObject)(e)?e.url:void 0;return(0,an.assert)(t||n,"Either name or url matcher should be specified"),this.frames().find(s=>t?s.name()===t:(0,Ib.urlMatches)(this._browserContext._options.baseURL,s.url(),n))||null}frames(){return[...this._frames]}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e),this._wrapApiCall(async()=>{this._channel.setDefaultNavigationTimeoutNoReply({timeout:e}).catch(()=>{})},!0)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._wrapApiCall(async()=>{this._channel.setDefaultTimeoutNoReply({timeout:e}).catch(()=>{})},!0)}_forceVideo(){return this._video||(this._video=new F$.Video(this,this._connection)),this._video}video(){return this._browserContext._options.recordVideo?this._forceVideo():null}async $(e,t){return await this._mainFrame.$(e,t)}async waitForSelector(e,t){return await this._mainFrame.waitForSelector(e,t)}async dispatchEvent(e,t,n,s){return await this._mainFrame.dispatchEvent(e,t,n,s)}async evaluateHandle(e,t){return(0,Pi.assertMaxArguments)(arguments.length,2),await this._mainFrame.evaluateHandle(e,t)}async $eval(e,t,n){return(0,Pi.assertMaxArguments)(arguments.length,3),await this._mainFrame.$eval(e,t,n)}async $$eval(e,t,n){return(0,Pi.assertMaxArguments)(arguments.length,3),await this._mainFrame.$$eval(e,t,n)}async $$(e){return await this._mainFrame.$$(e)}async addScriptTag(e={}){return await this._mainFrame.addScriptTag(e)}async addStyleTag(e={}){return await this._mainFrame.addStyleTag(e)}async exposeFunction(e,t){await this._channel.exposeBinding({name:e});let n=(s,...o)=>t(...o);this._bindings.set(e,n)}async exposeBinding(e,t,n={}){await this._channel.exposeBinding({name:e,needsHandle:n.handle}),this._bindings.set(e,t)}async setExtraHTTPHeaders(e){(0,$r.validateHeaders)(e),await this._channel.setExtraHTTPHeaders({headers:(0,an.headersObjectToArray)(e)})}url(){return this._mainFrame.url()}async content(){return await this._mainFrame.content()}async setContent(e,t){return await this._mainFrame.setContent(e,t)}async goto(e,t){return await this._mainFrame.goto(e,t)}async reload(e={}){let t=(0,Oi.verifyLoadState)("waitUntil",e.waitUntil===void 0?"load":e.waitUntil);return $r.Response.fromNullable((await this._channel.reload({...e,waitUntil:t})).response)}async addLocatorHandler(e,t,n={}){if(e._frame!==this._mainFrame)throw new Error("Locator must belong to the main frame of this page");if(n.times===0)return;let{uid:s}=await this._channel.registerLocatorHandler({selector:e._selector,noWaitAfter:n.noWaitAfter});this._locatorHandlers.set(s,{locator:e,handler:t,times:n.times})}async _onLocatorHandlerTriggered(e){let t=!1;try{let n=this._locatorHandlers.get(e);n&&n.times!==0&&(n.times!==void 0&&n.times--,await n.handler(n.locator)),t=n?.times===0}finally{this._wrapApiCall(()=>this._channel.resolveLocatorHandlerNoReply({uid:e,remove:t}),!0).catch(()=>{})}}async removeLocatorHandler(e){for(let[t,n]of this._locatorHandlers)n.locator._equals(e)&&(this._locatorHandlers.delete(t),await this._channel.unregisterLocatorHandler({uid:t}).catch(()=>{}))}async waitForLoadState(e,t){return await this._mainFrame.waitForLoadState(e,t)}async waitForNavigation(e){return await this._mainFrame.waitForNavigation(e)}async waitForURL(e,t){return await this._mainFrame.waitForURL(e,t)}async waitForRequest(e,t={}){let n=async a=>(0,an.isString)(e)||(0,an.isRegExp)(e)?(0,Ib.urlMatches)(this._browserContext._options.baseURL,a.url(),e):await e(a),s=oP(e),o=s?`waiting for request ${s}`:void 0;return await this._waitForEvent(Ve.Events.Page.Request,{predicate:n,timeout:t.timeout},o)}async waitForResponse(e,t={}){let n=async a=>(0,an.isString)(e)||(0,an.isRegExp)(e)?(0,Ib.urlMatches)(this._browserContext._options.baseURL,a.url(),e):await e(a),s=oP(e),o=s?`waiting for response ${s}`:void 0;return await this._waitForEvent(Ve.Events.Page.Response,{predicate:n,timeout:t.timeout},o)}async waitForEvent(e,t={}){return await this._waitForEvent(e,t,`waiting for event "${e}"`)}_closeErrorWithReason(){return new Ah.TargetClosedError(this._closeReason||this._browserContext._effectiveCloseReason())}async _waitForEvent(e,t,n){return await this._wrapApiCall(async()=>{let s=this._timeoutSettings.timeout(typeof t=="function"?{}:t),o=typeof t=="function"?t:t.predicate,a=N$.Waiter.createForEvent(this,e);n&&a.log(n),a.rejectOnTimeout(s,`Timeout ${s}ms exceeded while waiting for event "${e}"`),e!==Ve.Events.Page.Crash&&a.rejectOnEvent(this,Ve.Events.Page.Crash,new Error("Page crashed")),e!==Ve.Events.Page.Close&&a.rejectOnEvent(this,Ve.Events.Page.Close,()=>this._closeErrorWithReason());let l=await a.waitForEvent(this,e,o);return a.dispose(),l})}async goBack(e={}){let t=(0,Oi.verifyLoadState)("waitUntil",e.waitUntil===void 0?"load":e.waitUntil);return $r.Response.fromNullable((await this._channel.goBack({...e,waitUntil:t})).response)}async goForward(e={}){let t=(0,Oi.verifyLoadState)("waitUntil",e.waitUntil===void 0?"load":e.waitUntil);return $r.Response.fromNullable((await this._channel.goForward({...e,waitUntil:t})).response)}async emulateMedia(e={}){await this._channel.emulateMedia({media:e.media===null?"no-override":e.media,colorScheme:e.colorScheme===null?"no-override":e.colorScheme,reducedMotion:e.reducedMotion===null?"no-override":e.reducedMotion,forcedColors:e.forcedColors===null?"no-override":e.forcedColors})}async setViewportSize(e){this._viewportSize=e,await this._channel.setViewportSize({viewportSize:e})}viewportSize(){return this._viewportSize}async evaluate(e,t){return(0,Pi.assertMaxArguments)(arguments.length,2),await this._mainFrame.evaluate(e,t)}async addInitScript(e,t){let n=await(0,A$.evaluationScript)(e,t);await this._channel.addInitScript({source:n})}async route(e,t,n={}){this._routes.unshift(new $r.RouteHandler(this._browserContext._options.baseURL,e,t,n.times)),await this._updateInterceptionPatterns()}async routeFromHAR(e,t={}){if(t.update){await this._browserContext._recordIntoHAR(e,this,t);return}let n=await D$.HarRouter.create(this._connection.localUtils(),e,t.notFound||"abort",{urlMatch:t.url});this._harRouters.push(n),await n.addPageRoute(this)}_disposeHarRouters(){this._harRouters.forEach(e=>e.dispose()),this._harRouters=[]}async unrouteAll(e){await this._unrouteInternal(this._routes,[],e?.behavior),this._disposeHarRouters()}async unroute(e,t){let n=[],s=[];for(let o of this._routes)(0,an.urlMatchesEqual)(o.url,e)&&(!t||o.handler===t)?n.push(o):s.push(o);await this._unrouteInternal(n,s,"default")}async _unrouteInternal(e,t,n){if(this._routes=t,await this._updateInterceptionPatterns(),!n||n==="default")return;let s=e.map(o=>o.stop(n));await Promise.all(s)}async _updateInterceptionPatterns(){let e=$r.RouteHandler.prepareInterceptionPatterns(this._routes);await this._channel.setNetworkInterceptionPatterns({patterns:e})}async screenshot(e={}){let t={...e,mask:void 0};t.type||(t.type=(0,iP.determineScreenshotType)(e)),e.mask&&(t.mask=e.mask.map(s=>({frame:s._frame._channel,selector:s._selector})));let n=await this._channel.screenshot(t);return e.path&&(await(0,O$.mkdirIfNeeded)(e.path),await Ab.default.promises.writeFile(e.path,n.binary)),n.binary}async _expectScreenshot(e){let t=e!=null&&e.mask?e?.mask.map(s=>({frame:s._frame._channel,selector:s._selector})):void 0,n=e.locator?{frame:e.locator._frame._channel,selector:e.locator._selector}:void 0;return await this._channel.expectScreenshot({...e,isNot:!!e.isNot,locator:n,mask:t})}async title(){return await this._mainFrame.title()}async bringToFront(){await this._channel.bringToFront()}async[lP](){await this.close()}async close(e={}){this._closeReason=e.reason,this._closeWasCalled=!0;try{this._ownedContext?await this._ownedContext.close():await this._channel.close(e)}catch(t){if((0,Ah.isTargetClosedError)(t)&&!e.runBeforeUnload)return;throw t}}isClosed(){return this._closed}async click(e,t){return await this._mainFrame.click(e,t)}async dragAndDrop(e,t,n){return await this._mainFrame.dragAndDrop(e,t,n)}async dblclick(e,t){return await this._mainFrame.dblclick(e,t)}async tap(e,t){return await this._mainFrame.tap(e,t)}async fill(e,t,n){return await this._mainFrame.fill(e,t,n)}locator(e,t){return this.mainFrame().locator(e,t)}getByTestId(e){return this.mainFrame().getByTestId(e)}getByAltText(e,t){return this.mainFrame().getByAltText(e,t)}getByLabel(e,t){return this.mainFrame().getByLabel(e,t)}getByPlaceholder(e,t){return this.mainFrame().getByPlaceholder(e,t)}getByText(e,t){return this.mainFrame().getByText(e,t)}getByTitle(e,t){return this.mainFrame().getByTitle(e,t)}getByRole(e,t={}){return this.mainFrame().getByRole(e,t)}frameLocator(e){return this.mainFrame().frameLocator(e)}async focus(e,t){return await this._mainFrame.focus(e,t)}async textContent(e,t){return await this._mainFrame.textContent(e,t)}async innerText(e,t){return await this._mainFrame.innerText(e,t)}async innerHTML(e,t){return await this._mainFrame.innerHTML(e,t)}async getAttribute(e,t,n){return await this._mainFrame.getAttribute(e,t,n)}async inputValue(e,t){return await this._mainFrame.inputValue(e,t)}async isChecked(e,t){return await this._mainFrame.isChecked(e,t)}async isDisabled(e,t){return await this._mainFrame.isDisabled(e,t)}async isEditable(e,t){return await this._mainFrame.isEditable(e,t)}async isEnabled(e,t){return await this._mainFrame.isEnabled(e,t)}async isHidden(e,t){return await this._mainFrame.isHidden(e,t)}async isVisible(e,t){return await this._mainFrame.isVisible(e,t)}async hover(e,t){return await this._mainFrame.hover(e,t)}async selectOption(e,t,n){return await this._mainFrame.selectOption(e,t,n)}async setInputFiles(e,t,n){return await this._mainFrame.setInputFiles(e,t,n)}async type(e,t,n){return await this._mainFrame.type(e,t,n)}async press(e,t,n){return await this._mainFrame.press(e,t,n)}async check(e,t){return await this._mainFrame.check(e,t)}async uncheck(e,t){return await this._mainFrame.uncheck(e,t)}async setChecked(e,t,n){return await this._mainFrame.setChecked(e,t,n)}async waitForTimeout(e){return await this._mainFrame.waitForTimeout(e)}async waitForFunction(e,t,n){return await this._mainFrame.waitForFunction(e,t,n)}workers(){return[...this._workers]}async pause(){var e;if(require("inspector").url())return;let t=this._browserContext._timeoutSettings.defaultNavigationTimeout(),n=this._browserContext._timeoutSettings.defaultTimeout();this._browserContext.setDefaultNavigationTimeout(0),this._browserContext.setDefaultTimeout(0),(e=this._instrumentation)===null||e===void 0||e.onWillPause(),await this._closedOrCrashedScope.safeRace(this.context()._channel.pause()),this._browserContext.setDefaultNavigationTimeout(t),this._browserContext.setDefaultTimeout(n)}async pdf(e={}){let t={...e};t.margin&&(t.margin={...t.margin}),typeof e.width=="number"&&(t.width=e.width+"px"),typeof e.height=="number"&&(t.height=e.height+"px");for(let s of["top","right","bottom","left"]){let o=s;e.margin&&typeof e.margin[o]=="number"&&(t.margin[o]=t.margin[o]+"px")}let n=await this._channel.pdf(t);return e.path&&(await Ab.default.promises.mkdir(C$.default.dirname(e.path),{recursive:!0}),await Ab.default.promises.writeFile(e.path,n.pdf)),n.pdf}};Ys.Page=Mb;var Ih=class extends aP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s)}async call(e){try{let t=Oi.Frame.from(this._initializer.frame),n={context:t._page.context(),page:t._page,frame:t},s;this._initializer.handle?s=await e(n,Pi.JSHandle.from(this._initializer.handle)):s=await e(n,...this._initializer.args.map(Pi.parseResult)),this._channel.resolve({result:(0,Pi.serializeArgument)(s)}).catch(()=>{})}catch(t){this._channel.reject({error:(0,Ah.serializeError)(t)}).catch(()=>{})}}};Ys.BindingCall=Ih;function oP(r){if((0,an.isRegExp)(r))return`/${(0,sP.trimStringWithEllipsis)(r.source,50)}/${r.flags}`;if((0,an.isString)(r))return`"${(0,sP.trimStringWithEllipsis)(r,50)}"`}});var Mh=M(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.CDPSession=void 0;var B$=ze(),Fb=class extends B$.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._channel.on("event",({method:o,params:a})=>{this.emit(o,a)}),this.on=super.on,this.addListener=super.addListener,this.off=super.removeListener,this.removeListener=super.removeListener,this.once=super.once}async send(e,t){return(await this._channel.send({method:e,params:t})).result}async detach(){return await this._channel.detach()}};Rh.CDPSession=Fb});var Lb=M(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.ConsoleMessage=void 0;var j$=$$(require("util")),q$=Yn(),H$=Ua(),uP;function dP(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(dP=function(n){return n?t:e})(r)}function $$(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=dP(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}uP=j$.inspect.custom;var Nb=class{constructor(e){this._page=void 0,this._event=void 0,this._page="page"in e&&e.page?H$.Page.from(e.page):null,this._event=e}page(){return this._page}type(){return this._event.type}text(){return this._event.text}args(){return this._event.args.map(q$.JSHandle.from)}location(){return this._event.location}[uP](){return this.text()}};Fh.ConsoleMessage=Nb});var Bb=M(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.Dialog=void 0;var W$=ze(),U$=Ua(),Db=class extends W$.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._page=void 0,this._page=U$.Page.fromNullable(s.page)}page(){return this._page}type(){return this._initializer.type}message(){return this._initializer.message}defaultValue(){return this._initializer.defaultValue}async accept(e){await this._channel.accept({promptText:e})}async dismiss(){await this._channel.dismiss()}};Nh.Dialog=Db});var hP=M(Lh=>{"use strict";Object.defineProperty(Lh,"__esModule",{value:!0});Lh.WebError=void 0;var jb=class{constructor(e,t){this._page=void 0,this._error=void 0,this._page=e,this._error=t}page(){return this._page}error(){return this._error}};Lh.WebError=jb});var Qs=M(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.BrowserContext=void 0;za.prepareBrowserContextParams=dW;var bn=Ua(),z$=Ks(),Mn=cW(Gs()),fP=gP(require("fs")),V$=gP(require("path")),G$=ze(),K$=Dr(),J$=Dh(),X$=Ba(),Ie=Rn(),Y$=en(),Q$=ki(),At=ie(),Z$=ht(),eW=Mh(),tW=vh(),nW=Us(),rW=ja(),iW=Lt(),sW=Pb(),oW=Lb(),aW=Bb(),lW=hP(),pP=on(),mP;function gP(r){return r&&r.__esModule?r:{default:r}}function _P(r){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(_P=function(n){return n?t:e})(r)}function cW(r,e){if(!e&&r&&r.__esModule)return r;if(r===null||typeof r!="object"&&typeof r!="function")return{default:r};var t=_P(e);if(t&&t.has(r))return t.get(r);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var a=s?Object.getOwnPropertyDescriptor(r,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=r[o]}return n.default=r,t&&t.set(r,n),n}mP=Symbol.asyncDispose;var qb=class r extends G$.ChannelOwner{static from(e){return e._object}static fromNullable(e){return e?r.from(e):null}constructor(e,t,n,s){var o,a;super(e,t,n,s),this._pages=new Set,this._routes=[],this._browser=null,this._browserType=void 0,this._bindings=new Map,this._timeoutSettings=new Y$.TimeoutSettings,this._ownerPage=void 0,this._closedPromise=void 0,this._options={},this.request=void 0,this.tracing=void 0,this._backgroundPages=new Set,this._serviceWorkers=new Set,this._isChromium=void 0,this._harRecorders=new Map,this._closeWasCalled=!1,this._closeReason=void 0,this._harRouters=[],e instanceof J$.Browser&&(this._browser=e),(o=this._browser)===null||o===void 0||o._contexts.add(this),this._isChromium=((a=this._browser)===null||a===void 0?void 0:a._name)==="chromium",this.tracing=tW.Tracing.from(s.tracing),this.request=rW.APIRequestContext.from(s.requestContext),this._channel.on("bindingCall",({binding:l})=>this._onBinding(bn.BindingCall.from(l))),this._channel.on("close",()=>this._onClose()),this._channel.on("page",({page:l})=>this._onPage(bn.Page.from(l))),this._channel.on("route",({route:l})=>this._onRoute(Mn.Route.from(l))),this._channel.on("backgroundPage",({page:l})=>{let c=bn.Page.from(l);this._backgroundPages.add(c),this.emit(Ie.Events.BrowserContext.BackgroundPage,c)}),this._channel.on("serviceWorker",({worker:l})=>{let c=X$.Worker.from(l);c._context=this,this._serviceWorkers.add(c),this.emit(Ie.Events.BrowserContext.ServiceWorker,c)}),this._channel.on("console",l=>{let c=new oW.ConsoleMessage(l);this.emit(Ie.Events.BrowserContext.Console,c);let u=c.page();u&&u.emit(Ie.Events.Page.Console,c)}),this._channel.on("pageError",({error:l,page:c})=>{let u=bn.Page.from(c),d=(0,pP.parseError)(l);this.emit(Ie.Events.BrowserContext.WebError,new lW.WebError(u,d)),u&&u.emit(Ie.Events.Page.PageError,d)}),this._channel.on("dialog",({dialog:l})=>{let c=aW.Dialog.from(l),u=this.emit(Ie.Events.BrowserContext.Dialog,c),d=c.page();d&&(u=d.emit(Ie.Events.Page.Dialog,c)||u),u||(c.type()==="beforeunload"?l.accept({}).catch(()=>{}):l.dismiss().catch(()=>{}))}),this._channel.on("request",({request:l,page:c})=>this._onRequest(Mn.Request.from(l),bn.Page.fromNullable(c))),this._channel.on("requestFailed",({request:l,failureText:c,responseEndTiming:u,page:d})=>this._onRequestFailed(Mn.Request.from(l),u,c,bn.Page.fromNullable(d))),this._channel.on("requestFinished",l=>this._onRequestFinished(l)),this._channel.on("response",({response:l,page:c})=>this._onResponse(Mn.Response.from(l),bn.Page.fromNullable(c))),this._closedPromise=new Promise(l=>this.once(Ie.Events.BrowserContext.Close,l)),this._setEventToSubscriptionMapping(new Map([[Ie.Events.BrowserContext.Console,"console"],[Ie.Events.BrowserContext.Dialog,"dialog"],[Ie.Events.BrowserContext.Request,"request"],[Ie.Events.BrowserContext.Response,"response"],[Ie.Events.BrowserContext.RequestFinished,"requestFinished"],[Ie.Events.BrowserContext.RequestFailed,"requestFailed"]]))}_setOptions(e,t){this._options=e,this._options.recordHar&&this._harRecorders.set("",{path:this._options.recordHar.path,content:this._options.recordHar.content}),this.tracing._tracesDir=t.tracesDir}_onPage(e){this._pages.add(e),this.emit(Ie.Events.BrowserContext.Page,e),e._opener&&!e._opener.isClosed()&&e._opener.emit(Ie.Events.Page.Popup,e)}_onRequest(e,t){this.emit(Ie.Events.BrowserContext.Request,e),t&&t.emit(Ie.Events.Page.Request,e)}_onResponse(e,t){this.emit(Ie.Events.BrowserContext.Response,e),t&&t.emit(Ie.Events.Page.Response,e)}_onRequestFailed(e,t,n,s){e._failureText=n||null,e._setResponseEndTiming(t),this.emit(Ie.Events.BrowserContext.RequestFailed,e),s&&s.emit(Ie.Events.Page.RequestFailed,e)}_onRequestFinished(e){let{responseEndTiming:t}=e,n=Mn.Request.from(e.request),s=Mn.Response.fromNullable(e.response),o=bn.Page.fromNullable(e.page);n._setResponseEndTiming(t),this.emit(Ie.Events.BrowserContext.RequestFinished,n),o&&o.emit(Ie.Events.Page.RequestFinished,n),s&&s._finishedPromise.resolve(null)}async _onRoute(e){e._context=this;let t=e.request()._safePage(),n=this._routes.slice();for(let s of n){if(t!=null&&t._closeWasCalled||this._closeWasCalled)return;if(!s.matches(e.request().url()))continue;let o=this._routes.indexOf(s);if(o===-1)continue;s.willExpire()&&this._routes.splice(o,1);let a=await s.handle(e);if(this._routes.length||this._wrapApiCall(()=>this._updateInterceptionPatterns(),!0).catch(()=>{}),a)return}await e._innerContinue(!0).catch(()=>{})}async _onBinding(e){let t=this._bindings.get(e._initializer.name);t&&await e.call(t)}setDefaultNavigationTimeout(e){this._timeoutSettings.setDefaultNavigationTimeout(e),this._wrapApiCall(async()=>{this._channel.setDefaultNavigationTimeoutNoReply({timeout:e}).catch(()=>{})},!0)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._wrapApiCall(async()=>{this._channel.setDefaultTimeoutNoReply({timeout:e}).catch(()=>{})},!0)}browser(){return this._browser}pages(){return[...this._pages]}async newPage(){if(this._ownerPage)throw new Error("Please use browser.newContext()");return bn.Page.from((await this._channel.newPage()).page)}async cookies(e){return e||(e=[]),e&&typeof e=="string"&&(e=[e]),(await this._channel.cookies({urls:e})).cookies}async addCookies(e){await this._channel.addCookies({cookies:e})}async clearCookies(e={}){await this._channel.clearCookies({name:(0,At.isString)(e.name)?e.name:void 0,nameRegexSource:(0,At.isRegExp)(e.name)?e.name.source:void 0,nameRegexFlags:(0,At.isRegExp)(e.name)?e.name.flags:void 0,domain:(0,At.isString)(e.domain)?e.domain:void 0,domainRegexSource:(0,At.isRegExp)(e.domain)?e.domain.source:void 0,domainRegexFlags:(0,At.isRegExp)(e.domain)?e.domain.flags:void 0,path:(0,At.isString)(e.path)?e.path:void 0,pathRegexSource:(0,At.isRegExp)(e.path)?e.path.source:void 0,pathRegexFlags:(0,At.isRegExp)(e.path)?e.path.flags:void 0})}async grantPermissions(e,t){await this._channel.grantPermissions({permissions:e,...t})}async clearPermissions(){await this._channel.clearPermissions()}async setGeolocation(e){await this._channel.setGeolocation({geolocation:e||void 0})}async setExtraHTTPHeaders(e){Mn.validateHeaders(e),await this._channel.setExtraHTTPHeaders({headers:(0,At.headersObjectToArray)(e)})}async setOffline(e){await this._channel.setOffline({offline:e})}async setHTTPCredentials(e){await this._channel.setHTTPCredentials({httpCredentials:e||void 0})}async addInitScript(e,t){let n=await(0,K$.evaluationScript)(e,t);await this._channel.addInitScript({source:n})}async exposeBinding(e,t,n={}){await this._channel.exposeBinding({name:e,needsHandle:n.handle}),this._bindings.set(e,t)}async exposeFunction(e,t){await this._channel.exposeBinding({name:e});let n=(s,...o)=>t(...o);this._bindings.set(e,n)}async route(e,t,n={}){this._routes.unshift(new Mn.RouteHandler(this._options.baseURL,e,t,n.times)),await this._updateInterceptionPatterns()}async _recordIntoHAR(e,t,n={}){var s,o,a;let{harId:l}=await this._channel.harStart({page:t?._channel,options:wP({path:e,content:(s=n.updateContent)!==null&&s!==void 0?s:"attach",mode:(o=n.updateMode)!==null&&o!==void 0?o:"minimal",urlFilter:n.url})});this._harRecorders.set(l,{path:e,content:(a=n.updateContent)!==null&&a!==void 0?a:"attach"})}async routeFromHAR(e,t={}){if(t.update){await this._recordIntoHAR(e,null,t);return}let n=await sW.HarRouter.create(this._connection.localUtils(),e,t.notFound||"abort",{urlMatch:t.url});this._harRouters.push(n),await n.addContextRoute(this)}_disposeHarRouters(){this._harRouters.forEach(e=>e.dispose()),this._harRouters=[]}async unrouteAll(e){await this._unrouteInternal(this._routes,[],e?.behavior),this._disposeHarRouters()}async unroute(e,t){let n=[],s=[];for(let o of this._routes)(0,At.urlMatchesEqual)(o.url,e)&&(!t||o.handler===t)?n.push(o):s.push(o);await this._unrouteInternal(n,s,"default")}async _unrouteInternal(e,t,n){if(this._routes=t,await this._updateInterceptionPatterns(),!n||n==="default")return;let s=e.map(o=>o.stop(n));await Promise.all(s)}async _updateInterceptionPatterns(){let e=Mn.RouteHandler.prepareInterceptionPatterns(this._routes);await this._channel.setNetworkInterceptionPatterns({patterns:e})}_effectiveCloseReason(){var e;return this._closeReason||((e=this._browser)===null||e===void 0?void 0:e._closeReason)}async waitForEvent(e,t={}){return await this._wrapApiCall(async()=>{let n=this._timeoutSettings.timeout(typeof t=="function"?{}:t),s=typeof t=="function"?t:t.predicate,o=Q$.Waiter.createForEvent(this,e);o.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==Ie.Events.BrowserContext.Close&&o.rejectOnEvent(this,Ie.Events.BrowserContext.Close,()=>new pP.TargetClosedError(this._effectiveCloseReason()));let a=await o.waitForEvent(this,e,s);return o.dispose(),a})}async storageState(e={}){let t=await this._channel.storageState();return e.path&&(await(0,Z$.mkdirIfNeeded)(e.path),await fP.default.promises.writeFile(e.path,JSON.stringify(t,void 0,2),"utf8")),t}backgroundPages(){return[...this._backgroundPages]}serviceWorkers(){return[...this._serviceWorkers]}async newCDPSession(e){if(!(e instanceof bn.Page)&&!(e instanceof z$.Frame))throw new Error("page: expected Page or Frame");let t=await this._channel.newCDPSession(e instanceof bn.Page?{page:e._channel}:{frame:e._channel});return eW.CDPSession.from(t.session)}_onClose(){var e;this._browser&&this._browser._contexts.delete(this),(e=this._browserType)===null||e===void 0||(e=e._contexts)===null||e===void 0||e.delete(this),this._disposeHarRouters(),this.tracing._resetStackCounter(),this.emit(Ie.Events.BrowserContext.Close,this)}async[mP](){await this.close()}async close(e={}){this._closeWasCalled||(this._closeReason=e.reason,this._closeWasCalled=!0,await this._wrapApiCall(async()=>{var t;await((t=this._browserType)===null||t===void 0?void 0:t._willCloseContext(this));for(let[n,s]of this._harRecorders){let o=await this._channel.harExport({harId:n}),a=nW.Artifact.from(o.artifact),l=s.content==="attach"||s.path.endsWith(".zip"),c=s.path.endsWith(".zip");l&&!c?(await a.saveAs(s.path+".tmp"),await this._connection.localUtils()._channel.harUnzip({zipFile:s.path+".tmp",harFile:s.path})):await a.saveAs(s.path),await a.delete()}},!0),await this._channel.close(e),await this._closedPromise)}async _enableRecorder(e){await this._channel.recorderSupplementEnable(e)}};za.BrowserContext=qb;async function uW(r){if(typeof r.storageState!="string")return r.storageState;try{return JSON.parse(await fP.default.promises.readFile(r.storageState,"utf8"))}catch(e){throw(0,iW.rewriteErrorMessage)(e,`Error reading storage state from ${r.storageState}:
`+e.message),e}}function wP(r){if(r)return{path:r.path,content:r.content||(r.omitContent?"omit":void 0),urlGlob:(0,At.isString)(r.urlFilter)?r.urlFilter:void 0,urlRegexSource:(0,At.isRegExp)(r.urlFilter)?r.urlFilter.source:void 0,urlRegexFlags:(0,At.isRegExp)(r.urlFilter)?r.urlFilter.flags:void 0,mode:r.mode}}async function dW(r){if(r.videoSize&&!r.videosPath)throw new Error('"videoSize" option requires "videosPath" to be specified');r.extraHTTPHeaders&&Mn.validateHeaders(r.extraHTTPHeaders);let e={...r,viewport:r.viewport===null?void 0:r.viewport,noDefaultViewport:r.viewport===null,extraHTTPHeaders:r.extraHTTPHeaders?(0,At.headersObjectToArray)(r.extraHTTPHeaders):void 0,storageState:await uW(r),serviceWorkers:r.serviceWorkers,recordHar:wP(r.recordHar),colorScheme:r.colorScheme===null?"no-override":r.colorScheme,reducedMotion:r.reducedMotion===null?"no-override":r.reducedMotion,forcedColors:r.forcedColors===null?"no-override":r.forcedColors,acceptDownloads:hW(r.acceptDownloads)};return!e.recordVideo&&r.videosPath&&(e.recordVideo={dir:r.videosPath,size:r.videoSize}),e.recordVideo&&e.recordVideo.dir&&(e.recordVideo.dir=V$.default.resolve(process.cwd(),e.recordVideo.dir)),e}function hW(r){if(r!==void 0)return r?"accept":"deny"}});var Dh=M(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.Browser=void 0;var pW=vW(require("fs")),vP=Qs(),fW=ze(),bP=Rn(),mW=on(),gW=Mh(),_W=Us(),wW=ie(),yP;function vW(r){return r&&r.__esModule?r:{default:r}}yP=Symbol.asyncDispose;var Hb=class extends fW.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._contexts=new Set,this._isConnected=!0,this._closedPromise=void 0,this._shouldCloseConnectionOnClose=!1,this._browserType=void 0,this._options={},this._name=void 0,this._path=void 0,this._connectHeaders=void 0,this._closeReason=void 0,this._name=s.name,this._channel.on("close",()=>this._didClose()),this._closedPromise=new Promise(o=>this.once(bP.Events.Browser.Disconnected,o))}browserType(){return this._browserType}async newContext(e={}){return await this._innerNewContext(e,!1)}async _newContextForReuse(e={}){return await this._wrapApiCall(async()=>{for(let t of this._contexts){await this._browserType._willCloseContext(t);for(let n of t.pages())n._onClose();t._onClose()}return await this._innerNewContext(e,!0)},!0)}async _stopPendingOperations(e){return await this._wrapApiCall(async()=>{await this._channel.stopPendingOperations({reason:e})},!0)}async _innerNewContext(e={},t){e={...this._browserType._defaultContextOptions,...e};let n=await(0,vP.prepareBrowserContextParams)(e),s=t?await this._channel.newContextForReuse(n):await this._channel.newContext(n),o=vP.BrowserContext.from(s.context);return await this._browserType._didCreateContext(o,n,this._options,e.logger||this._logger),o}contexts(){return[...this._contexts]}version(){return this._initializer.version}async newPage(e={}){return await this._wrapApiCall(async()=>{let t=await this.newContext(e),n=await t.newPage();return n._ownedContext=t,t._ownerPage=n,n})}isConnected(){return this._isConnected}async newBrowserCDPSession(){return gW.CDPSession.from((await this._channel.newBrowserCDPSession()).session)}async startTracing(e,t={}){this._path=t.path,await this._channel.startTracing({...t,page:e?e._channel:void 0})}async stopTracing(){let e=_W.Artifact.from((await this._channel.stopTracing()).artifact),t=await e.readIntoBuffer();return await e.delete(),this._path&&(await(0,wW.mkdirIfNeeded)(this._path),await pW.default.promises.writeFile(this._path,t),this._path=void 0),t}async[yP](){await this.close()}async close(e={}){this._closeReason=e.reason;try{this._shouldCloseConnectionOnClose?this._connection.close():await this._channel.close(e),await this._closedPromise}catch(t){if((0,mW.isTargetClosedError)(t))return;throw t}}_didClose(){this._isConnected=!1,this.emit(bP.Events.Browser.Disconnected,this)}};Bh.Browser=Hb});var zb=M(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.BrowserType=void 0;var $b=Dh(),Wb=Qs(),bW=ze(),yW=qh(),xW=Rn(),xP=Dr(),Ai=ie(),SW=vo(),Ub=class extends bW.ChannelOwner{constructor(...e){super(...e),this._serverLauncher=void 0,this._contexts=new Set,this._playwright=void 0,this._defaultContextOptions=void 0,this._defaultContextTimeout=void 0,this._defaultContextNavigationTimeout=void 0,this._defaultLaunchOptions=void 0}static from(e){return e._object}executablePath(){if(!this._initializer.executablePath)throw new Error("Browser is not supported on current platform");return this._initializer.executablePath}name(){return this._initializer.name}async launch(e={}){var t;(0,Ai.assert)(!e.userDataDir,"userDataDir option is not supported in `browserType.launch`. Use `browserType.launchPersistentContext` instead"),(0,Ai.assert)(!e.port,"Cannot specify a port without launching as a server.");let n=e.logger||((t=this._defaultLaunchOptions)===null||t===void 0?void 0:t.logger);e={...this._defaultLaunchOptions,...e};let s={...e,ignoreDefaultArgs:Array.isArray(e.ignoreDefaultArgs)?e.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!e.ignoreDefaultArgs&&!Array.isArray(e.ignoreDefaultArgs),env:e.env?(0,xP.envObjectToArray)(e.env):void 0};return await this._wrapApiCall(async()=>{let o=$b.Browser.from((await this._channel.launch(s)).browser);return this._didLaunchBrowser(o,e,n),o})}async launchServer(e={}){if(!this._serverLauncher)throw new Error("Launching server is not supported");return e={...this._defaultLaunchOptions,...e},await this._serverLauncher.launchServer(e)}async launchPersistentContext(e,t={}){var n;let s=t.logger||((n=this._defaultLaunchOptions)===null||n===void 0?void 0:n.logger);(0,Ai.assert)(!t.port,"Cannot specify a port without launching as a server."),t={...this._defaultLaunchOptions,...this._defaultContextOptions,...t};let o=await(0,Wb.prepareBrowserContextParams)(t),a={...o,ignoreDefaultArgs:Array.isArray(t.ignoreDefaultArgs)?t.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!t.ignoreDefaultArgs&&!Array.isArray(t.ignoreDefaultArgs),env:t.env?(0,xP.envObjectToArray)(t.env):void 0,channel:t.channel,userDataDir:e};return await this._wrapApiCall(async()=>{let l=await this._channel.launchPersistentContext(a),c=Wb.BrowserContext.from(l.context);return await this._didCreateContext(c,o,t,s),c})}async connect(e,t){return typeof e=="string"?await this._connect({...t,wsEndpoint:e}):((0,Ai.assert)(e.wsEndpoint,"options.wsEndpoint is required"),await this._connect(e))}async _connect(e){let t=e.logger;return await this._wrapApiCall(async()=>{var n;let s=e.timeout?(0,Ai.monotonicTime)()+e.timeout:0,o={"x-playwright-browser":this.name(),...e.headers},a=this._connection.localUtils(),l={wsEndpoint:e.wsEndpoint,headers:o,exposeNetwork:(n=e.exposeNetwork)!==null&&n!==void 0?n:e._exposeNetwork,slowMo:e.slowMo,timeout:e.timeout};e.__testHookRedirectPortForwarding&&(l.socksProxyRedirectPortForTest=e.__testHookRedirectPortForwarding);let{pipe:c,headers:u}=await a._channel.connect(l),d=()=>c.close().catch(()=>{}),h=new yW.Connection(a,this._instrumentation);h.markAsRemote(),h.on("close",d);let p,f,_=w=>{var m;for(let x of((g=p)===null||g===void 0?void 0:g.contexts())||[]){var g;for(let b of x.pages())b._onClose();x._onClose()}(m=p)===null||m===void 0||m._didClose(),h.close(w||f)};c.on("closed",w=>_(w.reason)),h.onmessage=w=>c.send({message:w}).catch(()=>_()),c.on("message",({message:w})=>{try{h.dispatch(w)}catch(m){f=String(m),d()}});let v=await(0,SW.raceAgainstDeadline)(async()=>{e.__testHookBeforeCreateBrowser&&await e.__testHookBeforeCreateBrowser();let w=await h.initializePlaywright();if(!w._initializer.preLaunchedBrowser)throw d(),new Error("Malformed endpoint. Did you use BrowserType.launchServer method?");return w._setSelectors(this._playwright.selectors),p=$b.Browser.from(w._initializer.preLaunchedBrowser),this._didLaunchBrowser(p,{},t),p._shouldCloseConnectionOnClose=!0,p._connectHeaders=u,p.on(xW.Events.Browser.Disconnected,d),p},s);if(v.timedOut)throw d(),new Error(`Timeout ${e.timeout}ms exceeded`);return v.result})}async connectOverCDP(e,t){if(typeof e=="string")return await this._connectOverCDP(e,t);let n="endpointURL"in e?e.endpointURL:e.wsEndpoint;return(0,Ai.assert)(n,"Cannot connect over CDP without wsEndpoint."),await this.connectOverCDP(n,e)}async _connectOverCDP(e,t={}){if(this.name()!=="chromium")throw new Error("Connecting over CDP is only supported in Chromium.");let n=t.headers?(0,Ai.headersObjectToArray)(t.headers):void 0,s=await this._channel.connectOverCDP({endpointURL:e,headers:n,slowMo:t.slowMo,timeout:t.timeout}),o=$b.Browser.from(s.browser);return this._didLaunchBrowser(o,{},t.logger),s.defaultContext&&await this._didCreateContext(Wb.BrowserContext.from(s.defaultContext),{},{},t.logger),o}_didLaunchBrowser(e,t,n){e._browserType=this,e._options=t,e._logger=n}async _didCreateContext(e,t,n,s){e._logger=s,e._browserType=this,this._contexts.add(e),e._setOptions(t,n),this._defaultContextTimeout!==void 0&&e.setDefaultTimeout(this._defaultContextTimeout),this._defaultContextNavigationTimeout!==void 0&&e.setDefaultNavigationTimeout(this._defaultContextNavigationTimeout),await this._instrumentation.onDidCreateBrowserContext(e)}async _willCloseContext(e){this._contexts.delete(e),await this._instrumentation.onWillCloseBrowserContext(e)}};jh.BrowserType=Ub});var Xb=M(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.AndroidWebView=ln.AndroidSocket=ln.AndroidInput=ln.AndroidDevice=ln.Android=void 0;var kP=OW(require("fs")),Kb=ie(),Wr=Rn(),Vb=Qs(),Jb=ze(),CP=en(),EW=ki(),kW=require("events"),CW=qh(),SP=on(),TW=vo(),TP;function OW(r){return r&&r.__esModule?r:{default:r}}var Gb=class extends Jb.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._timeoutSettings=void 0,this._serverLauncher=void 0,this._timeoutSettings=new CP.TimeoutSettings}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._channel.setDefaultTimeoutNoReply({timeout:e})}async devices(e={}){let{devices:t}=await this._channel.devices(e);return t.map(n=>Va.from(n))}async launchServer(e={}){if(!this._serverLauncher)throw new Error("Launching server is not supported");return await this._serverLauncher.launchServer(e)}async connect(e,t={}){return await this._wrapApiCall(async()=>{let n=t.timeout?(0,Kb.monotonicTime)()+t.timeout:0,s={"x-playwright-browser":"android",...t.headers},o=this._connection.localUtils(),a={wsEndpoint:e,headers:s,slowMo:t.slowMo,timeout:t.timeout},{pipe:l}=await o._channel.connect(a),c=()=>l.close().catch(()=>{}),u=new CW.Connection(o,this._instrumentation);u.markAsRemote(),u.on("close",c);let d,h,p=()=>{var _;(_=d)===null||_===void 0||_._didClose(),u.close(h)};l.on("closed",p),u.onmessage=_=>l.send({message:_}).catch(p),l.on("message",({message:_})=>{try{u.dispatch(_)}catch(v){h=String(v),c()}});let f=await(0,TW.raceAgainstDeadline)(async()=>{let _=await u.initializePlaywright();if(!_._initializer.preConnectedAndroidDevice)throw c(),new Error("Malformed endpoint. Did you use Android.launchServer method?");return d=Va.from(_._initializer.preConnectedAndroidDevice),d._shouldCloseConnectionOnClose=!0,d.on(Wr.Events.AndroidDevice.Close,c),d},n);if(f.timedOut)throw c(),new Error(`Timeout ${t.timeout}ms exceeded`);return f.result})}};ln.Android=Gb;TP=Symbol.asyncDispose;var Va=class extends Jb.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._timeoutSettings=void 0,this._webViews=new Map,this._shouldCloseConnectionOnClose=!1,this.input=void 0,this.input=new $h(this),this._timeoutSettings=new CP.TimeoutSettings(e._timeoutSettings),this._channel.on("webViewAdded",({webView:o})=>this._onWebViewAdded(o)),this._channel.on("webViewRemoved",({socketName:o})=>this._onWebViewRemoved(o)),this._channel.on("close",()=>this._didClose())}_onWebViewAdded(e){let t=new Wh(this,e);this._webViews.set(e.socketName,t),this.emit(Wr.Events.AndroidDevice.WebView,t)}_onWebViewRemoved(e){let t=this._webViews.get(e);this._webViews.delete(e),t&&t.emit(Wr.Events.AndroidWebView.Close)}setDefaultTimeout(e){this._timeoutSettings.setDefaultTimeout(e),this._channel.setDefaultTimeoutNoReply({timeout:e})}serial(){return this._initializer.serial}model(){return this._initializer.model}webViews(){return[...this._webViews.values()]}async webView(e,t){let n=o=>e.pkg?o.pkg()===e.pkg:e.socketName?o._socketName()===e.socketName:!1,s=[...this._webViews.values()].find(n);return s||await this.waitForEvent("webview",{...t,predicate:n})}async wait(e,t){await this._channel.wait({selector:Kt(e),...t})}async fill(e,t,n){await this._channel.fill({selector:Kt(e),text:t,...n})}async press(e,t,n){await this.tap(e,n),await this.input.press(t)}async tap(e,t){await this._channel.tap({selector:Kt(e),...t})}async drag(e,t,n){await this._channel.drag({selector:Kt(e),dest:t,...n})}async fling(e,t,n){await this._channel.fling({selector:Kt(e),direction:t,...n})}async longTap(e,t){await this._channel.longTap({selector:Kt(e),...t})}async pinchClose(e,t,n){await this._channel.pinchClose({selector:Kt(e),percent:t,...n})}async pinchOpen(e,t,n){await this._channel.pinchOpen({selector:Kt(e),percent:t,...n})}async scroll(e,t,n,s){await this._channel.scroll({selector:Kt(e),direction:t,percent:n,...s})}async swipe(e,t,n,s){await this._channel.swipe({selector:Kt(e),direction:t,percent:n,...s})}async info(e){return(await this._channel.info({selector:Kt(e)})).info}async screenshot(e={}){let{binary:t}=await this._channel.screenshot();return e.path&&await kP.default.promises.writeFile(e.path,t),t}async[TP](){await this.close()}async close(){try{this._shouldCloseConnectionOnClose?this._connection.close():await this._channel.close()}catch(e){if((0,SP.isTargetClosedError)(e))return;throw e}}_didClose(){this.emit(Wr.Events.AndroidDevice.Close,this)}async shell(e){let{result:t}=await this._channel.shell({command:e});return t}async open(e){return Hh.from((await this._channel.open({command:e})).socket)}async installApk(e,t){await this._channel.installApk({file:await EP(e),args:t&&t.args})}async push(e,t,n){await this._channel.push({file:await EP(e),path:t,mode:n?n.mode:void 0})}async launchBrowser(e={}){let t=await(0,Vb.prepareBrowserContextParams)(e),n=await this._channel.launchBrowser(t),s=Vb.BrowserContext.from(n.context);return s._setOptions(t,{}),s}async waitForEvent(e,t={}){return await this._wrapApiCall(async()=>{let n=this._timeoutSettings.timeout(typeof t=="function"?{}:t),s=typeof t=="function"?t:t.predicate,o=EW.Waiter.createForEvent(this,e);o.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==Wr.Events.AndroidDevice.Close&&o.rejectOnEvent(this,Wr.Events.AndroidDevice.Close,()=>new SP.TargetClosedError);let a=await o.waitForEvent(this,e,s);return o.dispose(),a})}};ln.AndroidDevice=Va;var Hh=class extends Jb.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._channel.on("data",({data:o})=>this.emit(Wr.Events.AndroidSocket.Data,o)),this._channel.on("close",()=>this.emit(Wr.Events.AndroidSocket.Close))}async write(e){await this._channel.write({data:e})}async close(){await this._channel.close()}async[Symbol.asyncDispose](){await this.close()}};ln.AndroidSocket=Hh;async function EP(r){return(0,Kb.isString)(r)?await kP.default.promises.readFile(r):r}var $h=class{constructor(e){this._device=void 0,this._device=e}async type(e){await this._device._channel.inputType({text:e})}async press(e){await this._device._channel.inputPress({key:e})}async tap(e){await this._device._channel.inputTap({point:e})}async swipe(e,t,n){await this._device._channel.inputSwipe({segments:t,steps:n})}async drag(e,t,n){await this._device._channel.inputDrag({from:e,to:t,steps:n})}};ln.AndroidInput=$h;function Kt(r){let{checkable:e,checked:t,clazz:n,clickable:s,depth:o,desc:a,enabled:l,focusable:c,focused:u,hasChild:d,hasDescendant:h,longClickable:p,pkg:f,res:_,scrollable:v,selected:w,text:m}=r,g=x=>{if(x!==void 0)return(0,Kb.isRegExp)(x)?x.source:"^"+x.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")+"$"};return{checkable:e,checked:t,clazz:g(n),pkg:g(f),desc:g(a),res:g(_),text:g(m),clickable:s,depth:o,enabled:l,focusable:c,focused:u,hasChild:d?{selector:Kt(d.selector)}:void 0,hasDescendant:h?{selector:Kt(h.selector),maxDepth:h.maxDepth}:void 0,longClickable:p,scrollable:v,selected:w}}var Wh=class extends kW.EventEmitter{constructor(e,t){super(),this._device=void 0,this._data=void 0,this._pagePromise=void 0,this._device=e,this._data=t}pid(){return this._data.pid}pkg(){return this._data.pkg}_socketName(){return this._data.socketName}async page(){return this._pagePromise||(this._pagePromise=this._fetchPage()),await this._pagePromise}async _fetchPage(){let{context:e}=await this._device._channel.connectToWebView({socketName:this._data.socketName});return Vb.BrowserContext.from(e).pages()[0]}};ln.AndroidWebView=Wh});var Qb=M(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.ElectronApplication=Zs.Electron=void 0;var PW=en(),OP=Qs(),PP=ze(),AW=Dr(),Ur=Rn(),Ga=Yn(),IW=Lb(),RW=ki(),MW=on(),AP,Yb=class extends PP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s)}async launch(e={}){let t={...await(0,OP.prepareBrowserContextParams)(e),env:(0,AW.envObjectToArray)(e.env?e.env:process.env),tracesDir:e.tracesDir},n=Uh.from((await this._channel.launch(t)).electronApplication);return n._context._options=t,n}};Zs.Electron=Yb;AP=Symbol.asyncDispose;var Uh=class extends PP.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s),this._context=void 0,this._windows=new Set,this._timeoutSettings=new PW.TimeoutSettings,this._isClosed=!1,this._context=OP.BrowserContext.from(s.context);for(let o of this._context._pages)this._onPage(o);this._context.on(Ur.Events.BrowserContext.Page,o=>this._onPage(o)),this._channel.on("close",()=>{this._isClosed=!0,this.emit(Ur.Events.ElectronApplication.Close)}),this._channel.on("console",o=>this.emit(Ur.Events.ElectronApplication.Console,new IW.ConsoleMessage(o))),this._setEventToSubscriptionMapping(new Map([[Ur.Events.ElectronApplication.Console,"console"]]))}process(){return this._toImpl().process()}_onPage(e){this._windows.add(e),this.emit(Ur.Events.ElectronApplication.Window,e),e.once(Ur.Events.Page.Close,()=>this._windows.delete(e))}windows(){return[...this._windows]}async firstWindow(e){return this._windows.size?this._windows.values().next().value:await this.waitForEvent("window",e)}context(){return this._context}async[AP](){await this.close()}async close(){this._isClosed||await this._channel.close().catch(()=>{})}async waitForEvent(e,t={}){return await this._wrapApiCall(async()=>{let n=this._timeoutSettings.timeout(typeof t=="function"?{}:t),s=typeof t=="function"?t:t.predicate,o=RW.Waiter.createForEvent(this,e);o.rejectOnTimeout(n,`Timeout ${n}ms exceeded while waiting for event "${e}"`),e!==Ur.Events.ElectronApplication.Close&&o.rejectOnEvent(this,Ur.Events.ElectronApplication.Close,()=>new MW.TargetClosedError);let a=await o.waitForEvent(this,e,s);return o.dispose(),a})}async browserWindow(e){let t=await this._channel.browserWindow({page:e._channel});return Ga.JSHandle.from(t.handle)}async evaluate(e,t){let n=await this._channel.evaluateExpression({expression:String(e),isFunction:typeof e=="function",arg:(0,Ga.serializeArgument)(t)});return(0,Ga.parseResult)(n.value)}async evaluateHandle(e,t){let n=await this._channel.evaluateExpressionHandle({expression:String(e),isFunction:typeof e=="function",arg:(0,Ga.serializeArgument)(t)});return Ga.JSHandle.from(n.handle)}};Zs.ElectronApplication=Uh});var t0=M(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.SelectorsOwner=eo.Selectors=void 0;var FW=Dr(),NW=ze(),IP=lb(),Zb=class{constructor(){this._channels=new Set,this._registrations=[]}async register(e,t,n={}){let s=await(0,FW.evaluationScript)(t,void 0,!1),o={...n,name:e,source:s};for(let a of this._channels)await a._channel.register(o);this._registrations.push(o)}setTestIdAttribute(e){(0,IP.setTestIdAttribute)(e);for(let t of this._channels)t._channel.setTestIdAttributeName({testIdAttributeName:e}).catch(()=>{})}_addChannel(e){this._channels.add(e);for(let t of this._registrations)e._channel.register(t).catch(()=>{}),e._channel.setTestIdAttributeName({testIdAttributeName:(0,IP.testIdAttributeName)()}).catch(()=>{})}_removeChannel(e){this._channels.delete(e)}};eo.Selectors=Zb;var e0=class extends NW.ChannelOwner{static from(e){return e._object}};eo.SelectorsOwner=e0});var RP=M(zh=>{"use strict";Object.defineProperty(zh,"__esModule",{value:!0});zh.Playwright=void 0;var LW=on(),DW=Xb(),n0=zb(),BW=ze(),jW=Qb(),qW=ja(),r0=t0(),i0=class extends BW.ChannelOwner{constructor(e,t,n,s){var o,a;super(e,t,n,s),this._android=void 0,this._electron=void 0,this.chromium=void 0,this.firefox=void 0,this.webkit=void 0,this.devices=void 0,this.selectors=void 0,this.request=void 0,this.errors=void 0,this.request=new qW.APIRequest(this),this.chromium=n0.BrowserType.from(s.chromium),this.chromium._playwright=this,this.firefox=n0.BrowserType.from(s.firefox),this.firefox._playwright=this,this.webkit=n0.BrowserType.from(s.webkit),this.webkit._playwright=this,this._android=DW.Android.from(s.android),this._electron=jW.Electron.from(s.electron),this.devices=(o=(a=this._connection.localUtils())===null||a===void 0?void 0:a.devices)!==null&&o!==void 0?o:{},this.selectors=new r0.Selectors,this.errors={TimeoutError:LW.TimeoutError};let l=r0.SelectorsOwner.from(s.selectors);this.selectors._addChannel(l),this._connection.on("close",()=>{this.selectors._removeChannel(l)}),global._playwrightInstance=this}_setSelectors(e){let t=r0.SelectorsOwner.from(this._initializer.selectors);this.selectors._removeChannel(t),this.selectors=e,this.selectors._addChannel(t)}static from(e){return e._object}};zh.Playwright=i0});var MP=M(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.JsonPipe=void 0;var HW=ze(),s0=class extends HW.ChannelOwner{static from(e){return e._object}constructor(e,t,n,s){super(e,t,n,s)}channel(){return this._channel}};Vh.JsonPipe=s0});var FP=M(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.LocalUtils=void 0;var $W=ze(),o0=class extends $W.ChannelOwner{constructor(e,t,n,s){super(e,t,n,s),this.devices=void 0,this.devices={};for(let{name:o,descriptor:a}of s.deviceDescriptors)this.devices[o]=a}};Gh.LocalUtils=o0});var NP=M(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0});a0.createInstrumentation=WW;function WW(){let r=[];return new Proxy({},{get:(e,t)=>typeof t!="string"?e[t]:t==="addListener"?n=>r.push(n):t==="removeListener"?n=>r.splice(r.indexOf(n),1):t==="removeAllListeners"?()=>r.splice(0,r.length):t.startsWith("on")?async(...n)=>{for(let a of r){var s,o;await((s=(o=a)[t])===null||s===void 0?void 0:s.call(o,...n))}}:e[t]})}});var qh=M(Jh=>{"use strict";Object.defineProperty(Jh,"__esModule",{value:!0});Jh.Connection=void 0;var UW=Dh(),zW=Qs(),VW=zb(),jP=ze(),GW=Da(),KW=Ks(),JW=Yn(),Kh=Gs(),LP=Ua(),XW=Ba(),YW=Bb(),DP=on(),QW=Mh(),qP=RP(),BP=Qb(),ZW=Zv(),eU=yb(),to=Le(),tU=t0(),l0=Xb(),nU=Us(),rU=require("events"),iU=MP(),sU=ja(),oU=FP(),aU=vh(),Ka=Ao(),lU=NP(),c0=ie(),u0=class extends jP.ChannelOwner{constructor(e){super(e,"Root","",{})}async initialize(){return qP.Playwright.from((await this._channel.initialize({sdkLanguage:"javascript"})).playwright)}},d0=class extends jP.ChannelOwner{},h0=class extends rU.EventEmitter{constructor(e,t){super(),this._objects=new Map,this.onmessage=n=>{},this._lastId=0,this._callbacks=new Map,this._rootObject=void 0,this._closedError=void 0,this._isRemote=!1,this._localUtils=void 0,this._rawBuffers=!1,this.toImpl=void 0,this._tracingCount=0,this._instrumentation=void 0,this._rootObject=new u0(this),this._localUtils=e,this._instrumentation=t||(0,lU.createInstrumentation)()}markAsRemote(){this._isRemote=!0}isRemote(){return this._isRemote}useRawBuffers(){this._rawBuffers=!0}rawBuffers(){return this._rawBuffers}localUtils(){return this._localUtils}async initializePlaywright(){return await this._rootObject.initialize()}getObjectWithKnownName(e){return this._objects.get(e)}setIsTracing(e){e?this._tracingCount++:this._tracingCount--}async sendMessageToServer(e,t,n,s,o,a){var l;if(this._closedError)throw this._closedError;if(e._wasCollected)throw new Error("The object has been collected to prevent unbounded heap growth.");let c=e._guid,u=e._type,d=++this._lastId,h={id:d,guid:c,method:t,params:n};to.debugLogger.isEnabled("channel")&&to.debugLogger.log("channel","SEND> "+JSON.stringify(h));let p=o[0]?{file:o[0].file,line:o[0].line,column:o[0].column}:void 0,f={wallTime:a,apiName:s,location:p,internal:!s};return this._tracingCount&&o&&u!=="LocalUtils"&&((l=this._localUtils)===null||l===void 0||l._channel.addStackToTracingNoReply({callData:{stack:o,id:d}}).catch(()=>{})),c0.zones.exitZones(()=>this.onmessage({...h,metadata:f})),await new Promise((_,v)=>this._callbacks.set(d,{resolve:_,reject:v,apiName:s,type:u,method:t}))}dispatch(e){if(this._closedError)return;let{id:t,guid:n,method:s,params:o,result:a,error:l,log:c}=e;if(t){to.debugLogger.isEnabled("channel")&&to.debugLogger.log("channel","<RECV "+JSON.stringify(e));let h=this._callbacks.get(t);if(!h)throw new Error(`Cannot find command to respond: ${t}`);if(this._callbacks.delete(t),l&&!a){let p=(0,DP.parseError)(l);(0,c0.rewriteErrorMessage)(p,p.message+(0,c0.formatCallLog)(c)),h.reject(p)}else{let p=(0,Ka.findValidator)(h.type,h.method,"Result");h.resolve(p(a,"",{tChannelImpl:this._tChannelImplFromWire.bind(this),binary:this._rawBuffers?"buffer":"fromBase64"}))}return}if(to.debugLogger.isEnabled("channel")&&to.debugLogger.log("channel","<EVENT "+JSON.stringify(e)),s==="__create__"){this._createRemoteObject(n,o.type,o.guid,o.initializer);return}let u=this._objects.get(n);if(!u)throw new Error(`Cannot find object to "${s}": ${n}`);if(s==="__adopt__"){let h=this._objects.get(o.guid);if(!h)throw new Error(`Unknown new child: ${o.guid}`);u._adopt(h);return}if(s==="__dispose__"){u._dispose(o.reason);return}let d=(0,Ka.findValidator)(u._type,s,"Event");u._channel.emit(s,d(o,"",{tChannelImpl:this._tChannelImplFromWire.bind(this),binary:this._rawBuffers?"buffer":"fromBase64"}))}close(e){this._closedError=new DP.TargetClosedError(e);for(let t of this._callbacks.values())t.reject(this._closedError);this._callbacks.clear(),this.emit("close")}_tChannelImplFromWire(e,t,n,s){if(t&&typeof t=="object"&&typeof t.guid=="string"){let o=this._objects.get(t.guid);if(!o)throw new Error(`Object with guid ${t.guid} was not bound in the connection`);if(e!=="*"&&!e.includes(o._type))throw new Ka.ValidationError(`${n}: expected channel ${e.toString()}`);return o._channel}throw new Ka.ValidationError(`${n}: expected channel ${e.toString()}`)}_createRemoteObject(e,t,n,s){let o=this._objects.get(e);if(!o)throw new Error(`Cannot find parent object ${e} to create ${n}`);let a;switch(s=(0,Ka.findValidator)(t,"","Initializer")(s,"",{tChannelImpl:this._tChannelImplFromWire.bind(this),binary:this._rawBuffers?"buffer":"fromBase64"}),t){case"Android":a=new l0.Android(o,t,n,s);break;case"AndroidSocket":a=new l0.AndroidSocket(o,t,n,s);break;case"AndroidDevice":a=new l0.AndroidDevice(o,t,n,s);break;case"APIRequestContext":a=new sU.APIRequestContext(o,t,n,s);break;case"Artifact":a=new nU.Artifact(o,t,n,s);break;case"BindingCall":a=new LP.BindingCall(o,t,n,s);break;case"Browser":a=new UW.Browser(o,t,n,s);break;case"BrowserContext":a=new zW.BrowserContext(o,t,n,s);break;case"BrowserType":a=new VW.BrowserType(o,t,n,s);break;case"CDPSession":a=new QW.CDPSession(o,t,n,s);break;case"Dialog":a=new YW.Dialog(o,t,n,s);break;case"Electron":a=new BP.Electron(o,t,n,s);break;case"ElectronApplication":a=new BP.ElectronApplication(o,t,n,s);break;case"ElementHandle":a=new GW.ElementHandle(o,t,n,s);break;case"Frame":a=new KW.Frame(o,t,n,s);break;case"JSHandle":a=new JW.JSHandle(o,t,n,s);break;case"JsonPipe":a=new iU.JsonPipe(o,t,n,s);break;case"LocalUtils":a=new oU.LocalUtils(o,t,n,s),this._localUtils||(this._localUtils=a);break;case"Page":a=new LP.Page(o,t,n,s);break;case"Playwright":a=new qP.Playwright(o,t,n,s);break;case"Request":a=new Kh.Request(o,t,n,s);break;case"Response":a=new Kh.Response(o,t,n,s);break;case"Route":a=new Kh.Route(o,t,n,s);break;case"Stream":a=new ZW.Stream(o,t,n,s);break;case"Selectors":a=new tU.SelectorsOwner(o,t,n,s);break;case"SocksSupport":a=new d0(o,t,n,s);break;case"Tracing":a=new aU.Tracing(o,t,n,s);break;case"WebSocket":a=new Kh.WebSocket(o,t,n,s);break;case"Worker":a=new XW.Worker(o,t,n,s);break;case"WritableStream":a=new eU.WritableStream(o,t,n,s);break;default:throw new Error("Missing type "+t)}return a}};Jh.Connection=h0});var HP=M(Xh=>{"use strict";Object.defineProperty(Xh,"__esModule",{value:!0});Xh.DebugControllerDispatcher=void 0;var no=ie(),Ja=Cw(),cU=He(),p0=class extends cU.Dispatcher{constructor(e,t){super(e,t,"DebugController",{}),this._type_DebugController=void 0,this._listeners=void 0,this._type_DebugController=!0,this._listeners=[no.eventsHelper.addEventListener(this._object,Ja.DebugController.Events.StateChanged,n=>{this._dispatchEvent("stateChanged",n)}),no.eventsHelper.addEventListener(this._object,Ja.DebugController.Events.InspectRequested,({selector:n,locator:s})=>{this._dispatchEvent("inspectRequested",{selector:n,locator:s})}),no.eventsHelper.addEventListener(this._object,Ja.DebugController.Events.SourceChanged,({text:n,header:s,footer:o,actions:a})=>{this._dispatchEvent("sourceChanged",{text:n,header:s,footer:o,actions:a})}),no.eventsHelper.addEventListener(this._object,Ja.DebugController.Events.Paused,({paused:n})=>{this._dispatchEvent("paused",{paused:n})}),no.eventsHelper.addEventListener(this._object,Ja.DebugController.Events.SetModeRequested,({mode:n})=>{this._dispatchEvent("setModeRequested",{mode:n})})]}async initialize(e){this._object.initialize(e.codegenId,e.sdkLanguage)}async setReportStateChanged(e){this._object.setReportStateChanged(e.enabled)}async resetForReuse(){await this._object.resetForReuse()}async navigate(e){await this._object.navigate(e.url)}async setRecorderMode(e){await this._object.setRecorderMode(e)}async highlight(e){await this._object.highlight(e.selector)}async hideHighlight(){await this._object.hideHighlight()}async resume(){await this._object.resume()}async kill(){await this._object.kill()}async closeAllBrowsers(){await this._object.closeAllBrowsers()}_onDispose(){no.eventsHelper.removeEventListeners(this._listeners),this._object.dispose()}};Xh.DebugControllerDispatcher=p0});var UP=M(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.PlaywrightConnection=void 0;var Ii=Gv(),f0=li(),$P=De(),uU=Rs(),Ri=ie(),dU=Ku(),hU=HP(),wt=Le(),m0=class{constructor(e,t,n,s,o,a,l){if(this._ws=void 0,this._onClose=void 0,this._dispatcherConnection=void 0,this._cleanups=[],this._id=void 0,this._disconnected=!1,this._preLaunched=void 0,this._options=void 0,this._root=void 0,this._profileName=void 0,this._ws=n,this._preLaunched=o,this._options=s,s.launchOptions=pU(s.launchOptions),(t==="reuse-browser"||t==="pre-launched-browser-or-android")&&(0,Ri.assert)(o.playwright),t==="pre-launched-browser-or-android"&&(0,Ri.assert)(o.browser||o.androidDevice),this._onClose=l,this._id=a,this._profileName=`${new Date().toISOString()}-${t}`,this._dispatcherConnection=new Ii.DispatcherConnection,this._dispatcherConnection.onmessage=async c=>{if(await e,n.readyState!==n.CLOSING){let u=JSON.stringify(c);wt.debugLogger.isEnabled("server:channel")&&wt.debugLogger.log("server:channel",`[${this._id}] ${(0,Ri.monotonicTime)()*1e3} SEND \u25BA ${u}`),wt.debugLogger.isEnabled("server:metadata")&&this.logServerMetadata(c,u,"SEND"),n.send(u)}},n.on("message",async c=>{await e;let u=Buffer.from(c).toString(),d=JSON.parse(u);wt.debugLogger.isEnabled("server:channel")&&wt.debugLogger.log("server:channel",`[${this._id}] ${(0,Ri.monotonicTime)()*1e3} \u25C0 RECV ${u}`),wt.debugLogger.isEnabled("server:metadata")&&this.logServerMetadata(d,u,"RECV"),this._dispatcherConnection.dispatch(d)}),n.on("close",()=>this._onDisconnect()),n.on("error",c=>this._onDisconnect(c)),t==="controller"){this._root=this._initDebugControllerMode();return}this._root=new Ii.RootDispatcher(this._dispatcherConnection,async(c,u)=>{if(await(0,Ri.startProfiling)(),t==="reuse-browser")return await this._initReuseBrowsersMode(c);if(t==="pre-launched-browser-or-android")return this._preLaunched.browser?await this._initPreLaunchedBrowserMode(c):await this._initPreLaunchedAndroidMode(c);if(t==="launch-browser")return await this._initLaunchBrowserMode(c,u);throw new Error("Unsupported client type: "+t)})}async _initLaunchBrowserMode(e,t){wt.debugLogger.log("server",`[${this._id}] engaged launch mode for "${this._options.browserName}"`);let n=(0,Ii.createPlaywright)({sdkLanguage:t.sdkLanguage,isServer:!0}),s=await this._createOwnedSocksProxy(n),o=await n[this._options.browserName].launch((0,$P.serverSideCallMetadata)(),this._options.launchOptions);return this._cleanups.push(async()=>{for(let a of n.allBrowsers())await a.close({reason:"Connection terminated"})}),o.on(f0.Browser.Events.Disconnected,()=>{this.close({code:1001,reason:"Browser closed"})}),new Ii.PlaywrightDispatcher(e,n,s,o)}async _initPreLaunchedBrowserMode(e){var t;wt.debugLogger.log("server",`[${this._id}] engaged pre-launched (browser) mode`);let n=this._preLaunched.playwright;(t=this._preLaunched.socksProxy)===null||t===void 0||t.setPattern(this._options.socksProxyPattern);let s=this._preLaunched.browser;s.on(f0.Browser.Events.Disconnected,()=>{this.close({code:1001,reason:"Browser closed"})});let o=new Ii.PlaywrightDispatcher(e,n,this._preLaunched.socksProxy,s);for(let a of n.allBrowsers())a!==s&&await a.close({reason:"Connection terminated"});return this._cleanups.push(()=>o.cleanup()),o}async _initPreLaunchedAndroidMode(e){wt.debugLogger.log("server",`[${this._id}] engaged pre-launched (Android) mode`);let t=this._preLaunched.playwright,n=this._preLaunched.androidDevice;n.on(dU.AndroidDevice.Events.Close,()=>{this.close({code:1001,reason:"Android device disconnected"})});let s=new Ii.PlaywrightDispatcher(e,t,void 0,void 0,n);return this._cleanups.push(()=>s.cleanup()),s}_initDebugControllerMode(){wt.debugLogger.log("server",`[${this._id}] engaged reuse controller mode`);let e=this._preLaunched.playwright;return new hU.DebugControllerDispatcher(this._dispatcherConnection,e.debugController)}async _initReuseBrowsersMode(e){wt.debugLogger.log("server",`[${this._id}] engaged reuse browsers mode for ${this._options.browserName}`);let t=this._preLaunched.playwright,n=WP(this._options.launchOptions),s=t.allBrowsers().find(a=>a.options.name!==this._options.browserName?!1:WP(a.options.originalLaunchOptions)===n);for(let a of t.allBrowsers())a!==s&&a.options.name===this._options.browserName&&a.options.channel===this._options.launchOptions.channel&&await a.close({reason:"Connection terminated"});return s||(s=await t[this._options.browserName||"chromium"].launch((0,$P.serverSideCallMetadata)(),{...this._options.launchOptions,headless:!!process.env.PW_DEBUG_CONTROLLER_HEADLESS}),s.on(f0.Browser.Events.Disconnected,()=>{this.close({code:1001,reason:"Browser closed"})})),this._cleanups.push(async()=>{for(let a of t.allBrowsers()){for(let l of a.contexts())l.pages().length?await l.stopPendingOperations("Connection closed"):await l.close({reason:"Connection terminated"});a.contexts()||await a.close({reason:"Connection terminated"})}}),new Ii.PlaywrightDispatcher(e,t,void 0,s)}async _createOwnedSocksProxy(e){if(!this._options.socksProxyPattern)return;let t=new uU.SocksProxy;return t.setPattern(this._options.socksProxyPattern),e.options.socksProxyPort=await t.listen(0),wt.debugLogger.log("server",`[${this._id}] started socks proxy on port ${e.options.socksProxyPort}`),this._cleanups.push(()=>t.close()),t}async _onDisconnect(e){this._disconnected=!0,wt.debugLogger.log("server",`[${this._id}] disconnected. error: ${e}`),this._root._dispose(),wt.debugLogger.log("server",`[${this._id}] starting cleanup`);for(let t of this._cleanups)await t().catch(()=>{});await(0,Ri.stopProfiling)(this._profileName),this._onClose(),wt.debugLogger.log("server",`[${this._id}] finished cleanup`)}logServerMetadata(e,t,n){let s={wallTime:Date.now(),id:e.id,guid:e.guid,method:e.method,payloadSizeInBytes:Buffer.byteLength(t,"utf-8")};wt.debugLogger.log("server:metadata",(n==="SEND"?"SEND \u25BA ":"\u25C0 RECV ")+JSON.stringify(s))}async close(e){if(!this._disconnected){wt.debugLogger.log("server",`[${this._id}] force closing connection: ${e?.reason||""} (${e?.code||0})`);try{this._ws.close(e?.code,e?.reason)}catch{}}}};Yh.PlaywrightConnection=m0;function WP(r){let e={...r};for(let t of Object.keys(e)){let n=t;e[n]===fU[n]&&delete e[n]}for(let t of mU)delete e[t];return JSON.stringify(e)}function pU(r){return{channel:r.channel,args:r.args,ignoreAllDefaultArgs:r.ignoreAllDefaultArgs,ignoreDefaultArgs:r.ignoreDefaultArgs,timeout:r.timeout,headless:r.headless,proxy:r.proxy,chromiumSandbox:r.chromiumSandbox,firefoxUserPrefs:r.firefoxUserPrefs,slowMo:r.slowMo,executablePath:(0,Ri.isUnderTest)()?r.executablePath:void 0}}var fU={ignoreAllDefaultArgs:!1,handleSIGINT:!1,handleSIGTERM:!1,handleSIGHUP:!1,headless:!0,devtools:!1},mU=["headless","tracesDir"]});var w0=M(Qh=>{"use strict";Object.defineProperty(Qh,"__esModule",{value:!0});Qh.PlaywrightServer=void 0;var gU=mi(),_U=UP(),g0=Hp(),zP=Le(),wU=ie(),vU=Zp(),_0=class{constructor(e){this._preLaunchedPlaywright=void 0,this._options=void 0,this._wsServer=void 0,this._options=e,e.preLaunchedBrowser&&(this._preLaunchedPlaywright=e.preLaunchedBrowser.attribution.playwright),e.preLaunchedAndroidDevice&&(this._preLaunchedPlaywright=e.preLaunchedAndroidDevice._android.attribution.playwright);let t=new g0.Semaphore(this._options.maxConnections),n=new g0.Semaphore(1),s=new g0.Semaphore(1);this._wsServer=new vU.WSServer({onUpgrade:(o,a)=>{let l=(0,wU.userAgentVersionMatchesErrorMessage)(o.headers["user-agent"]||"");if(l)return{error:`HTTP/${o.httpVersion} 428 Precondition Required\r
\r
${l}`}},onHeaders:o=>{process.env.PWTEST_SERVER_WS_HEADERS&&o.push(process.env.PWTEST_SERVER_WS_HEADERS)},onConnection:(o,a,l,c)=>{let u=o.headers["x-playwright-browser"],d=a.searchParams.get("browser")||(Array.isArray(u)?u[0]:u)||null,h=o.headers["x-playwright-proxy"],p=a.searchParams.get("proxy")||(Array.isArray(h)?h[0]:h),f=o.headers["x-playwright-launch-options"]||"",_=Array.isArray(f)?f[0]:f,v=a.searchParams.get("launch-options"),w={};try{w=JSON.parse(v||_)}catch{}let m=this._options.mode==="extension";m&&(this._preLaunchedPlaywright||(this._preLaunchedPlaywright=(0,gU.createPlaywright)({sdkLanguage:"javascript",isServer:!0})));let g="launch-browser",x=t;return m&&a.searchParams.has("debug-controller")?(g="controller",x=n):m?(g="reuse-browser",x=s):this._options.mode==="launchServer"&&(g="pre-launched-browser-or-android",x=t),new _U.PlaywrightConnection(x.acquire(),g,l,{socksProxyPattern:p,browserName:d,launchOptions:w},{playwright:this._preLaunchedPlaywright,browser:this._options.preLaunchedBrowser,androidDevice:this._options.preLaunchedAndroidDevice,socksProxy:this._options.preLaunchedSocksProxy},c,()=>x.release())},onClose:async()=>{zP.debugLogger.log("server","closing browsers"),this._preLaunchedPlaywright&&await Promise.all(this._preLaunchedPlaywright.allBrowsers().map(o=>o.close({reason:"Playwright Server stopped"}))),zP.debugLogger.log("server","closed browsers")}})}async listen(e=0,t){return this._wsServer.listen(e,t,this._options.path)}async close(){await this._wsServer.close()}};Qh.PlaywrightServer=_0});var VP=M(Zh=>{"use strict";Object.defineProperty(Zh,"__esModule",{value:!0});Zh.BrowserServerLauncherImpl=void 0;var bU=Be(),yU=Dr(),xU=ie(),SU=De(),EU=mi(),kU=w0(),CU=yt(),TU=Lt(),pG=Rs(),v0=class{constructor(e){this._browserName=void 0,this._browserName=e}async launchServer(e={}){let t=(0,EU.createPlaywright)({sdkLanguage:"javascript",isServer:!0}),n=void 0;t.options.socksProxyPort=await n?.listen(0);let s=(0,SU.serverSideCallMetadata)(),o=await t[this._browserName].launch(s,{...e,ignoreDefaultArgs:Array.isArray(e.ignoreDefaultArgs)?e.ignoreDefaultArgs:void 0,ignoreAllDefaultArgs:!!e.ignoreDefaultArgs&&!Array.isArray(e.ignoreDefaultArgs),env:e.env?(0,yU.envObjectToArray)(e.env):void 0},OU(e.logger)).catch(d=>{let h=CU.helper.formatBrowserLogs(s.log);throw(0,TU.rewriteErrorMessage)(d,`${d.message} Failed to launch browser.${h}`),d}),a=e.wsPath?e.wsPath.startsWith("/")?e.wsPath:`/${e.wsPath}`:`/${(0,xU.createGuid)()}`,l=new kU.PlaywrightServer({mode:"launchServer",path:a,maxConnections:1/0,preLaunchedBrowser:o,preLaunchedSocksProxy:n}),c=await l.listen(e.port),u=new bU.ws.EventEmitter;return u.process=()=>o.options.browserProcess.process,u.wsEndpoint=()=>c,u.close=()=>o.options.browserProcess.close(),u[Symbol.asyncDispose]=u.close,u.kill=()=>o.options.browserProcess.kill(),u._disconnectForTest=()=>l.close(),u._userDataDirForTest=o._userDataDirForTest,o.options.browserProcess.onclose=(d,h)=>{n?.close().catch(()=>{}),l.close(),u.emit("close",d,h)},u}};Zh.BrowserServerLauncherImpl=v0;function OU(r){return r?(e,t)=>{r.isEnabled("protocol","verbose")&&r.log("protocol","verbose",(e==="send"?"SEND \u25BA ":"\u25C0 RECV ")+JSON.stringify(t),[],{})}:void 0}});var GP=M(ep=>{"use strict";Object.defineProperty(ep,"__esModule",{value:!0});ep.AndroidServerLauncherImpl=void 0;var PU=Be(),AU=ie(),IU=mi(),RU=w0(),b0=class{async launchServer(e={}){let n=await(0,IU.createPlaywright)({sdkLanguage:"javascript",isServer:!0}).android.devices({host:e.adbHost,port:e.adbPort,omitDriverInstall:e.omitDriverInstall});if(n.length===0)throw new Error("No devices found");if(e.deviceSerialNumber&&(n=n.filter(u=>u.serial===e.deviceSerialNumber),n.length===0))throw new Error(`No device with serial number '${e.deviceSerialNumber}' not found`);if(n.length>1)throw new Error("More than one device found. Please specify deviceSerialNumber");let s=n[0],o=e.wsPath?e.wsPath.startsWith("/")?e.wsPath:`/${e.wsPath}`:`/${(0,AU.createGuid)()}`,a=new RU.PlaywrightServer({mode:"launchServer",path:o,maxConnections:1,preLaunchedAndroidDevice:s}),l=await a.listen(e.port),c=new PU.ws.EventEmitter;return c.wsEndpoint=()=>l,c.close=()=>s.close(),c.kill=()=>s.close(),s.on("close",()=>{a.close(),c.emit("close")}),c}};ep.AndroidServerLauncherImpl=b0});var KP=M(x0=>{"use strict";Object.defineProperty(x0,"__esModule",{value:!0});x0.createInProcessPlaywright=NU;var tp=Gv(),MU=qh(),y0=VP(),FU=GP();function NU(){let r=(0,tp.createPlaywright)({sdkLanguage:process.env.PW_LANG_NAME||"javascript"}),e=new MU.Connection(void 0,void 0);e.useRawBuffers();let t=new tp.DispatcherConnection(!0);t.onmessage=o=>e.dispatch(o),e.onmessage=o=>t.dispatch(o);let n=new tp.RootDispatcher(t);new tp.PlaywrightDispatcher(n,r);let s=e.getObjectWithKnownName("Playwright");return s.chromium._serverLauncher=new y0.BrowserServerLauncherImpl("chromium"),s.firefox._serverLauncher=new y0.BrowserServerLauncherImpl("firefox"),s.webkit._serverLauncher=new y0.BrowserServerLauncherImpl("webkit"),s._android._serverLauncher=new FU.AndroidServerLauncherImpl,t.onmessage=o=>setImmediate(()=>e.dispatch(o)),e.onmessage=o=>setImmediate(()=>t.dispatch(o)),e.toImpl=o=>o?t._dispatchers.get(o._guid)._object:t._dispatchers.get(""),s._toImpl=e.toImpl,s}});var XP=M((_G,JP)=>{"use strict";var LU=KP();JP.exports=(0,LU.createInProcessPlaywright)()});var ZP=M((wG,QP)=>{var YP=process.versions.node,DU=YP.split("."),[BU]=[+DU[0]];BU<14&&(console.error("You are running Node.js "+YP+`.
Playwright requires Node.js 14 or higher. 
Please update your version of Node.js.`),process.exit(1));QP.exports=XP()});var qU={};hA(qU,{default:()=>sA});module.exports=pA(qU);var Xe=require("@raycast/api");var Fn=ip(ZP(),1),eA=Fn.default.chromium,vG=Fn.default.firefox,bG=Fn.default.webkit,yG=Fn.default.selectors,xG=Fn.default.devices,SG=Fn.default.errors,EG=Fn.default.request,kG=Fn.default._electron,CG=Fn.default._android;var tA=require("node:fs/promises"),S0=require("node:path"),nA=require("node:os"),rA=require("node:url"),iA=require("react"),ro=require("react/jsx-runtime");function sA(){let{outputDirectory:r}=(0,Xe.getPreferenceValues)(),e=(0,iA.useRef)(null);function t(){async function n(s){if(!s.website){(0,Xe.showToast)({style:Xe.Toast.Style.Failure,title:"Website is required"});return}let o=await(0,Xe.showToast)({style:Xe.Toast.Style.Animated,title:"Taking screenshot of website..."});try{let a;s.website.startsWith("http")?a=s.website:a="https://"+s.website;let l=await eA.launch({headless:!0}),c=await l.newPage();await c.goto(a);let u=await c.screenshot({fullPage:!0}),d=new rA.URL(a),h=Date.now(),p=d.hostname+"_"+h+".png",f=u.toString("base64"),_=jU(p);await(0,tA.writeFile)(_,f,"base64"),await l.close(),o.style=Xe.Toast.Style.Success,o.title="Took screenshot of website";let v=r?`in "${r}"`:"on the Desktop";o.message=`Look for it ${v}`,o.primaryAction={title:"Show in Finder",onAction:async()=>{await(0,Xe.showInFinder)(_)}},e.current?.reset()}catch(a){o.style=Xe.Toast.Style.Failure,o.title="Failed taking screenshot of website",o.message=String(a)}}return(0,ro.jsx)(Xe.Action.SubmitForm,{icon:Xe.Icon.Window,title:"Take Screenshot",onSubmit:n})}return(0,ro.jsx)(Xe.Form,{actions:(0,ro.jsx)(Xe.ActionPanel,{children:(0,ro.jsx)(t,{})}),children:(0,ro.jsx)(Xe.Form.TextField,{id:"website",title:"Website URL",ref:e,placeholder:"Enter address of the site you want to screenshot..."})})}function jU(...r){let{outputDirectory:e}=(0,Xe.getPreferenceValues)();return e?(0,S0.join)(e,...r):(0,S0.join)((0,nA.homedir)(),"Desktop",...r)}
/*! Bundled license information:

playwright-core/lib/utilsBundleImpl/index.js:
  (*! Bundled license information:
  
  progress/lib/node-progress.js:
    (*!
     * node-progress
     * Copyright(c) 2011 TJ Holowaychuk <tj@vision-media.ca>
     * MIT Licensed
     *)
  *)
*/
